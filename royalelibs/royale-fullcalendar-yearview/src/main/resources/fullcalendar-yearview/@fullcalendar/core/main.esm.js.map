{"version":3,"file":"main.esm.js","sources":["../src/util/dom-manip.ts","../src/util/geom.ts","../src/util/scrollbars.ts","../src/util/dom-geom.ts","../src/util/dom-event.ts","../src/datelib/marker.ts","../src/datelib/duration.ts","../src/util/misc.ts","../../../node_modules/tslib/tslib.es6.js","../src/structs/recurring-event.ts","../src/util/object.ts","../src/structs/event-store.ts","../src/datelib/date-range.ts","../src/util/array.ts","../src/util/memoize.ts","../src/datelib/formatting-native.ts","../src/datelib/formatting-cmd.ts","../src/datelib/formatting-func.ts","../src/datelib/formatting.ts","../src/api/EventSourceApi.ts","../src/api/EventApi.ts","../src/component/event-rendering.ts","../src/structs/event-mutation.ts","../src/reducers/eventStore.ts","../src/validation.ts","../src/util/html.ts","../src/component/event-ui.ts","../src/structs/event.ts","../src/structs/business-hours.ts","../src/component/memoized-rendering.ts","../src/component/event-splitting.ts","../src/component/date-rendering.ts","../src/util/promise.ts","../src/common/Mixin.ts","../src/common/EmitterMixin.ts","../src/common/PositionCache.ts","../src/common/scroll-controller.ts","../src/common/ScrollComponent.ts","../src/theme/Theme.ts","../src/component/Component.ts","../src/component/DateComponent.ts","../src/plugin-system.ts","../src/event-sources/array-event-source.ts","../src/event-sources/func-event-source.ts","../src/util/requestJson.ts","../src/event-sources/json-feed-event-source.ts","../src/structs/recurring-event-simple.ts","../src/option-change-handlers.ts","../src/options.ts","../src/datelib/locale.ts","../src/OptionsManager.ts","../src/datelib/calendar-system.ts","../src/datelib/parsing.ts","../src/datelib/env.ts","../src/structs/event-source.ts","../src/reducers/eventSources.ts","../src/DateProfileGenerator.ts","../src/reducers/main.ts","../src/structs/date-span.ts","../src/structs/view-def.ts","../src/structs/view-config.ts","../src/structs/view-spec.ts","../src/Toolbar.ts","../src/CalendarComponent.ts","../src/interactions/interaction.ts","../src/interactions/EventClicking.ts","../src/interactions/EventHovering.ts","../src/theme/StandardTheme.ts","../src/Calendar.ts","../src/View.ts","../src/component/renderers/FgEventRenderer.ts","../src/component/renderers/FillRenderer.ts","../src/datelib/timezone.ts","../src/interactions/ElementDragging.ts","../src/formatting-api.ts","../src/structs/drag-meta.ts","../src/common/table-utils.ts","../src/common/DayHeader.ts","../src/common/DaySeries.ts","../src/common/DayTable.ts","../src/common/slicing-utils.ts","../src/main.ts"],"sourcesContent":["\n// Creating\n// ----------------------------------------------------------------------------------------------------------------\n\nconst elementPropHash = { // when props given to createElement should be treated as props, not attributes\n  className: true,\n  colSpan: true,\n  rowSpan: true\n}\n\nconst containerTagHash = {\n  '<tr': 'tbody',\n  '<td': 'tr'\n}\n\nexport function createElement(tagName: string, attrs: object | null, content?: ElementContent): HTMLElement {\n  let el: HTMLElement = document.createElement(tagName)\n\n  if (attrs) {\n    for (let attrName in attrs) {\n      if (attrName === 'style') {\n        applyStyle(el, attrs[attrName])\n      } else if (elementPropHash[attrName]) {\n        el[attrName] = attrs[attrName]\n      } else {\n        el.setAttribute(attrName, attrs[attrName])\n      }\n    }\n  }\n\n  if (typeof content === 'string') {\n    el.innerHTML = content // shortcut. no need to process HTML in any way\n  } else if (content != null) {\n    appendToElement(el, content)\n  }\n\n  return el\n}\n\nexport function htmlToElement(html: string): HTMLElement {\n  html = html.trim()\n  let container = document.createElement(computeContainerTag(html))\n  container.innerHTML = html\n  return container.firstChild as HTMLElement\n}\n\nexport function htmlToElements(html: string): HTMLElement[] {\n  return Array.prototype.slice.call(htmlToNodeList(html))\n}\n\nfunction htmlToNodeList(html: string): NodeList {\n  html = html.trim()\n  let container = document.createElement(computeContainerTag(html))\n  container.innerHTML = html\n  return container.childNodes\n}\n\n// assumes html already trimmed and tag names are lowercase\nfunction computeContainerTag(html: string) {\n  return containerTagHash[\n    html.substr(0, 3) // faster than using regex\n  ] || 'div'\n}\n\n\n// Inserting / Removing\n// ----------------------------------------------------------------------------------------------------------------\n\nexport type ElementContent = string | Node | Node[] | NodeList\n\nexport function appendToElement(el: HTMLElement, content: ElementContent) {\n  let childNodes = normalizeContent(content)\n\n  for (let i = 0; i < childNodes.length; i++) {\n    el.appendChild(childNodes[i])\n  }\n}\n\nexport function prependToElement(parent: HTMLElement, content: ElementContent) {\n  let newEls = normalizeContent(content)\n  let afterEl = parent.firstChild || null // if no firstChild, will append to end, but that's okay, b/c there were no children\n\n  for (let i = 0; i < newEls.length; i++) {\n    parent.insertBefore(newEls[i], afterEl)\n  }\n}\n\nexport function insertAfterElement(refEl: HTMLElement, content: ElementContent) {\n  let newEls = normalizeContent(content)\n  let afterEl = refEl.nextSibling || null\n\n  for (let i = 0; i < newEls.length; i++) {\n    refEl.parentNode.insertBefore(newEls[i], afterEl)\n  }\n}\n\nfunction normalizeContent(content: ElementContent): Node[] {\n  let els\n  if (typeof content === 'string') {\n    els = htmlToElements(content)\n  } else if (content instanceof Node) {\n    els = [ content ]\n  } else { // Node[] or NodeList\n    els = Array.prototype.slice.call(content)\n  }\n  return els\n}\n\nexport function removeElement(el: HTMLElement) {\n  if (el.parentNode) {\n    el.parentNode.removeChild(el)\n  }\n}\n\n\n// Querying\n// ----------------------------------------------------------------------------------------------------------------\n\n// from https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\nconst matchesMethod =\n  Element.prototype.matches ||\n  (Element.prototype as any).matchesSelector ||\n  (Element.prototype as any).msMatchesSelector\n\nconst closestMethod = Element.prototype.closest || function(selector) {\n  // polyfill\n  let el = this\n  if (!document.documentElement.contains(el)) {\n    return null\n  }\n  do {\n    if (elementMatches(el, selector)) {\n      return el\n    }\n    el = el.parentElement || el.parentNode\n  } while (el !== null && el.nodeType === 1)\n  return null\n}\n\nexport function elementClosest(el: HTMLElement, selector: string): HTMLElement {\n  return closestMethod.call(el, selector)\n}\n\nexport function elementMatches(el: HTMLElement, selector: string): HTMLElement {\n  return matchesMethod.call(el, selector)\n}\n\n// accepts multiple subject els\n// returns a real array. good for methods like forEach\nexport function findElements(container: HTMLElement[] | HTMLElement | NodeListOf<HTMLElement>, selector: string): HTMLElement[] {\n  let containers = container instanceof HTMLElement ? [ container ] : container\n  let allMatches: HTMLElement[] = []\n\n  for (let i = 0; i < containers.length; i++) {\n    let matches = containers[i].querySelectorAll(selector)\n\n    for (let j = 0; j < matches.length; j++) {\n      allMatches.push(matches[j] as HTMLElement)\n    }\n  }\n\n  return allMatches\n}\n\n// accepts multiple subject els\n// only queries direct child elements\nexport function findChildren(parent: HTMLElement[] | HTMLElement, selector?: string): HTMLElement[] {\n  let parents = parent instanceof HTMLElement ? [ parent ] : parent\n  let allMatches = []\n\n  for (let i = 0; i < parents.length; i++) {\n    let childNodes = parents[i].children // only ever elements\n\n    for (let j = 0; j < childNodes.length; j++) {\n      let childNode = childNodes[j]\n\n      if (!selector || elementMatches(childNode as HTMLElement, selector)) {\n        allMatches.push(childNode)\n      }\n    }\n  }\n\n  return allMatches\n}\n\n\n// Attributes\n// ----------------------------------------------------------------------------------------------------------------\n\nexport function forceClassName(el: HTMLElement, className: string, bool) { // might not be used anywhere\n  if (bool) {\n    el.classList.add(className)\n  } else {\n    el.classList.remove(className)\n  }\n}\n\n\n// Style\n// ----------------------------------------------------------------------------------------------------------------\n\nconst PIXEL_PROP_RE = /(top|left|right|bottom|width|height)$/i\n\nexport function applyStyle(el: HTMLElement, props: object) {\n  for (let propName in props) {\n    applyStyleProp(el, propName, props[propName])\n  }\n}\n\nexport function applyStyleProp(el: HTMLElement, name: string, val) {\n  if (val == null) {\n    el.style[name] = ''\n  } else if (typeof val === 'number' && PIXEL_PROP_RE.test(name)) {\n    el.style[name] = val + 'px'\n  } else {\n    el.style[name] = val\n  }\n}\n","\nexport interface Point {\n  left: number\n  top: number\n}\n\nexport interface Rect {\n  left: number\n  right: number\n  top: number\n  bottom: number\n}\n\n\nexport function pointInsideRect(point: Point, rect: Rect): boolean {\n  return point.left >= rect.left &&\n    point.left < rect.right &&\n    point.top >= rect.top &&\n    point.top < rect.bottom\n}\n\n\n// Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false\nexport function intersectRects(rect1: Rect, rect2: Rect): Rect | false {\n  let res = {\n    left: Math.max(rect1.left, rect2.left),\n    right: Math.min(rect1.right, rect2.right),\n    top: Math.max(rect1.top, rect2.top),\n    bottom: Math.min(rect1.bottom, rect2.bottom)\n  }\n\n  if (res.left < res.right && res.top < res.bottom) {\n    return res\n  }\n\n  return false\n}\n\n\nexport function translateRect(rect: Rect, deltaX: number, deltaY: number): Rect {\n  return {\n    left: rect.left + deltaX,\n    right: rect.right + deltaX,\n    top: rect.top + deltaY,\n    bottom: rect.bottom + deltaY\n  }\n}\n\n\n// Returns a new point that will have been moved to reside within the given rectangle\nexport function constrainPoint(point: Point, rect: Rect): Point {\n  return {\n    left: Math.min(Math.max(point.left, rect.left), rect.right),\n    top: Math.min(Math.max(point.top, rect.top), rect.bottom)\n  }\n}\n\n\n// Returns a point that is the center of the given rectangle\nexport function getRectCenter(rect: Rect): Point {\n  return {\n    left: (rect.left + rect.right) / 2,\n    top: (rect.top + rect.bottom) / 2\n  }\n}\n\n\n// Subtracts point2's coordinates from point1's coordinates, returning a delta\nexport function diffPoints(point1: Point, point2: Point): Point {\n  return {\n    left: point1.left - point2.left,\n    top: point1.top - point2.top\n  }\n}\n","import { createElement, removeElement } from './dom-manip'\n\n\n// Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side\n\nlet isRtlScrollbarOnLeft: boolean | null = null\n\nexport function getIsRtlScrollbarOnLeft() { // responsible for caching the computation\n  if (isRtlScrollbarOnLeft === null) {\n    isRtlScrollbarOnLeft = computeIsRtlScrollbarOnLeft()\n  }\n  return isRtlScrollbarOnLeft\n}\n\nfunction computeIsRtlScrollbarOnLeft() { // creates an offscreen test element, then removes it\n  let outerEl = createElement('div', {\n    style: {\n      position: 'absolute',\n      top: -1000,\n      left: 0,\n      border: 0,\n      padding: 0,\n      overflow: 'scroll',\n      direction: 'rtl'\n    }\n  }, '<div></div>')\n\n  document.body.appendChild(outerEl)\n  let innerEl = outerEl.firstChild as HTMLElement\n  let res = innerEl.getBoundingClientRect().left > outerEl.getBoundingClientRect().left\n\n  removeElement(outerEl)\n  return res\n}\n\n\n// The scrollbar width computations in computeEdges are sometimes flawed when it comes to\n// retina displays, rounding, and IE11. Massage them into a usable value.\nexport function sanitizeScrollbarWidth(width: number) {\n  width = Math.max(0, width) // no negatives\n  width = Math.round(width)\n  return width\n}\n","import { Rect, intersectRects } from './geom'\nimport { sanitizeScrollbarWidth, getIsRtlScrollbarOnLeft } from './scrollbars'\n\nexport interface EdgeInfo {\n  borderLeft: number\n  borderRight: number\n  borderTop: number\n  borderBottom: number\n  scrollbarLeft: number\n  scrollbarRight: number\n  scrollbarBottom: number\n  paddingLeft?: number\n  paddingRight?: number\n  paddingTop?: number\n  paddingBottom?: number\n}\n\n\nexport function computeEdges(el, getPadding = false): EdgeInfo {\n  let computedStyle = window.getComputedStyle(el)\n  let borderLeft = parseInt(computedStyle.borderLeftWidth, 10) || 0\n  let borderRight = parseInt(computedStyle.borderRightWidth, 10) || 0\n  let borderTop = parseInt(computedStyle.borderTopWidth, 10) || 0\n  let borderBottom = parseInt(computedStyle.borderBottomWidth, 10) || 0\n\n  // must use offset(Width|Height) because compatible with client(Width|Height)\n  let scrollbarLeftRight = sanitizeScrollbarWidth(el.offsetWidth - el.clientWidth - borderLeft - borderRight)\n  let scrollbarBottom = sanitizeScrollbarWidth(el.offsetHeight - el.clientHeight - borderTop - borderBottom)\n\n  let res: EdgeInfo = {\n    borderLeft,\n    borderRight,\n    borderTop,\n    borderBottom,\n    scrollbarBottom,\n    scrollbarLeft: 0,\n    scrollbarRight: 0\n  }\n\n  if (getIsRtlScrollbarOnLeft() && computedStyle.direction === 'rtl') { // is the scrollbar on the left side?\n    res.scrollbarLeft = scrollbarLeftRight\n  } else {\n    res.scrollbarRight = scrollbarLeftRight\n  }\n\n  if (getPadding) {\n    res.paddingLeft = parseInt(computedStyle.paddingLeft, 10) || 0\n    res.paddingRight = parseInt(computedStyle.paddingRight, 10) || 0\n    res.paddingTop = parseInt(computedStyle.paddingTop, 10) || 0\n    res.paddingBottom = parseInt(computedStyle.paddingBottom, 10) || 0\n  }\n\n  return res\n}\n\n\nexport function computeInnerRect(el, goWithinPadding = false) {\n  let outerRect = computeRect(el)\n  let edges = computeEdges(el, goWithinPadding)\n  let res = {\n    left: outerRect.left + edges.borderLeft + edges.scrollbarLeft,\n    right: outerRect.right - edges.borderRight - edges.scrollbarRight,\n    top: outerRect.top + edges.borderTop,\n    bottom: outerRect.bottom - edges.borderBottom - edges.scrollbarBottom\n  }\n\n  if (goWithinPadding) {\n    res.left += edges.paddingLeft\n    res.right -= edges.paddingRight\n    res.top += edges.paddingTop\n    res.bottom -= edges.paddingBottom\n  }\n\n  return res\n}\n\n\nexport function computeRect(el): Rect {\n  let rect = el.getBoundingClientRect()\n\n  return {\n    left: rect.left + window.pageXOffset,\n    top: rect.top + window.pageYOffset,\n    right: rect.right + window.pageXOffset,\n    bottom: rect.bottom + window.pageYOffset\n  }\n}\n\n\nfunction computeViewportRect(): Rect {\n  return {\n    left: window.pageXOffset,\n    right: window.pageXOffset + document.documentElement.clientWidth,\n    top: window.pageYOffset,\n    bottom: window.pageYOffset + document.documentElement.clientHeight\n  }\n}\n\n\nexport function computeHeightAndMargins(el: HTMLElement) {\n  return el.getBoundingClientRect().height + computeVMargins(el)\n}\n\n\nexport function computeVMargins(el: HTMLElement) {\n  let computed = window.getComputedStyle(el)\n\n  return parseInt(computed.marginTop, 10) +\n    parseInt(computed.marginBottom, 10)\n}\n\n\n// does not return window\nexport function getClippingParents(el: HTMLElement): HTMLElement[] {\n  let parents: HTMLElement[] = []\n\n  while (el instanceof HTMLElement) { // will stop when gets to document or null\n    let computedStyle = window.getComputedStyle(el)\n\n    if (computedStyle.position === 'fixed') {\n      break\n    }\n\n    if ((/(auto|scroll)/).test(computedStyle.overflow + computedStyle.overflowY + computedStyle.overflowX)) {\n      parents.push(el)\n    }\n\n    el = el.parentNode as HTMLElement\n  }\n\n  return parents\n}\n\n\nexport function computeClippingRect(el: HTMLElement): Rect {\n  return getClippingParents(el)\n    .map(function(el) {\n      return computeInnerRect(el)\n    })\n    .concat(computeViewportRect())\n    .reduce(function(rect0, rect1) {\n      return intersectRects(rect0, rect1) || rect1 // should always intersect\n    })\n}\n","import { elementClosest } from './dom-manip'\n\n\n// Stops a mouse/touch event from doing it's native browser action\nexport function preventDefault(ev) {\n  ev.preventDefault()\n}\n\n\n// Event Delegation\n// ----------------------------------------------------------------------------------------------------------------\n\nexport function listenBySelector(\n  container: HTMLElement,\n  eventType: string,\n  selector: string,\n  handler: (ev: Event, matchedTarget: HTMLElement) => void\n) {\n  function realHandler(ev: Event) {\n    let matchedChild = elementClosest(ev.target as HTMLElement, selector)\n    if (matchedChild) {\n      handler.call(matchedChild, ev, matchedChild)\n    }\n  }\n\n  container.addEventListener(eventType, realHandler)\n\n  return function() {\n    container.removeEventListener(eventType, realHandler)\n  }\n}\n\nexport function listenToHoverBySelector(\n  container: HTMLElement,\n  selector: string,\n  onMouseEnter: (ev: Event, matchedTarget: HTMLElement) => void,\n  onMouseLeave: (ev: Event, matchedTarget: HTMLElement) => void\n) {\n  let currentMatchedChild\n\n  return listenBySelector(container, 'mouseover', selector, function(ev, matchedChild) {\n    if (matchedChild !== currentMatchedChild) {\n      currentMatchedChild = matchedChild\n      onMouseEnter(ev, matchedChild)\n\n      let realOnMouseLeave = (ev) => {\n        currentMatchedChild = null\n        onMouseLeave(ev, matchedChild)\n        matchedChild.removeEventListener('mouseleave', realOnMouseLeave)\n      }\n\n      // listen to the next mouseleave, and then unattach\n      matchedChild.addEventListener('mouseleave', realOnMouseLeave)\n    }\n  })\n}\n\n\n// Animation\n// ----------------------------------------------------------------------------------------------------------------\n\nconst transitionEventNames = [\n  'webkitTransitionEnd',\n  'otransitionend',\n  'oTransitionEnd',\n  'msTransitionEnd',\n  'transitionend'\n]\n\n// triggered only when the next single subsequent transition finishes\nexport function whenTransitionDone(el: HTMLElement, callback: (ev: Event) => void) {\n  let realCallback = function(ev) {\n    callback(ev)\n    transitionEventNames.forEach(function(eventName) {\n      el.removeEventListener(eventName, realCallback)\n    })\n  }\n\n  transitionEventNames.forEach(function(eventName) {\n    el.addEventListener(eventName, realCallback) // cross-browser way to determine when the transition finishes\n  })\n}\n","import { Duration } from './duration'\n\nexport type DateMarker = Date\n\nexport const DAY_IDS = [ 'sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat' ]\n\n\n// Adding\n\nexport function addWeeks(m: DateMarker, n: number) {\n  let a = dateToUtcArray(m)\n  a[2] += n * 7\n  return arrayToUtcDate(a)\n}\n\nexport function addDays(m: DateMarker, n: number) {\n  let a = dateToUtcArray(m)\n  a[2] += n\n  return arrayToUtcDate(a)\n}\n\nexport function addMs(m: DateMarker, n: number) {\n  let a = dateToUtcArray(m)\n  a[6] += n\n  return arrayToUtcDate(a)\n}\n\n\n// Diffing (all return floats)\n\nexport function diffWeeks(m0, m1) {\n  return diffDays(m0, m1) / 7\n}\n\nexport function diffDays(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60 * 24)\n}\n\nexport function diffHours(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60)\n}\n\nexport function diffMinutes(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60)\n}\n\nexport function diffSeconds(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / 1000\n}\n\nexport function diffDayAndTime(m0: DateMarker, m1: DateMarker): Duration {\n  let m0day = startOfDay(m0)\n  let m1day = startOfDay(m1)\n\n  return {\n    years: 0,\n    months: 0,\n    days: Math.round(diffDays(m0day, m1day)),\n    milliseconds: (m1.valueOf() - m1day.valueOf()) - (m0.valueOf() - m0day.valueOf())\n  }\n}\n\n\n// Diffing Whole Units\n\nexport function diffWholeWeeks(m0: DateMarker, m1: DateMarker): number {\n  let d = diffWholeDays(m0, m1)\n\n  if (d !== null && d % 7 === 0) {\n    return d / 7\n  }\n\n  return null\n}\n\nexport function diffWholeDays(m0: DateMarker, m1: DateMarker): number {\n  if (timeAsMs(m0) === timeAsMs(m1)) {\n    return Math.round(diffDays(m0, m1))\n  }\n  return null\n}\n\n\n// Start-Of\n\nexport function startOfDay(m: DateMarker): DateMarker {\n  return arrayToUtcDate([\n    m.getUTCFullYear(),\n    m.getUTCMonth(),\n    m.getUTCDate()\n  ])\n}\n\nexport function startOfHour(m: DateMarker) {\n  return arrayToUtcDate([\n    m.getUTCFullYear(),\n    m.getUTCMonth(),\n    m.getUTCDate(),\n    m.getUTCHours()\n  ])\n}\n\nexport function startOfMinute(m: DateMarker) {\n  return arrayToUtcDate([\n    m.getUTCFullYear(),\n    m.getUTCMonth(),\n    m.getUTCDate(),\n    m.getUTCHours(),\n    m.getUTCMinutes()\n  ])\n}\n\nexport function startOfSecond(m: DateMarker) {\n  return arrayToUtcDate([\n    m.getUTCFullYear(),\n    m.getUTCMonth(),\n    m.getUTCDate(),\n    m.getUTCHours(),\n    m.getUTCMinutes(),\n    m.getUTCSeconds()\n  ])\n}\n\n\n// Week Computation\n\nexport function weekOfYear(marker, dow, doy) {\n  let y = marker.getUTCFullYear()\n  let w = weekOfGivenYear(marker, y, dow, doy)\n\n  if (w < 1) {\n    return weekOfGivenYear(marker, y - 1, dow, doy)\n  }\n\n  let nextW = weekOfGivenYear(marker, y + 1, dow, doy)\n  if (nextW >= 1) {\n    return Math.min(w, nextW)\n  }\n\n  return w\n}\n\nfunction weekOfGivenYear(marker, year, dow, doy) {\n  let firstWeekStart = arrayToUtcDate([ year, 0, 1 + firstWeekOffset(year, dow, doy) ])\n  let dayStart = startOfDay(marker)\n  let days = Math.round(diffDays(firstWeekStart, dayStart))\n\n  return Math.floor(days / 7) + 1 // zero-indexed\n}\n\n// start-of-first-week - start-of-year\nfunction firstWeekOffset(year, dow, doy) {\n\n  // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n  let fwd = 7 + dow - doy\n\n  // first-week day local weekday -- which local weekday is fwd\n  let fwdlw = (7 + arrayToUtcDate([ year, 0, fwd ]).getUTCDay() - dow) % 7\n\n  return -fwdlw + fwd - 1\n}\n\n\n// Array Conversion\n\nexport function dateToLocalArray(date) {\n  return [\n    date.getFullYear(),\n    date.getMonth(),\n    date.getDate(),\n    date.getHours(),\n    date.getMinutes(),\n    date.getSeconds(),\n    date.getMilliseconds()\n  ]\n}\n\nexport function arrayToLocalDate(a) {\n  return new Date(\n    a[0],\n    a[1] || 0,\n    a[2] == null ? 1 : a[2], // day of month\n    a[3] || 0,\n    a[4] || 0,\n    a[5] || 0\n  )\n}\n\nexport function dateToUtcArray(date) {\n  return [\n    date.getUTCFullYear(),\n    date.getUTCMonth(),\n    date.getUTCDate(),\n    date.getUTCHours(),\n    date.getUTCMinutes(),\n    date.getUTCSeconds(),\n    date.getUTCMilliseconds()\n  ]\n}\n\nexport function arrayToUtcDate(a) {\n\n  // according to web standards (and Safari), a month index is required.\n  // massage if only given a year.\n  if (a.length === 1) {\n    a = a.concat([ 0 ])\n  }\n\n  return new Date(Date.UTC.apply(Date, a))\n}\n\n\n// Other Utils\n\nexport function isValidDate(m: DateMarker) {\n  return !isNaN(m.valueOf())\n}\n\nexport function timeAsMs(m: DateMarker) {\n  return m.getUTCHours() * 1000 * 60 * 60 +\n    m.getUTCMinutes() * 1000 * 60 +\n    m.getUTCSeconds() * 1000 +\n    m.getUTCMilliseconds()\n}\n","import { isInt } from '../util/misc'\n\nexport type DurationInput = DurationObjectInput | string | number\n\nexport interface DurationObjectInput {\n  years?: number\n  year?: number\n  months?: number\n  month?: number\n  weeks?: number\n  week?: number\n  days?: number\n  day?: number\n  hours?: number\n  hour?: number\n  minutes?: number\n  minute?: number\n  seconds?: number\n  second?: number\n  milliseconds?: number\n  millisecond?: number\n  ms?: number\n}\n\nexport interface Duration {\n  years: number\n  months: number\n  days: number\n  milliseconds: number\n}\n\nconst INTERNAL_UNITS = [ 'years', 'months', 'days', 'milliseconds' ]\nconst PARSE_RE = /^(-?)(?:(\\d+)\\.)?(\\d+):(\\d\\d)(?::(\\d\\d)(?:\\.(\\d\\d\\d))?)?/\n\n\n// Parsing and Creation\n\nexport function createDuration(input: DurationInput, unit?: string): Duration | null {\n  if (typeof input === 'string') {\n    return parseString(input)\n  } else if (typeof input === 'object' && input) { // non-null object\n    return normalizeObject(input)\n  } else if (typeof input === 'number') {\n    return normalizeObject({ [unit || 'milliseconds']: input })\n  } else {\n    return null\n  }\n}\n\nfunction parseString(s: string): Duration {\n  let m = PARSE_RE.exec(s)\n  if (m) {\n    let sign = m[1] ? -1 : 1\n    return {\n      years: 0,\n      months: 0,\n      days: sign * (m[2] ? parseInt(m[2], 10) : 0),\n      milliseconds: sign * (\n        (m[3] ? parseInt(m[3], 10) : 0) * 60 * 60 * 1000 + // hours\n        (m[4] ? parseInt(m[4], 10) : 0) * 60 * 1000 + // minutes\n        (m[5] ? parseInt(m[5], 10) : 0) * 1000 + // seconds\n        (m[6] ? parseInt(m[6], 10) : 0) // ms\n      )\n    }\n  }\n  return null\n}\n\nfunction normalizeObject(obj: DurationObjectInput): Duration {\n  return {\n    years: obj.years || obj.year || 0,\n    months: obj.months || obj.month || 0,\n    days:\n      (obj.days || obj.day || 0) +\n      getWeeksFromInput(obj) * 7,\n    milliseconds:\n      (obj.hours || obj.hour || 0) * 60 * 60 * 1000 + // hours\n      (obj.minutes || obj.minute || 0) * 60 * 1000 + // minutes\n      (obj.seconds || obj.second || 0) * 1000 + // seconds\n      (obj.milliseconds || obj.millisecond || obj.ms || 0) // ms\n  }\n}\n\nexport function getWeeksFromInput(obj: DurationObjectInput) {\n  return obj.weeks || obj.week || 0\n}\n\n\n// Equality\n\nexport function durationsEqual(d0: Duration, d1: Duration): boolean {\n  return d0.years === d1.years &&\n    d0.months === d1.months &&\n    d0.days === d1.days &&\n    d0.milliseconds === d1.milliseconds\n}\n\nexport function isSingleDay(dur: Duration) {\n  return dur.years === 0 && dur.months === 0 && dur.days === 1 && dur.milliseconds === 0\n}\n\n\n// Simple Math\n\nexport function addDurations(d0: Duration, d1: Duration) {\n  return {\n    years: d0.years + d1.years,\n    months: d0.months + d1.months,\n    days: d0.days + d1.days,\n    milliseconds: d0.milliseconds + d1.milliseconds\n  }\n}\n\nexport function subtractDurations(d1: Duration, d0: Duration): Duration {\n  return {\n    years: d1.years - d0.years,\n    months: d1.months - d0.months,\n    days: d1.days - d0.days,\n    milliseconds: d1.milliseconds - d0.milliseconds\n  }\n}\n\nexport function multiplyDuration(d: Duration, n: number) {\n  return {\n    years: d.years * n,\n    months: d.months * n,\n    days: d.days * n,\n    milliseconds: d.milliseconds * n\n  }\n}\n\n\n// Conversions\n// \"Rough\" because they are based on average-case Gregorian months/years\n\nexport function asRoughYears(dur: Duration) {\n  return asRoughDays(dur) / 365\n}\n\nexport function asRoughMonths(dur: Duration) {\n  return asRoughDays(dur) / 30\n}\n\nexport function asRoughDays(dur: Duration) {\n  return asRoughMs(dur) / 864e5\n}\n\nexport function asRoughHours(dur: Duration) {\n  return asRoughMs(dur) / (1000 * 60 * 60)\n}\n\nexport function asRoughMinutes(dur: Duration) {\n  return asRoughMs(dur) / (1000 * 60)\n}\n\nexport function asRoughSeconds(dur: Duration) {\n  return asRoughMs(dur) / 1000\n}\n\nexport function asRoughMs(dur: Duration) {\n  return dur.years * (365 * 864e5) +\n    dur.months * (30 * 864e5) +\n    dur.days * 864e5 +\n    dur.milliseconds\n}\n\n\n// Advanced Math\n\nexport function wholeDivideDurations(numerator: Duration, denominator: Duration): number {\n  let res = null\n\n  for (let i = 0; i < INTERNAL_UNITS.length; i++) {\n    let unit = INTERNAL_UNITS[i]\n\n    if (denominator[unit]) {\n      let localRes = numerator[unit] / denominator[unit]\n\n      if (!isInt(localRes) || (res !== null && res !== localRes)) {\n        return null\n      }\n\n      res = localRes\n\n    } else if (numerator[unit]) {\n      // needs to divide by something but can't!\n      return null\n    }\n  }\n\n  return res\n}\n\nexport function greatestDurationDenominator(dur: Duration, dontReturnWeeks?: boolean) {\n  let ms = dur.milliseconds\n  if (ms) {\n    if (ms % 1000 !== 0) {\n      return { unit: 'millisecond', value: ms }\n    }\n    if (ms % (1000 * 60) !== 0) {\n      return { unit: 'second', value: ms / 1000 }\n    }\n    if (ms % (1000 * 60 * 60) !== 0) {\n      return { unit: 'minute', value: ms / (1000 * 60) }\n    }\n    if (ms) {\n      return { unit: 'hour', value: ms / (1000 * 60 * 60) }\n    }\n  }\n  if (dur.days) {\n    if (!dontReturnWeeks && dur.days % 7 === 0) {\n      return { unit: 'week', value: dur.days / 7 }\n    }\n    return { unit: 'day', value: dur.days }\n  }\n  if (dur.months) {\n    return { unit: 'month', value: dur.months }\n  }\n  if (dur.years) {\n    return { unit: 'year', value: dur.years }\n  }\n  return { unit: 'millisecond', value: 0 }\n}\n","import { applyStyle } from './dom-manip'\nimport { computeVMargins } from './dom-geom'\nimport { preventDefault } from './dom-event'\nimport { DateMarker, startOfDay, addDays, diffDays, diffDayAndTime } from '../datelib/marker'\nimport { Duration, asRoughMs, createDuration } from '../datelib/duration'\nimport { DateEnv } from '../datelib/env'\nimport { DateRange, OpenDateRange } from '../datelib/date-range'\n\n\n/* FullCalendar-specific DOM Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n\n\n// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left\n// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.\nexport function compensateScroll(rowEl: HTMLElement, scrollbarWidths) {\n  if (scrollbarWidths.left) {\n    applyStyle(rowEl, {\n      borderLeftWidth: 1,\n      marginLeft: scrollbarWidths.left - 1\n    })\n  }\n  if (scrollbarWidths.right) {\n    applyStyle(rowEl, {\n      borderRightWidth: 1,\n      marginRight: scrollbarWidths.right - 1\n    })\n  }\n}\n\n\n// Undoes compensateScroll and restores all borders/margins\nexport function uncompensateScroll(rowEl: HTMLElement) {\n  applyStyle(rowEl, {\n    marginLeft: '',\n    marginRight: '',\n    borderLeftWidth: '',\n    borderRightWidth: ''\n  })\n}\n\n\n// Make the mouse cursor express that an event is not allowed in the current area\nexport function disableCursor() {\n  document.body.classList.add('fc-not-allowed')\n}\n\n\n// Returns the mouse cursor to its original look\nexport function enableCursor() {\n  document.body.classList.remove('fc-not-allowed')\n}\n\n\n// Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.\n// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering\n// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and\n// reduces the available height.\nexport function distributeHeight(els: HTMLElement[], availableHeight, shouldRedistribute) {\n\n  // *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,\n  // and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.\n\n  let minOffset1 = Math.floor(availableHeight / els.length) // for non-last element\n  let minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)) // for last element *FLOORING NOTE*\n  let flexEls = [] // elements that are allowed to expand. array of DOM nodes\n  let flexOffsets = [] // amount of vertical space it takes up\n  let flexHeights = [] // actual css height\n  let usedHeight = 0\n\n  undistributeHeight(els) // give all elements their natural height\n\n  // find elements that are below the recommended height (expandable).\n  // important to query for heights in a single first pass (to avoid reflow oscillation).\n  els.forEach(function(el, i) {\n    let minOffset = i === els.length - 1 ? minOffset2 : minOffset1\n    let naturalHeight = el.getBoundingClientRect().height\n    let naturalOffset = naturalHeight + computeVMargins(el)\n\n    if (naturalOffset < minOffset) {\n      flexEls.push(el)\n      flexOffsets.push(naturalOffset)\n      flexHeights.push(naturalHeight)\n    } else {\n      // this element stretches past recommended height (non-expandable). mark the space as occupied.\n      usedHeight += naturalOffset\n    }\n  })\n\n  // readjust the recommended height to only consider the height available to non-maxed-out rows.\n  if (shouldRedistribute) {\n    availableHeight -= usedHeight\n    minOffset1 = Math.floor(availableHeight / flexEls.length)\n    minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)) // *FLOORING NOTE*\n  }\n\n  // assign heights to all expandable elements\n  flexEls.forEach(function(el, i) {\n    let minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1\n    let naturalOffset = flexOffsets[i]\n    let naturalHeight = flexHeights[i]\n    let newHeight = minOffset - (naturalOffset - naturalHeight) // subtract the margin/padding\n\n    if (naturalOffset < minOffset) { // we check this again because redistribution might have changed things\n      el.style.height = newHeight + 'px'\n    }\n  })\n}\n\n\n// Undoes distrubuteHeight, restoring all els to their natural height\nexport function undistributeHeight(els: HTMLElement[]) {\n  els.forEach(function(el) {\n    el.style.height = ''\n  })\n}\n\n\n// Given `els`, a set of <td> cells, find the cell with the largest natural width and set the widths of all the\n// cells to be that width.\n// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline\nexport function matchCellWidths(els: HTMLElement[]) {\n  let maxInnerWidth = 0\n\n  els.forEach(function(el) {\n    let innerEl = el.firstChild // hopefully an element\n    if (innerEl instanceof HTMLElement) {\n      let innerWidth = innerEl.getBoundingClientRect().width\n      if (innerWidth > maxInnerWidth) {\n        maxInnerWidth = innerWidth\n      }\n    }\n  })\n\n  maxInnerWidth++ // sometimes not accurate of width the text needs to stay on one line. insurance\n\n  els.forEach(function(el) {\n    el.style.width = maxInnerWidth + 'px'\n  })\n\n  return maxInnerWidth\n}\n\n\n// Given one element that resides inside another,\n// Subtracts the height of the inner element from the outer element.\nexport function subtractInnerElHeight(outerEl: HTMLElement, innerEl: HTMLElement) {\n\n  // effin' IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked\n  let reflowStyleProps = {\n    position: 'relative', // cause a reflow, which will force fresh dimension recalculation\n    left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll\n  }\n  applyStyle(outerEl, reflowStyleProps)\n  applyStyle(innerEl, reflowStyleProps)\n\n  let diff = // grab the dimensions\n    outerEl.getBoundingClientRect().height -\n    innerEl.getBoundingClientRect().height\n\n  // undo hack\n  let resetStyleProps = { position: '', left: '' }\n  applyStyle(outerEl, resetStyleProps)\n  applyStyle(innerEl, resetStyleProps)\n\n  return diff\n}\n\n\n/* Selection\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nexport function preventSelection(el: HTMLElement) {\n  el.classList.add('fc-unselectable')\n  el.addEventListener('selectstart', preventDefault)\n}\n\n\nexport function allowSelection(el: HTMLElement) {\n  el.classList.remove('fc-unselectable')\n  el.removeEventListener('selectstart', preventDefault)\n}\n\n\n/* Context Menu\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nexport function preventContextMenu(el: HTMLElement) {\n  el.addEventListener('contextmenu', preventDefault)\n}\n\n\nexport function allowContextMenu(el: HTMLElement) {\n  el.removeEventListener('contextmenu', preventDefault)\n}\n\n\n/* Object Ordering by Field\n----------------------------------------------------------------------------------------------------------------------*/\n\nexport function parseFieldSpecs(input) {\n  let specs = []\n  let tokens = []\n  let i\n  let token\n\n  if (typeof input === 'string') {\n    tokens = input.split(/\\s*,\\s*/)\n  } else if (typeof input === 'function') {\n    tokens = [ input ]\n  } else if (Array.isArray(input)) {\n    tokens = input\n  }\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i]\n\n    if (typeof token === 'string') {\n      specs.push(\n        token.charAt(0) === '-' ?\n          { field: token.substring(1), order: -1 } :\n          { field: token, order: 1 }\n      )\n    } else if (typeof token === 'function') {\n      specs.push({ func: token })\n    }\n  }\n\n  return specs\n}\n\n\nexport function compareByFieldSpecs(obj0, obj1, fieldSpecs) {\n  let i\n  let cmp\n\n  for (i = 0; i < fieldSpecs.length; i++) {\n    cmp = compareByFieldSpec(obj0, obj1, fieldSpecs[i])\n    if (cmp) {\n      return cmp\n    }\n  }\n\n  return 0\n}\n\n\nexport function compareByFieldSpec(obj0, obj1, fieldSpec) {\n  if (fieldSpec.func) {\n    return fieldSpec.func(obj0, obj1)\n  }\n\n  return flexibleCompare(obj0[fieldSpec.field], obj1[fieldSpec.field])\n    * (fieldSpec.order || 1)\n}\n\n\nexport function flexibleCompare(a, b) {\n  if (!a && !b) {\n    return 0\n  }\n  if (b == null) {\n    return -1\n  }\n  if (a == null) {\n    return 1\n  }\n  if (typeof a === 'string' || typeof b === 'string') {\n    return String(a).localeCompare(String(b))\n  }\n  return a - b\n}\n\n\n/* String Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nexport function capitaliseFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1)\n}\n\n\nexport function padStart(val, len) { // doesn't work with total length more than 3\n  let s = String(val)\n  return '000'.substr(0, len - s.length) + s\n}\n\n\n/* Number Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nexport function compareNumbers(a, b) { // for .sort()\n  return a - b\n}\n\n\nexport function isInt(n) {\n  return n % 1 === 0\n}\n\n\n/* Weird Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nexport function applyAll(functions, thisObj, args) {\n  if (typeof functions === 'function') { // supplied a single function\n    functions = [ functions ]\n  }\n  if (functions) {\n    let i\n    let ret\n    for (i = 0; i < functions.length; i++) {\n      ret = functions[i].apply(thisObj, args) || ret\n    }\n    return ret\n  }\n}\n\n\nexport function firstDefined(...args) {\n  for (let i = 0; i < args.length; i++) {\n    if (args[i] !== undefined) {\n      return args[i]\n    }\n  }\n}\n\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714\nexport function debounce(func, wait) {\n  let timeout\n  let args\n  let context\n  let timestamp\n  let result\n\n  let later = function() {\n    let last = new Date().valueOf() - timestamp\n    if (last < wait) {\n      timeout = setTimeout(later, wait - last)\n    } else {\n      timeout = null\n      result = func.apply(context, args)\n      context = args = null\n    }\n  }\n\n  return function() {\n    context = this\n    args = arguments\n    timestamp = new Date().valueOf()\n    if (!timeout) {\n      timeout = setTimeout(later, wait)\n    }\n    return result\n  }\n}\n\n\n/* Object Parsing\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nexport type GenericHash = { [key: string]: any }\n\n// Number and Boolean are only types that defaults or not computed for\n// TODO: write more comments\nexport function refineProps(rawProps: GenericHash, processors: GenericHash, defaults: GenericHash = {}, leftoverProps?: GenericHash): GenericHash {\n  let refined: GenericHash = {}\n\n  for (let key in processors) {\n    let processor = processors[key]\n\n    if (rawProps[key] !== undefined) {\n      // found\n      if (processor === Function) {\n        refined[key] = typeof rawProps[key] === 'function' ? rawProps[key] : null\n      } else if (processor) { // a refining function?\n        refined[key] = processor(rawProps[key])\n      } else {\n        refined[key] = rawProps[key]\n      }\n    } else if (defaults[key] !== undefined) {\n      // there's an explicit default\n      refined[key] = defaults[key]\n    } else {\n      // must compute a default\n      if (processor === String) {\n        refined[key] = '' // empty string is default for String\n      } else if (!processor || processor === Number || processor === Boolean || processor === Function) {\n        refined[key] = null // assign null for other non-custom processor funcs\n      } else {\n        refined[key] = processor(null) // run the custom processor func\n      }\n    }\n  }\n\n  if (leftoverProps) {\n    for (let key in rawProps) {\n      if (processors[key] === undefined) {\n        leftoverProps[key] = rawProps[key]\n      }\n    }\n  }\n\n  return refined\n}\n\n\n/* Date stuff that doesn't belong in datelib core\n----------------------------------------------------------------------------------------------------------------------*/\n\n\n// given a timed range, computes an all-day range that has the same exact duration,\n// but whose start time is aligned with the start of the day.\nexport function computeAlignedDayRange(timedRange: DateRange): DateRange {\n  let dayCnt = Math.floor(diffDays(timedRange.start, timedRange.end)) || 1\n  let start = startOfDay(timedRange.start)\n  let end = addDays(start, dayCnt)\n  return { start, end }\n}\n\n\n// given a timed range, computes an all-day range based on how for the end date bleeds into the next day\n// TODO: give nextDayThreshold a default arg\nexport function computeVisibleDayRange(timedRange: OpenDateRange, nextDayThreshold: Duration = createDuration(0)): OpenDateRange {\n  let startDay: DateMarker = null\n  let endDay: DateMarker = null\n\n  if (timedRange.end) {\n    endDay = startOfDay(timedRange.end)\n\n    let endTimeMS: number = timedRange.end.valueOf() - endDay.valueOf() // # of milliseconds into `endDay`\n\n    // If the end time is actually inclusively part of the next day and is equal to or\n    // beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.\n    // Otherwise, leaving it as inclusive will cause it to exclude `endDay`.\n    if (endTimeMS && endTimeMS >= asRoughMs(nextDayThreshold)) {\n      endDay = addDays(endDay, 1)\n    }\n  }\n\n  if (timedRange.start) {\n    startDay = startOfDay(timedRange.start) // the beginning of the day the range starts\n\n    // If end is within `startDay` but not past nextDayThreshold, assign the default duration of one day.\n    if (endDay && endDay <= startDay) {\n      endDay = addDays(startDay, 1)\n    }\n  }\n\n  return { start: startDay, end: endDay }\n}\n\n\n// spans from one day into another?\nexport function isMultiDayRange(range: DateRange) {\n  let visibleRange = computeVisibleDayRange(range)\n\n  return diffDays(visibleRange.start, visibleRange.end) > 1\n}\n\n\nexport function diffDates(date0: DateMarker, date1: DateMarker, dateEnv: DateEnv, largeUnit?: string) {\n  if (largeUnit === 'year') {\n    return createDuration(dateEnv.diffWholeYears(date0, date1), 'year')!\n  } else if (largeUnit === 'month') {\n    return createDuration(dateEnv.diffWholeMonths(date0, date1), 'month')!\n  } else {\n    return diffDayAndTime(date0, date1) // returns a duration\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { EventInput, EventDef } from './event'\nimport { DateRange } from '../datelib/date-range'\nimport { DateEnv } from '../datelib/env'\nimport { Duration } from '../datelib/duration'\nimport { DateMarker, startOfDay } from '../datelib/marker'\nimport { __assign } from 'tslib'\n\n/*\nThe plugin system for defining how a recurring event is expanded into individual instances.\n*/\n\nexport interface ParsedRecurring {\n  typeData: any\n  allDayGuess: boolean | null\n  duration: Duration | null // signals hasEnd\n}\n\nexport interface RecurringType {\n  parse: (rawEvent: EventInput, leftoverProps: any, dateEnv: DateEnv) => ParsedRecurring | null\n  expand: (typeData: any, framingRange: DateRange, dateEnv: DateEnv) => DateMarker[]\n}\n\n\nexport function parseRecurring(\n  eventInput: EventInput,\n  allDayDefault: boolean | null,\n  dateEnv: DateEnv,\n  recurringTypes: RecurringType[],\n  leftovers: any\n) {\n  for (let i = 0; i < recurringTypes.length; i++) {\n    let localLeftovers = {} as any\n    let parsed = recurringTypes[i].parse(eventInput, localLeftovers, dateEnv) as ParsedRecurring\n\n    if (parsed) {\n\n      let allDay = localLeftovers.allDay\n      delete localLeftovers.allDay // remove from leftovers\n      if (allDay == null) {\n        allDay = allDayDefault\n        if (allDay == null) {\n          allDay = parsed.allDayGuess\n          if (allDay == null) {\n            allDay = false\n          }\n        }\n      }\n\n      __assign(leftovers, localLeftovers)\n\n      return {\n        allDay,\n        duration: parsed.duration,\n        typeData: parsed.typeData,\n        typeId: i\n      }\n\n    }\n  }\n\n  return null\n}\n\n\n/*\nEvent MUST have a recurringDef\n*/\nexport function expandRecurringRanges(\n  eventDef: EventDef,\n  duration: Duration,\n  framingRange: DateRange,\n  dateEnv: DateEnv,\n  recurringTypes: RecurringType[]\n): DateMarker[] {\n  let typeDef = recurringTypes[eventDef.recurringDef.typeId]\n  let markers = typeDef.expand(\n    eventDef.recurringDef.typeData,\n    {\n      start: dateEnv.subtract(framingRange.start, duration), // for when event starts before framing range and goes into\n      end: framingRange.end\n    },\n    dateEnv\n  )\n\n  // the recurrence plugins don't guarantee that all-day events are start-of-day, so we have to\n  if (eventDef.allDay) {\n    markers = markers.map(startOfDay)\n  }\n\n  return markers\n}\n","\nconst hasOwnProperty = Object.prototype.hasOwnProperty\n\n// Merges an array of objects into a single object.\n// The second argument allows for an array of property names who's object values will be merged together.\nexport function mergeProps(propObjs, complexProps?): any {\n  let dest = {}\n  let i\n  let name\n  let complexObjs\n  let j\n  let val\n  let props\n\n  if (complexProps) {\n    for (i = 0; i < complexProps.length; i++) {\n      name = complexProps[i]\n      complexObjs = []\n\n      // collect the trailing object values, stopping when a non-object is discovered\n      for (j = propObjs.length - 1; j >= 0; j--) {\n        val = propObjs[j][name]\n\n        if (typeof val === 'object' && val) { // non-null object\n          complexObjs.unshift(val)\n        } else if (val !== undefined) {\n          dest[name] = val // if there were no objects, this value will be used\n          break\n        }\n      }\n\n      // if the trailing values were objects, use the merged value\n      if (complexObjs.length) {\n        dest[name] = mergeProps(complexObjs)\n      }\n    }\n  }\n\n  // copy values into the destination, going from last to first\n  for (i = propObjs.length - 1; i >= 0; i--) {\n    props = propObjs[i]\n\n    for (name in props) {\n      if (!(name in dest)) { // if already assigned by previous props or complex props, don't reassign\n        dest[name] = props[name]\n      }\n    }\n  }\n\n  return dest\n}\n\n\nexport function filterHash(hash, func) {\n  let filtered = {}\n\n  for (let key in hash) {\n    if (func(hash[key], key)) {\n      filtered[key] = hash[key]\n    }\n  }\n\n  return filtered\n}\n\n\nexport function mapHash<InputItem, OutputItem>(\n  hash: { [key: string]: InputItem },\n  func: (input: InputItem, key: string) => OutputItem\n): { [key: string]: OutputItem } {\n  let newHash = {}\n\n  for (let key in hash) {\n    newHash[key] = func(hash[key], key)\n  }\n\n  return newHash\n}\n\n\nexport function arrayToHash(a): { [key: string]: true } {\n  let hash = {}\n\n  for (let item of a) {\n    hash[item] = true\n  }\n\n  return hash\n}\n\n\nexport function hashValuesToArray(obj) {\n  let a = []\n\n  for (let key in obj) {\n    a.push(obj[key])\n  }\n\n  return a\n}\n\n\nexport function isPropsEqual(obj0, obj1) {\n\n  for (let key in obj0) {\n    if (hasOwnProperty.call(obj0, key)) {\n      if (!(key in obj1)) {\n        return false\n      }\n    }\n  }\n\n  for (let key in obj1) {\n    if (hasOwnProperty.call(obj1, key)) {\n      if (obj0[key] !== obj1[key]) {\n        return false\n      }\n    }\n  }\n\n  return true\n}\n","import {\n  EventInput,\n  EventDef,\n  EventDefHash,\n  EventInstance,\n  EventInstanceHash,\n  createEventInstance,\n  parseEvent,\n  EventTuple\n} from './event'\nimport { EventSource } from './event-source'\nimport { expandRecurringRanges } from './recurring-event'\nimport Calendar from '../Calendar'\nimport { filterHash } from '../util/object'\nimport { DateRange } from '../datelib/date-range'\n\n/*\nA data structure that encapsulates EventDefs and EventInstances.\nUtils for parsing this data from raw EventInputs.\nUtils for manipulating an EventStore.\n*/\n\nexport interface EventStore {\n  defs: EventDefHash\n  instances: EventInstanceHash\n}\n\nexport function parseEvents(\n  rawEvents: EventInput[],\n  sourceId: string,\n  calendar: Calendar,\n  allowOpenRange?: boolean\n): EventStore {\n  let eventStore = createEmptyEventStore()\n\n  for (let rawEvent of rawEvents) {\n    let tuple = parseEvent(rawEvent, sourceId, calendar, allowOpenRange)\n\n    if (tuple) {\n      eventTupleToStore(tuple, eventStore)\n    }\n  }\n\n  return eventStore\n}\n\nexport function eventTupleToStore(tuple: EventTuple, eventStore: EventStore = createEmptyEventStore()) {\n  eventStore.defs[tuple.def.defId] = tuple.def\n\n  if (tuple.instance) {\n    eventStore.instances[tuple.instance.instanceId] = tuple.instance\n  }\n\n  return eventStore\n}\n\nexport function expandRecurring(eventStore: EventStore, framingRange: DateRange, calendar: Calendar): EventStore {\n  let dateEnv = calendar.dateEnv\n  let { defs, instances } = eventStore\n\n  // remove existing recurring instances\n  instances = filterHash(instances, function(instance: EventInstance) {\n    return !defs[instance.defId].recurringDef\n  })\n\n  for (let defId in defs) {\n    let def = defs[defId]\n\n    if (def.recurringDef) {\n      let duration = def.recurringDef.duration\n\n      if (!duration) {\n        duration = def.allDay ?\n          calendar.defaultAllDayEventDuration :\n          calendar.defaultTimedEventDuration\n      }\n\n      let starts = expandRecurringRanges(def, duration, framingRange, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes)\n\n      for (let start of starts) {\n        let instance = createEventInstance(defId, {\n          start,\n          end: dateEnv.add(start, duration)\n        })\n        instances[instance.instanceId] = instance\n      }\n    }\n  }\n\n  return { defs, instances }\n}\n\n// retrieves events that have the same groupId as the instance specified by `instanceId`\n// or they are the same as the instance.\n// why might instanceId not be in the store? an event from another calendar?\nexport function getRelevantEvents(eventStore: EventStore, instanceId: string): EventStore {\n  let instance = eventStore.instances[instanceId]\n\n  if (instance) {\n    let def = eventStore.defs[instance.defId]\n\n    // get events/instances with same group\n    let newStore = filterEventStoreDefs(eventStore, function(lookDef) {\n      return isEventDefsGrouped(def, lookDef)\n    })\n\n    // add the original\n    // TODO: wish we could use eventTupleToStore or something like it\n    newStore.defs[def.defId] = def\n    newStore.instances[instance.instanceId] = instance\n\n    return newStore\n  }\n\n  return createEmptyEventStore()\n}\n\nfunction isEventDefsGrouped(def0: EventDef, def1: EventDef): boolean {\n  return Boolean(def0.groupId && def0.groupId === def1.groupId)\n}\n\nexport function transformRawEvents(rawEvents, eventSource: EventSource, calendar: Calendar) {\n  let calEachTransform = calendar.opt('eventDataTransform')\n  let sourceEachTransform = eventSource ? eventSource.eventDataTransform : null\n\n  if (sourceEachTransform) {\n    rawEvents = transformEachRawEvent(rawEvents, sourceEachTransform)\n  }\n\n  if (calEachTransform) {\n    rawEvents = transformEachRawEvent(rawEvents, calEachTransform)\n  }\n\n  return rawEvents\n}\n\nfunction transformEachRawEvent(rawEvents, func) {\n  let refinedEvents\n\n  if (!func) {\n    refinedEvents = rawEvents\n  } else {\n    refinedEvents = []\n\n    for (let rawEvent of rawEvents) {\n      let refinedEvent = func(rawEvent)\n\n      if (refinedEvent) {\n        refinedEvents.push(refinedEvent)\n      } else if (refinedEvent == null) {\n        refinedEvents.push(rawEvent)\n      } // if a different falsy value, do nothing\n    }\n  }\n\n  return refinedEvents\n}\n\nexport function createEmptyEventStore(): EventStore {\n  return { defs: {}, instances: {} }\n}\n\nexport function mergeEventStores(store0: EventStore, store1: EventStore): EventStore {\n  return {\n    defs: { ...store0.defs, ...store1.defs },\n    instances: { ...store0.instances, ...store1.instances }\n  }\n}\n\nexport function filterEventStoreDefs(eventStore: EventStore, filterFunc: (eventDef: EventDef) => boolean): EventStore {\n  let defs = filterHash(eventStore.defs, filterFunc)\n  let instances = filterHash(eventStore.instances, function(instance: EventInstance) {\n    return defs[instance.defId] // still exists?\n  })\n  return { defs, instances }\n}\n","import { DateMarker } from './marker'\nimport { DateEnv, DateInput } from './env'\n\nexport interface DateRangeInput {\n  start?: DateInput\n  end?: DateInput\n}\n\nexport interface OpenDateRange {\n  start: DateMarker | null\n  end: DateMarker | null\n}\n\nexport interface DateRange {\n  start: DateMarker\n  end: DateMarker\n}\n\nexport function parseRange(input: DateRangeInput, dateEnv: DateEnv): OpenDateRange {\n  let start = null\n  let end = null\n\n  if (input.start) {\n    start = dateEnv.createMarker(input.start)\n  }\n\n  if (input.end) {\n    end = dateEnv.createMarker(input.end)\n  }\n\n  if (!start && !end) {\n    return null\n  }\n\n  if (start && end && end < start) {\n    return null\n  }\n\n  return { start, end }\n}\n\n// SIDE-EFFECT: will mutate ranges.\n// Will return a new array result.\nexport function invertRanges(ranges: DateRange[], constraintRange: DateRange): DateRange[] {\n  let invertedRanges: DateRange[] = []\n  let start = constraintRange.start // the end of the previous range. the start of the new range\n  let i\n  let dateRange\n\n  // ranges need to be in order. required for our date-walking algorithm\n  ranges.sort(compareRanges)\n\n  for (i = 0; i < ranges.length; i++) {\n    dateRange = ranges[i]\n\n    // add the span of time before the event (if there is any)\n    if (dateRange.start > start) { // compare millisecond time (skip any ambig logic)\n      invertedRanges.push({ start, end: dateRange.start })\n    }\n\n    if (dateRange.end > start) {\n      start = dateRange.end\n    }\n  }\n\n  // add the span of time after the last event (if there is any)\n  if (start < constraintRange.end) { // compare millisecond time (skip any ambig logic)\n    invertedRanges.push({ start, end: constraintRange.end })\n  }\n\n  return invertedRanges\n}\n\nfunction compareRanges(range0: DateRange, range1: DateRange) {\n  return range0.start.valueOf() - range1.start.valueOf() // earlier ranges go first\n}\n\nexport function intersectRanges(range0: OpenDateRange, range1: OpenDateRange): OpenDateRange {\n  let start = range0.start\n  let end = range0.end\n  let newRange = null\n\n  if (range1.start !== null) {\n    if (start === null) {\n      start = range1.start\n    } else {\n      start = new Date(Math.max(start.valueOf(), range1.start.valueOf()))\n    }\n  }\n\n  if (range1.end != null) {\n    if (end === null) {\n      end = range1.end\n    } else {\n      end = new Date(Math.min(end.valueOf(), range1.end.valueOf()))\n    }\n  }\n\n  if (start === null || end === null || start < end) {\n    newRange = { start, end }\n  }\n\n  return newRange\n}\n\nexport function rangesEqual(range0: OpenDateRange, range1: OpenDateRange): boolean {\n  return (range0.start === null ? null : range0.start.valueOf()) === (range1.start === null ? null : range1.start.valueOf()) &&\n    (range0.end === null ? null : range0.end.valueOf()) === (range1.end === null ? null : range1.end.valueOf())\n}\n\nexport function rangesIntersect(range0: OpenDateRange, range1: OpenDateRange): boolean {\n  return (range0.end === null || range1.start === null || range0.end > range1.start) &&\n    (range0.start === null || range1.end === null || range0.start < range1.end)\n}\n\nexport function rangeContainsRange(outerRange: OpenDateRange, innerRange: OpenDateRange): boolean {\n  return (outerRange.start === null || (innerRange.start !== null && innerRange.start >= outerRange.start)) &&\n    (outerRange.end === null || (innerRange.end !== null && innerRange.end <= outerRange.end))\n}\n\nexport function rangeContainsMarker(range: OpenDateRange, date: DateMarker | number): boolean { // date can be a millisecond time\n  return (range.start === null || date >= range.start) &&\n    (range.end === null || date < range.end)\n}\n\n// If the given date is not within the given range, move it inside.\n// (If it's past the end, make it one millisecond before the end).\nexport function constrainMarkerToRange(date: DateMarker, range: DateRange): DateMarker {\n  if (range.start != null && date < range.start) {\n    return range.start\n  }\n\n  if (range.end != null && date >= range.end) {\n    return new Date(range.end.valueOf() - 1)\n  }\n\n  return date\n}\n","\nexport function removeMatching(array, testFunc) {\n  let removeCnt = 0\n  let i = 0\n\n  while (i < array.length) {\n    if (testFunc(array[i])) { // truthy value means *remove*\n      array.splice(i, 1)\n      removeCnt++\n    } else {\n      i++\n    }\n  }\n\n  return removeCnt\n}\n\n\nexport function removeExact(array, exactVal) {\n  let removeCnt = 0\n  let i = 0\n\n  while (i < array.length) {\n    if (array[i] === exactVal) {\n      array.splice(i, 1)\n      removeCnt++\n    } else {\n      i++\n    }\n  }\n\n  return removeCnt\n}\n\nexport function isArraysEqual(a0, a1) {\n  let len = a0.length\n  let i\n\n  if (len !== a1.length) { // not array? or not same length?\n    return false\n  }\n\n  for (i = 0; i < len; i++) {\n    if (a0[i] !== a1[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n","import { isArraysEqual } from './array'\n\nexport function memoize<T>(workerFunc: T): T {\n  let args\n  let res\n\n  return function() {\n    if (!args || !isArraysEqual(args, arguments)) {\n      args = arguments\n      res = (workerFunc as any).apply(this, arguments)\n    }\n\n    return res\n  } as any\n}\n\n/*\nalways executes the workerFunc, but if the result is equal to the previous result,\nreturn the previous result instead.\n*/\nexport function memoizeOutput<T>(workerFunc: T, equalityFunc: (output0, output1) => boolean): T {\n  let cachedRes = null\n\n  return function() {\n    let newRes = (workerFunc as any).apply(this, arguments)\n\n    if (cachedRes === null || !(cachedRes === newRes || equalityFunc(cachedRes, newRes))) {\n      cachedRes = newRes\n    }\n\n    return cachedRes\n  } as any\n}\n","import { DateMarker, timeAsMs } from './marker'\nimport { CalendarSystem } from './calendar-system'\nimport { Locale } from './locale'\nimport { DateFormatter, DateFormattingContext, ZonedMarker, formatTimeZoneOffset } from './formatting'\nimport { memoize } from '../util/memoize'\n\nconst EXTENDED_SETTINGS_AND_SEVERITIES = {\n  week: 3,\n  separator: 0, // 0 = not applicable\n  omitZeroMinute: 0,\n  meridiem: 0, // like am/pm\n  omitCommas: 0\n}\n\nconst STANDARD_DATE_PROP_SEVERITIES = {\n  timeZoneName: 7,\n  era: 6,\n  year: 5,\n  month: 4,\n  day: 2,\n  weekday: 2,\n  hour: 1,\n  minute: 1,\n  second: 1\n}\n\nconst MERIDIEM_RE = /\\s*([ap])\\.?m\\.?/i // eats up leading spaces too\nconst COMMA_RE = /,/g // we need re for globalness\nconst MULTI_SPACE_RE = /\\s+/g\nconst LTR_RE = /\\u200e/g // control character\nconst UTC_RE = /UTC|GMT/\n\nexport class NativeFormatter implements DateFormatter {\n\n  standardDateProps: any\n  extendedSettings: any\n  severity: number\n  private buildFormattingFunc: typeof buildFormattingFunc // caching for efficiency with same date env\n\n  constructor(formatSettings) {\n    let standardDateProps: any = {}\n    let extendedSettings: any = {}\n    let severity = 0\n\n    for (let name in formatSettings) {\n      if (name in EXTENDED_SETTINGS_AND_SEVERITIES) {\n        extendedSettings[name] = formatSettings[name]\n        severity = Math.max(EXTENDED_SETTINGS_AND_SEVERITIES[name], severity)\n      } else {\n        standardDateProps[name] = formatSettings[name]\n\n        if (name in STANDARD_DATE_PROP_SEVERITIES) {\n          severity = Math.max(STANDARD_DATE_PROP_SEVERITIES[name], severity)\n        }\n      }\n    }\n\n    this.standardDateProps = standardDateProps\n    this.extendedSettings = extendedSettings\n    this.severity = severity\n\n    this.buildFormattingFunc = memoize(buildFormattingFunc)\n  }\n\n  format(date: ZonedMarker, context: DateFormattingContext) {\n    return this.buildFormattingFunc(this.standardDateProps, this.extendedSettings, context)(date)\n  }\n\n  formatRange(start: ZonedMarker, end: ZonedMarker, context: DateFormattingContext) {\n    let { standardDateProps, extendedSettings } = this\n\n    let diffSeverity = computeMarkerDiffSeverity(start.marker, end.marker, context.calendarSystem)\n    if (!diffSeverity) {\n      return this.format(start, context)\n    }\n\n    let biggestUnitForPartial = diffSeverity\n    if (\n      biggestUnitForPartial > 1 && // the two dates are different in a way that's larger scale than time\n      (standardDateProps.year === 'numeric' || standardDateProps.year === '2-digit') &&\n      (standardDateProps.month === 'numeric' || standardDateProps.month === '2-digit') &&\n      (standardDateProps.day === 'numeric' || standardDateProps.day === '2-digit')\n    ) {\n      biggestUnitForPartial = 1 // make it look like the dates are only different in terms of time\n    }\n\n    let full0 = this.format(start, context)\n    let full1 = this.format(end, context)\n\n    if (full0 === full1) {\n      return full0\n    }\n\n    let partialDateProps = computePartialFormattingOptions(standardDateProps, biggestUnitForPartial)\n    let partialFormattingFunc = buildFormattingFunc(partialDateProps, extendedSettings, context)\n    let partial0 = partialFormattingFunc(start)\n    let partial1 = partialFormattingFunc(end)\n\n    let insertion = findCommonInsertion(full0, partial0, full1, partial1)\n    let separator = extendedSettings.separator || ''\n\n    if (insertion) {\n      return insertion.before + partial0 + separator + partial1 + insertion.after\n    }\n\n    return full0 + separator + full1\n  }\n\n  getLargestUnit() {\n    switch (this.severity) {\n      case 7:\n      case 6:\n      case 5:\n        return 'year'\n      case 4:\n        return 'month'\n      case 3:\n        return 'week'\n      default:\n        return 'day'\n    }\n  }\n\n}\n\nfunction buildFormattingFunc(\n  standardDateProps,\n  extendedSettings,\n  context: DateFormattingContext\n): (date: ZonedMarker) => string {\n  let standardDatePropCnt = Object.keys(standardDateProps).length\n\n  if (standardDatePropCnt === 1 && standardDateProps.timeZoneName === 'short') {\n    return function(date: ZonedMarker) {\n      return formatTimeZoneOffset(date.timeZoneOffset)\n    }\n  }\n\n  if (standardDatePropCnt === 0 && extendedSettings.week) {\n    return function(date: ZonedMarker) {\n      return formatWeekNumber(\n        context.computeWeekNumber(date.marker),\n        context.weekLabel,\n        context.locale,\n        extendedSettings.week\n      )\n    }\n  }\n\n  return buildNativeFormattingFunc(standardDateProps, extendedSettings, context)\n}\n\nfunction buildNativeFormattingFunc(\n  standardDateProps,\n  extendedSettings,\n  context: DateFormattingContext\n): (date: ZonedMarker) => string {\n  standardDateProps = { ...standardDateProps } // copy\n  extendedSettings = { ...extendedSettings } // copy\n\n  sanitizeSettings(standardDateProps, extendedSettings)\n\n  standardDateProps.timeZone = 'UTC' // we leverage the only guaranteed timeZone for our UTC markers\n\n  let normalFormat = new Intl.DateTimeFormat(context.locale.codes, standardDateProps)\n  let zeroFormat // needed?\n\n  if (extendedSettings.omitZeroMinute) {\n    let zeroProps = { ...standardDateProps }\n    delete zeroProps.minute // seconds and ms were already considered in sanitizeSettings\n    zeroFormat = new Intl.DateTimeFormat(context.locale.codes, zeroProps)\n  }\n\n  return function(date: ZonedMarker) {\n    let marker = date.marker\n    let format\n\n    if (zeroFormat && !marker.getUTCMinutes()) {\n      format = zeroFormat\n    } else {\n      format = normalFormat\n    }\n\n    let s = format.format(marker)\n\n    return postProcess(s, date, standardDateProps, extendedSettings, context)\n  }\n}\n\nfunction sanitizeSettings(standardDateProps, extendedSettings) {\n\n  // deal with a browser inconsistency where formatting the timezone\n  // requires that the hour/minute be present.\n  if (standardDateProps.timeZoneName) {\n    if (!standardDateProps.hour) {\n      standardDateProps.hour = '2-digit'\n    }\n    if (!standardDateProps.minute) {\n      standardDateProps.minute = '2-digit'\n    }\n  }\n\n  // only support short timezone names\n  if (standardDateProps.timeZoneName === 'long') {\n    standardDateProps.timeZoneName = 'short'\n  }\n\n  // if requesting to display seconds, MUST display minutes\n  if (extendedSettings.omitZeroMinute && (standardDateProps.second || standardDateProps.millisecond)) {\n    delete extendedSettings.omitZeroMinute\n  }\n}\n\nfunction postProcess(s: string, date: ZonedMarker, standardDateProps, extendedSettings, context: DateFormattingContext): string {\n\n  s = s.replace(LTR_RE, '') // remove left-to-right control chars. do first. good for other regexes\n\n  if (standardDateProps.timeZoneName === 'short') {\n    s = injectTzoStr(\n      s,\n      (context.timeZone === 'UTC' || date.timeZoneOffset == null) ?\n        'UTC' : // important to normalize for IE, which does \"GMT\"\n        formatTimeZoneOffset(date.timeZoneOffset)\n    )\n  }\n\n  if (extendedSettings.omitCommas) {\n    s = s.replace(COMMA_RE, '').trim()\n  }\n\n  if (extendedSettings.omitZeroMinute) {\n    s = s.replace(':00', '') // zeroFormat doesn't always achieve this\n  }\n\n  // ^ do anything that might create adjacent spaces before this point,\n  // because MERIDIEM_RE likes to eat up loading spaces\n\n  if (extendedSettings.meridiem === false) {\n    s = s.replace(MERIDIEM_RE, '').trim()\n  } else if (extendedSettings.meridiem === 'narrow') { // a/p\n    s = s.replace(MERIDIEM_RE, function(m0, m1) {\n      return m1.toLocaleLowerCase()\n    })\n  } else if (extendedSettings.meridiem === 'short') { // am/pm\n    s = s.replace(MERIDIEM_RE, function(m0, m1) {\n      return m1.toLocaleLowerCase() + 'm'\n    })\n  } else if (extendedSettings.meridiem === 'lowercase') { // other meridiem transformers already converted to lowercase\n    s = s.replace(MERIDIEM_RE, function(m0) {\n      return m0.toLocaleLowerCase()\n    })\n  }\n\n  s = s.replace(MULTI_SPACE_RE, ' ')\n  s = s.trim()\n\n  return s\n}\n\nfunction injectTzoStr(s: string, tzoStr: string): string {\n  let replaced = false\n\n  s = s.replace(UTC_RE, function() {\n    replaced = true\n    return tzoStr\n  })\n\n  // IE11 doesn't include UTC/GMT in the original string, so append to end\n  if (!replaced) {\n    s += ' ' + tzoStr\n  }\n\n  return s\n}\n\nfunction formatWeekNumber(num: number, weekLabel: string, locale: Locale, display?: 'numeric' | 'narrow' | 'short'): string {\n  let parts = []\n\n  if (display === 'narrow') {\n    parts.push(weekLabel)\n  } else if (display === 'short') {\n    parts.push(weekLabel, ' ')\n  }\n  // otherwise, considered 'numeric'\n\n  parts.push(locale.simpleNumberFormat.format(num))\n\n  if (locale.options.isRtl) { // TODO: use control characters instead?\n    parts.reverse()\n  }\n\n  return parts.join('')\n}\n\n\n// Range Formatting Utils\n\n// 0 = exactly the same\n// 1 = different by time\n// and bigger\nfunction computeMarkerDiffSeverity(d0: DateMarker, d1: DateMarker, ca: CalendarSystem) {\n  if (ca.getMarkerYear(d0) !== ca.getMarkerYear(d1)) {\n    return 5\n  }\n  if (ca.getMarkerMonth(d0) !== ca.getMarkerMonth(d1)) {\n    return 4\n  }\n  if (ca.getMarkerDay(d0) !== ca.getMarkerDay(d1)) {\n    return 2\n  }\n  if (timeAsMs(d0) !== timeAsMs(d1)) {\n    return 1\n  }\n  return 0\n}\n\nfunction computePartialFormattingOptions(options, biggestUnit) {\n  let partialOptions = {}\n\n  for (let name in options) {\n    if (\n      !(name in STANDARD_DATE_PROP_SEVERITIES) || // not a date part prop (like timeZone)\n      STANDARD_DATE_PROP_SEVERITIES[name] <= biggestUnit\n    ) {\n      partialOptions[name] = options[name]\n    }\n  }\n\n  return partialOptions\n}\n\nfunction findCommonInsertion(full0, partial0, full1, partial1) {\n\n  let i0 = 0\n  while (i0 < full0.length) {\n\n    let found0 = full0.indexOf(partial0, i0)\n    if (found0 === -1) {\n      break\n    }\n\n    let before0 = full0.substr(0, found0)\n    i0 = found0 + partial0.length\n    let after0 = full0.substr(i0)\n\n    let i1 = 0\n    while (i1 < full1.length) {\n\n      let found1 = full1.indexOf(partial1, i1)\n      if (found1 === -1) {\n        break\n      }\n\n      let before1 = full1.substr(0, found1)\n      i1 = found1 + partial1.length\n      let after1 = full1.substr(i1)\n\n      if (before0 === before1 && after0 === after1) {\n        return {\n          before: before0,\n          after: after0\n        }\n      }\n    }\n  }\n\n  return null\n}\n","import {\n  DateFormatter, DateFormattingContext, ZonedMarker,\n  VerboseFormattingArg, createVerboseFormattingArg\n} from './formatting'\n\nexport type CmdFormatterFunc = (cmd: string, arg: VerboseFormattingArg) => string\n\n/*\nTODO: fix the terminology of \"formatter\" vs \"formatting func\"\n*/\n\n/*\nAt the time of instantiation, this object does not know which cmd-formatting system it will use.\nIt receives this at the time of formatting, as a setting.\n*/\nexport class CmdFormatter implements DateFormatter {\n\n  cmdStr: string\n  separator: string\n\n  constructor(cmdStr: string, separator?: string) {\n    this.cmdStr = cmdStr\n    this.separator = separator\n  }\n\n  format(date: ZonedMarker, context: DateFormattingContext) {\n    return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(date, null, context, this.separator))\n  }\n\n  formatRange(start: ZonedMarker, end: ZonedMarker, context: DateFormattingContext) {\n    return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(start, end, context, this.separator))\n  }\n\n}\n","import {\n  DateFormatter, DateFormattingContext, ZonedMarker,\n  VerboseFormattingArg, createVerboseFormattingArg\n} from './formatting'\n\nexport type FuncFormatterFunc = (arg: VerboseFormattingArg) => string\n\n\nexport class FuncFormatter implements DateFormatter {\n\n  func: FuncFormatterFunc\n\n  constructor(func: FuncFormatterFunc) {\n    this.func = func\n  }\n\n  format(date: ZonedMarker, context: DateFormattingContext) {\n    return this.func(createVerboseFormattingArg(date, null, context))\n  }\n\n  formatRange(start: ZonedMarker, end: ZonedMarker, context: DateFormattingContext) {\n    return this.func(createVerboseFormattingArg(start, end, context))\n  }\n\n}\n","import { padStart } from '../util/misc'\nimport { DateMarker } from './marker'\nimport { CalendarSystem } from './calendar-system'\nimport { Locale } from './locale'\nimport { NativeFormatter } from './formatting-native'\nimport { CmdFormatter, CmdFormatterFunc } from './formatting-cmd'\nimport { FuncFormatter, FuncFormatterFunc } from './formatting-func'\n\nexport interface ZonedMarker {\n  marker: DateMarker,\n  timeZoneOffset: number\n}\n\nexport interface ExpandedZonedMarker extends ZonedMarker {\n  array: number[],\n  year: number,\n  month: number,\n  day: number,\n  hour: number,\n  minute: number,\n  second: number,\n  millisecond: number\n}\n\nexport interface VerboseFormattingArg { // TODO: kill this\n  date: ExpandedZonedMarker\n  start: ExpandedZonedMarker\n  end?: ExpandedZonedMarker\n  timeZone: string\n  localeCodes: string[],\n  separator: string\n}\n\nexport interface DateFormattingContext {\n  timeZone: string,\n  locale: Locale,\n  calendarSystem: CalendarSystem\n  computeWeekNumber: (d: DateMarker) => number\n  weekLabel: string\n  cmdFormatter?: CmdFormatterFunc\n}\n\nexport interface DateFormatter {\n  format(date: ZonedMarker, context: DateFormattingContext)\n  formatRange(start: ZonedMarker, end: ZonedMarker, context: DateFormattingContext)\n}\n\n// TODO: use Intl.DateTimeFormatOptions\nexport type FormatterInput = object | string | FuncFormatterFunc\n\n\n// Formatter Object Creation\n\nexport function createFormatter(input: FormatterInput, defaultSeparator?: string): DateFormatter {\n  if (typeof input === 'object' && input) { // non-null object\n    if (typeof defaultSeparator === 'string') {\n      input = { separator: defaultSeparator, ...input }\n    }\n    return new NativeFormatter(input)\n\n  } else if (typeof input === 'string') {\n    return new CmdFormatter(input, defaultSeparator)\n\n  } else if (typeof input === 'function') {\n    return new FuncFormatter(input as FuncFormatterFunc)\n  }\n}\n\n\n// String Utils\n\n// timeZoneOffset is in minutes\nexport function buildIsoString(marker: DateMarker, timeZoneOffset?: number, stripZeroTime: boolean = false) {\n  let s = marker.toISOString()\n\n  s = s.replace('.000', '')\n\n  if (stripZeroTime) {\n    s = s.replace('T00:00:00Z', '')\n  }\n\n  if (s.length > 10) { // time part wasn't stripped, can add timezone info\n    if (timeZoneOffset == null) {\n      s = s.replace('Z', '')\n    } else if (timeZoneOffset !== 0) {\n      s = s.replace('Z', formatTimeZoneOffset(timeZoneOffset, true))\n    }\n    // otherwise, its UTC-0 and we want to keep the Z\n  }\n\n  return s\n}\n\nexport function formatIsoTimeString(marker: DateMarker) {\n  return padStart(marker.getUTCHours(), 2) + ':' +\n    padStart(marker.getUTCMinutes(), 2) + ':' +\n    padStart(marker.getUTCSeconds(), 2)\n}\n\nexport function formatTimeZoneOffset(minutes: number, doIso = false) {\n  let sign = minutes < 0 ? '-' : '+'\n  let abs = Math.abs(minutes)\n  let hours = Math.floor(abs / 60)\n  let mins = Math.round(abs % 60)\n\n  if (doIso) {\n    return sign + padStart(hours, 2) + ':' + padStart(mins, 2)\n  } else {\n    return 'GMT' + sign + hours + (mins ? ':' + padStart(mins, 2) : '')\n  }\n}\n\n\n// Arg Utils\n\nexport function createVerboseFormattingArg(start: ZonedMarker, end: ZonedMarker, context: DateFormattingContext, separator?: string): VerboseFormattingArg {\n  let startInfo = expandZonedMarker(start, context.calendarSystem)\n  let endInfo = end ? expandZonedMarker(end, context.calendarSystem) : null\n\n  return {\n    date: startInfo,\n    start: startInfo,\n    end: endInfo,\n    timeZone: context.timeZone,\n    localeCodes: context.locale.codes,\n    separator\n  }\n}\n\nfunction expandZonedMarker(dateInfo: ZonedMarker, calendarSystem: CalendarSystem): ExpandedZonedMarker {\n  let a = calendarSystem.markerToArray(dateInfo.marker)\n\n  return {\n    marker: dateInfo.marker,\n    timeZoneOffset: dateInfo.timeZoneOffset,\n    array: a,\n    year: a[0],\n    month: a[1],\n    day: a[2],\n    hour: a[3],\n    minute: a[4],\n    second: a[5],\n    millisecond: a[6]\n  }\n}\n","import Calendar from '../Calendar'\nimport { EventSource } from '../structs/event-source'\n\nexport default class EventSourceApi {\n\n  calendar: Calendar\n  internalEventSource: EventSource // rename?\n\n  constructor(calendar: Calendar, internalEventSource: EventSource) {\n    this.calendar = calendar\n    this.internalEventSource = internalEventSource\n  }\n\n  remove() {\n    this.calendar.dispatch({\n      type: 'REMOVE_EVENT_SOURCE',\n      sourceId: this.internalEventSource.sourceId\n    })\n  }\n\n  refetch() {\n    this.calendar.dispatch({\n      type: 'FETCH_EVENT_SOURCES',\n      sourceIds: [ this.internalEventSource.sourceId ]\n    })\n  }\n\n  get id(): string {\n    return this.internalEventSource.publicId\n  }\n\n  // only relevant to json-feed event sources\n  get url(): string {\n    return this.internalEventSource.meta.url\n  }\n\n}\n","import Calendar from '../Calendar'\nimport { EventDef, EventInstance, NON_DATE_PROPS, DATE_PROPS } from '../structs/event'\nimport { UNSCOPED_EVENT_UI_PROPS } from '../component/event-ui'\nimport { EventMutation } from '../structs/event-mutation'\nimport { DateInput } from '../datelib/env'\nimport { diffDates, computeAlignedDayRange } from '../util/misc'\nimport { DurationInput, createDuration, durationsEqual } from '../datelib/duration'\nimport { createFormatter, FormatterInput } from '../datelib/formatting'\nimport EventSourceApi from './EventSourceApi'\n\nexport default class EventApi {\n\n  _calendar: Calendar\n  _def: EventDef\n  _instance: EventInstance | null\n\n  constructor(calendar: Calendar, def: EventDef, instance?: EventInstance) {\n    this._calendar = calendar\n    this._def = def\n    this._instance = instance || null\n  }\n\n  /*\n  TODO: make event struct more responsible for this\n  */\n  setProp(name: string, val: string) {\n    if (name in DATE_PROPS) {\n      // error. date-related props need other methods\n\n    } else if (name in NON_DATE_PROPS) {\n\n      if (typeof NON_DATE_PROPS[name] === 'function') {\n        val = NON_DATE_PROPS[name](val)\n      }\n\n      this.mutate({\n        standardProps: { [name]: val }\n      })\n\n    } else if (name in UNSCOPED_EVENT_UI_PROPS) {\n      let ui\n\n      if (typeof UNSCOPED_EVENT_UI_PROPS[name] === 'function') {\n        val = UNSCOPED_EVENT_UI_PROPS[name](val)\n      }\n\n      if (name === 'color') {\n        ui = { backgroundColor: val, borderColor: val }\n      } else if (name === 'editable') {\n        ui = { startEditable: val, durationEditable: val }\n      } else {\n        ui = { [name]: val }\n      }\n\n      this.mutate({\n        standardProps: { ui }\n      })\n\n    } else {\n      // error\n    }\n  }\n\n  setExtendedProp(name: string, val: any) {\n    this.mutate({\n      extendedProps: { [name]: val }\n    })\n  }\n\n  setStart(startInput: DateInput, options: { granularity?: string, maintainDuration?: boolean } = {}) {\n    let { dateEnv } = this._calendar\n    let start = dateEnv.createMarker(startInput)\n\n    if (start && this._instance) { // TODO: warning if parsed bad\n      let instanceRange = this._instance.range\n      let startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity) // what if parsed bad!?\n\n      if (options.maintainDuration) {\n        this.mutate({ datesDelta: startDelta })\n      } else {\n        this.mutate({ startDelta })\n      }\n    }\n  }\n\n  setEnd(endInput: DateInput | null, options: { granularity?: string } = {}) {\n    let { dateEnv } = this._calendar\n    let end\n\n    if (endInput != null) {\n      end = dateEnv.createMarker(endInput)\n\n      if (!end) {\n        return // TODO: warning if parsed bad\n      }\n    }\n\n    if (this._instance) {\n      if (end) {\n        let endDelta = diffDates(this._instance.range.end, end, dateEnv, options.granularity)\n        this.mutate({ endDelta })\n      } else {\n        this.mutate({ standardProps: { hasEnd: false } })\n      }\n    }\n  }\n\n  setDates(startInput: DateInput, endInput: DateInput | null, options: { allDay?: boolean, granularity?: string } = {}) {\n    let { dateEnv } = this._calendar\n    let standardProps = { allDay: options.allDay } as any\n    let start = dateEnv.createMarker(startInput)\n    let end\n\n    if (!start) {\n      return // TODO: warning if parsed bad\n    }\n\n    if (endInput != null) {\n      end = dateEnv.createMarker(endInput)\n\n      if (!end) { // TODO: warning if parsed bad\n        return\n      }\n    }\n\n    if (this._instance) {\n      let instanceRange = this._instance.range\n\n      // when computing the diff for an event being converted to all-day,\n      // compute diff off of the all-day values the way event-mutation does.\n      if (options.allDay === true) {\n        instanceRange = computeAlignedDayRange(instanceRange)\n      }\n\n      let startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity)\n\n      if (end) {\n        let endDelta = diffDates(instanceRange.end, end, dateEnv, options.granularity)\n\n        if (durationsEqual(startDelta, endDelta)) {\n          this.mutate({ datesDelta: startDelta, standardProps })\n        } else {\n          this.mutate({ startDelta, endDelta, standardProps })\n        }\n\n      } else { // means \"clear the end\"\n        standardProps.hasEnd = false\n        this.mutate({ datesDelta: startDelta, standardProps })\n      }\n    }\n  }\n\n  moveStart(deltaInput: DurationInput) {\n    let delta = createDuration(deltaInput)\n\n    if (delta) { // TODO: warning if parsed bad\n      this.mutate({ startDelta: delta })\n    }\n  }\n\n  moveEnd(deltaInput: DurationInput) {\n    let delta = createDuration(deltaInput)\n\n    if (delta) { // TODO: warning if parsed bad\n      this.mutate({ endDelta: delta })\n    }\n  }\n\n  moveDates(deltaInput: DurationInput) {\n    let delta = createDuration(deltaInput)\n\n    if (delta) { // TODO: warning if parsed bad\n      this.mutate({ datesDelta: delta })\n    }\n  }\n\n  setAllDay(allDay: boolean, options: { maintainDuration?: boolean } = {}) {\n    let standardProps = { allDay } as any\n    let maintainDuration = options.maintainDuration\n\n    if (maintainDuration == null) {\n      maintainDuration = this._calendar.opt('allDayMaintainDuration')\n    }\n\n    if (this._def.allDay !== allDay) {\n      standardProps.hasEnd = maintainDuration\n    }\n\n    this.mutate({ standardProps })\n  }\n\n  formatRange(formatInput: FormatterInput) {\n    let { dateEnv } = this._calendar\n    let instance = this._instance\n    let formatter = createFormatter(formatInput, this._calendar.opt('defaultRangeSeparator'))\n\n    if (this._def.hasEnd) {\n      return dateEnv.formatRange(instance.range.start, instance.range.end, formatter, {\n        forcedStartTzo: instance.forcedStartTzo,\n        forcedEndTzo: instance.forcedEndTzo\n      })\n    } else {\n      return dateEnv.format(instance.range.start, formatter, {\n        forcedTzo: instance.forcedStartTzo\n      })\n    }\n  }\n\n  mutate(mutation: EventMutation) { // meant to be private. but plugins need access\n    let def = this._def\n    let instance = this._instance\n\n    if (instance) {\n      this._calendar.dispatch({\n        type: 'MUTATE_EVENTS',\n        instanceId: instance.instanceId,\n        mutation,\n        fromApi: true\n      })\n\n      let eventStore = this._calendar.state.eventStore\n      this._def = eventStore.defs[def.defId]\n      this._instance = eventStore.instances[instance.instanceId]\n    }\n  }\n\n  remove() {\n    this._calendar.dispatch({\n      type: 'REMOVE_EVENT_DEF',\n      defId: this._def.defId\n    })\n  }\n\n  get source(): EventSourceApi | null {\n    let sourceId = this._def.sourceId\n\n    if (sourceId) {\n      return new EventSourceApi(\n        this._calendar,\n        this._calendar.state.eventSources[sourceId]\n      )\n    }\n    return null\n  }\n\n  get start(): Date | null {\n    return this._instance ?\n      this._calendar.dateEnv.toDate(this._instance.range.start) :\n      null\n  }\n\n  get end(): Date | null {\n    return (this._instance && this._def.hasEnd) ?\n      this._calendar.dateEnv.toDate(this._instance.range.end) :\n      null\n  }\n\n  // computable props that all access the def\n  // TODO: find a TypeScript-compatible way to do this at scale\n  get id(): string { return this._def.publicId }\n  get groupId(): string { return this._def.groupId }\n  get allDay(): boolean { return this._def.allDay }\n  get title(): string { return this._def.title }\n  get url(): string { return this._def.url }\n  get rendering(): string { return this._def.rendering }\n  get startEditable(): boolean { return this._def.ui.startEditable }\n  get durationEditable(): boolean { return this._def.ui.durationEditable }\n  get constraint(): any { return this._def.ui.constraints[0] || null }\n  get overlap(): any { return this._def.ui.overlap }\n  get allow(): any { return this._def.ui.allows[0] || null }\n  get backgroundColor(): string { return this._def.ui.backgroundColor }\n  get borderColor(): string { return this._def.ui.borderColor }\n  get textColor(): string { return this._def.ui.textColor }\n\n  // NOTE: user can't modify these because Object.freeze was called in event-def parsing\n  get classNames(): string[] { return this._def.ui.classNames }\n  get extendedProps(): any { return this._def.extendedProps }\n\n}\n","import { EventDef, EventTuple, EventDefHash } from '../structs/event'\nimport { EventStore } from '../structs/event-store'\nimport { DateRange, invertRanges, intersectRanges } from '../datelib/date-range'\nimport { Duration } from '../datelib/duration'\nimport { computeVisibleDayRange } from '../util/misc'\nimport { Seg } from './DateComponent'\nimport View from '../View'\nimport EventApi from '../api/EventApi'\nimport { EventUi, EventUiHash, combineEventUis } from './event-ui'\nimport { mapHash } from '../util/object'\n\nexport interface EventRenderRange extends EventTuple {\n  ui: EventUi\n  range: DateRange\n  isStart: boolean\n  isEnd: boolean\n}\n\n/*\nSpecifying nextDayThreshold signals that all-day ranges should be sliced.\n*/\nexport function sliceEventStore(eventStore: EventStore, eventUiBases: EventUiHash, framingRange: DateRange, nextDayThreshold?: Duration) {\n  let inverseBgByGroupId: { [groupId: string]: DateRange[] } = {}\n  let inverseBgByDefId: { [defId: string]: DateRange[] } = {}\n  let defByGroupId: { [groupId: string]: EventDef } = {}\n  let bgRanges: EventRenderRange[] = []\n  let fgRanges: EventRenderRange[] = []\n  let eventUis = compileEventUis(eventStore.defs, eventUiBases)\n\n  for (let defId in eventStore.defs) {\n    let def = eventStore.defs[defId]\n\n    if (def.rendering === 'inverse-background') {\n      if (def.groupId) {\n        inverseBgByGroupId[def.groupId] = []\n\n        if (!defByGroupId[def.groupId]) {\n          defByGroupId[def.groupId] = def\n        }\n      } else {\n        inverseBgByDefId[defId] = []\n      }\n    }\n  }\n\n  for (let instanceId in eventStore.instances) {\n    let instance = eventStore.instances[instanceId]\n    let def = eventStore.defs[instance.defId]\n    let ui = eventUis[def.defId]\n    let origRange = instance.range\n\n    let normalRange = (!def.allDay && nextDayThreshold) ?\n      computeVisibleDayRange(origRange, nextDayThreshold) :\n      origRange\n\n    let slicedRange = intersectRanges(normalRange, framingRange)\n\n    if (slicedRange) {\n      if (def.rendering === 'inverse-background') {\n        if (def.groupId) {\n          inverseBgByGroupId[def.groupId].push(slicedRange)\n        } else {\n          inverseBgByDefId[instance.defId].push(slicedRange)\n        }\n      } else {\n        (def.rendering === 'background' ? bgRanges : fgRanges).push({\n          def,\n          ui,\n          instance,\n          range: slicedRange,\n          isStart: normalRange.start && normalRange.start.valueOf() === slicedRange.start.valueOf(),\n          isEnd: normalRange.end && normalRange.end.valueOf() === slicedRange.end.valueOf()\n        })\n      }\n    }\n  }\n\n  for (let groupId in inverseBgByGroupId) { // BY GROUP\n    let ranges = inverseBgByGroupId[groupId]\n    let invertedRanges = invertRanges(ranges, framingRange)\n\n    for (let invertedRange of invertedRanges) {\n      let def = defByGroupId[groupId]\n      let ui = eventUis[def.defId]\n\n      bgRanges.push({\n        def,\n        ui,\n        instance: null,\n        range: invertedRange,\n        isStart: false,\n        isEnd: false\n      })\n    }\n  }\n\n  for (let defId in inverseBgByDefId) {\n    let ranges = inverseBgByDefId[defId]\n    let invertedRanges = invertRanges(ranges, framingRange)\n\n    for (let invertedRange of invertedRanges) {\n      bgRanges.push({\n        def: eventStore.defs[defId],\n        ui: eventUis[defId],\n        instance: null,\n        range: invertedRange,\n        isStart: false,\n        isEnd: false\n      })\n    }\n  }\n\n  return { bg: bgRanges, fg: fgRanges }\n}\n\nexport function hasBgRendering(def: EventDef) {\n  return def.rendering === 'background' || def.rendering === 'inverse-background'\n}\n\nexport function filterSegsViaEls(view: View, segs: Seg[], isMirror: boolean) {\n\n  if (view.hasPublicHandlers('eventRender')) {\n    segs = segs.filter(function(seg) {\n      let custom = view.publiclyTrigger('eventRender', [\n        {\n          event: new EventApi(\n            view.calendar,\n            seg.eventRange.def,\n            seg.eventRange.instance\n          ),\n          isMirror,\n          isStart: seg.isStart,\n          isEnd: seg.isEnd,\n          // TODO: include seg.range once all components consistently generate it\n          el: seg.el,\n          view\n        }\n      ])\n\n      if (custom === false) { // means don't render at all\n        return false\n      } else if (custom && custom !== true) {\n        seg.el = custom\n      }\n\n      return true\n    })\n  }\n\n  for (let seg of segs) {\n    setElSeg(seg.el, seg)\n  }\n\n  return segs\n}\n\nfunction setElSeg(el: HTMLElement, seg: Seg) {\n  (el as any).fcSeg = seg\n}\n\nexport function getElSeg(el: HTMLElement): Seg | null {\n  return (el as any).fcSeg || null\n}\n\n\n// event ui computation\n\nexport function compileEventUis(eventDefs: EventDefHash, eventUiBases: EventUiHash) {\n  return mapHash(eventDefs, function(eventDef: EventDef) {\n    return compileEventUi(eventDef, eventUiBases)\n  })\n}\n\nexport function compileEventUi(eventDef: EventDef, eventUiBases: EventUiHash) {\n  let uis = []\n\n  if (eventUiBases['']) {\n    uis.push(eventUiBases[''])\n  }\n\n  if (eventUiBases[eventDef.defId]) {\n    uis.push(eventUiBases[eventDef.defId])\n  }\n\n  uis.push(eventDef.ui)\n\n  return combineEventUis(uis)\n}\n","import { Duration } from '../datelib/duration'\nimport { EventStore, createEmptyEventStore } from './event-store'\nimport { EventDef, EventInstance } from './event'\nimport Calendar from '../Calendar'\nimport { computeAlignedDayRange } from '../util/misc'\nimport { startOfDay } from '../datelib/marker'\nimport { EventUiHash, EventUi } from '../component/event-ui'\nimport { compileEventUis } from '../component/event-rendering'\n\n/*\nA data structure for how to modify an EventDef/EventInstance within an EventStore\n*/\n\nexport interface EventMutation {\n  datesDelta?: Duration // body start+end moving together. for dragging\n  startDelta?: Duration // for resizing\n  endDelta?: Duration // for resizing\n  standardProps?: any // for the def. should not include extendedProps\n  extendedProps?: any // for the def\n}\n\n// applies the mutation to ALL defs/instances within the event store\nexport function applyMutationToEventStore(eventStore: EventStore, eventConfigBase: EventUiHash, mutation: EventMutation, calendar: Calendar): EventStore {\n  let eventConfigs = compileEventUis(eventStore.defs, eventConfigBase)\n  let dest = createEmptyEventStore()\n\n  for (let defId in eventStore.defs) {\n    let def = eventStore.defs[defId]\n\n    dest.defs[defId] = applyMutationToEventDef(def, eventConfigs[defId], mutation, calendar.pluginSystem.hooks.eventDefMutationAppliers, calendar)\n  }\n\n  for (let instanceId in eventStore.instances) {\n    let instance = eventStore.instances[instanceId]\n    let def = dest.defs[instance.defId] // important to grab the newly modified def\n\n    dest.instances[instanceId] = applyMutationToEventInstance(instance, def, eventConfigs[instance.defId], mutation, calendar)\n  }\n\n  return dest\n}\n\nexport type eventDefMutationApplier = (eventDef: EventDef, mutation: EventMutation, calendar: Calendar) => void\n\n\nfunction applyMutationToEventDef(eventDef: EventDef, eventConfig: EventUi, mutation: EventMutation, appliers: eventDefMutationApplier[], calendar: Calendar): EventDef {\n  let standardProps = mutation.standardProps || {}\n\n  // if hasEnd has not been specified, guess a good value based on deltas.\n  // if duration will change, there's no way the default duration will persist,\n  // and thus, we need to mark the event as having a real end\n  if (\n    standardProps.hasEnd == null &&\n    eventConfig.durationEditable &&\n    (mutation.startDelta || mutation.endDelta)\n  ) {\n    standardProps.hasEnd = true // TODO: is this mutation okay?\n  }\n\n  let copy: EventDef = {\n    ...eventDef,\n    ...standardProps,\n    ui: { ...eventDef.ui, ...standardProps.ui } // the only prop we want to recursively overlay\n  }\n\n  if (mutation.extendedProps) {\n    copy.extendedProps = { ...copy.extendedProps, ...mutation.extendedProps }\n  }\n\n  for (let applier of appliers) {\n    applier(copy, mutation, calendar)\n  }\n\n  if (!copy.hasEnd && calendar.opt('forceEventDuration')) {\n    copy.hasEnd = true\n  }\n\n  return copy\n}\n\n\nfunction applyMutationToEventInstance(\n  eventInstance: EventInstance,\n  eventDef: EventDef, // must first be modified by applyMutationToEventDef\n  eventConfig: EventUi,\n  mutation: EventMutation,\n  calendar: Calendar\n): EventInstance {\n  let dateEnv = calendar.dateEnv\n  let forceAllDay = mutation.standardProps && mutation.standardProps.allDay === true\n  let clearEnd = mutation.standardProps && mutation.standardProps.hasEnd === false\n  let copy = { ...eventInstance } as EventInstance\n\n  if (forceAllDay) {\n    copy.range = computeAlignedDayRange(copy.range)\n  }\n\n  if (mutation.datesDelta && eventConfig.startEditable) {\n    copy.range = {\n      start: dateEnv.add(copy.range.start, mutation.datesDelta),\n      end: dateEnv.add(copy.range.end, mutation.datesDelta)\n    }\n  }\n\n  if (mutation.startDelta && eventConfig.durationEditable) {\n    copy.range = {\n      start: dateEnv.add(copy.range.start, mutation.startDelta),\n      end: copy.range.end\n    }\n  }\n\n  if (mutation.endDelta && eventConfig.durationEditable) {\n    copy.range = {\n      start: copy.range.start,\n      end: dateEnv.add(copy.range.end, mutation.endDelta)\n    }\n  }\n\n  if (clearEnd) {\n    copy.range = {\n      start: copy.range.start,\n      end: calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start)\n    }\n  }\n\n  // in case event was all-day but the supplied deltas were not\n  // better util for this?\n  if (eventDef.allDay) {\n    copy.range = {\n      start: startOfDay(copy.range.start),\n      end: startOfDay(copy.range.end)\n    }\n  }\n\n  // handle invalid durations\n  if (copy.range.end < copy.range.start) {\n    copy.range.end = calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start)\n  }\n\n  return copy\n}\n","import Calendar from '../Calendar'\nimport { filterHash, mapHash } from '../util/object'\nimport { EventMutation, applyMutationToEventStore } from '../structs/event-mutation'\nimport { EventDef, EventInstance, EventInput, EventInstanceHash } from '../structs/event'\nimport {\n  EventStore,\n  mergeEventStores,\n  getRelevantEvents,\n  createEmptyEventStore,\n  filterEventStoreDefs,\n  parseEvents,\n  expandRecurring,\n  transformRawEvents\n} from '../structs/event-store'\nimport { Action } from './types'\nimport { EventSourceHash, EventSource } from '../structs/event-source'\nimport { DateRange } from '../datelib/date-range'\nimport { DateProfile } from '../DateProfileGenerator'\nimport { DateEnv } from '../datelib/env'\nimport { EventUiHash } from '../component/event-ui'\n\n\nexport default function(eventStore: EventStore, action: Action, eventSources: EventSourceHash, dateProfile: DateProfile, calendar: Calendar): EventStore {\n  switch (action.type) {\n\n    case 'RECEIVE_EVENTS': // raw\n      return receiveRawEvents(\n        eventStore,\n        eventSources[action.sourceId],\n        action.fetchId,\n        action.fetchRange,\n        action.rawEvents,\n        calendar\n      )\n\n    case 'ADD_EVENTS': // already parsed, but not expanded\n      return addEvent(\n        eventStore,\n        action.eventStore, // new ones\n        dateProfile ? dateProfile.activeRange : null,\n        calendar\n      )\n\n    case 'MERGE_EVENTS': // already parsed and expanded\n      return mergeEventStores(eventStore, action.eventStore)\n\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n    case 'NEXT':\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      if (dateProfile) {\n        return expandRecurring(eventStore, dateProfile.activeRange, calendar)\n      } else {\n        return eventStore\n      }\n\n    case 'CHANGE_TIMEZONE':\n      return rezoneDates(eventStore, action.oldDateEnv, calendar.dateEnv)\n\n    case 'MUTATE_EVENTS':\n      return applyMutationToRelated(eventStore, action.instanceId, action.mutation, action.fromApi, calendar)\n\n    case 'REMOVE_EVENT_INSTANCES':\n      return excludeInstances(eventStore, action.instances)\n\n    case 'REMOVE_EVENT_DEF':\n      return filterEventStoreDefs(eventStore, function(eventDef) {\n        return eventDef.defId !== action.defId\n      })\n\n    case 'REMOVE_EVENT_SOURCE':\n      return excludeEventsBySourceId(eventStore, action.sourceId)\n\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return filterEventStoreDefs(eventStore, function(eventDef: EventDef) {\n        return !eventDef.sourceId // only keep events with no source id\n      })\n\n    case 'REMOVE_ALL_EVENTS':\n      return createEmptyEventStore()\n\n    case 'RESET_EVENTS':\n      return { // returns a new object with the same contents\n        defs: eventStore.defs,\n        instances: eventStore.instances\n      }\n\n    default:\n      return eventStore\n  }\n}\n\n\nfunction receiveRawEvents(\n  eventStore: EventStore,\n  eventSource: EventSource,\n  fetchId: string,\n  fetchRange: DateRange | null,\n  rawEvents: EventInput[],\n  calendar: Calendar\n): EventStore {\n\n  if (\n    eventSource && // not already removed\n    fetchId === eventSource.latestFetchId // TODO: wish this logic was always in event-sources\n  ) {\n\n    let subset = parseEvents(\n      transformRawEvents(rawEvents, eventSource, calendar),\n      eventSource.sourceId,\n      calendar\n    )\n\n    if (fetchRange) {\n      subset = expandRecurring(subset, fetchRange, calendar)\n    }\n\n    return mergeEventStores(\n      excludeEventsBySourceId(eventStore, eventSource.sourceId),\n      subset\n    )\n  }\n\n  return eventStore\n}\n\n\nfunction addEvent(eventStore: EventStore, subset: EventStore, expandRange: DateRange | null, calendar: Calendar): EventStore {\n\n  if (expandRange) {\n    subset = expandRecurring(subset, expandRange, calendar)\n  }\n\n  return mergeEventStores(eventStore, subset)\n}\n\n\nfunction rezoneDates(eventStore: EventStore, oldDateEnv: DateEnv, newDateEnv: DateEnv): EventStore {\n  let defs = eventStore.defs\n\n  let instances = mapHash(eventStore.instances, function(instance: EventInstance): EventInstance {\n    let def = defs[instance.defId]\n\n    if (def.allDay || def.recurringDef) {\n      return instance // isn't dependent on timezone\n    } else {\n      return {\n        ...instance,\n        range: {\n          start: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.start, instance.forcedStartTzo)),\n          end: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.end, instance.forcedEndTzo))\n        },\n        forcedStartTzo: newDateEnv.canComputeOffset ? null : instance.forcedStartTzo,\n        forcedEndTzo: newDateEnv.canComputeOffset ? null : instance.forcedEndTzo\n      }\n    }\n  })\n\n  return { defs, instances }\n}\n\n\nfunction applyMutationToRelated(eventStore: EventStore, instanceId: string, mutation: EventMutation, fromApi: boolean, calendar: Calendar): EventStore {\n  let relevant = getRelevantEvents(eventStore, instanceId)\n  let eventConfigBase = fromApi ?\n    { '': { // HACK. always allow API to mutate events\n      startEditable: true,\n      durationEditable: true,\n      constraints: [],\n      overlap: null,\n      allows: [],\n      backgroundColor: '',\n      borderColor: '',\n      textColor: '',\n      classNames: []\n    } } as EventUiHash :\n    calendar.eventUiBases\n\n\n  relevant = applyMutationToEventStore(relevant, eventConfigBase, mutation, calendar)\n\n  return mergeEventStores(eventStore, relevant)\n}\n\n\nfunction excludeEventsBySourceId(eventStore, sourceId) {\n  return filterEventStoreDefs(eventStore, function(eventDef: EventDef) {\n    return eventDef.sourceId !== sourceId\n  })\n}\n\n\n// QUESTION: why not just return instances? do a general object-property-exclusion util\nexport function excludeInstances(eventStore: EventStore, removals: EventInstanceHash): EventStore {\n  return {\n    defs: eventStore.defs,\n    instances: filterHash(eventStore.instances, function(instance: EventInstance) {\n      return !removals[instance.instanceId]\n    })\n  }\n}\n","import { EventStore, expandRecurring, filterEventStoreDefs, parseEvents, createEmptyEventStore } from './structs/event-store'\nimport Calendar from './Calendar'\nimport { DateSpan, DateSpanApi } from './structs/date-span'\nimport { rangeContainsRange, rangesIntersect, DateRange, OpenDateRange } from './datelib/date-range'\nimport EventApi from './api/EventApi'\nimport { compileEventUis } from './component/event-rendering'\nimport { excludeInstances } from './reducers/eventStore'\nimport { EventInput } from './structs/event'\nimport { EventInteractionState } from './interactions/event-interaction-state'\nimport { SplittableProps } from './component/event-splitting'\nimport { mapHash } from './util/object'\n\n// TODO: rename to \"criteria\" ?\nexport type ConstraintInput = 'businessHours' | string | EventInput | EventInput[]\nexport type Constraint = 'businessHours' | string | EventStore | false // false means won't pass at all\nexport type OverlapFunc = ((stillEvent: EventApi, movingEvent: EventApi | null) => boolean)\nexport type AllowFunc = (span: DateSpanApi, movingEvent: EventApi | null) => boolean\nexport type isPropsValidTester = (props: SplittableProps, calendar: Calendar) => boolean\n\n\n// high-level segmenting-aware tester functions\n// ------------------------------------------------------------------------------------------------------------------------\n\nexport function isInteractionValid(interaction: EventInteractionState, calendar: Calendar) {\n  return isNewPropsValid({ eventDrag: interaction }, calendar) // HACK: the eventDrag props is used for ALL interactions\n}\n\nexport function isDateSelectionValid(dateSelection: DateSpan, calendar: Calendar) {\n  return isNewPropsValid({ dateSelection }, calendar)\n}\n\nfunction isNewPropsValid(newProps, calendar: Calendar) {\n  let view = calendar.view\n\n  let props = {\n    businessHours: view ? view.props.businessHours : createEmptyEventStore(), // why? yuck\n    dateSelection: '',\n    eventStore: calendar.state.eventStore,\n    eventUiBases: calendar.eventUiBases,\n    eventSelection: '',\n    eventDrag: null,\n    eventResize: null,\n    ...newProps\n  }\n\n  return (calendar.pluginSystem.hooks.isPropsValid || isPropsValid)(props, calendar)\n}\n\nexport function isPropsValid(state: SplittableProps, calendar: Calendar, dateSpanMeta = {}, filterConfig?): boolean {\n\n  if (state.eventDrag && !isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n    return false\n  }\n\n  if (state.dateSelection && !isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n    return false\n  }\n\n  return true\n}\n\n\n// Moving Event Validation\n// ------------------------------------------------------------------------------------------------------------------------\n\nfunction isInteractionPropsValid(state: SplittableProps, calendar: Calendar, dateSpanMeta: any, filterConfig): boolean {\n  let interaction = state.eventDrag // HACK: the eventDrag props is used for ALL interactions\n\n  let subjectEventStore = interaction.mutatedEvents\n  let subjectDefs = subjectEventStore.defs\n  let subjectInstances = subjectEventStore.instances\n  let subjectConfigs = compileEventUis(\n    subjectDefs,\n    interaction.isEvent ?\n      state.eventUiBases :\n      { '': calendar.selectionConfig } // if not a real event, validate as a selection\n  )\n\n  if (filterConfig) {\n    subjectConfigs = mapHash(subjectConfigs, filterConfig)\n  }\n\n  let otherEventStore = excludeInstances(state.eventStore, interaction.affectedEvents.instances) // exclude the subject events. TODO: exclude defs too?\n  let otherDefs = otherEventStore.defs\n  let otherInstances = otherEventStore.instances\n  let otherConfigs = compileEventUis(otherDefs, state.eventUiBases)\n\n  for (let subjectInstanceId in subjectInstances) {\n    let subjectInstance = subjectInstances[subjectInstanceId]\n    let subjectRange = subjectInstance.range\n    let subjectConfig = subjectConfigs[subjectInstance.defId]\n    let subjectDef = subjectDefs[subjectInstance.defId]\n\n    // constraint\n    if (!allConstraintsPass(subjectConfig.constraints, subjectRange, otherEventStore, state.businessHours, calendar)) {\n      return false\n    }\n\n    // overlap\n\n    let overlapFunc = calendar.opt('eventOverlap')\n    if (typeof overlapFunc !== 'function') { overlapFunc = null }\n\n    for (let otherInstanceId in otherInstances) {\n      let otherInstance = otherInstances[otherInstanceId]\n\n      // intersect! evaluate\n      if (rangesIntersect(subjectRange, otherInstance.range)) {\n        let otherOverlap = otherConfigs[otherInstance.defId].overlap\n\n        // consider the other event's overlap. only do this if the subject event is a \"real\" event\n        if (otherOverlap === false && interaction.isEvent) {\n          return false\n        }\n\n        if (subjectConfig.overlap === false) {\n          return false\n        }\n\n        if (overlapFunc && !overlapFunc(\n          new EventApi(calendar, otherDefs[otherInstance.defId], otherInstance), // still event\n          new EventApi(calendar, subjectDef, subjectInstance) // moving event\n        )) {\n          return false\n        }\n      }\n    }\n\n    // allow (a function)\n\n    let calendarEventStore = calendar.state.eventStore // need global-to-calendar, not local to component (splittable)state\n\n    for (let subjectAllow of subjectConfig.allows) {\n\n      let subjectDateSpan: DateSpan = {\n        ...dateSpanMeta,\n        range: subjectInstance.range,\n        allDay: subjectDef.allDay\n      }\n\n      let origDef = calendarEventStore.defs[subjectDef.defId]\n      let origInstance = calendarEventStore.instances[subjectInstanceId]\n      let eventApi\n\n      if (origDef) { // was previously in the calendar\n        eventApi = new EventApi(calendar, origDef, origInstance)\n      } else { // was an external event\n        eventApi = new EventApi(calendar, subjectDef) // no instance, because had no dates\n      }\n\n      if (!subjectAllow(\n        calendar.buildDateSpanApi(subjectDateSpan),\n        eventApi\n      )) {\n        return false\n      }\n    }\n\n  }\n\n  return true\n}\n\n\n// Date Selection Validation\n// ------------------------------------------------------------------------------------------------------------------------\n\nfunction isDateSelectionPropsValid(state: SplittableProps, calendar: Calendar, dateSpanMeta: any, filterConfig): boolean {\n  let relevantEventStore = state.eventStore\n  let relevantDefs = relevantEventStore.defs\n  let relevantInstances = relevantEventStore.instances\n\n  let selection = state.dateSelection\n  let selectionRange = selection.range\n  let { selectionConfig } = calendar\n\n  if (filterConfig) {\n    selectionConfig = filterConfig(selectionConfig)\n  }\n\n  // constraint\n  if (!allConstraintsPass(selectionConfig.constraints, selectionRange, relevantEventStore, state.businessHours, calendar)) {\n    return false\n  }\n\n  // overlap\n\n  let overlapFunc = calendar.opt('selectOverlap')\n  if (typeof overlapFunc !== 'function') { overlapFunc = null }\n\n  for (let relevantInstanceId in relevantInstances) {\n    let relevantInstance = relevantInstances[relevantInstanceId]\n\n    // intersect! evaluate\n    if (rangesIntersect(selectionRange, relevantInstance.range)) {\n\n      if (selectionConfig.overlap === false) {\n        return false\n      }\n\n      if (overlapFunc && !overlapFunc(\n        new EventApi(calendar, relevantDefs[relevantInstance.defId], relevantInstance)\n      )) {\n        return false\n      }\n    }\n  }\n\n  // allow (a function)\n  for (let selectionAllow of selectionConfig.allows) {\n\n    let fullDateSpan = { ...dateSpanMeta, ...selection }\n\n    if (!selectionAllow(\n      calendar.buildDateSpanApi(fullDateSpan),\n      null\n    )) {\n      return false\n    }\n  }\n\n  return true\n}\n\n\n// Constraint Utils\n// ------------------------------------------------------------------------------------------------------------------------\n\nfunction allConstraintsPass(\n  constraints: Constraint[],\n  subjectRange: DateRange,\n  otherEventStore: EventStore,\n  businessHoursUnexpanded: EventStore,\n  calendar: Calendar\n): boolean {\n  for (let constraint of constraints) {\n    if (!anyRangesContainRange(\n      constraintToRanges(constraint, subjectRange, otherEventStore, businessHoursUnexpanded, calendar),\n      subjectRange\n    )) {\n      return false\n    }\n  }\n\n  return true\n}\n\nfunction constraintToRanges(\n  constraint: Constraint,\n  subjectRange: DateRange, // for expanding a recurring constraint, or expanding business hours\n  otherEventStore: EventStore, // for if constraint is an even group ID\n  businessHoursUnexpanded: EventStore, // for if constraint is 'businessHours'\n  calendar: Calendar // for expanding businesshours\n): OpenDateRange[] {\n\n  if (constraint === 'businessHours') {\n    return eventStoreToRanges(\n      expandRecurring(businessHoursUnexpanded, subjectRange, calendar)\n    )\n\n  } else if (typeof constraint === 'string') { // an group ID\n    return eventStoreToRanges(\n      filterEventStoreDefs(otherEventStore, function(eventDef) {\n        return eventDef.groupId === constraint\n      })\n    )\n\n  } else if (typeof constraint === 'object' && constraint) { // non-null object\n    return eventStoreToRanges(\n      expandRecurring(constraint, subjectRange, calendar)\n    )\n  }\n\n  return [] // if it's false\n}\n\n// TODO: move to event-store file?\nfunction eventStoreToRanges(eventStore: EventStore): DateRange[] {\n  let { instances } = eventStore\n  let ranges: DateRange[] = []\n\n  for (let instanceId in instances) {\n    ranges.push(instances[instanceId].range)\n  }\n\n  return ranges\n}\n\n// TODO: move to geom file?\nfunction anyRangesContainRange(outerRanges: DateRange[], innerRange: DateRange): boolean {\n\n  for (let outerRange of outerRanges) {\n    if (rangeContainsRange(outerRange, innerRange)) {\n      return true\n    }\n  }\n\n  return false\n}\n\n\n// Parsing\n// ------------------------------------------------------------------------------------------------------------------------\n\nexport function normalizeConstraint(input: ConstraintInput, calendar: Calendar): Constraint | null {\n  if (Array.isArray(input)) {\n    return parseEvents(input, '', calendar, true) // allowOpenRange=true\n\n  } else if (typeof input === 'object' && input) { // non-null object\n    return parseEvents([ input ], '', calendar, true) // allowOpenRange=true\n\n  } else if (input != null) {\n    return String(input)\n\n  } else {\n    return null\n  }\n}\n","\nexport function htmlEscape(s) {\n  return (s + '').replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/'/g, '&#039;')\n    .replace(/\"/g, '&quot;')\n    .replace(/\\n/g, '<br />')\n}\n\n\n// Given a hash of CSS properties, returns a string of CSS.\n// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.\nexport function cssToStr(cssProps) {\n  let statements = []\n\n  for (let name in cssProps) {\n    let val = cssProps[name]\n    if (val != null && val !== '') {\n      statements.push(name + ':' + val)\n    }\n  }\n\n  return statements.join(';')\n}\n\n\n// Given an object hash of HTML attribute names to values,\n// generates a string that can be injected between < > in HTML\nexport function attrsToStr(attrs) {\n  let parts = []\n\n  for (let name in attrs) {\n    let val = attrs[name]\n    if (val != null) {\n      parts.push(name + '=\"' + htmlEscape(val) + '\"')\n    }\n  }\n\n  return parts.join(' ')\n}\n\n\nexport type ClassNameInput = string | string[]\n\nexport function parseClassName(raw: ClassNameInput) {\n  if (Array.isArray(raw)) {\n    return raw\n  } else if (typeof raw === 'string') {\n    return raw.split(/\\s+/)\n  } else {\n    return []\n  }\n}\n","import { Constraint, AllowFunc, normalizeConstraint, ConstraintInput } from '../validation'\nimport { parseClassName } from '../util/html'\nimport { refineProps, capitaliseFirstLetter } from '../util/misc'\nimport Calendar from '../Calendar'\n\n// TODO: better called \"EventSettings\" or \"EventConfig\"\n// TODO: move this file into structs\n// TODO: separate constraint/overlap/allow, because selection uses only that, not other props\n\nexport interface UnscopedEventUiInput {\n  editable?: boolean\n  startEditable?: boolean\n  durationEditable?: boolean\n  constraint?: ConstraintInput\n  overlap?: boolean\n  allow?: AllowFunc\n  className?: string[] | string\n  classNames?: string[] | string\n  backgroundColor?: string\n  borderColor?: string\n  textColor?: string\n  color?: string\n}\n\nexport interface EventUi {\n  startEditable: boolean | null\n  durationEditable: boolean | null\n  constraints: Constraint[]\n  overlap: boolean | null\n  allows: AllowFunc[]\n  backgroundColor: string\n  borderColor: string\n  textColor: string,\n  classNames: string[]\n}\n\nexport type EventUiHash = { [defId: string]: EventUi }\n\nexport const UNSCOPED_EVENT_UI_PROPS = {\n  editable: Boolean,\n  startEditable: Boolean,\n  durationEditable: Boolean,\n  constraint: null,\n  overlap: null,\n  allow: null,\n  className: parseClassName,\n  classNames: parseClassName,\n  color: String,\n  backgroundColor: String,\n  borderColor: String,\n  textColor: String\n}\n\nexport function processUnscopedUiProps(rawProps: UnscopedEventUiInput, calendar: Calendar, leftovers?): EventUi {\n  let props = refineProps(rawProps, UNSCOPED_EVENT_UI_PROPS, {}, leftovers)\n  let constraint = normalizeConstraint(props.constraint, calendar)\n\n  return {\n    startEditable: props.startEditable != null ? props.startEditable : props.editable,\n    durationEditable: props.durationEditable != null ? props.durationEditable : props.editable,\n    constraints: constraint != null ? [ constraint ] : [],\n    overlap: props.overlap,\n    allows: props.allow != null ? [ props.allow ] : [],\n    backgroundColor: props.backgroundColor || props.color,\n    borderColor: props.borderColor || props.color,\n    textColor: props.textColor,\n    classNames: props.classNames.concat(props.className)\n  }\n}\n\nexport function processScopedUiProps(prefix: string, rawScoped: any, calendar: Calendar, leftovers?): EventUi {\n  let rawUnscoped = {} as any\n  let wasFound = {} as any\n\n  for (let key in UNSCOPED_EVENT_UI_PROPS) {\n    let scopedKey = prefix + capitaliseFirstLetter(key)\n    rawUnscoped[key] = rawScoped[scopedKey]\n    wasFound[scopedKey] = true\n  }\n\n  if (prefix === 'event') {\n    rawUnscoped.editable = rawScoped.editable // special case. there is no 'eventEditable', just 'editable'\n  }\n\n  if (leftovers) {\n    for (let key in rawScoped) {\n      if (!wasFound[key]) {\n        leftovers[key] = rawScoped[key]\n      }\n    }\n  }\n\n  return processUnscopedUiProps(rawUnscoped, calendar)\n}\n\nconst EMPTY_EVENT_UI: EventUi = {\n  startEditable: null,\n  durationEditable: null,\n  constraints: [],\n  overlap: null,\n  allows: [],\n  backgroundColor: '',\n  borderColor: '',\n  textColor: '',\n  classNames: []\n}\n\n// prevent against problems with <2 args!\nexport function combineEventUis(uis: EventUi[]): EventUi {\n  return uis.reduce(combineTwoEventUis, EMPTY_EVENT_UI)\n}\n\nfunction combineTwoEventUis(item0: EventUi, item1: EventUi): EventUi { // hash1 has higher precedence\n  return {\n    startEditable: item1.startEditable != null ? item1.startEditable : item0.startEditable,\n    durationEditable: item1.durationEditable != null ? item1.durationEditable : item0.durationEditable,\n    constraints: item0.constraints.concat(item1.constraints),\n    overlap: typeof item1.overlap === 'boolean' ? item1.overlap : item0.overlap,\n    allows: item0.allows.concat(item1.allows),\n    backgroundColor: item1.backgroundColor || item0.backgroundColor,\n    borderColor: item1.borderColor || item0.borderColor,\n    textColor: item1.textColor || item0.textColor,\n    classNames: item0.classNames.concat(item1.classNames)\n  }\n}\n","import { refineProps } from '../util/misc'\nimport { DateInput } from '../datelib/env'\nimport Calendar from '../Calendar'\nimport { DateRange } from '../datelib/date-range'\nimport { startOfDay } from '../datelib/marker'\nimport { parseRecurring } from './recurring-event'\nimport { Duration } from '../datelib/duration'\nimport { UnscopedEventUiInput, EventUi, processUnscopedUiProps } from '../component/event-ui'\nimport { __assign } from 'tslib'\n\n/*\nUtils for parsing event-input data. Each util parses a subset of the event-input's data.\nIt's up to the caller to stitch them together into an aggregate object like an EventStore.\n*/\n\nexport type EventRenderingChoice = '' | 'background' | 'inverse-background' | 'none'\n\nexport interface EventNonDateInput extends UnscopedEventUiInput {\n  id?: string | number\n  groupId?: string | number\n  title?: string\n  url?: string\n  rendering?: EventRenderingChoice\n  extendedProps?: object\n  [extendedProp: string]: any\n}\n\nexport interface EventDateInput {\n  start?: DateInput\n  end?: DateInput\n  date?: DateInput\n  allDay?: boolean\n}\n\nexport type EventInput = EventNonDateInput & EventDateInput\n\nexport interface EventDef {\n  defId: string\n  sourceId: string\n  publicId: string\n  groupId: string\n  allDay: boolean\n  hasEnd: boolean\n  recurringDef: { typeId: number, typeData: any, duration: Duration | null } | null\n  title: string\n  url: string\n  rendering: EventRenderingChoice\n  ui: EventUi\n  extendedProps: any\n}\n\nexport interface EventInstance {\n  instanceId: string\n  defId: string\n  range: DateRange\n  forcedStartTzo: number | null\n  forcedEndTzo: number | null\n}\n\nexport interface EventTuple {\n  def: EventDef\n  instance: EventInstance | null\n}\n\nexport type EventInstanceHash = { [instanceId: string]: EventInstance }\nexport type EventDefHash = { [defId: string]: EventDef }\n\nexport const NON_DATE_PROPS = {\n  id: String,\n  groupId: String,\n  title: String,\n  url: String,\n  rendering: String,\n  extendedProps: null\n}\n\nexport const DATE_PROPS = {\n  start: null,\n  date: null, // alias for start\n  end: null,\n  allDay: null\n}\n\nlet uid = 0\n\n\nexport function parseEvent(raw: EventInput, sourceId: string, calendar: Calendar, allowOpenRange?: boolean): EventTuple | null {\n  let allDayDefault = computeIsAllDayDefault(sourceId, calendar)\n  let leftovers0 = {}\n  let recurringRes = parseRecurring(\n    raw, // raw, but with single-event stuff stripped out\n    allDayDefault,\n    calendar.dateEnv,\n    calendar.pluginSystem.hooks.recurringTypes,\n    leftovers0 // will populate with non-recurring props\n  )\n\n  if (recurringRes) {\n    let def = parseEventDef(leftovers0, sourceId, recurringRes.allDay, Boolean(recurringRes.duration), calendar)\n\n    def.recurringDef = { // don't want all the props from recurringRes. TODO: more efficient way to do this\n      typeId: recurringRes.typeId,\n      typeData: recurringRes.typeData,\n      duration: recurringRes.duration\n    }\n\n    return { def, instance: null }\n\n  } else {\n    let leftovers1 = {}\n    let singleRes = parseSingle(raw, allDayDefault, calendar, leftovers1, allowOpenRange)\n\n    if (singleRes) {\n      let def = parseEventDef(leftovers1, sourceId, singleRes.allDay, singleRes.hasEnd, calendar)\n      let instance = createEventInstance(def.defId, singleRes.range, singleRes.forcedStartTzo, singleRes.forcedEndTzo)\n\n      return { def, instance }\n    }\n  }\n\n  return null\n}\n\n\n/*\nWill NOT populate extendedProps with the leftover properties.\nWill NOT populate date-related props.\nThe EventNonDateInput has been normalized (id => publicId, etc).\n*/\nexport function parseEventDef(raw: EventNonDateInput, sourceId: string, allDay: boolean, hasEnd: boolean, calendar: Calendar): EventDef {\n  let leftovers = {}\n  let def = pluckNonDateProps(raw, calendar, leftovers) as EventDef\n\n  def.defId = String(uid++)\n  def.sourceId = sourceId\n  def.allDay = allDay\n  def.hasEnd = hasEnd\n\n  for (let eventDefParser of calendar.pluginSystem.hooks.eventDefParsers) {\n    let newLeftovers = {}\n    eventDefParser(def, leftovers, newLeftovers)\n    leftovers = newLeftovers\n  }\n\n  def.extendedProps = __assign(leftovers, def.extendedProps || {})\n\n  // help out EventApi from having user modify props\n  Object.freeze(def.ui.classNames)\n  Object.freeze(def.extendedProps)\n\n  return def\n}\n\nexport type eventDefParserFunc = (def: EventDef, props: any, leftovers: any) => void\n\n\nexport function createEventInstance(\n  defId: string,\n  range: DateRange,\n  forcedStartTzo?: number,\n  forcedEndTzo?: number\n): EventInstance {\n  return {\n    instanceId: String(uid++),\n    defId,\n    range,\n    forcedStartTzo: forcedStartTzo == null ? null : forcedStartTzo,\n    forcedEndTzo: forcedEndTzo == null ? null : forcedEndTzo\n  }\n}\n\n\nfunction parseSingle(raw: EventInput, allDayDefault: boolean | null, calendar: Calendar, leftovers?, allowOpenRange?: boolean) {\n  let props = pluckDateProps(raw, leftovers)\n  let allDay = props.allDay\n  let startMeta\n  let startMarker = null\n  let hasEnd = false\n  let endMeta\n  let endMarker = null\n\n  startMeta = calendar.dateEnv.createMarkerMeta(props.start)\n\n  if (startMeta) {\n    startMarker = startMeta.marker\n  } else if (!allowOpenRange) {\n    return null\n  }\n\n  if (props.end != null) {\n    endMeta = calendar.dateEnv.createMarkerMeta(props.end)\n  }\n\n  if (allDay == null) {\n    if (allDayDefault != null) {\n      allDay = allDayDefault\n    } else {\n      // fall back to the date props LAST\n      allDay = (!startMeta || startMeta.isTimeUnspecified) &&\n        (!endMeta || endMeta.isTimeUnspecified)\n    }\n  }\n\n  if (allDay && startMarker) {\n    startMarker = startOfDay(startMarker)\n  }\n\n  if (endMeta) {\n    endMarker = endMeta.marker\n\n    if (allDay) {\n      endMarker = startOfDay(endMarker)\n    }\n\n    if (startMarker && endMarker <= startMarker) {\n      endMarker = null\n    }\n  }\n\n  if (endMarker) {\n    hasEnd = true\n  } else if (!allowOpenRange) {\n    hasEnd = calendar.opt('forceEventDuration') || false\n\n    endMarker = calendar.dateEnv.add(\n      startMarker,\n      allDay ?\n        calendar.defaultAllDayEventDuration :\n        calendar.defaultTimedEventDuration\n    )\n  }\n\n  return {\n    allDay,\n    hasEnd,\n    range: { start: startMarker, end: endMarker },\n    forcedStartTzo: startMeta ? startMeta.forcedTzo : null,\n    forcedEndTzo: endMeta ? endMeta.forcedTzo : null\n  }\n}\n\n\nfunction pluckDateProps(raw: EventInput, leftovers: any) {\n  let props = refineProps(raw, DATE_PROPS, {}, leftovers)\n\n  props.start = (props.start !== null) ? props.start : props.date\n  delete props.date\n\n  return props\n}\n\n\nfunction pluckNonDateProps(raw: EventInput, calendar: Calendar, leftovers?) {\n  let preLeftovers = {}\n  let props = refineProps(raw, NON_DATE_PROPS, {}, preLeftovers)\n  let ui = processUnscopedUiProps(preLeftovers, calendar, leftovers)\n\n  props.publicId = props.id\n  delete props.id\n\n  props.ui = ui\n\n  return props\n}\n\n\nfunction computeIsAllDayDefault(sourceId: string, calendar: Calendar): boolean | null {\n  let res = null\n\n  if (sourceId) {\n    let source = calendar.state.eventSources[sourceId]\n    res = source.allDayDefault\n  }\n\n  if (res == null) {\n    res = calendar.opt('allDayDefault')\n  }\n\n  return res\n}\n","import Calendar from '../Calendar'\n\nimport { EventInput } from './event'\nimport { EventStore, parseEvents } from './event-store'\n\n/*\nUtils for converting raw business hour input into an EventStore,\nfor both rendering and the constraint system.\n*/\n\nexport type BusinessHoursInput = boolean | EventInput | EventInput[]\n\nconst DEF_DEFAULTS = {\n  startTime: '09:00',\n  endTime: '17:00',\n  daysOfWeek: [ 1, 2, 3, 4, 5 ], // monday - friday\n  rendering: 'inverse-background',\n  classNames: 'fc-nonbusiness',\n  groupId: '_businessHours' // so multiple defs get grouped\n}\n\n/*\nTODO: pass around as EventDefHash!!!\n*/\nexport function parseBusinessHours(input: BusinessHoursInput, calendar: Calendar): EventStore {\n  return parseEvents(\n    refineInputs(input),\n    '',\n    calendar\n  )\n}\n\nfunction refineInputs(input: BusinessHoursInput) {\n  let rawDefs\n\n  if (input === true) {\n    rawDefs = [ {} ] // will get DEF_DEFAULTS verbatim\n  } else if (Array.isArray(input)) {\n    // if specifying an array, every sub-definition NEEDS a day-of-week\n    rawDefs = input.filter(function(rawDef) {\n      return rawDef.daysOfWeek\n    })\n  } else if (typeof input === 'object' && input) { // non-null object\n    rawDefs = [ input ]\n  } else { // is probably false\n    rawDefs = []\n  }\n\n  rawDefs = rawDefs.map(function(rawDef) {\n    return { ...DEF_DEFAULTS, ...rawDef }\n  })\n\n  return rawDefs\n}\n","import { isArraysEqual } from '../util/array'\n\nexport interface MemoizedRendering<ArgsType extends any[]> {\n  (...args: ArgsType): void\n  unrender: () => void\n  dependents: MemoizedRendering<any>[]\n}\n\nexport function memoizeRendering<ArgsType extends any[]>(\n  renderFunc: (...args: ArgsType) => void,\n  unrenderFunc?: (...args: ArgsType) => void,\n  dependencies: MemoizedRendering<any>[] = []\n): MemoizedRendering<ArgsType> {\n\n  let dependents: MemoizedRendering<any>[] = []\n  let thisContext\n  let prevArgs\n\n  function unrender() {\n    if (prevArgs) {\n\n      for (let dependent of dependents) {\n        dependent.unrender()\n      }\n\n      if (unrenderFunc) {\n        unrenderFunc.apply(thisContext, prevArgs)\n      }\n\n      prevArgs = null\n    }\n  }\n\n  function res() {\n    if (!prevArgs || !isArraysEqual(prevArgs, arguments)) {\n      unrender()\n      thisContext = this\n      prevArgs = arguments\n      renderFunc.apply(this, arguments)\n    }\n  }\n\n  res.dependents = dependents\n  res.unrender = unrender\n\n  for (let dependency of dependencies) {\n    dependency.dependents.push(res)\n  }\n\n  return res\n}\n","import { EventStore, createEmptyEventStore } from '../structs/event-store'\nimport { EventDef } from '../structs/event'\nimport { EventInteractionState } from '../interactions/event-interaction-state'\nimport { mapHash } from '../util/object'\nimport { memoize } from '../util/memoize'\nimport { EventUiHash, EventUi, combineEventUis } from './event-ui'\nimport { DateSpan } from '../structs/date-span'\nimport { __assign } from 'tslib'\n\nexport interface SplittableProps {\n  businessHours: EventStore | null // is this really allowed to be null?\n  dateSelection: DateSpan | null\n  eventStore: EventStore\n  eventUiBases: EventUiHash\n  eventSelection: string\n  eventDrag: EventInteractionState | null\n  eventResize: EventInteractionState | null\n}\n\nconst EMPTY_EVENT_STORE = createEmptyEventStore() // for purecomponents. TODO: keep elsewhere\n\nexport default abstract class Splitter<PropsType extends SplittableProps = SplittableProps> {\n\n  private getKeysForEventDefs = memoize(this._getKeysForEventDefs)\n  private splitDateSelection = memoize(this._splitDateSpan)\n  private splitEventStore = memoize(this._splitEventStore)\n  private splitIndividualUi = memoize(this._splitIndividualUi)\n  private splitEventDrag = memoize(this._splitInteraction)\n  private splitEventResize = memoize(this._splitInteraction)\n  private eventUiBuilders = {} // TODO: typescript protection\n\n  abstract getKeyInfo(props: PropsType): { [key: string]: { ui?: EventUi, businessHours?: EventStore } }\n  abstract getKeysForDateSpan(dateSpan: DateSpan): string[]\n  abstract getKeysForEventDef(eventDef: EventDef): string[]\n\n  splitProps(props: PropsType): { [key: string]: SplittableProps } {\n\n    let keyInfos = this.getKeyInfo(props)\n    let defKeys = this.getKeysForEventDefs(props.eventStore)\n    let dateSelections = this.splitDateSelection(props.dateSelection)\n    let individualUi = this.splitIndividualUi(props.eventUiBases, defKeys) // the individual *bases*\n    let eventStores = this.splitEventStore(props.eventStore, defKeys)\n    let eventDrags = this.splitEventDrag(props.eventDrag)\n    let eventResizes = this.splitEventResize(props.eventResize)\n    let splitProps: { [key: string]: SplittableProps } = {}\n\n    this.eventUiBuilders = mapHash(keyInfos, (info, key) => {\n      return this.eventUiBuilders[key] || memoize(buildEventUiForKey)\n    })\n\n    for (let key in keyInfos) {\n      let keyInfo = keyInfos[key]\n      let eventStore = eventStores[key] || EMPTY_EVENT_STORE\n      let buildEventUi = this.eventUiBuilders[key]\n\n      splitProps[key] = {\n        businessHours: keyInfo.businessHours || props.businessHours,\n        dateSelection: dateSelections[key] || null,\n        eventStore,\n        eventUiBases: buildEventUi(props.eventUiBases[''], keyInfo.ui, individualUi[key]),\n        eventSelection: eventStore.instances[props.eventSelection] ? props.eventSelection : '',\n        eventDrag: eventDrags[key] || null,\n        eventResize: eventResizes[key] || null\n      }\n    }\n\n    return splitProps\n  }\n\n  private _splitDateSpan(dateSpan: DateSpan | null) {\n    let dateSpans = {}\n\n    if (dateSpan) {\n      let keys = this.getKeysForDateSpan(dateSpan)\n\n      for (let key of keys) {\n        dateSpans[key] = dateSpan\n      }\n    }\n\n    return dateSpans\n  }\n\n  private _getKeysForEventDefs(eventStore: EventStore) {\n    return mapHash(eventStore.defs, (eventDef: EventDef) => {\n      return this.getKeysForEventDef(eventDef)\n    })\n  }\n\n  private _splitEventStore(eventStore: EventStore, defKeys): { [key: string]: EventStore } {\n    let { defs, instances } = eventStore\n    let splitStores = {}\n\n    for (let defId in defs) {\n      for (let key of defKeys[defId]) {\n\n        if (!splitStores[key]) {\n          splitStores[key] = createEmptyEventStore()\n        }\n\n        splitStores[key].defs[defId] = defs[defId]\n      }\n    }\n\n    for (let instanceId in instances) {\n      let instance = instances[instanceId]\n\n      for (let key of defKeys[instance.defId]) {\n\n        if (splitStores[key]) { // must have already been created\n          splitStores[key].instances[instanceId] = instance\n        }\n      }\n    }\n\n    return splitStores\n  }\n\n  private _splitIndividualUi(eventUiBases: EventUiHash, defKeys): { [key: string]: EventUiHash } {\n    let splitHashes: { [key: string]: EventUiHash } = {}\n\n    for (let defId in eventUiBases) {\n      if (defId) { // not the '' key\n        for (let key of defKeys[defId]) {\n\n          if (!splitHashes[key]) {\n            splitHashes[key] = {}\n          }\n\n          splitHashes[key][defId] = eventUiBases[defId]\n        }\n      }\n    }\n\n    return splitHashes\n  }\n\n  private _splitInteraction(interaction: EventInteractionState | null): { [key: string]: EventInteractionState } {\n    let splitStates: { [key: string]: EventInteractionState } = {}\n\n    if (interaction) {\n      let affectedStores = this._splitEventStore(\n        interaction.affectedEvents,\n        this._getKeysForEventDefs(interaction.affectedEvents) // can't use cached. might be events from other calendar\n      )\n\n      // can't rely on defKeys because event data is mutated\n      let mutatedKeysByDefId = this._getKeysForEventDefs(interaction.mutatedEvents)\n      let mutatedStores = this._splitEventStore(interaction.mutatedEvents, mutatedKeysByDefId)\n\n      let populate = function(key) {\n        if (!splitStates[key]) {\n          splitStates[key] = {\n            affectedEvents: affectedStores[key] || EMPTY_EVENT_STORE,\n            mutatedEvents: mutatedStores[key] || EMPTY_EVENT_STORE,\n            isEvent: interaction.isEvent,\n            origSeg: interaction.origSeg\n          }\n        }\n      }\n\n      for (let key in affectedStores) {\n        populate(key)\n      }\n\n      for (let key in mutatedStores) {\n        populate(key)\n      }\n    }\n\n    return splitStates\n  }\n\n}\n\nfunction buildEventUiForKey(allUi: EventUi | null, eventUiForKey: EventUi | null, individualUi: EventUiHash | null) {\n  let baseParts = []\n\n  if (allUi) {\n    baseParts.push(allUi)\n  }\n\n  if (eventUiForKey) {\n    baseParts.push(eventUiForKey)\n  }\n\n  let stuff = {\n    '': combineEventUis(baseParts)\n  }\n\n  if (individualUi) {\n    __assign(stuff, individualUi)\n  }\n\n  return stuff\n}\n","import { htmlEscape, attrsToStr } from '../util/html'\nimport { DateMarker, startOfDay, addDays, DAY_IDS } from '../datelib/marker'\nimport { rangeContainsMarker } from '../datelib/date-range'\nimport Component, { ComponentContext } from '../component/Component'\nimport { DateProfile } from '../DateProfileGenerator'\n\n\n// Generates HTML for an anchor to another view into the calendar.\n// Will either generate an <a> tag or a non-clickable <span> tag, depending on enabled settings.\n// `gotoOptions` can either be a DateMarker, or an object with the form:\n// { date, type, forceOff }\n// `type` is a view-type like \"day\" or \"week\". default value is \"day\".\n// `attrs` and `innerHtml` are use to generate the rest of the HTML tag.\nexport function buildGotoAnchorHtml(component: Component<any>, gotoOptions, attrs, innerHtml?) {\n  let { dateEnv } = component\n  let date\n  let type\n  let forceOff\n  let finalOptions\n\n  if (gotoOptions instanceof Date) {\n    date = gotoOptions // a single date-like input\n  } else {\n    date = gotoOptions.date\n    type = gotoOptions.type\n    forceOff = gotoOptions.forceOff\n  }\n\n  finalOptions = { // for serialization into the link\n    date: dateEnv.formatIso(date, { omitTime: true }),\n    type: type || 'day'\n  }\n\n  if (typeof attrs === 'string') {\n    innerHtml = attrs\n    attrs = null\n  }\n\n  attrs = attrs ? ' ' + attrsToStr(attrs) : '' // will have a leading space\n  innerHtml = innerHtml || ''\n\n  if (!forceOff && component.opt('navLinks')) {\n    return '<a' + attrs +\n      ' data-goto=\"' + htmlEscape(JSON.stringify(finalOptions)) + '\">' +\n      innerHtml +\n      '</a>'\n  } else {\n    return '<span' + attrs + '>' +\n      innerHtml +\n      '</span>'\n  }\n}\n\n\nexport function getAllDayHtml(component: Component<any>) {\n  return component.opt('allDayHtml') || htmlEscape(component.opt('allDayText'))\n}\n\n\n// Computes HTML classNames for a single-day element\nexport function getDayClasses(date: DateMarker, dateProfile: DateProfile, context: ComponentContext, noThemeHighlight?) {\n  let { calendar, view, theme, dateEnv } = context\n  let classes = []\n  let todayStart: DateMarker\n  let todayEnd: DateMarker\n\n  if (!rangeContainsMarker(dateProfile.activeRange, date)) {\n    classes.push('fc-disabled-day')\n  } else {\n    classes.push('fc-' + DAY_IDS[date.getUTCDay()])\n\n    if (\n      view.opt('monthMode') &&\n      dateEnv.getMonth(date) !== dateEnv.getMonth(dateProfile.currentRange.start)\n    ) {\n      classes.push('fc-other-month')\n    }\n\n    todayStart = startOfDay(calendar.getNow())\n    todayEnd = addDays(todayStart, 1)\n\n    if (date < todayStart) {\n      classes.push('fc-past')\n    } else if (date >= todayEnd) {\n      classes.push('fc-future')\n    } else {\n      classes.push('fc-today')\n\n      if (noThemeHighlight !== true) {\n        classes.push(theme.getClass('today'))\n      }\n    }\n  }\n\n  return classes\n}\n","\n// given a function that resolves a result asynchronously.\n// the function can either call passed-in success and failure callbacks,\n// or it can return a promise.\n// if you need to pass additional params to func, bind them first.\nexport function unpromisify(func, success, failure?) {\n\n  // guard against success/failure callbacks being called more than once\n  // and guard against a promise AND callback being used together.\n  let isResolved = false\n  let wrappedSuccess = function() {\n    if (!isResolved) {\n      isResolved = true\n      success.apply(this, arguments)\n    }\n  }\n  let wrappedFailure = function() {\n    if (!isResolved) {\n      isResolved = true\n      if (failure) {\n        failure.apply(this, arguments)\n      }\n    }\n  }\n\n  let res = func(wrappedSuccess, wrappedFailure)\n  if (res && typeof res.then === 'function') {\n    res.then(wrappedSuccess, wrappedFailure)\n  }\n}\n","\nexport default class Mixin {\n\n  // mix into a CLASS\n  static mixInto(destClass) {\n    this.mixIntoObj(destClass.prototype)\n  }\n\n  // mix into ANY object\n  static mixIntoObj(destObj) {\n    Object.getOwnPropertyNames(this.prototype).forEach((name) => { // copy methods\n      if (!destObj[name]) { // if destination doesn't already define it\n        destObj[name] = this.prototype[name]\n      }\n    })\n  }\n\n  /*\n  will override existing methods\n  TODO: remove! not used anymore\n  */\n  static mixOver(destClass) {\n    Object.getOwnPropertyNames(this.prototype).forEach((name) => { // copy methods\n      destClass.prototype[name] = this.prototype[name]\n    })\n  }\n\n}\n","/*\nUSAGE:\n  import { default as EmitterMixin, EmitterInterface } from './EmitterMixin'\nin class:\n  on: EmitterInterface['on']\n  one: EmitterInterface['one']\n  off: EmitterInterface['off']\n  trigger: EmitterInterface['trigger']\n  triggerWith: EmitterInterface['triggerWith']\n  hasHandlers: EmitterInterface['hasHandlers']\nafter class:\n  EmitterMixin.mixInto(TheClass)\n*/\n\nimport { applyAll } from '../util/misc'\nimport Mixin from './Mixin'\n\nexport interface EmitterInterface {\n  on(types, handler)\n  one(types, handler)\n  off(types, handler)\n  trigger(type, ...args)\n  triggerWith(type, context, args)\n  hasHandlers(type)\n}\n\nexport default class EmitterMixin extends Mixin implements EmitterInterface {\n\n  _handlers: any\n  _oneHandlers: any\n\n  on(type, handler) {\n    addToHash(\n      this._handlers || (this._handlers = {}),\n      type,\n      handler\n    )\n    return this // for chaining\n  }\n\n  // todo: add comments\n  one(type, handler) {\n    addToHash(\n      this._oneHandlers || (this._oneHandlers = {}),\n      type,\n      handler\n    )\n    return this // for chaining\n  }\n\n  off(type, handler?) {\n    if (this._handlers) {\n      removeFromHash(this._handlers, type, handler)\n    }\n    if (this._oneHandlers) {\n      removeFromHash(this._oneHandlers, type, handler)\n    }\n    return this // for chaining\n  }\n\n  trigger(type, ...args) {\n    this.triggerWith(type, this, args)\n    return this // for chaining\n  }\n\n  triggerWith(type, context, args) {\n    if (this._handlers) {\n      applyAll(this._handlers[type], context, args)\n    }\n    if (this._oneHandlers) {\n      applyAll(this._oneHandlers[type], context, args)\n      delete this._oneHandlers[type] // will never fire again\n    }\n    return this // for chaining\n  }\n\n  hasHandlers(type) {\n    return (this._handlers && this._handlers[type] && this._handlers[type].length) ||\n      (this._oneHandlers && this._oneHandlers[type] && this._oneHandlers[type].length)\n  }\n\n}\n\nfunction addToHash(hash, type, handler) {\n  (hash[type] || (hash[type] = []))\n    .push(handler)\n}\n\nfunction removeFromHash(hash, type, handler?) {\n  if (handler) {\n    if (hash[type]) {\n      hash[type] = hash[type].filter(function(func) {\n        return func !== handler\n      })\n    }\n  } else {\n    delete hash[type] // remove all handler funcs for this type\n  }\n}\n","\n/*\nRecords offset information for a set of elements, relative to an origin element.\nCan record the left/right OR the top/bottom OR both.\nProvides methods for querying the cache by position.\n*/\nexport default class PositionCache {\n\n  originClientRect: ClientRect\n  els: HTMLElement[] // assumed to be siblings\n  originEl: HTMLElement // options can override the natural originEl\n  isHorizontal: boolean // whether to query for left/right/width\n  isVertical: boolean // whether to query for top/bottom/height\n\n  // arrays of coordinates (from topleft of originEl)\n  // caller can access these directly\n  lefts: any\n  rights: any\n  tops: any\n  bottoms: any\n\n\n  constructor(originEl: HTMLElement, els: HTMLElement[], isHorizontal: boolean, isVertical: boolean) {\n    this.originEl = originEl\n    this.els = els\n    this.isHorizontal = isHorizontal\n    this.isVertical = isVertical\n  }\n\n\n  // Queries the els for coordinates and stores them.\n  // Call this method before using and of the get* methods below.\n  build() {\n    let originEl = this.originEl\n    let originClientRect = this.originClientRect =\n      originEl.getBoundingClientRect() // relative to viewport top-left\n\n    if (this.isHorizontal) {\n      this.buildElHorizontals(originClientRect.left)\n    }\n\n    if (this.isVertical) {\n      this.buildElVerticals(originClientRect.top)\n    }\n  }\n\n\n  // Populates the left/right internal coordinate arrays\n  buildElHorizontals(originClientLeft: number) {\n    let lefts = []\n    let rights = []\n\n    for (let el of this.els) {\n      let rect = el.getBoundingClientRect()\n      lefts.push(rect.left - originClientLeft)\n      rights.push(rect.right - originClientLeft)\n    }\n\n    this.lefts = lefts\n    this.rights = rights\n  }\n\n\n  // Populates the top/bottom internal coordinate arrays\n  buildElVerticals(originClientTop: number) {\n    let tops = []\n    let bottoms = []\n\n    for (let el of this.els) {\n      let rect = el.getBoundingClientRect()\n      tops.push(rect.top - originClientTop)\n      bottoms.push(rect.bottom - originClientTop)\n    }\n\n    this.tops = tops\n    this.bottoms = bottoms\n  }\n\n\n  // Given a left offset (from document left), returns the index of the el that it horizontally intersects.\n  // If no intersection is made, returns undefined.\n  leftToIndex(leftPosition: number) {\n    let lefts = this.lefts\n    let rights = this.rights\n    let len = lefts.length\n    let i\n\n    for (i = 0; i < len; i++) {\n      if (leftPosition >= lefts[i] && leftPosition < rights[i]) {\n        return i\n      }\n    }\n  }\n\n\n  // Given a top offset (from document top), returns the index of the el that it vertically intersects.\n  // If no intersection is made, returns undefined.\n  topToIndex(topPosition: number) {\n    let tops = this.tops\n    let bottoms = this.bottoms\n    let len = tops.length\n    let i\n\n    for (i = 0; i < len; i++) {\n      if (topPosition >= tops[i] && topPosition < bottoms[i]) {\n        return i\n      }\n    }\n  }\n\n\n  // Gets the width of the element at the given index\n  getWidth(leftIndex: number) {\n    return this.rights[leftIndex] - this.lefts[leftIndex]\n  }\n\n\n  // Gets the height of the element at the given index\n  getHeight(topIndex: number) {\n    return this.bottoms[topIndex] - this.tops[topIndex]\n  }\n\n}\n","\n/*\nAn object for getting/setting scroll-related information for an element.\nInternally, this is done very differently for window versus DOM element,\nso this object serves as a common interface.\n*/\nexport abstract class ScrollController {\n\n  abstract getScrollTop(): number\n  abstract getScrollLeft(): number\n  abstract setScrollTop(top: number): void\n  abstract setScrollLeft(left: number): void\n  abstract getClientWidth(): number\n  abstract getClientHeight(): number\n  abstract getScrollWidth(): number\n  abstract getScrollHeight(): number\n\n  getMaxScrollTop() {\n    return this.getScrollHeight() - this.getClientHeight()\n  }\n\n  getMaxScrollLeft() {\n    return this.getScrollWidth() - this.getClientWidth()\n  }\n\n  canScrollVertically() {\n    return this.getMaxScrollTop() > 0\n  }\n\n  canScrollHorizontally() {\n    return this.getMaxScrollLeft() > 0\n  }\n\n  canScrollUp() {\n    return this.getScrollTop() > 0\n  }\n\n  canScrollDown() {\n    return this.getScrollTop() < this.getMaxScrollTop()\n  }\n\n  canScrollLeft() {\n    return this.getScrollLeft() > 0\n  }\n\n  canScrollRight() {\n    return this.getScrollLeft() < this.getMaxScrollLeft()\n  }\n\n}\n\nexport class ElementScrollController extends ScrollController {\n\n  el: HTMLElement\n\n  constructor(el: HTMLElement) {\n    super()\n    this.el = el\n  }\n\n  getScrollTop() {\n    return this.el.scrollTop\n  }\n\n  getScrollLeft() {\n    return this.el.scrollLeft\n  }\n\n  setScrollTop(top: number) {\n    this.el.scrollTop = top\n  }\n\n  setScrollLeft(left: number) {\n    this.el.scrollLeft = left\n  }\n\n  getScrollWidth() {\n    return this.el.scrollWidth\n  }\n\n  getScrollHeight() {\n    return this.el.scrollHeight\n  }\n\n  getClientHeight() {\n    return this.el.clientHeight\n  }\n\n  getClientWidth() {\n    return this.el.clientWidth\n  }\n\n}\n\nexport class WindowScrollController extends ScrollController {\n\n  getScrollTop() {\n    return window.pageYOffset\n  }\n\n  getScrollLeft() {\n    return window.pageXOffset\n  }\n\n  setScrollTop(n: number) {\n    window.scroll(window.pageXOffset, n)\n  }\n\n  setScrollLeft(n: number) {\n    window.scroll(n, window.pageYOffset)\n  }\n\n  getScrollWidth() {\n    return document.documentElement.scrollWidth\n  }\n\n  getScrollHeight() {\n    return document.documentElement.scrollHeight\n  }\n\n  getClientHeight() {\n    return document.documentElement.clientHeight\n  }\n\n  getClientWidth() {\n    return document.documentElement.clientWidth\n  }\n\n}\n","import { computeEdges } from '../util/dom-geom'\nimport { removeElement, createElement, applyStyle, applyStyleProp } from '../util/dom-manip'\nimport { ElementScrollController } from './scroll-controller'\n\nexport interface ScrollbarWidths {\n  left: number\n  right: number\n  bottom: number\n}\n\n/*\nEmbodies a div that has potential scrollbars\n*/\nexport default class ScrollComponent extends ElementScrollController {\n\n  overflowX: string\n  overflowY: string\n\n  constructor(overflowX: string, overflowY: string) {\n    super(\n      createElement('div', {\n        className: 'fc-scroller'\n      })\n    )\n    this.overflowX = overflowX\n    this.overflowY = overflowY\n    this.applyOverflow()\n  }\n\n\n  // sets to natural height, unlocks overflow\n  clear() {\n    this.setHeight('auto')\n    this.applyOverflow()\n  }\n\n\n  destroy() {\n    removeElement(this.el)\n  }\n\n\n  // Overflow\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  applyOverflow() {\n    applyStyle(this.el, {\n      overflowX: this.overflowX,\n      overflowY: this.overflowY\n    })\n  }\n\n\n  // Causes any 'auto' overflow values to resolves to 'scroll' or 'hidden'.\n  // Useful for preserving scrollbar widths regardless of future resizes.\n  // Can pass in scrollbarWidths for optimization.\n  lockOverflow(scrollbarWidths: ScrollbarWidths) {\n    let overflowX = this.overflowX\n    let overflowY = this.overflowY\n\n    scrollbarWidths = scrollbarWidths || this.getScrollbarWidths()\n\n    if (overflowX === 'auto') {\n      overflowX = (\n          scrollbarWidths.bottom || // horizontal scrollbars?\n          this.canScrollHorizontally() // OR scrolling pane with massless scrollbars?\n        ) ? 'scroll' : 'hidden'\n    }\n\n    if (overflowY === 'auto') {\n      overflowY = (\n          scrollbarWidths.left || scrollbarWidths.right || // horizontal scrollbars?\n          this.canScrollVertically() // OR scrolling pane with massless scrollbars?\n        ) ? 'scroll' : 'hidden'\n    }\n\n    applyStyle(this.el, { overflowX, overflowY })\n  }\n\n\n  setHeight(height: number | string) {\n    applyStyleProp(this.el, 'height', height)\n  }\n\n\n  getScrollbarWidths(): ScrollbarWidths {\n    let edges = computeEdges(this.el)\n    return {\n      left: edges.scrollbarLeft,\n      right: edges.scrollbarRight,\n      bottom: edges.scrollbarBottom\n    }\n  }\n\n}\n","\nexport default class Theme {\n\n  calendarOptions: any\n\n  // settings. default values are set after the class\n  classes: any\n  iconClasses: any\n  baseIconClass: string\n  iconOverrideOption: any\n  iconOverrideCustomButtonOption: any\n  iconOverridePrefix: string\n\n\n  constructor(calendarOptions) {\n    this.calendarOptions = calendarOptions\n    this.processIconOverride()\n  }\n\n\n  processIconOverride() {\n    if (this.iconOverrideOption) {\n      this.setIconOverride(\n        this.calendarOptions[this.iconOverrideOption]\n      )\n    }\n  }\n\n\n  setIconOverride(iconOverrideHash) {\n    let iconClassesCopy\n    let buttonName\n\n    if (typeof iconOverrideHash === 'object' && iconOverrideHash) { // non-null object\n      iconClassesCopy = { ...this.iconClasses }\n\n      for (buttonName in iconOverrideHash) {\n        iconClassesCopy[buttonName] = this.applyIconOverridePrefix(\n          iconOverrideHash[buttonName]\n        )\n      }\n\n      this.iconClasses = iconClassesCopy\n    } else if (iconOverrideHash === false) {\n      this.iconClasses = {}\n    }\n  }\n\n\n  applyIconOverridePrefix(className) {\n    let prefix = this.iconOverridePrefix\n\n    if (prefix && className.indexOf(prefix) !== 0) { // if not already present\n      className = prefix + className\n    }\n\n    return className\n  }\n\n\n  getClass(key) {\n    return this.classes[key] || ''\n  }\n\n\n  getIconClass(buttonName) {\n    let className = this.iconClasses[buttonName]\n\n    if (className) {\n      return this.baseIconClass + ' ' + className\n    }\n\n    return ''\n  }\n\n\n  getCustomButtonIconClass(customButtonProps) {\n    let className\n\n    if (this.iconOverrideCustomButtonOption) {\n      className = customButtonProps[this.iconOverrideCustomButtonOption]\n\n      if (className) {\n        return this.baseIconClass + ' ' + this.applyIconOverridePrefix(className)\n      }\n    }\n\n    return ''\n  }\n\n}\n\nTheme.prototype.classes = {}\nTheme.prototype.iconClasses = {}\nTheme.prototype.baseIconClass = ''\nTheme.prototype.iconOverridePrefix = ''\n\nexport type ThemeClass = { new(calendarOptions: any): Theme }\n","import Calendar from '../Calendar'\nimport View from '../View'\nimport Theme from '../theme/Theme'\nimport { DateEnv } from '../datelib/env'\n\nlet guid = 0\n\nexport interface ComponentContext {\n  options: any\n  dateEnv: DateEnv\n  theme: Theme\n  calendar: Calendar\n  view: View\n}\n\nexport type EqualityFuncHash = { [propName: string]: (obj0, obj1) => boolean }\n\nexport default class Component<PropsType> {\n\n  equalityFuncs: EqualityFuncHash // can't initialize here. done below...\n\n  uid: string\n  props: PropsType | null\n\n  // context vars\n  context: ComponentContext\n  dateEnv: DateEnv\n  theme: Theme\n  view: View\n  calendar: Calendar\n  isRtl: boolean\n\n  constructor(context: ComponentContext, isView?: boolean) {\n\n    // HACK to populate view at top of component instantiation call chain\n    if (isView) {\n      context.view = this as any\n    }\n\n    this.uid = String(guid++)\n    this.context = context\n    this.dateEnv = context.dateEnv\n    this.theme = context.theme\n    this.view = context.view\n    this.calendar = context.calendar\n    this.isRtl = this.opt('dir') === 'rtl'\n  }\n\n  static addEqualityFuncs(newFuncs: EqualityFuncHash) {\n    this.prototype.equalityFuncs = {\n      ...this.prototype.equalityFuncs,\n      ...newFuncs\n    }\n  }\n\n  opt(name) {\n    return this.context.options[name]\n  }\n\n  receiveProps(props: PropsType) {\n    let { anyChanges, comboProps } = recycleProps(this.props || {}, props, this.equalityFuncs)\n\n    this.props = comboProps\n\n    if (anyChanges) {\n      this.render(comboProps)\n    }\n  }\n\n  protected render(props: PropsType) {\n  }\n\n  // after destroy is called, this component won't ever be used again\n  destroy() {\n  }\n\n}\n\nComponent.prototype.equalityFuncs = {}\n\n\n/*\nReuses old values when equal. If anything is unequal, returns newProps as-is.\nGreat for PureComponent, but won't be feasible with React, so just eliminate and use React's DOM diffing.\n*/\nfunction recycleProps(oldProps, newProps, equalityFuncs: EqualityFuncHash) {\n  let comboProps = {} as any // some old, some new\n  let anyChanges = false\n\n  for (let key in newProps) {\n    if (\n      key in oldProps && (\n        oldProps[key] === newProps[key] ||\n        (equalityFuncs[key] && equalityFuncs[key](oldProps[key], newProps[key]))\n      )\n    ) {\n      // equal to old? use old prop\n      comboProps[key] = oldProps[key]\n    } else {\n      comboProps[key] = newProps[key]\n      anyChanges = true\n    }\n  }\n\n  for (let key in oldProps) {\n    if (!(key in newProps)) {\n      anyChanges = true\n      break\n    }\n  }\n\n  return { anyChanges, comboProps }\n}\n","import Component, { ComponentContext } from './Component'\nimport { EventRenderRange } from './event-rendering'\nimport { DateSpan } from '../structs/date-span'\nimport { EventInstanceHash } from '../structs/event'\nimport { rangeContainsRange } from '../datelib/date-range'\nimport { Hit } from '../interactions/hit'\nimport { elementClosest, removeElement } from '../util/dom-manip'\nimport { isDateSelectionValid, isInteractionValid } from '../validation'\nimport EventApi from '../api/EventApi'\nimport FgEventRenderer from './renderers/FgEventRenderer'\nimport FillRenderer from './renderers/FillRenderer'\nimport { EventInteractionState } from '../interactions/event-interaction-state'\nimport View from '../View'\nimport { EventHandlerName, EventHandlerArgs } from '../types/input-types'\n\nexport type DateComponentHash = { [uid: string]: DateComponent<any> }\n\n// NOTE: for fg-events, eventRange.range is NOT sliced,\n// thus, we need isStart/isEnd\nexport interface Seg {\n  component?: DateComponent<any>\n  isStart: boolean\n  isEnd: boolean\n  eventRange?: EventRenderRange\n  el?: HTMLElement\n  [otherProp: string]: any // TODO: remove this. extending Seg will handle this\n}\n\nexport interface EventSegUiInteractionState {\n  affectedInstances: EventInstanceHash\n  segs: Seg[]\n  isEvent: boolean\n  sourceSeg: any\n}\n\n/*\nPURPOSES:\n- hook up to fg, fill, and mirror renderers\n- interface for dragging and hits\n*/\nexport default class DateComponent<PropsType> extends Component<PropsType> {\n\n  // self-config, overridable by subclasses. must set on prototype\n  fgSegSelector: string // lets eventRender produce elements without fc-event class\n  bgSegSelector: string\n  // IN SCHEDULER: allowAcrossResources\n\n  // if defined, holds the unit identified (ex: \"year\" or \"month\") that determines the level of granularity\n  // of the date areas. if not defined, assumes to be day and time granularity.\n  // TODO: port isTimeScale into same system?\n  largeUnit: any\n\n  eventRenderer: FgEventRenderer\n  mirrorRenderer: FgEventRenderer\n  fillRenderer: FillRenderer\n\n  el: HTMLElement // passed in to constructor\n\n\n  constructor(context: ComponentContext, el: HTMLElement, isView?: boolean) {\n    super(context, isView)\n\n    this.el = el\n  }\n\n  destroy() {\n    super.destroy()\n\n    removeElement(this.el)\n  }\n\n\n  // TODO: WHAT ABOUT (sourceSeg && sourceSeg.component.doesDragMirror)\n  //\n  // Event Drag-n-Drop Rendering (for both events and external elements)\n  // ---------------------------------------------------------------------------------------------------------------\n  /*\n  renderEventDragSegs(state: EventSegUiInteractionState) {\n    if (state) {\n      let { isEvent, segs, sourceSeg } = state\n\n      if (this.eventRenderer) {\n        this.eventRenderer.hideByHash(state.affectedInstances)\n      }\n\n      // if the user is dragging something that is considered an event with real event data,\n      // and this component likes to do drag mirrors OR the component where the seg came from\n      // likes to do drag mirrors, then render a drag mirror.\n      if (isEvent && (this.doesDragMirror || sourceSeg && sourceSeg.component.doesDragMirror)) {\n        if (this.mirrorRenderer) {\n          this.mirrorRenderer.renderSegs(segs, { isDragging: true, sourceSeg })\n        }\n      }\n\n      // if it would be impossible to render a drag mirror OR this component likes to render\n      // highlights, then render a highlight.\n      if (!isEvent || this.doesDragHighlight) {\n        if (this.fillRenderer) {\n          this.fillRenderer.renderSegs('highlight', segs)\n        }\n      }\n    }\n  }\n  */\n\n\n  // Hit System\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  buildPositionCaches() {\n  }\n\n\n  queryHit(positionLeft: number, positionTop: number, elWidth: number, elHeight: number): Hit | null {\n    return null // this should be abstract\n  }\n\n\n  // Validation\n  // -----------------------------------------------------------------------------------------------------------------\n\n  isInteractionValid(interaction: EventInteractionState) {\n    let { calendar } = this\n    let dateProfile = (this.props as any).dateProfile // HACK\n    let instances = interaction.mutatedEvents.instances\n\n    if (dateProfile) { // HACK for DayTile\n      for (let instanceId in instances) {\n        if (!rangeContainsRange(dateProfile.validRange, instances[instanceId].range)) {\n          return false\n        }\n      }\n    }\n\n    return isInteractionValid(interaction, calendar)\n  }\n\n  isDateSelectionValid(selection: DateSpan): boolean {\n    let dateProfile = (this.props as any).dateProfile // HACK\n\n    if (\n      dateProfile && // HACK for DayTile\n      !rangeContainsRange(dateProfile.validRange, selection.range)\n    ) {\n      return false\n    }\n\n    return isDateSelectionValid(selection, this.calendar)\n  }\n\n\n  // Triggering\n  // -----------------------------------------------------------------------------------------------------------------\n  // TODO: move to Calendar\n\n\n  publiclyTrigger<T extends EventHandlerName>(name: T, args?: EventHandlerArgs<T>) {\n    let calendar = this.calendar\n\n    return calendar.publiclyTrigger(name, args)\n  }\n\n\n  publiclyTriggerAfterSizing<T extends EventHandlerName>(name: T, args: EventHandlerArgs<T>) {\n    let calendar = this.calendar\n\n    return calendar.publiclyTriggerAfterSizing(name, args)\n  }\n\n\n  hasPublicHandlers<T extends EventHandlerName>(name: T) {\n    let calendar = this.calendar\n\n    return calendar.hasPublicHandlers(name)\n  }\n\n\n  triggerRenderedSegs(segs: Seg[], isMirrors: boolean) {\n    let { calendar } = this\n\n    if (this.hasPublicHandlers('eventPositioned')) {\n\n      for (let seg of segs) {\n        this.publiclyTriggerAfterSizing('eventPositioned', [\n          {\n            event: new EventApi(\n              calendar,\n              seg.eventRange.def,\n              seg.eventRange.instance\n            ),\n            isMirror: isMirrors,\n            isStart: seg.isStart,\n            isEnd: seg.isEnd,\n            el: seg.el,\n            view: this as unknown as View // safe to cast because this method is only called on context.view\n          }\n        ])\n      }\n    }\n\n    if (!calendar.state.loadingLevel) { // avoid initial empty state while pending\n      calendar.afterSizingTriggers._eventsPositioned = [ null ] // fire once\n    }\n  }\n\n  triggerWillRemoveSegs(segs: Seg[], isMirrors: boolean) {\n    let { calendar } = this\n\n    for (let seg of segs) {\n      calendar.trigger('eventElRemove', seg.el)\n    }\n\n    if (this.hasPublicHandlers('eventDestroy')) {\n\n      for (let seg of segs) {\n        this.publiclyTrigger('eventDestroy', [\n          {\n            event: new EventApi(\n              calendar,\n              seg.eventRange.def,\n              seg.eventRange.instance\n            ),\n            isMirror: isMirrors,\n            el: seg.el,\n            view: this as unknown as View // safe to cast because this method is only called on context.view\n          }\n        ])\n      }\n    }\n  }\n\n\n  // Pointer Interaction Utils\n  // -----------------------------------------------------------------------------------------------------------------\n\n  isValidSegDownEl(el: HTMLElement) {\n    return !(this.props as any).eventDrag && // HACK\n      !(this.props as any).eventResize && // HACK\n      !elementClosest(el, '.fc-mirror') &&\n      (this.isPopover() || !this.isInPopover(el))\n      // ^above line ensures we don't detect a seg interaction within a nested component.\n      // it's a HACK because it only supports a popover as the nested component.\n  }\n\n\n  isValidDateDownEl(el: HTMLElement) {\n    let segEl = elementClosest(el, this.fgSegSelector)\n\n    return (!segEl || segEl.classList.contains('fc-mirror')) &&\n      !elementClosest(el, '.fc-more') && // a \"more..\" link\n      !elementClosest(el, 'a[data-goto]') && // a clickable nav link\n      !this.isInPopover(el)\n  }\n\n\n  isPopover() {\n    return this.el.classList.contains('fc-popover')\n  }\n\n\n  isInPopover(el: HTMLElement) {\n    return Boolean(elementClosest(el, '.fc-popover'))\n  }\n\n}\n\nDateComponent.prototype.fgSegSelector = '.fc-event-container > *'\nDateComponent.prototype.bgSegSelector = '.fc-bgevent:not(.fc-nonbusiness)'\n","import { reducerFunc } from './reducers/types'\nimport { eventDefParserFunc } from './structs/event'\nimport { eventDefMutationApplier } from './structs/event-mutation'\nimport Calendar, { DatePointTransform, DateSpanTransform, CalendarInteractionClass, OptionChangeHandlerMap } from './Calendar'\nimport { ViewConfigInputHash } from './structs/view-config'\nimport { ViewSpec } from './structs/view-spec'\nimport View, { ViewProps } from './View'\nimport { CalendarComponentProps } from './CalendarComponent'\nimport { isPropsValidTester } from './validation'\nimport { eventDragMutationMassager, eventIsDraggableTransformer, EventDropTransformers } from './interactions/event-dragging'\nimport { dateSelectionJoinTransformer } from './interactions/date-selecting'\nimport { EventResizeJoinTransforms } from './interactions/event-resizing'\nimport { ExternalDefTransform } from './interactions/external-element-dragging'\nimport { InteractionClass } from './interactions/interaction'\nimport { ThemeClass } from './theme/Theme'\nimport { EventSourceDef } from './structs/event-source'\nimport { CmdFormatterFunc } from './datelib/formatting-cmd'\nimport { RecurringType } from './structs/recurring-event'\nimport { NamedTimeZoneImplClass } from './datelib/timezone'\nimport { ElementDraggingClass } from './interactions/ElementDragging'\n\n// TODO: easier way to add new hooks? need to update a million things\n\nexport interface PluginDefInput {\n  deps?: PluginDef[]\n  reducers?: reducerFunc[]\n  eventDefParsers?: eventDefParserFunc[]\n  isDraggableTransformers?: eventIsDraggableTransformer[]\n  eventDragMutationMassagers?: eventDragMutationMassager[]\n  eventDefMutationAppliers?: eventDefMutationApplier[]\n  dateSelectionTransformers?: dateSelectionJoinTransformer[]\n  datePointTransforms?: DatePointTransform[]\n  dateSpanTransforms?: DateSpanTransform[]\n  views?: ViewConfigInputHash\n  viewPropsTransformers?: ViewPropsTransformerClass[]\n  isPropsValid?: isPropsValidTester\n  externalDefTransforms?: ExternalDefTransform[]\n  eventResizeJoinTransforms?: EventResizeJoinTransforms[]\n  viewContainerModifiers?: ViewContainerModifier[]\n  eventDropTransformers?: EventDropTransformers[]\n  componentInteractions?: InteractionClass[]\n  calendarInteractions?: CalendarInteractionClass[]\n  themeClasses?: { [themeSystemName: string]: ThemeClass }\n  eventSourceDefs?: EventSourceDef[]\n  cmdFormatter?: CmdFormatterFunc\n  recurringTypes?: RecurringType[]\n  namedTimeZonedImpl?: NamedTimeZoneImplClass\n  defaultView?: string\n  elementDraggingImpl?: ElementDraggingClass\n  optionChangeHandlers?: OptionChangeHandlerMap\n}\n\nexport interface PluginHooks {\n  reducers: reducerFunc[]\n  eventDefParsers: eventDefParserFunc[]\n  isDraggableTransformers: eventIsDraggableTransformer[]\n  eventDragMutationMassagers: eventDragMutationMassager[]\n  eventDefMutationAppliers: eventDefMutationApplier[]\n  dateSelectionTransformers: dateSelectionJoinTransformer[]\n  datePointTransforms: DatePointTransform[]\n  dateSpanTransforms: DateSpanTransform[]\n  views: ViewConfigInputHash // TODO: parse before gets to this step?\n  viewPropsTransformers: ViewPropsTransformerClass[]\n  isPropsValid: isPropsValidTester | null\n  externalDefTransforms: ExternalDefTransform[]\n  eventResizeJoinTransforms: EventResizeJoinTransforms[]\n  viewContainerModifiers: ViewContainerModifier[]\n  eventDropTransformers: EventDropTransformers[]\n  componentInteractions: InteractionClass[]\n  calendarInteractions: CalendarInteractionClass[]\n  themeClasses: { [themeSystemName: string]: ThemeClass }\n  eventSourceDefs: EventSourceDef[]\n  cmdFormatter?: CmdFormatterFunc\n  recurringTypes: RecurringType[]\n  namedTimeZonedImpl?: NamedTimeZoneImplClass\n  defaultView: string\n  elementDraggingImpl?: ElementDraggingClass\n  optionChangeHandlers: OptionChangeHandlerMap\n}\n\nexport interface PluginDef extends PluginHooks {\n  id: string\n  deps: PluginDef[]\n}\n\nexport type ViewPropsTransformerClass = new() => ViewPropsTransformer\n\nexport interface ViewPropsTransformer {\n  transform(viewProps: ViewProps, viewSpec: ViewSpec, calendarProps: CalendarComponentProps, view: View): any\n}\n\nexport type ViewContainerModifier = (contentEl: HTMLElement, calendar: Calendar) => void\n\n\nlet uid = 0\n\nexport function createPlugin(input: PluginDefInput): PluginDef {\n  return {\n    id: String(uid++),\n    deps: input.deps || [],\n    reducers: input.reducers || [],\n    eventDefParsers: input.eventDefParsers || [],\n    isDraggableTransformers: input.isDraggableTransformers || [],\n    eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n    eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n    dateSelectionTransformers: input.dateSelectionTransformers || [],\n    datePointTransforms: input.datePointTransforms || [],\n    dateSpanTransforms: input.dateSpanTransforms || [],\n    views: input.views || {},\n    viewPropsTransformers: input.viewPropsTransformers || [],\n    isPropsValid: input.isPropsValid || null,\n    externalDefTransforms: input.externalDefTransforms || [],\n    eventResizeJoinTransforms: input.eventResizeJoinTransforms || [],\n    viewContainerModifiers: input.viewContainerModifiers || [],\n    eventDropTransformers: input.eventDropTransformers || [],\n    componentInteractions: input.componentInteractions || [],\n    calendarInteractions: input.calendarInteractions || [],\n    themeClasses: input.themeClasses || {},\n    eventSourceDefs: input.eventSourceDefs || [],\n    cmdFormatter: input.cmdFormatter,\n    recurringTypes: input.recurringTypes || [],\n    namedTimeZonedImpl: input.namedTimeZonedImpl,\n    defaultView: input.defaultView || '',\n    elementDraggingImpl: input.elementDraggingImpl,\n    optionChangeHandlers: input.optionChangeHandlers || {}\n  }\n}\n\nexport class PluginSystem {\n\n  hooks: PluginHooks\n  addedHash: { [pluginId: string]: true }\n\n  constructor() {\n    this.hooks = {\n      reducers: [],\n      eventDefParsers: [],\n      isDraggableTransformers: [],\n      eventDragMutationMassagers: [],\n      eventDefMutationAppliers: [],\n      dateSelectionTransformers: [],\n      datePointTransforms: [],\n      dateSpanTransforms: [],\n      views: {},\n      viewPropsTransformers: [],\n      isPropsValid: null,\n      externalDefTransforms: [],\n      eventResizeJoinTransforms: [],\n      viewContainerModifiers: [],\n      eventDropTransformers: [],\n      componentInteractions: [],\n      calendarInteractions: [],\n      themeClasses: {},\n      eventSourceDefs: [],\n      cmdFormatter: null,\n      recurringTypes: [],\n      namedTimeZonedImpl: null,\n      defaultView: '',\n      elementDraggingImpl: null,\n      optionChangeHandlers: {}\n    }\n    this.addedHash = {}\n  }\n\n  add(plugin: PluginDef) {\n    if (!this.addedHash[plugin.id]) {\n      this.addedHash[plugin.id] = true\n\n      for (let dep of plugin.deps) {\n        this.add(dep)\n      }\n\n      this.hooks = combineHooks(this.hooks, plugin)\n    }\n  }\n\n}\n\nfunction combineHooks(hooks0: PluginHooks, hooks1: PluginHooks): PluginHooks {\n  return {\n    reducers: hooks0.reducers.concat(hooks1.reducers),\n    eventDefParsers: hooks0.eventDefParsers.concat(hooks1.eventDefParsers),\n    isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n    eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n    eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n    dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n    datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n    dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n    views: { ...hooks0.views, ...hooks1.views },\n    viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n    isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n    externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n    eventResizeJoinTransforms: hooks0.eventResizeJoinTransforms.concat(hooks1.eventResizeJoinTransforms),\n    viewContainerModifiers: hooks0.viewContainerModifiers.concat(hooks1.viewContainerModifiers),\n    eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n    calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n    componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n    themeClasses: { ...hooks0.themeClasses, ...hooks1.themeClasses },\n    eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n    cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n    recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n    namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n    defaultView: hooks0.defaultView || hooks1.defaultView, // put earlier plugins FIRST\n    elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl, // \"\n    optionChangeHandlers: { ...hooks0.optionChangeHandlers, ...hooks1.optionChangeHandlers }\n  }\n}\n","import { createPlugin } from '../plugin-system'\nimport { EventSourceDef } from '../structs/event-source'\nimport { EventInput } from '../structs/event'\n\nlet eventSourceDef: EventSourceDef = {\n  ignoreRange: true,\n\n  parseMeta(raw: any): EventInput[] | null {\n    if (Array.isArray(raw)) { // short form\n      return raw\n    } else if (Array.isArray(raw.events)) {\n      return raw.events\n    }\n    return null\n  },\n\n  fetch(arg, success) {\n    success({\n      rawEvents: arg.eventSource.meta as EventInput[]\n    })\n  }\n}\n\nexport default createPlugin({\n  eventSourceDefs: [ eventSourceDef ]\n})\n","import { unpromisify } from '../util/promise'\nimport { EventSourceError, EventSourceDef } from '../structs/event-source'\nimport { EventInput } from '../structs/event'\nimport { createPlugin } from '../plugin-system'\n\nexport type EventSourceFunc = (\n  arg: {\n    start: Date\n    end: Date\n    timeZone: string\n  },\n  successCallback: (events: EventInput[]) => void,\n  failureCallback: (error: EventSourceError) => void\n) => (void | PromiseLike<EventInput[]>)\n\n\nlet eventSourceDef: EventSourceDef = {\n\n  parseMeta(raw: any): EventSourceFunc {\n    if (typeof raw === 'function') { // short form\n      return raw\n    } else if (typeof raw.events === 'function') {\n      return raw.events\n    }\n    return null\n  },\n\n  fetch(arg, success, failure) {\n    let dateEnv = arg.calendar.dateEnv\n    let func = arg.eventSource.meta as EventSourceFunc\n\n    unpromisify(\n      func.bind(null, { // the function returned from parseMeta\n        start: dateEnv.toDate(arg.range.start),\n        end: dateEnv.toDate(arg.range.end),\n        startStr: dateEnv.formatIso(arg.range.start),\n        endStr: dateEnv.formatIso(arg.range.end),\n        timeZone: dateEnv.timeZone\n      }),\n      function(rawEvents) { // success\n        success({ rawEvents }) // needs an object response\n      },\n      failure // send errorObj directly to failure callback\n    )\n  }\n\n}\n\nexport default createPlugin({\n  eventSourceDefs: [ eventSourceDef ]\n})\n","\nexport default function requestJson(method: string, url: string, params: object, successCallback, failureCallback) {\n  method = method.toUpperCase()\n\n  let body = null\n\n  if (method === 'GET') {\n    url = injectQueryStringParams(url, params)\n  } else {\n    body = encodeParams(params)\n  }\n\n  let xhr = new XMLHttpRequest()\n  xhr.open(method, url, true)\n\n  if (method !== 'GET') {\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n  }\n\n  xhr.onload = function() {\n    if (xhr.status >= 200 && xhr.status < 400) {\n      try {\n        let res = JSON.parse(xhr.responseText)\n        successCallback(res, xhr)\n      } catch (err) {\n        failureCallback('Failure parsing JSON', xhr)\n      }\n    } else {\n      failureCallback('Request failed', xhr)\n    }\n  }\n\n  xhr.onerror = function() {\n    failureCallback('Request failed', xhr)\n  }\n\n  xhr.send(body)\n}\n\nfunction injectQueryStringParams(url: string, params) {\n  return url +\n    (url.indexOf('?') === -1 ? '?' : '&') +\n    encodeParams(params)\n}\n\nfunction encodeParams(params) {\n  let parts = []\n\n  for (let key in params) {\n    parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]))\n  }\n\n  return parts.join('&')\n}\n","import requestJson from '../util/requestJson'\nimport Calendar from '../Calendar'\nimport { EventSourceDef } from '../structs/event-source'\nimport { DateRange } from '../datelib/date-range'\nimport { __assign } from 'tslib'\nimport { createPlugin } from '../plugin-system'\n\ninterface JsonFeedMeta {\n  url: string\n  method: string\n  extraParams?: any\n  startParam?: string\n  endParam?: string\n  timeZoneParam?: string\n}\n\nlet eventSourceDef: EventSourceDef = {\n\n  parseMeta(raw: any): JsonFeedMeta | null {\n    if (typeof raw === 'string') { // short form\n      raw = { url: raw }\n    } else if (!raw || typeof raw !== 'object' || !raw.url) {\n      return null\n    }\n\n    return {\n      url: raw.url,\n      method: (raw.method || 'GET').toUpperCase(),\n      extraParams: raw.extraParams,\n      startParam: raw.startParam,\n      endParam: raw.endParam,\n      timeZoneParam: raw.timeZoneParam\n    }\n  },\n\n  fetch(arg, success, failure) {\n    let meta: JsonFeedMeta = arg.eventSource.meta\n    let requestParams = buildRequestParams(meta, arg.range, arg.calendar)\n\n    requestJson(\n      meta.method, meta.url, requestParams,\n      function(rawEvents, xhr) {\n        success({ rawEvents, xhr })\n      },\n      function(errorMessage, xhr) {\n        failure({ message: errorMessage, xhr })\n      }\n    )\n  }\n\n}\n\nexport default createPlugin({\n  eventSourceDefs: [ eventSourceDef ]\n})\n\nfunction buildRequestParams(meta: JsonFeedMeta, range: DateRange, calendar: Calendar) {\n  const dateEnv = calendar.dateEnv\n  let startParam\n  let endParam\n  let timeZoneParam\n  let customRequestParams\n  let params = {}\n\n  startParam = meta.startParam\n  if (startParam == null) {\n    startParam = calendar.opt('startParam')\n  }\n\n  endParam = meta.endParam\n  if (endParam == null) {\n    endParam = calendar.opt('endParam')\n  }\n\n  timeZoneParam = meta.timeZoneParam\n  if (timeZoneParam == null) {\n    timeZoneParam = calendar.opt('timeZoneParam')\n  }\n\n  // retrieve any outbound GET/POST data from the options\n  if (typeof meta.extraParams === 'function') {\n    // supplied as a function that returns a key/value object\n    customRequestParams = meta.extraParams()\n  } else {\n    // probably supplied as a straight key/value object\n    customRequestParams = meta.extraParams || {}\n  }\n\n  __assign(params, customRequestParams)\n\n  params[startParam] = dateEnv.formatIso(range.start)\n  params[endParam] = dateEnv.formatIso(range.end)\n\n  if (dateEnv.timeZone !== 'local') {\n    params[timeZoneParam] = dateEnv.timeZone\n  }\n\n  return params\n}\n","import { startOfDay, addDays, DateMarker } from '../datelib/marker'\nimport { Duration, createDuration, subtractDurations } from '../datelib/duration'\nimport { arrayToHash } from '../util/object'\nimport { refineProps } from '../util/misc'\nimport { RecurringType, ParsedRecurring } from './recurring-event'\nimport { EventInput } from './event'\nimport { DateRange, intersectRanges } from '../datelib/date-range'\nimport { DateEnv } from '../datelib/env'\nimport { createPlugin } from '../plugin-system'\n\n/*\nAn implementation of recurring events that only supports every-day or weekly recurrences.\n*/\n\ninterface SimpleRecurringData {\n  daysOfWeek: number[] | null\n  startTime: Duration | null\n  endTime: Duration | null\n  startRecur: DateMarker | null\n  endRecur: DateMarker | null\n}\n\ninterface SimpleParsedRecurring extends ParsedRecurring {\n  typeData: SimpleRecurringData // the whole point is to make this more specific\n}\n\nlet recurring: RecurringType = {\n\n  parse(rawEvent: EventInput, leftoverProps: any, dateEnv: DateEnv): SimpleParsedRecurring | null {\n    let createMarker = dateEnv.createMarker.bind(dateEnv)\n    let processors = {\n      daysOfWeek: null,\n      startTime: createDuration,\n      endTime: createDuration,\n      startRecur: createMarker,\n      endRecur: createMarker\n    }\n\n    let props = refineProps(rawEvent, processors, {}, leftoverProps) as SimpleRecurringData\n    let anyValid = false\n\n    for (let propName in props) {\n      if (props[propName] != null) {\n        anyValid = true\n        break\n      }\n    }\n\n    if (anyValid) {\n      let duration: Duration = null\n\n      if ('duration' in leftoverProps) {\n        duration = createDuration(leftoverProps.duration)\n        delete leftoverProps.duration\n      }\n      if (!duration && props.startTime && props.endTime) {\n        duration = subtractDurations(props.endTime, props.startTime)\n      }\n\n      return {\n        allDayGuess: Boolean(!props.startTime && !props.endTime),\n        duration,\n        typeData: props // doesn't need endTime anymore but oh well\n      }\n    }\n\n    return null\n  },\n\n  expand(typeData: SimpleRecurringData, framingRange: DateRange, dateEnv: DateEnv): DateMarker[] {\n    let clippedFramingRange = intersectRanges(\n      framingRange,\n      { start: typeData.startRecur, end: typeData.endRecur }\n    )\n\n    if (clippedFramingRange) {\n      return expandRanges(\n        typeData.daysOfWeek,\n        typeData.startTime,\n        clippedFramingRange,\n        dateEnv\n      )\n    } else {\n      return []\n    }\n  }\n\n}\n\nexport default createPlugin({\n  recurringTypes: [ recurring ]\n})\n\nfunction expandRanges(\n  daysOfWeek: number[] | null,\n  startTime: Duration | null,\n  framingRange: DateRange,\n  dateEnv: DateEnv\n): DateMarker[] {\n  let dowHash: { [num: string]: true } | null = daysOfWeek ? arrayToHash(daysOfWeek) : null\n  let dayMarker = startOfDay(framingRange.start)\n  let endMarker = framingRange.end\n  let instanceStarts: DateMarker[] = []\n\n  while (dayMarker < endMarker) {\n    let instanceStart\n\n    // if everyday, or this particular day-of-week\n    if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n\n      if (startTime) {\n        instanceStart = dateEnv.add(dayMarker, startTime)\n      } else {\n        instanceStart = dayMarker\n      }\n\n      instanceStarts.push(instanceStart)\n    }\n\n    dayMarker = addDays(dayMarker, 1)\n  }\n\n  return instanceStarts\n}\n","import { createPlugin } from './plugin-system'\nimport { Calendar } from './main'\nimport { hashValuesToArray } from './util/object'\nimport { EventSource } from './structs/event-source'\n\nexport default createPlugin({\n  optionChangeHandlers: {\n    events(events, calendar, deepEqual) {\n      handleEventSources([ events ], calendar, deepEqual)\n    },\n    eventSources: handleEventSources,\n    plugins: handlePlugins\n  }\n})\n\nfunction handleEventSources(inputs, calendar: Calendar, deepEqual) {\n  let unfoundSources: EventSource[] = hashValuesToArray(calendar.state.eventSources)\n  let newInputs = []\n\n  for (let input of inputs) {\n    let inputFound = false\n\n    for (let i = 0; i < unfoundSources.length; i++) {\n      if (deepEqual(unfoundSources[i]._raw, input)) {\n        unfoundSources.splice(i, 1) // delete\n        inputFound = true\n        break\n      }\n    }\n\n    if (!inputFound) {\n      newInputs.push(input)\n    }\n  }\n\n  for (let unfoundSource of unfoundSources) {\n    calendar.dispatch({\n      type: 'REMOVE_EVENT_SOURCE',\n      sourceId: unfoundSource.sourceId\n    })\n  }\n\n  for (let newInput of newInputs) {\n    calendar.addEventSource(newInput)\n  }\n}\n\n// shortcoming: won't remove plugins\nfunction handlePlugins(inputs, calendar: Calendar) {\n  calendar.addPluginInputs(inputs) // will gracefully handle duplicates\n}\n","import { mergeProps } from './util/object'\nimport { PluginDef } from './plugin-system'\nimport ArrayEventSourcePlugin from './event-sources/array-event-source'\nimport FuncEventSourcePlugin from './event-sources/func-event-source'\nimport JsonFeedEventSourcePlugin from './event-sources/json-feed-event-source'\nimport SimpleRecurrencePlugin from './structs/recurring-event-simple'\nimport { capitaliseFirstLetter } from './util/misc'\nimport DefaultOptionChangeHandlers from './option-change-handlers'\n\nexport const config = {} as any // TODO: make these options\n\nexport const globalDefaults = {\n\n  defaultRangeSeparator: ' - ',\n  titleRangeSeparator: ' \\u2013 ', // en dash\n\n  defaultTimedEventDuration: '01:00:00',\n  defaultAllDayEventDuration: { day: 1 },\n  forceEventDuration: false,\n  nextDayThreshold: '00:00:00',\n\n  // display\n  columnHeader: true,\n  defaultView: '',\n  aspectRatio: 1.35,\n  header: {\n    left: 'title',\n    center: '',\n    right: 'today prev,next'\n  },\n  weekends: true,\n  weekNumbers: false,\n  weekNumberCalculation: 'local',\n\n  editable: false,\n\n  // nowIndicator: false,\n\n  scrollTime: '06:00:00',\n  minTime: '00:00:00',\n  maxTime: '24:00:00',\n  showNonCurrentDates: true,\n\n  // event ajax\n  lazyFetching: true,\n  startParam: 'start',\n  endParam: 'end',\n  timeZoneParam: 'timeZone',\n\n  timeZone: 'local', // TODO: throw error if given falsy value?\n\n  // allDayDefault: undefined,\n\n  // locale\n  locales: [],\n  locale: '', // blank values means it will compute based off locales[]\n  // dir: will get this from the default locale\n  // buttonIcons: null,\n\n  // allows setting a min-height to the event segment to prevent short events overlapping each other\n  timeGridEventMinHeight: 0,\n\n  themeSystem: 'standard',\n\n  // eventResizableFromStart: false,\n  dragRevertDuration: 500,\n  dragScroll: true,\n\n  allDayMaintainDuration: false,\n\n  // selectable: false,\n  unselectAuto: true,\n  // selectMinDistance: 0,\n\n  dropAccept: '*',\n\n  eventOrder: 'start,-duration,allDay,title',\n  // ^ if start tie, longer events go before shorter. final tie-breaker is title text\n\n  // rerenderDelay: null,\n\n  eventLimit: false,\n  eventLimitClick: 'popover',\n  dayPopoverFormat: { month: 'long', day: 'numeric', year: 'numeric' },\n\n  handleWindowResize: true,\n  windowResizeDelay: 100, // milliseconds before an updateSize happens\n\n  longPressDelay: 1000,\n  eventDragMinDistance: 5 // only applies to mouse\n\n}\n\n\nexport const rtlDefaults = { // right-to-left defaults\n  header: { // TODO: smarter solution (first/center/last ?)\n    left: 'next,prev today',\n    center: '',\n    right: 'title'\n  },\n  buttonIcons: {\n    // TODO: make RTL support the responibility of the theme\n    prev: 'fc-icon-chevron-right',\n    next: 'fc-icon-chevron-left',\n    prevYear: 'fc-icon-chevrons-right',\n    nextYear: 'fc-icon-chevrons-left'\n  }\n}\n\n\nlet complexOptions = [ // names of options that are objects whose properties should be combined\n  'header',\n  'footer',\n  'buttonText',\n  'buttonIcons'\n]\n\n\n// Merges an array of option objects into a single object\nexport function mergeOptions(optionObjs) {\n  return mergeProps(optionObjs, complexOptions)\n}\n\n\n\n// TODO: move this stuff to a \"plugin\"-related file...\n\nconst INTERNAL_PLUGINS: PluginDef[] = [\n  ArrayEventSourcePlugin,\n  FuncEventSourcePlugin,\n  JsonFeedEventSourcePlugin,\n  SimpleRecurrencePlugin,\n  DefaultOptionChangeHandlers\n]\n\nexport function refinePluginDefs(pluginInputs: any[]): PluginDef[] {\n  let plugins = []\n\n  for (let pluginInput of pluginInputs) {\n\n    if (typeof pluginInput === 'string') {\n      let globalName = 'FullCalendar' + capitaliseFirstLetter(pluginInput)\n\n      if (!window[globalName]) {\n        console.warn('Plugin file not loaded for ' + pluginInput)\n      } else {\n        plugins.push(window[globalName].default) // is an ES6 module\n      }\n\n    } else {\n      plugins.push(pluginInput)\n    }\n  }\n\n  return INTERNAL_PLUGINS.concat(plugins)\n}\n","import { mergeProps, hashValuesToArray } from '../util/object'\nimport { __assign } from 'tslib'\n\nexport type LocaleCodeArg = string | string[]\nexport type LocaleSingularArg = LocaleCodeArg | RawLocale\n\nexport interface Locale {\n  codeArg: LocaleCodeArg\n  codes: string[]\n  week: { dow: number, doy: number }\n  simpleNumberFormat: Intl.NumberFormat\n  options: any\n}\n\nexport interface RawLocale {\n  code: string\n  [otherProp: string]: any\n}\n\nexport type RawLocaleMap = { [code: string]: RawLocale }\n\nexport interface RawLocaleInfo {\n  map: RawLocaleMap\n  defaultCode: string\n}\n\nconst RAW_EN_LOCALE = {\n  code: 'en',\n  week: {\n    dow: 0, // Sunday is the first day of the week\n    doy: 4 // 4 days need to be within the year to be considered the first week\n  },\n  dir: 'ltr',\n  buttonText: {\n    prev: 'prev',\n    next: 'next',\n    prevYear: 'prev year',\n    nextYear: 'next year',\n    year: 'year',\n    today: 'today',\n    month: 'month',\n    week: 'week',\n    day: 'day',\n    list: 'list'\n  },\n  weekLabel: 'W',\n  allDayText: 'all-day',\n  eventLimitText: 'more',\n  noEventsMessage: 'No events to display'\n}\n\nexport function parseRawLocales(explicitRawLocales: RawLocale[]): RawLocaleInfo {\n  let defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en'\n  let globalArray = window['FullCalendarLocalesAll'] || [] // from locales-all.js\n  let globalObject = window['FullCalendarLocales'] || {} // from locales/*.js. keys are meaningless\n  let allRawLocales = globalArray.concat( // globalArray is low prio\n    hashValuesToArray(globalObject), // medium prio\n    explicitRawLocales // highest prio\n  )\n  let rawLocaleMap = {\n    en: RAW_EN_LOCALE // necessary?\n  }\n\n  for (let rawLocale of allRawLocales) {\n    rawLocaleMap[rawLocale.code] = rawLocale\n  }\n\n  return {\n    map: rawLocaleMap,\n    defaultCode\n  }\n}\n\nexport function buildLocale(inputSingular: LocaleSingularArg, available: RawLocaleMap) {\n  if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n    return parseLocale(\n      inputSingular.code,\n      [ inputSingular.code ],\n      inputSingular\n    )\n  } else {\n    return queryLocale(inputSingular, available)\n  }\n}\n\nfunction queryLocale(codeArg: LocaleCodeArg, available: RawLocaleMap): Locale {\n  let codes = [].concat(codeArg || []) // will convert to array\n  let raw = queryRawLocale(codes, available) || RAW_EN_LOCALE\n\n  return parseLocale(codeArg, codes, raw)\n}\n\nfunction queryRawLocale(codes: string[], available: RawLocaleMap): RawLocale {\n  for (let i = 0; i < codes.length; i++) {\n    let parts = codes[i].toLocaleLowerCase().split('-')\n\n    for (let j = parts.length; j > 0; j--) {\n      let simpleId = parts.slice(0, j).join('-')\n\n      if (available[simpleId]) {\n        return available[simpleId]\n      }\n    }\n  }\n  return null\n}\n\nfunction parseLocale(codeArg: LocaleCodeArg, codes: string[], raw: RawLocale): Locale {\n  let merged = mergeProps([ RAW_EN_LOCALE, raw ], [ 'buttonText' ])\n\n  delete merged.code // don't want this part of the options\n\n  let week = merged.week\n  delete merged.week\n\n  return {\n    codeArg,\n    codes,\n    week,\n    simpleNumberFormat: new Intl.NumberFormat(codeArg),\n    options: merged\n  }\n}\n","import { firstDefined } from './util/misc'\nimport { globalDefaults, rtlDefaults, mergeOptions } from './options'\nimport { parseRawLocales, buildLocale } from './datelib/locale'\nimport { __assign } from 'tslib'\n\n\nexport default class OptionsManager {\n\n  dirDefaults: any // option defaults related to LTR or RTL\n  localeDefaults: any // option defaults related to current locale\n  overrides: any // option overrides given to the fullCalendar constructor\n  dynamicOverrides: any // options set with dynamic setter method. higher precedence than view overrides.\n  computed: any\n\n\n  constructor(overrides) {\n    this.overrides = { ...overrides } // make a copy\n    this.dynamicOverrides = {}\n    this.compute()\n  }\n\n\n  mutate(updates, removals: string[], isDynamic?: boolean) {\n    let overrideHash = isDynamic ? this.dynamicOverrides : this.overrides\n\n    __assign(overrideHash, updates)\n\n    for (let propName of removals) {\n      delete overrideHash[propName]\n    }\n\n    this.compute()\n  }\n\n\n  // Computes the flattened options hash for the calendar and assigns to `this.options`.\n  // Assumes this.overrides and this.dynamicOverrides have already been initialized.\n  compute() {\n\n    // TODO: not a very efficient system\n    let locales = firstDefined( // explicit locale option given?\n      this.dynamicOverrides.locales,\n      this.overrides.locales,\n      globalDefaults.locales\n    )\n    let locale = firstDefined( // explicit locales option given?\n      this.dynamicOverrides.locale,\n      this.overrides.locale,\n      globalDefaults.locale\n    )\n    let available = parseRawLocales(locales)\n    let localeDefaults = buildLocale(locale || available.defaultCode, available.map).options\n\n    let dir = firstDefined( // based on options computed so far, is direction RTL?\n      this.dynamicOverrides.dir,\n      this.overrides.dir,\n      localeDefaults.dir\n    )\n\n    let dirDefaults = dir === 'rtl' ? rtlDefaults : {}\n\n    this.dirDefaults = dirDefaults\n    this.localeDefaults = localeDefaults\n\n    this.computed = mergeOptions([ // merge defaults and overrides. lowest to highest precedence\n      globalDefaults, // global defaults\n      dirDefaults,\n      localeDefaults,\n      this.overrides,\n      this.dynamicOverrides\n    ])\n  }\n\n}\n","import { DateMarker, arrayToUtcDate, dateToUtcArray } from './marker'\n\nexport interface CalendarSystem {\n  getMarkerYear(d: DateMarker): number\n  getMarkerMonth(d: DateMarker): number\n  getMarkerDay(d: DateMarker): number\n  arrayToMarker(arr: number[]): DateMarker\n  markerToArray(d: DateMarker): number[]\n}\n\n\nlet calendarSystemClassMap = {}\n\nexport function registerCalendarSystem(name, theClass) {\n  calendarSystemClassMap[name] = theClass\n}\n\nexport function createCalendarSystem(name) {\n  return new calendarSystemClassMap[name]()\n}\n\n\nclass GregorianCalendarSystem implements CalendarSystem {\n\n  getMarkerYear(d: DateMarker) {\n    return d.getUTCFullYear()\n  }\n\n  getMarkerMonth(d: DateMarker) {\n    return d.getUTCMonth()\n  }\n\n  getMarkerDay(d: DateMarker) {\n    return d.getUTCDate()\n  }\n\n  arrayToMarker(arr) {\n    return arrayToUtcDate(arr)\n  }\n\n  markerToArray(marker) {\n    return dateToUtcArray(marker)\n  }\n\n}\n\nregisterCalendarSystem('gregory', GregorianCalendarSystem)\n","import { isValidDate } from './marker'\n\n\nconst ISO_RE = /^\\s*(\\d{4})(-(\\d{2})(-(\\d{2})([T ](\\d{2}):(\\d{2})(:(\\d{2})(\\.(\\d+))?)?(Z|(([-+])(\\d{2})(:?(\\d{2}))?))?)?)?)?$/\n\nexport function parse(str) {\n  let m = ISO_RE.exec(str)\n\n  if (m) {\n    let marker = new Date(Date.UTC(\n      Number(m[1]),\n      m[3] ? Number(m[3]) - 1 : 0,\n      Number(m[5] || 1),\n      Number(m[7] || 0),\n      Number(m[8] || 0),\n      Number(m[10] || 0),\n      m[12] ? Number('0.' + m[12]) * 1000 : 0\n    ))\n\n    if (isValidDate(marker)) {\n      let timeZoneOffset = null\n\n      if (m[13]) {\n        timeZoneOffset = (m[15] === '-' ? -1 : 1) * (\n          Number(m[16] || 0) * 60 +\n          Number(m[18] || 0)\n        )\n      }\n\n      return {\n        marker,\n        isTimeUnspecified: !m[6],\n        timeZoneOffset\n      }\n    }\n  }\n\n  return null\n}\n","import {\n  DateMarker, addMs,\n  diffHours, diffMinutes, diffSeconds, diffWholeWeeks, diffWholeDays,\n  startOfDay, startOfHour, startOfMinute, startOfSecond,\n  weekOfYear, arrayToUtcDate, dateToUtcArray, dateToLocalArray, arrayToLocalDate, timeAsMs, isValidDate\n} from './marker'\nimport { CalendarSystem, createCalendarSystem } from './calendar-system'\nimport { Locale } from './locale'\nimport { NamedTimeZoneImpl, NamedTimeZoneImplClass } from './timezone'\nimport { Duration, asRoughYears, asRoughMonths, asRoughDays, asRoughMs } from './duration'\nimport { DateFormatter, buildIsoString } from './formatting'\nimport { parse } from './parsing'\nimport { isInt } from '../util/misc'\nimport { CmdFormatterFunc } from './formatting-cmd'\n\nexport interface DateEnvSettings {\n  timeZone: string\n  namedTimeZoneImpl?: NamedTimeZoneImplClass\n  calendarSystem: string\n  locale: Locale\n  weekNumberCalculation?: any\n  firstDay?: any,\n  weekLabel?: string,\n  cmdFormatter?: CmdFormatterFunc\n}\n\nexport type DateInput = Date | string | number | number[]\n\nexport interface DateMarkerMeta {\n  marker: DateMarker\n  isTimeUnspecified: boolean\n  forcedTzo: number | null\n}\n\n\nexport class DateEnv {\n\n  timeZone: string\n  namedTimeZoneImpl: NamedTimeZoneImpl\n  canComputeOffset: boolean\n\n  calendarSystem: CalendarSystem\n  locale: Locale\n  weekDow: number // which day begins the week\n  weekDoy: number // which day must be within the year, for computing the first week number\n  weekNumberFunc: any\n  weekLabel: string // DON'T LIKE how options are confused with local\n  cmdFormatter?: CmdFormatterFunc\n\n\n  constructor(settings: DateEnvSettings) {\n    let timeZone = this.timeZone = settings.timeZone\n    let isNamedTimeZone = timeZone !== 'local' && timeZone !== 'UTC'\n\n    if (settings.namedTimeZoneImpl && isNamedTimeZone) {\n      this.namedTimeZoneImpl = new settings.namedTimeZoneImpl(timeZone)\n    }\n\n    this.canComputeOffset = Boolean(!isNamedTimeZone || this.namedTimeZoneImpl)\n\n    this.calendarSystem = createCalendarSystem(settings.calendarSystem)\n    this.locale = settings.locale\n    this.weekDow = settings.locale.week.dow\n    this.weekDoy = settings.locale.week.doy\n\n    if (settings.weekNumberCalculation === 'ISO') {\n      this.weekDow = 1\n      this.weekDoy = 4\n    }\n\n    if (typeof settings.firstDay === 'number') {\n      this.weekDow = settings.firstDay\n    }\n\n    if (typeof settings.weekNumberCalculation === 'function') {\n      this.weekNumberFunc = settings.weekNumberCalculation\n    }\n\n    this.weekLabel = settings.weekLabel != null ? settings.weekLabel : settings.locale.options.weekLabel\n\n    this.cmdFormatter = settings.cmdFormatter\n  }\n\n\n  // Creating / Parsing\n\n  createMarker(input: DateInput): DateMarker {\n    let meta = this.createMarkerMeta(input)\n    if (meta === null) {\n      return null\n    }\n    return meta.marker\n  }\n\n  createNowMarker(): DateMarker {\n    if (this.canComputeOffset) {\n      return this.timestampToMarker(new Date().valueOf())\n    } else {\n      // if we can't compute the current date val for a timezone,\n      // better to give the current local date vals than UTC\n      return arrayToUtcDate(dateToLocalArray(new Date()))\n    }\n  }\n\n  createMarkerMeta(input: DateInput): DateMarkerMeta {\n\n    if (typeof input === 'string') {\n      return this.parse(input)\n    }\n\n    let marker = null\n\n    if (typeof input === 'number') {\n      marker = this.timestampToMarker(input)\n    } else if (input instanceof Date) {\n      input = input.valueOf()\n\n      if (!isNaN(input)) {\n        marker = this.timestampToMarker(input)\n      }\n    } else if (Array.isArray(input)) {\n      marker = arrayToUtcDate(input)\n    }\n\n    if (marker === null || !isValidDate(marker)) {\n      return null\n    }\n\n    return { marker, isTimeUnspecified: false, forcedTzo: null }\n  }\n\n  parse(s: string) {\n    let parts = parse(s)\n    if (parts === null) {\n      return null\n    }\n\n    let marker = parts.marker\n    let forcedTzo = null\n\n    if (parts.timeZoneOffset !== null) {\n      if (this.canComputeOffset) {\n        marker = this.timestampToMarker(marker.valueOf() - parts.timeZoneOffset * 60 * 1000)\n      } else {\n        forcedTzo = parts.timeZoneOffset\n      }\n    }\n\n    return { marker, isTimeUnspecified: parts.isTimeUnspecified, forcedTzo }\n  }\n\n\n  // Accessors\n\n  getYear(marker: DateMarker): number {\n    return this.calendarSystem.getMarkerYear(marker)\n  }\n\n  getMonth(marker: DateMarker): number {\n    return this.calendarSystem.getMarkerMonth(marker)\n  }\n\n\n  // Adding / Subtracting\n\n  add(marker: DateMarker, dur: Duration): DateMarker {\n    let a = this.calendarSystem.markerToArray(marker)\n    a[0] += dur.years\n    a[1] += dur.months\n    a[2] += dur.days\n    a[6] += dur.milliseconds\n    return this.calendarSystem.arrayToMarker(a)\n  }\n\n  subtract(marker: DateMarker, dur: Duration): DateMarker {\n    let a = this.calendarSystem.markerToArray(marker)\n    a[0] -= dur.years\n    a[1] -= dur.months\n    a[2] -= dur.days\n    a[6] -= dur.milliseconds\n    return this.calendarSystem.arrayToMarker(a)\n  }\n\n  addYears(marker: DateMarker, n: number) {\n    let a = this.calendarSystem.markerToArray(marker)\n    a[0] += n\n    return this.calendarSystem.arrayToMarker(a)\n  }\n\n  addMonths(marker: DateMarker, n: number) {\n    let a = this.calendarSystem.markerToArray(marker)\n    a[1] += n\n    return this.calendarSystem.arrayToMarker(a)\n  }\n\n\n  // Diffing Whole Units\n\n  diffWholeYears(m0: DateMarker, m1: DateMarker): number {\n    let { calendarSystem } = this\n\n    if (\n      timeAsMs(m0) === timeAsMs(m1) &&\n      calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1) &&\n      calendarSystem.getMarkerMonth(m0) === calendarSystem.getMarkerMonth(m1)\n    ) {\n      return calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0)\n    }\n    return null\n  }\n\n  diffWholeMonths(m0: DateMarker, m1: DateMarker): number {\n    let { calendarSystem } = this\n\n    if (\n      timeAsMs(m0) === timeAsMs(m1) &&\n      calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1)\n    ) {\n      return (calendarSystem.getMarkerMonth(m1) - calendarSystem.getMarkerMonth(m0)) +\n          (calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0)) * 12\n    }\n    return null\n  }\n\n\n  // Range / Duration\n\n  greatestWholeUnit(m0: DateMarker, m1: DateMarker) {\n    let n = this.diffWholeYears(m0, m1)\n\n    if (n !== null) {\n      return { unit: 'year', value: n }\n    }\n\n    n = this.diffWholeMonths(m0, m1)\n\n    if (n !== null) {\n      return { unit: 'month', value: n }\n    }\n\n    n = diffWholeWeeks(m0, m1)\n\n    if (n !== null) {\n      return { unit: 'week', value: n }\n    }\n\n    n = diffWholeDays(m0, m1)\n\n    if (n !== null) {\n      return { unit: 'day', value: n }\n    }\n\n    n = diffHours(m0, m1)\n\n    if (isInt(n)) {\n      return { unit: 'hour', value: n }\n    }\n\n    n = diffMinutes(m0, m1)\n\n    if (isInt(n)) {\n      return { unit: 'minute', value: n }\n    }\n\n    n = diffSeconds(m0, m1)\n\n    if (isInt(n)) {\n      return { unit: 'second', value: n }\n    }\n\n    return { unit: 'millisecond', value: m1.valueOf() - m0.valueOf() }\n  }\n\n  countDurationsBetween(m0: DateMarker, m1: DateMarker, d: Duration) {\n    // TODO: can use greatestWholeUnit\n    let diff\n\n    if (d.years) {\n      diff = this.diffWholeYears(m0, m1)\n      if (diff !== null) {\n        return diff / asRoughYears(d)\n      }\n    }\n\n    if (d.months) {\n      diff = this.diffWholeMonths(m0, m1)\n      if (diff !== null) {\n        return diff / asRoughMonths(d)\n      }\n    }\n\n    if (d.days) {\n      diff = diffWholeDays(m0, m1)\n      if (diff !== null) {\n        return diff / asRoughDays(d)\n      }\n    }\n\n    return (m1.valueOf() - m0.valueOf()) / asRoughMs(d)\n  }\n\n\n  // Start-Of\n\n  startOf(m: DateMarker, unit: string) {\n    if (unit === 'year') {\n      return this.startOfYear(m)\n    } else if (unit === 'month') {\n      return this.startOfMonth(m)\n    } else if (unit === 'week') {\n      return this.startOfWeek(m)\n    } else if (unit === 'day') {\n      return startOfDay(m)\n    } else if (unit === 'hour') {\n      return startOfHour(m)\n    } else if (unit === 'minute') {\n      return startOfMinute(m)\n    } else if (unit === 'second') {\n      return startOfSecond(m)\n    }\n  }\n\n  startOfYear(m: DateMarker): DateMarker {\n    return this.calendarSystem.arrayToMarker([\n      this.calendarSystem.getMarkerYear(m)\n    ])\n  }\n\n  startOfMonth(m: DateMarker): DateMarker {\n    return this.calendarSystem.arrayToMarker([\n      this.calendarSystem.getMarkerYear(m),\n      this.calendarSystem.getMarkerMonth(m)\n    ])\n  }\n\n  startOfWeek(m: DateMarker): DateMarker {\n    return this.calendarSystem.arrayToMarker([\n      this.calendarSystem.getMarkerYear(m),\n      this.calendarSystem.getMarkerMonth(m),\n      m.getUTCDate() - ((m.getUTCDay() - this.weekDow + 7) % 7)\n    ])\n  }\n\n\n  // Week Number\n\n  computeWeekNumber(marker: DateMarker): number {\n    if (this.weekNumberFunc) {\n      return this.weekNumberFunc(this.toDate(marker))\n    } else {\n      return weekOfYear(marker, this.weekDow, this.weekDoy)\n    }\n  }\n\n  // TODO: choke on timeZoneName: long\n  format(marker: DateMarker, formatter: DateFormatter, dateOptions: { forcedTzo?: number } = {}) {\n    return formatter.format(\n      {\n        marker: marker,\n        timeZoneOffset: dateOptions.forcedTzo != null ?\n          dateOptions.forcedTzo :\n          this.offsetForMarker(marker)\n      },\n      this\n    )\n  }\n\n  formatRange(start: DateMarker, end: DateMarker, formatter: DateFormatter, dateOptions: { forcedStartTzo?: number, forcedEndTzo?: number, isEndExclusive?: boolean } = {}) {\n\n    if (dateOptions.isEndExclusive) {\n      end = addMs(end, -1)\n    }\n\n    return formatter.formatRange(\n      {\n        marker: start,\n        timeZoneOffset: dateOptions.forcedStartTzo != null ?\n          dateOptions.forcedStartTzo :\n          this.offsetForMarker(start)\n      },\n      {\n        marker: end,\n        timeZoneOffset: dateOptions.forcedEndTzo != null ?\n          dateOptions.forcedEndTzo :\n          this.offsetForMarker(end)\n      },\n      this\n    )\n  }\n\n  formatIso(marker: DateMarker, extraOptions: any = {}) {\n    let timeZoneOffset = null\n\n    if (!extraOptions.omitTimeZoneOffset) {\n      if (extraOptions.forcedTzo != null) {\n        timeZoneOffset = extraOptions.forcedTzo\n      } else {\n        timeZoneOffset = this.offsetForMarker(marker)\n      }\n    }\n\n    return buildIsoString(marker, timeZoneOffset, extraOptions.omitTime)\n  }\n\n\n  // TimeZone\n\n  timestampToMarker(ms: number) {\n    if (this.timeZone === 'local') {\n      return arrayToUtcDate(dateToLocalArray(new Date(ms)))\n    } else if (this.timeZone === 'UTC' || !this.namedTimeZoneImpl) {\n      return new Date(ms)\n    } else {\n      return arrayToUtcDate(this.namedTimeZoneImpl.timestampToArray(ms))\n    }\n  }\n\n  offsetForMarker(m: DateMarker) {\n    if (this.timeZone === 'local') {\n      return -arrayToLocalDate(dateToUtcArray(m)).getTimezoneOffset() // convert \"inverse\" offset to \"normal\" offset\n    } else if (this.timeZone === 'UTC') {\n      return 0\n    } else if (this.namedTimeZoneImpl) {\n      return this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m))\n    }\n    return null\n  }\n\n\n  // Conversion\n\n  toDate(m: DateMarker, forcedTzo?: number): Date {\n    if (this.timeZone === 'local') {\n      return arrayToLocalDate(dateToUtcArray(m))\n    } else if (this.timeZone === 'UTC') {\n      return new Date(m.valueOf()) // make sure it's a copy\n    } else if (!this.namedTimeZoneImpl) {\n      return new Date(m.valueOf() - (forcedTzo || 0))\n    } else {\n      return new Date(\n        m.valueOf() -\n        this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m)) * 1000 * 60 // convert minutes -> ms\n      )\n    }\n  }\n\n}\n","import { refineProps } from '../util/misc'\nimport { EventInput } from './event'\nimport Calendar from '../Calendar'\nimport { DateRange } from '../datelib/date-range'\nimport { EventSourceFunc } from '../event-sources/func-event-source'\nimport { EventUi, processUnscopedUiProps } from '../component/event-ui'\nimport { ConstraintInput, AllowFunc } from '../validation'\n\n/*\nParsing and normalization of the EventSource data type, which defines how event data is fetched.\nContains the plugin system for defining new types if event sources.\n\nTODO: \"EventSource\" is the same name as a built-in type in TypeScript. Rethink.\n*/\n\nexport type EventSourceError = {\n  message: string\n  response?: any // an XHR or something like it\n  [otherProp: string]: any\n}\n\nexport type EventInputTransformer = (eventInput: EventInput) => EventInput | null\nexport type EventSourceSuccessResponseHandler = (rawData: any, response: any) => EventInput[] | void\nexport type EventSourceErrorResponseHandler = (error: EventSourceError) => void\n\nexport interface ExtendedEventSourceInput {\n  id?: string | number // only accept number?\n  allDayDefault?: boolean\n  eventDataTransform?: EventInputTransformer\n\n  // array or function (TODO: move this to array-event-source/func-event-source?)\n  events?: EventInput[] | EventSourceFunc\n\n  // json feed (TODO: how to move this to json-feed-event-source?)\n  url?: string\n  method?: string\n  extraParams?: object | (() => object)\n  startParam?: string\n  endParam?: string\n  timeZoneParam?: string\n\n  // for any network-related sources\n  success?: EventSourceSuccessResponseHandler\n  failure?: EventSourceErrorResponseHandler\n\n  editable?: boolean\n  startEditable?: boolean\n  durationEditable?: boolean\n  constraint?: ConstraintInput\n  overlap?: boolean\n  allow?: AllowFunc\n  className?: string[] | string\n  classNames?: string[] | string\n  backgroundColor?: string\n  borderColor?: string\n  textColor?: string\n  color?: string\n\n  [otherProp: string]: any // in case plugins want more props\n}\n\nexport type EventSourceInput =\n  ExtendedEventSourceInput | // object in extended form\n  EventSourceFunc | // just a function\n  string // a URL for a JSON feed\n\nexport interface EventSource {\n  _raw: any\n  sourceId: string\n  sourceDefId: number // one of the few IDs that's a NUMBER not a string\n  meta: any\n  publicId: string\n  isFetching: boolean\n  latestFetchId: string\n  fetchRange: DateRange | null\n  allDayDefault: boolean | null\n  eventDataTransform: EventInputTransformer\n  ui: EventUi\n  success: EventSourceSuccessResponseHandler | null\n  failure: EventSourceErrorResponseHandler | null\n  extendedProps: any // undocumented\n}\n\nexport type EventSourceHash = { [sourceId: string]: EventSource }\n\nexport type EventSourceFetcher = (\n  arg: {\n    eventSource: EventSource\n    calendar: Calendar\n    range: DateRange\n  },\n  success: (res: { rawEvents: EventInput[], xhr?: XMLHttpRequest }) => void,\n  failure: (error: EventSourceError) => void\n) => (void | PromiseLike<EventInput[]>)\n\nexport interface EventSourceDef {\n  ignoreRange?: boolean\n  parseMeta: (raw: EventSourceInput) => object | null\n  fetch: EventSourceFetcher\n}\n\nconst SIMPLE_SOURCE_PROPS = {\n  id: String,\n  allDayDefault: Boolean,\n  eventDataTransform: Function,\n  success: Function,\n  failure: Function\n}\n\nlet uid = 0\n\nexport function doesSourceNeedRange(eventSource: EventSource, calendar: Calendar) {\n  let defs = calendar.pluginSystem.hooks.eventSourceDefs\n\n  return !defs[eventSource.sourceDefId].ignoreRange\n}\n\nexport function parseEventSource(raw: EventSourceInput, calendar: Calendar): EventSource | null {\n  let defs = calendar.pluginSystem.hooks.eventSourceDefs\n\n  for (let i = defs.length - 1; i >= 0; i--) { // later-added plugins take precedence\n    let def = defs[i]\n    let meta = def.parseMeta(raw)\n\n    if (meta) {\n      let res = parseEventSourceProps(\n        typeof raw === 'object' ? raw : {},\n        meta,\n        i,\n        calendar\n      )\n\n      res._raw = raw\n      return res\n    }\n  }\n\n  return null\n}\n\nfunction parseEventSourceProps(raw: ExtendedEventSourceInput, meta: object, sourceDefId: number, calendar: Calendar): EventSource {\n  let leftovers0 = {}\n  let props = refineProps(raw, SIMPLE_SOURCE_PROPS, {}, leftovers0)\n  let leftovers1 = {}\n  let ui = processUnscopedUiProps(leftovers0, calendar, leftovers1)\n\n  props.isFetching = false\n  props.latestFetchId = ''\n  props.fetchRange = null\n  props.publicId = String(raw.id || '')\n  props.sourceId = String(uid++)\n  props.sourceDefId = sourceDefId\n  props.meta = meta\n  props.ui = ui\n  props.extendedProps = leftovers1\n\n  return props as EventSource\n}\n","import { EventSource, EventSourceHash, doesSourceNeedRange } from '../structs/event-source'\nimport Calendar from '../Calendar'\nimport { arrayToHash, filterHash } from '../util/object'\nimport { DateRange } from '../datelib/date-range'\nimport { DateProfile } from '../DateProfileGenerator'\nimport { Action } from './types'\n\nexport default function(eventSources: EventSourceHash, action: Action, dateProfile: DateProfile | null, calendar: Calendar): EventSourceHash {\n  switch (action.type) {\n\n    case 'ADD_EVENT_SOURCES': // already parsed\n      return addSources(eventSources, action.sources, dateProfile ? dateProfile.activeRange : null, calendar)\n\n    case 'REMOVE_EVENT_SOURCE':\n      return removeSource(eventSources, action.sourceId)\n\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n    case 'NEXT':\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      if (dateProfile) {\n        return fetchDirtySources(eventSources, dateProfile.activeRange, calendar)\n      } else {\n        return eventSources\n      }\n\n    case 'FETCH_EVENT_SOURCES':\n    case 'CHANGE_TIMEZONE':\n      return fetchSourcesByIds(\n        eventSources,\n        (action as any).sourceIds ?\n          arrayToHash((action as any).sourceIds) :\n          excludeStaticSources(eventSources, calendar),\n        dateProfile ? dateProfile.activeRange : null,\n        calendar\n      )\n\n    case 'RECEIVE_EVENTS':\n    case 'RECEIVE_EVENT_ERROR':\n      return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange)\n\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return {}\n\n    default:\n      return eventSources\n  }\n}\n\n\nlet uid = 0\n\n\nfunction addSources(eventSourceHash: EventSourceHash, sources: EventSource[], fetchRange: DateRange | null, calendar: Calendar): EventSourceHash {\n  let hash: EventSourceHash = {}\n\n  for (let source of sources) {\n    hash[source.sourceId] = source\n  }\n\n  if (fetchRange) {\n    hash = fetchDirtySources(hash, fetchRange, calendar)\n  }\n\n  return { ...eventSourceHash, ...hash }\n}\n\n\nfunction removeSource(eventSourceHash: EventSourceHash, sourceId: string): EventSourceHash {\n  return filterHash(eventSourceHash, function(eventSource: EventSource) {\n    return eventSource.sourceId !== sourceId\n  })\n}\n\n\nfunction fetchDirtySources(sourceHash: EventSourceHash, fetchRange: DateRange, calendar: Calendar): EventSourceHash {\n  return fetchSourcesByIds(\n    sourceHash,\n    filterHash(sourceHash, function(eventSource) {\n      return isSourceDirty(eventSource, fetchRange, calendar)\n    }),\n    fetchRange,\n    calendar\n  )\n}\n\n\nfunction isSourceDirty(eventSource: EventSource, fetchRange: DateRange, calendar: Calendar) {\n\n  if (!doesSourceNeedRange(eventSource, calendar)) {\n    return !eventSource.latestFetchId\n  } else {\n    return !calendar.opt('lazyFetching') ||\n      !eventSource.fetchRange ||\n      fetchRange.start < eventSource.fetchRange.start ||\n      fetchRange.end > eventSource.fetchRange.end\n  }\n}\n\n\nfunction fetchSourcesByIds(\n  prevSources: EventSourceHash,\n  sourceIdHash: { [sourceId: string]: any },\n  fetchRange: DateRange,\n  calendar: Calendar\n): EventSourceHash {\n  let nextSources: EventSourceHash = {}\n\n  for (let sourceId in prevSources) {\n    let source = prevSources[sourceId]\n\n    if (sourceIdHash[sourceId]) {\n      nextSources[sourceId] = fetchSource(source, fetchRange, calendar)\n    } else {\n      nextSources[sourceId] = source\n    }\n  }\n\n  return nextSources\n}\n\n\nfunction fetchSource(eventSource: EventSource, fetchRange: DateRange, calendar: Calendar) {\n  let sourceDef = calendar.pluginSystem.hooks.eventSourceDefs[eventSource.sourceDefId]\n  let fetchId = String(uid++)\n\n  sourceDef.fetch(\n    {\n      eventSource,\n      calendar,\n      range: fetchRange\n    },\n    function(res) {\n      let { rawEvents } = res\n      let calSuccess = calendar.opt('eventSourceSuccess')\n      let calSuccessRes\n      let sourceSuccessRes\n\n      if (eventSource.success) {\n        sourceSuccessRes = eventSource.success(rawEvents, res.xhr)\n      }\n      if (calSuccess) {\n        calSuccessRes = calSuccess(rawEvents, res.xhr)\n      }\n\n      rawEvents = sourceSuccessRes || calSuccessRes || rawEvents\n\n      calendar.dispatch({\n        type: 'RECEIVE_EVENTS',\n        sourceId: eventSource.sourceId,\n        fetchId,\n        fetchRange,\n        rawEvents\n      })\n    },\n    function(error) {\n      let callFailure = calendar.opt('eventSourceFailure')\n\n      console.warn(error.message, error)\n\n      if (eventSource.failure) {\n        eventSource.failure(error)\n      }\n      if (callFailure) {\n        callFailure(error)\n      }\n\n      calendar.dispatch({\n        type: 'RECEIVE_EVENT_ERROR',\n        sourceId: eventSource.sourceId,\n        fetchId,\n        fetchRange,\n        error\n      })\n    }\n  )\n\n  return {\n    ...eventSource,\n    isFetching: true,\n    latestFetchId: fetchId\n  }\n}\n\n\nfunction receiveResponse(sourceHash: EventSourceHash, sourceId: string, fetchId: string, fetchRange: DateRange) {\n  let eventSource: EventSource = sourceHash[sourceId]\n\n  if (\n    eventSource && // not already removed\n    fetchId === eventSource.latestFetchId\n  ) {\n    return {\n      ...sourceHash,\n      [sourceId]: {\n        ...eventSource,\n        isFetching: false,\n        fetchRange\n      }\n    }\n  }\n\n  return sourceHash\n}\n\n\nfunction excludeStaticSources(eventSources: EventSourceHash, calendar: Calendar): EventSourceHash {\n  return filterHash(eventSources, function(eventSource) {\n    return doesSourceNeedRange(eventSource, calendar)\n  })\n}\n","import { DateMarker, startOfDay, addDays } from './datelib/marker'\nimport { Duration, createDuration, getWeeksFromInput, asRoughDays, asRoughMs, greatestDurationDenominator, durationsEqual } from './datelib/duration'\nimport { DateRange, OpenDateRange, constrainMarkerToRange, intersectRanges, rangesIntersect, parseRange, rangesEqual } from './datelib/date-range'\nimport { ViewSpec } from './structs/view-spec'\nimport { DateEnv } from './datelib/env'\nimport Calendar from './Calendar'\nimport { computeVisibleDayRange } from './util/misc'\n\n\nexport interface DateProfile {\n  currentRange: DateRange\n  currentRangeUnit: string\n  isRangeAllDay: boolean\n  validRange: OpenDateRange\n  activeRange: DateRange\n  renderRange: DateRange\n  minTime: Duration\n  maxTime: Duration\n  isValid: boolean\n  dateIncrement: Duration\n}\n\n\nexport default class DateProfileGenerator {\n\n  viewSpec: ViewSpec\n  options: any\n  dateEnv: DateEnv\n  calendar: Calendar // avoid\n  isHiddenDayHash: boolean[]\n\n\n  constructor(viewSpec: ViewSpec, calendar: Calendar) {\n    this.viewSpec = viewSpec\n    this.options = viewSpec.options\n    this.dateEnv = calendar.dateEnv\n    this.calendar = calendar\n\n    this.initHiddenDays()\n  }\n\n\n  /* Date Range Computation\n  ------------------------------------------------------------------------------------------------------------------*/\n\n\n  // Builds a structure with info about what the dates/ranges will be for the \"prev\" view.\n  buildPrev(currentDateProfile: DateProfile, currentDate: DateMarker): DateProfile {\n    let { dateEnv } = this\n\n    let prevDate = dateEnv.subtract(\n      dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n      currentDateProfile.dateIncrement\n    )\n\n    return this.build(prevDate, -1)\n  }\n\n\n  // Builds a structure with info about what the dates/ranges will be for the \"next\" view.\n  buildNext(currentDateProfile: DateProfile, currentDate: DateMarker): DateProfile {\n    let { dateEnv } = this\n\n    let nextDate = dateEnv.add(\n      dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n      currentDateProfile.dateIncrement\n    )\n\n    return this.build(nextDate, 1)\n  }\n\n\n  // Builds a structure holding dates/ranges for rendering around the given date.\n  // Optional direction param indicates whether the date is being incremented/decremented\n  // from its previous value. decremented = -1, incremented = 1 (default).\n  build(currentDate: DateMarker, direction?, forceToValid = false): DateProfile {\n    let validRange: DateRange\n    let minTime = null\n    let maxTime = null\n    let currentInfo\n    let isRangeAllDay\n    let renderRange: DateRange\n    let activeRange: DateRange\n    let isValid\n\n    validRange = this.buildValidRange()\n    validRange = this.trimHiddenDays(validRange)\n\n    if (forceToValid) {\n      currentDate = constrainMarkerToRange(currentDate, validRange)\n    }\n\n    currentInfo = this.buildCurrentRangeInfo(currentDate, direction)\n    isRangeAllDay = /^(year|month|week|day)$/.test(currentInfo.unit)\n    renderRange = this.buildRenderRange(\n      this.trimHiddenDays(currentInfo.range),\n      currentInfo.unit,\n      isRangeAllDay\n    )\n    renderRange = this.trimHiddenDays(renderRange)\n    activeRange = renderRange\n\n    if (!this.options.showNonCurrentDates) {\n      activeRange = intersectRanges(activeRange, currentInfo.range)\n    }\n\n    minTime = createDuration(this.options.minTime)\n    maxTime = createDuration(this.options.maxTime)\n    activeRange = this.adjustActiveRange(activeRange, minTime, maxTime)\n    activeRange = intersectRanges(activeRange, validRange) // might return null\n\n    // it's invalid if the originally requested date is not contained,\n    // or if the range is completely outside of the valid range.\n    isValid = rangesIntersect(currentInfo.range, validRange)\n\n    return {\n      // constraint for where prev/next operations can go and where events can be dragged/resized to.\n      // an object with optional start and end properties.\n      validRange: validRange,\n\n      // range the view is formally responsible for.\n      // for example, a month view might have 1st-31st, excluding padded dates\n      currentRange: currentInfo.range,\n\n      // name of largest unit being displayed, like \"month\" or \"week\"\n      currentRangeUnit: currentInfo.unit,\n\n      isRangeAllDay,\n\n      // dates that display events and accept drag-n-drop\n      // will be `null` if no dates accept events\n      activeRange,\n\n      // date range with a rendered skeleton\n      // includes not-active days that need some sort of DOM\n      renderRange,\n\n      // Duration object that denotes the first visible time of any given day\n      minTime,\n\n      // Duration object that denotes the exclusive visible end time of any given day\n      maxTime,\n\n      isValid,\n\n      // how far the current date will move for a prev/next operation\n      dateIncrement: this.buildDateIncrement(currentInfo.duration)\n        // pass a fallback (might be null) ^\n    }\n  }\n\n\n  // Builds an object with optional start/end properties.\n  // Indicates the minimum/maximum dates to display.\n  // not responsible for trimming hidden days.\n  buildValidRange(): OpenDateRange {\n    return this.getRangeOption('validRange', this.calendar.getNow()) ||\n      { start: null, end: null } // completely open-ended\n  }\n\n\n  // Builds a structure with info about the \"current\" range, the range that is\n  // highlighted as being the current month for example.\n  // See build() for a description of `direction`.\n  // Guaranteed to have `range` and `unit` properties. `duration` is optional.\n  buildCurrentRangeInfo(date: DateMarker, direction) {\n    let { viewSpec, dateEnv } = this\n    let duration = null\n    let unit = null\n    let range = null\n    let dayCount\n\n    if (viewSpec.duration) {\n      duration = viewSpec.duration\n      unit = viewSpec.durationUnit\n      range = this.buildRangeFromDuration(date, direction, duration, unit)\n    } else if ((dayCount = this.options.dayCount)) {\n      unit = 'day'\n      range = this.buildRangeFromDayCount(date, direction, dayCount)\n    } else if ((range = this.buildCustomVisibleRange(date))) {\n      unit = dateEnv.greatestWholeUnit(range.start, range.end).unit\n    } else {\n      duration = this.getFallbackDuration()\n      unit = greatestDurationDenominator(duration).unit\n      range = this.buildRangeFromDuration(date, direction, duration, unit)\n    }\n\n    return { duration: duration, unit: unit, range }\n  }\n\n\n  getFallbackDuration(): Duration {\n    return createDuration({ day: 1 })\n  }\n\n\n  // Returns a new activeRange to have time values (un-ambiguate)\n  // minTime or maxTime causes the range to expand.\n  adjustActiveRange(range: DateRange, minTime: Duration, maxTime: Duration) {\n    let { dateEnv } = this\n    let start = range.start\n    let end = range.end\n\n    if ((this.viewSpec.class as any).prototype.usesMinMaxTime) {\n\n      // expand active range if minTime is negative (why not when positive?)\n      if (asRoughDays(minTime) < 0) {\n        start = startOfDay(start) // necessary?\n        start = dateEnv.add(start, minTime)\n      }\n\n      // expand active range if maxTime is beyond one day (why not when positive?)\n      if (asRoughDays(maxTime) > 1) {\n        end = startOfDay(end) // necessary?\n        end = addDays(end, -1)\n        end = dateEnv.add(end, maxTime)\n      }\n    }\n\n    return { start, end }\n  }\n\n\n  // Builds the \"current\" range when it is specified as an explicit duration.\n  // `unit` is the already-computed greatestDurationDenominator unit of duration.\n  buildRangeFromDuration(date: DateMarker, direction, duration: Duration, unit) {\n    let { dateEnv } = this\n    let alignment = this.options.dateAlignment\n    let dateIncrementInput\n    let dateIncrementDuration\n    let start: DateMarker\n    let end: DateMarker\n    let res\n\n    // compute what the alignment should be\n    if (!alignment) {\n      dateIncrementInput = this.options.dateIncrement\n\n      if (dateIncrementInput) {\n        dateIncrementDuration = createDuration(dateIncrementInput)\n\n        // use the smaller of the two units\n        if (asRoughMs(dateIncrementDuration) < asRoughMs(duration)) {\n          alignment = greatestDurationDenominator(\n            dateIncrementDuration,\n            !getWeeksFromInput(dateIncrementInput)\n          ).unit\n        } else {\n          alignment = unit\n        }\n      } else {\n        alignment = unit\n      }\n    }\n\n    // if the view displays a single day or smaller\n    if (asRoughDays(duration) <= 1) {\n      if (this.isHiddenDay(start)) {\n        start = this.skipHiddenDays(start, direction)\n        start = startOfDay(start)\n      }\n    }\n\n    function computeRes() {\n      start = dateEnv.startOf(date, alignment)\n      end = dateEnv.add(start, duration)\n      res = { start, end }\n    }\n\n    computeRes()\n\n    // if range is completely enveloped by hidden days, go past the hidden days\n    if (!this.trimHiddenDays(res)) {\n      date = this.skipHiddenDays(date, direction)\n      computeRes()\n    }\n\n    return res\n  }\n\n\n  // Builds the \"current\" range when a dayCount is specified.\n  buildRangeFromDayCount(date: DateMarker, direction, dayCount) {\n    let { dateEnv } = this\n    let customAlignment = this.options.dateAlignment\n    let runningCount = 0\n    let start: DateMarker = date\n    let end: DateMarker\n\n    if (customAlignment) {\n      start = dateEnv.startOf(start, customAlignment)\n    }\n\n    start = startOfDay(start)\n    start = this.skipHiddenDays(start, direction)\n\n    end = start\n    do {\n      end = addDays(end, 1)\n      if (!this.isHiddenDay(end)) {\n        runningCount++\n      }\n    } while (runningCount < dayCount)\n\n    return { start, end }\n  }\n\n\n  // Builds a normalized range object for the \"visible\" range,\n  // which is a way to define the currentRange and activeRange at the same time.\n  buildCustomVisibleRange(date: DateMarker) {\n    let { dateEnv } = this\n    let visibleRange = this.getRangeOption('visibleRange', dateEnv.toDate(date))\n\n    if (visibleRange && (visibleRange.start == null || visibleRange.end == null)) {\n      return null\n    }\n\n    return visibleRange\n  }\n\n\n  // Computes the range that will represent the element/cells for *rendering*,\n  // but which may have voided days/times.\n  // not responsible for trimming hidden days.\n  buildRenderRange(currentRange: DateRange, currentRangeUnit, isRangeAllDay) {\n    return currentRange\n  }\n\n\n  // Compute the duration value that should be added/substracted to the current date\n  // when a prev/next operation happens.\n  buildDateIncrement(fallback): Duration {\n    let dateIncrementInput = this.options.dateIncrement\n    let customAlignment\n\n    if (dateIncrementInput) {\n      return createDuration(dateIncrementInput)\n    } else if ((customAlignment = this.options.dateAlignment)) {\n      return createDuration(1, customAlignment)\n    } else if (fallback) {\n      return fallback\n    } else {\n      return createDuration({ days: 1 })\n    }\n  }\n\n\n  // Arguments after name will be forwarded to a hypothetical function value\n  // WARNING: passed-in arguments will be given to generator functions as-is and can cause side-effects.\n  // Always clone your objects if you fear mutation.\n  getRangeOption(name, ...otherArgs): OpenDateRange {\n    let val = this.options[name]\n\n    if (typeof val === 'function') {\n      val = val.apply(null, otherArgs)\n    }\n\n    if (val) {\n      val = parseRange(val, this.dateEnv)\n    }\n\n    if (val) {\n      val = computeVisibleDayRange(val)\n    }\n\n    return val\n  }\n\n\n  /* Hidden Days\n  ------------------------------------------------------------------------------------------------------------------*/\n\n\n  // Initializes internal variables related to calculating hidden days-of-week\n  initHiddenDays() {\n    let hiddenDays = this.options.hiddenDays || [] // array of day-of-week indices that are hidden\n    let isHiddenDayHash = [] // is the day-of-week hidden? (hash with day-of-week-index -> bool)\n    let dayCnt = 0\n    let i\n\n    if (this.options.weekends === false) {\n      hiddenDays.push(0, 6) // 0=sunday, 6=saturday\n    }\n\n    for (i = 0; i < 7; i++) {\n      if (\n        !(isHiddenDayHash[i] = hiddenDays.indexOf(i) !== -1)\n      ) {\n        dayCnt++\n      }\n    }\n\n    if (!dayCnt) {\n      throw new Error('invalid hiddenDays') // all days were hidden? bad.\n    }\n\n    this.isHiddenDayHash = isHiddenDayHash\n  }\n\n\n  // Remove days from the beginning and end of the range that are computed as hidden.\n  // If the whole range is trimmed off, returns null\n  trimHiddenDays(range: DateRange): DateRange | null {\n    let start = range.start\n    let end = range.end\n\n    if (start) {\n      start = this.skipHiddenDays(start)\n    }\n\n    if (end) {\n      end = this.skipHiddenDays(end, -1, true)\n    }\n\n    if (start == null || end == null || start < end) {\n      return { start, end }\n    }\n\n    return null\n  }\n\n\n  // Is the current day hidden?\n  // `day` is a day-of-week index (0-6), or a Date (used for UTC)\n  isHiddenDay(day) {\n    if (day instanceof Date) {\n      day = day.getUTCDay()\n    }\n    return this.isHiddenDayHash[day]\n  }\n\n\n  // Incrementing the current day until it is no longer a hidden day, returning a copy.\n  // DOES NOT CONSIDER validRange!\n  // If the initial value of `date` is not a hidden day, don't do anything.\n  // Pass `isExclusive` as `true` if you are dealing with an end date.\n  // `inc` defaults to `1` (increment one day forward each time)\n  skipHiddenDays(date: DateMarker, inc = 1, isExclusive = false) {\n    while (\n      this.isHiddenDayHash[(date.getUTCDay() + (isExclusive ? inc : 0) + 7) % 7]\n    ) {\n      date = addDays(date, inc)\n    }\n    return date\n  }\n\n}\n\n\n// TODO: find a way to avoid comparing DateProfiles. it's tedious\nexport function isDateProfilesEqual(p0: DateProfile, p1: DateProfile) {\n  return rangesEqual(p0.validRange, p1.validRange) &&\n    rangesEqual(p0.activeRange, p1.activeRange) &&\n    rangesEqual(p0.renderRange, p1.renderRange) &&\n    durationsEqual(p0.minTime, p1.minTime) &&\n    durationsEqual(p0.maxTime, p1.maxTime)\n  /*\n  TODO: compare more?\n    currentRange: DateRange\n    currentRangeUnit: string\n    isRangeAllDay: boolean\n    isValid: boolean\n    dateIncrement: Duration\n  */\n}\n","import Calendar from '../Calendar'\nimport reduceEventSources from './eventSources'\nimport reduceEventStore from './eventStore'\nimport { DateProfile, isDateProfilesEqual } from '../DateProfileGenerator'\nimport { DateSpan } from '../structs/date-span'\nimport { EventInteractionState } from '../interactions/event-interaction-state'\nimport { CalendarState, Action } from './types'\nimport { EventSourceHash } from '../structs/event-source'\nimport { DateMarker } from '../datelib/marker'\nimport { rangeContainsMarker } from '../datelib/date-range'\n\nexport default function(state: CalendarState, action: Action, calendar: Calendar): CalendarState {\n\n  let viewType = reduceViewType(state.viewType, action)\n  let dateProfile = reduceDateProfile(state.dateProfile, action, state.currentDate, viewType, calendar)\n  let eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendar)\n\n  let nextState = {\n    ...state,\n    viewType,\n    dateProfile,\n    currentDate: reduceCurrentDate(state.currentDate, action, dateProfile),\n    eventSources,\n    eventStore: reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendar),\n    dateSelection: reduceDateSelection(state.dateSelection, action, calendar),\n    eventSelection: reduceSelectedEvent(state.eventSelection, action),\n    eventDrag: reduceEventDrag(state.eventDrag, action, eventSources, calendar),\n    eventResize: reduceEventResize(state.eventResize, action, eventSources, calendar),\n    eventSourceLoadingLevel: computeLoadingLevel(eventSources),\n    loadingLevel: computeLoadingLevel(eventSources)\n  }\n\n  for (let reducerFunc of calendar.pluginSystem.hooks.reducers) {\n    nextState = reducerFunc(nextState, action, calendar)\n  }\n\n  // console.log(action.type, nextState)\n\n  return nextState\n}\n\nfunction reduceViewType(currentViewType: string, action: Action): string {\n  switch (action.type) {\n    case 'SET_VIEW_TYPE':\n      return action.viewType\n    default:\n      return currentViewType\n  }\n}\n\nfunction reduceDateProfile(currentDateProfile: DateProfile | null, action: Action, currentDate: DateMarker, viewType: string, calendar: Calendar): DateProfile {\n  let newDateProfile: DateProfile\n\n  switch (action.type) {\n\n    case 'PREV':\n      newDateProfile = calendar.dateProfileGenerators[viewType].buildPrev(currentDateProfile, currentDate)\n      break\n\n    case 'NEXT':\n      newDateProfile = calendar.dateProfileGenerators[viewType].buildNext(currentDateProfile, currentDate)\n      break\n\n    case 'SET_DATE':\n      if (\n        !currentDateProfile.activeRange ||\n        !rangeContainsMarker(currentDateProfile.currentRange, action.dateMarker)\n      ) {\n        newDateProfile = calendar.dateProfileGenerators[viewType].build(\n          action.dateMarker,\n          undefined,\n          true // forceToValid\n        )\n      }\n      break\n\n    case 'SET_VIEW_TYPE':\n      let generator = calendar.dateProfileGenerators[viewType]\n\n      if (!generator) {\n        throw new Error(\n          viewType ?\n            'The FullCalendar view \"' + viewType + '\" does not exist. Make sure your plugins are loaded correctly.' :\n            'No available FullCalendar view plugins.'\n        )\n      }\n\n      newDateProfile = generator.build(\n        action.dateMarker || currentDate,\n        undefined,\n        true // forceToValid\n      )\n      break\n  }\n\n  if (\n    newDateProfile &&\n    newDateProfile.isValid &&\n    !(currentDateProfile && isDateProfilesEqual(currentDateProfile, newDateProfile))\n  ) {\n    return newDateProfile\n  } else {\n    return currentDateProfile\n  }\n}\n\nfunction reduceCurrentDate(currentDate: DateMarker, action: Action, dateProfile: DateProfile): DateMarker {\n  switch (action.type) {\n\n    case 'PREV':\n    case 'NEXT':\n      if (!rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n        return dateProfile.currentRange.start\n      } else {\n        return currentDate\n      }\n\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      let newDate = action.dateMarker || currentDate\n      if (dateProfile.activeRange && !rangeContainsMarker(dateProfile.activeRange, newDate)) {\n        return dateProfile.currentRange.start\n      } else {\n        return newDate\n      }\n\n    default:\n      return currentDate\n  }\n}\n\nfunction reduceDateSelection(currentSelection: DateSpan | null, action: Action, calendar: Calendar) {\n  switch (action.type) {\n    case 'SELECT_DATES':\n      return action.selection\n    case 'UNSELECT_DATES':\n      return null\n    default:\n      return currentSelection\n  }\n}\n\nfunction reduceSelectedEvent(currentInstanceId: string, action: Action): string {\n  switch (action.type) {\n    case 'SELECT_EVENT':\n      return action.eventInstanceId\n    case 'UNSELECT_EVENT':\n      return ''\n    default:\n      return currentInstanceId\n  }\n}\n\nfunction reduceEventDrag(currentDrag: EventInteractionState | null, action: Action, sources: EventSourceHash, calendar: Calendar): EventInteractionState | null {\n  switch (action.type) {\n\n    case 'SET_EVENT_DRAG':\n      let newDrag = action.state\n\n      return {\n        affectedEvents: newDrag.affectedEvents,\n        mutatedEvents: newDrag.mutatedEvents,\n        isEvent: newDrag.isEvent,\n        origSeg: newDrag.origSeg\n      }\n\n    case 'UNSET_EVENT_DRAG':\n      return null\n\n    default:\n      return currentDrag\n  }\n}\n\nfunction reduceEventResize(currentResize: EventInteractionState | null, action: Action, sources: EventSourceHash, calendar: Calendar): EventInteractionState | null {\n  switch (action.type) {\n\n    case 'SET_EVENT_RESIZE':\n      let newResize = action.state\n\n      return {\n        affectedEvents: newResize.affectedEvents,\n        mutatedEvents: newResize.mutatedEvents,\n        isEvent: newResize.isEvent,\n        origSeg: newResize.origSeg\n      }\n\n    case 'UNSET_EVENT_RESIZE':\n      return null\n\n    default:\n      return currentResize\n  }\n}\n\nfunction computeLoadingLevel(eventSources: EventSourceHash): number {\n  let cnt = 0\n\n  for (let sourceId in eventSources) {\n    if (eventSources[sourceId].isFetching) {\n      cnt++\n    }\n  }\n\n  return cnt\n}\n","import { DateRange, rangesEqual, OpenDateRange } from '../datelib/date-range'\nimport { DateInput, DateEnv } from '../datelib/env'\nimport { refineProps } from '../util/misc'\nimport { Duration } from '../datelib/duration'\nimport { parseEventDef, createEventInstance } from './event'\nimport { EventRenderRange, compileEventUi } from '../component/event-rendering'\nimport { EventUiHash } from '../component/event-ui'\nimport Calendar from '../Calendar'\n\n/*\nA data-structure for a date-range that will be visually displayed.\nContains other metadata like allDay, and anything else Components might like to store.\n\nTODO: in future, put otherProps in own object.\n*/\n\nexport interface OpenDateSpanInput {\n  start?: DateInput\n  end?: DateInput\n  allDay?: boolean\n  [otherProp: string]: any\n}\n\nexport interface DateSpanInput extends OpenDateSpanInput {\n  start: DateInput\n  end: DateInput\n}\n\nexport interface OpenDateSpan {\n  range: OpenDateRange\n  allDay: boolean\n  [otherProp: string]: any\n}\n\nexport interface DateSpan extends OpenDateSpan {\n  range: DateRange\n}\n\nexport interface DateSpanApi {\n  start: Date\n  end: Date\n  startStr: string\n  endStr: string\n  allDay: boolean\n}\n\nexport interface DatePointApi {\n  date: Date\n  dateStr: string\n  allDay: boolean\n}\n\nconst STANDARD_PROPS = {\n  start: null,\n  end: null,\n  allDay: Boolean\n}\n\nexport function parseDateSpan(raw: DateSpanInput, dateEnv: DateEnv, defaultDuration?: Duration): DateSpan | null {\n  let span = parseOpenDateSpan(raw, dateEnv)\n  let { range } = span\n\n  if (!range.start) {\n    return null\n  }\n\n  if (!range.end) {\n    if (defaultDuration == null) {\n      return null\n    } else {\n      range.end = dateEnv.add(range.start, defaultDuration)\n    }\n  }\n\n  return span as DateSpan\n}\n\n/*\nTODO: somehow combine with parseRange?\nWill return null if the start/end props were present but parsed invalidly.\n*/\nexport function parseOpenDateSpan(raw: OpenDateSpanInput, dateEnv: DateEnv): OpenDateSpan | null {\n  let leftovers = {} as DateSpan\n  let standardProps = refineProps(raw, STANDARD_PROPS, {}, leftovers)\n  let startMeta = standardProps.start ? dateEnv.createMarkerMeta(standardProps.start) : null\n  let endMeta = standardProps.end ? dateEnv.createMarkerMeta(standardProps.end) : null\n  let allDay = standardProps.allDay\n\n  if (allDay == null) {\n    allDay = (startMeta && startMeta.isTimeUnspecified) &&\n      (!endMeta || endMeta.isTimeUnspecified)\n  }\n\n  // use this leftover object as the selection object\n  leftovers.range = {\n    start: startMeta ? startMeta.marker : null,\n    end: endMeta ? endMeta.marker : null\n  }\n  leftovers.allDay = allDay\n\n  return leftovers\n}\n\nexport function isDateSpansEqual(span0: DateSpan, span1: DateSpan): boolean {\n  return rangesEqual(span0.range, span1.range) &&\n    span0.allDay === span1.allDay &&\n    isSpanPropsEqual(span0, span1)\n}\n\n// the NON-DATE-RELATED props\nfunction isSpanPropsEqual(span0: DateSpan, span1: DateSpan): boolean {\n\n  for (let propName in span1) {\n    if (propName !== 'range' && propName !== 'allDay') {\n      if (span0[propName] !== span1[propName]) {\n        return false\n      }\n    }\n  }\n\n  // are there any props that span0 has that span1 DOESN'T have?\n  // both have range/allDay, so no need to special-case.\n  for (let propName in span0) {\n    if (!(propName in span1)) {\n      return false\n    }\n  }\n\n  return true\n}\n\nexport function buildDateSpanApi(span: DateSpan, dateEnv: DateEnv): DateSpanApi {\n  return {\n    start: dateEnv.toDate(span.range.start),\n    end: dateEnv.toDate(span.range.end),\n    startStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\n    endStr: dateEnv.formatIso(span.range.end, { omitTime: span.allDay }),\n    allDay: span.allDay\n  }\n}\n\nexport function buildDatePointApi(span: DateSpan, dateEnv: DateEnv): DatePointApi {\n  return {\n    date: dateEnv.toDate(span.range.start),\n    dateStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\n    allDay: span.allDay\n  }\n}\n\nexport function fabricateEventRange(dateSpan: DateSpan, eventUiBases: EventUiHash, calendar: Calendar): EventRenderRange {\n  let def = parseEventDef(\n    { editable: false },\n    '', // sourceId\n    dateSpan.allDay,\n    true, // hasEnd\n    calendar\n  )\n\n  return {\n    def,\n    ui: compileEventUi(def, eventUiBases),\n    instance: createEventInstance(def.defId, dateSpan.range),\n    range: dateSpan.range,\n    isStart: true,\n    isEnd: true\n  }\n}\n","import { ViewClass, ViewConfigHash } from './view-config'\n\n/*\nRepresents information for an instantiatable View class along with settings\nthat are specific to that view. No other settings, like calendar-wide settings, are stored.\n*/\nexport interface ViewDef {\n  type: string\n  class: ViewClass\n  overrides: any\n  defaults: any\n}\n\nexport type ViewDefHash = { [viewType: string]: ViewDef }\n\nexport function compileViewDefs(defaultConfigs: ViewConfigHash, overrideConfigs: ViewConfigHash): ViewDefHash {\n  let hash: ViewDefHash = {}\n  let viewType: string\n\n  for (viewType in defaultConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs)\n  }\n\n  for (viewType in overrideConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs)\n  }\n\n  return hash\n}\n\nfunction ensureViewDef(viewType: string, hash: ViewDefHash, defaultConfigs: ViewConfigHash, overrideConfigs: ViewConfigHash): ViewDef | null {\n  if (hash[viewType]) {\n    return hash[viewType]\n  }\n\n  let viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs)\n\n  if (viewDef) {\n    hash[viewType] = viewDef\n  }\n\n  return viewDef\n}\n\nfunction buildViewDef(viewType: string, hash: ViewDefHash, defaultConfigs: ViewConfigHash, overrideConfigs: ViewConfigHash): ViewDef | null {\n  let defaultConfig = defaultConfigs[viewType]\n  let overrideConfig = overrideConfigs[viewType]\n\n  let queryProp = function(name) {\n    return (defaultConfig && defaultConfig[name] !== null) ? defaultConfig[name] :\n      ((overrideConfig && overrideConfig[name] !== null) ? overrideConfig[name] : null)\n  }\n\n  let theClass = queryProp('class') as ViewClass\n  let superType = queryProp('superType') as string\n\n  if (!superType && theClass) {\n    superType =\n      findViewNameBySubclass(theClass, overrideConfigs) ||\n      findViewNameBySubclass(theClass, defaultConfigs)\n  }\n\n  let superDef: ViewDef | null = null\n\n  if (superType) {\n\n    if (superType === viewType) {\n      throw new Error('Can\\'t have a custom view type that references itself')\n    }\n\n    superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs)\n  }\n\n  if (!theClass && superDef) {\n    theClass = superDef.class\n  }\n\n  if (!theClass) {\n    return null // don't throw a warning, might be settings for a single-unit view\n  }\n\n  return {\n    type: viewType,\n    class: theClass,\n    defaults: {\n      ...(superDef ? superDef.defaults : {}),\n      ...(defaultConfig ? defaultConfig.options : {})\n    },\n    overrides: {\n      ...(superDef ? superDef.overrides : {}),\n      ...(overrideConfig ? overrideConfig.options : {})\n    }\n  }\n}\n\nfunction findViewNameBySubclass(viewSubclass: ViewClass, configs: ViewConfigHash): string {\n  let superProto = Object.getPrototypeOf(viewSubclass.prototype)\n\n  for (let viewType in configs) {\n    let parsed = configs[viewType]\n\n    // need DIRECT subclass, so instanceof won't do it\n    if (parsed.class && parsed.class.prototype === superProto) {\n      return viewType\n    }\n  }\n\n  return ''\n}\n","import View from '../View'\nimport { ViewSpec } from './view-spec'\nimport { refineProps } from '../util/misc'\nimport { mapHash } from '../util/object'\nimport { ComponentContext } from '../component/Component'\nimport DateProfileGenerator from '../DateProfileGenerator'\n\n/*\nA view-config represents information for either:\nA) creating a new instantiatable view class. in which case, supplied a class/type in addition to options, OR\nB) options to customize an existing view, in which case only provides options.\n*/\n\nexport type ViewClass = new(\n  context: ComponentContext,\n  viewSpec: ViewSpec,\n  dateProfileGenerator:\n  DateProfileGenerator,\n  parentEl: HTMLElement\n) => View\n\nexport interface ViewConfigObjectInput {\n  type?: string\n  class?: ViewClass\n  [optionName: string]: any\n}\n\nexport type ViewConfigInput = ViewClass | ViewConfigObjectInput\nexport type ViewConfigInputHash = { [viewType: string]: ViewConfigInput }\n\nexport interface ViewConfig {\n  superType: string\n  class: ViewClass | null\n  options: any\n}\n\nexport type ViewConfigHash = { [viewType: string]: ViewConfig }\n\nexport function parseViewConfigs(inputs: ViewConfigInputHash): ViewConfigHash {\n  return mapHash(inputs, parseViewConfig)\n}\n\nconst VIEW_DEF_PROPS = {\n  type: String,\n  class: null\n}\n\nfunction parseViewConfig(input: ViewConfigInput): ViewConfig {\n  if (typeof input === 'function') {\n    input = { class: input }\n  }\n\n  let options = {}\n  let props = refineProps(input, VIEW_DEF_PROPS, {}, options)\n\n  return {\n    superType: props.type,\n    class: props.class,\n    options\n  }\n}\n","import { ViewDef, compileViewDefs } from './view-def'\nimport { Duration, createDuration, greatestDurationDenominator, getWeeksFromInput } from '../datelib/duration'\nimport OptionsManager from '../OptionsManager'\nimport { mapHash } from '../util/object'\nimport { globalDefaults } from '../options'\nimport { ViewConfigInputHash, parseViewConfigs, ViewConfigHash, ViewClass } from './view-config'\n\n/*\nRepresents everything needed to instantiate a new view instance,\nincluding options that have been compiled from view-specific and calendar-wide options,\nas well as duration information.\n\nOverall flow:\nViewConfig -> ViewDef -> ViewSpec\n*/\nexport interface ViewSpec {\n  type: string\n  class: ViewClass\n  duration: Duration\n  durationUnit: string\n  singleUnit: string\n  options: any\n  buttonTextOverride: string\n  buttonTextDefault: string\n}\n\nexport type ViewSpecHash = { [viewType: string]: ViewSpec }\n\nexport function buildViewSpecs(defaultInputs: ViewConfigInputHash, optionsManager: OptionsManager): ViewSpecHash {\n  let defaultConfigs = parseViewConfigs(defaultInputs)\n  let overrideConfigs = parseViewConfigs(optionsManager.overrides.views)\n  let viewDefs = compileViewDefs(defaultConfigs, overrideConfigs)\n\n  return mapHash(viewDefs, function(viewDef) {\n    return buildViewSpec(viewDef, overrideConfigs, optionsManager)\n  })\n}\n\nfunction buildViewSpec(viewDef: ViewDef, overrideConfigs: ViewConfigHash, optionsManager: OptionsManager): ViewSpec {\n  let durationInput =\n    viewDef.overrides.duration ||\n    viewDef.defaults.duration ||\n    optionsManager.dynamicOverrides.duration ||\n    optionsManager.overrides.duration\n\n  let duration = null\n  let durationUnit = ''\n  let singleUnit = ''\n  let singleUnitOverrides = {}\n\n  if (durationInput) {\n    duration = createDuration(durationInput)\n\n    if (duration) { // valid?\n      let denom = greatestDurationDenominator(\n        duration,\n        !getWeeksFromInput(durationInput)\n      )\n\n      durationUnit = denom.unit\n\n      if (denom.value === 1) {\n        singleUnit = durationUnit\n        singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].options : {}\n      }\n    }\n  }\n\n  let queryButtonText = function(options) {\n    let buttonTextMap = options.buttonText || {}\n    let buttonTextKey = viewDef.defaults.buttonTextKey\n\n    if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n      return buttonTextMap[buttonTextKey]\n    }\n\n    if (buttonTextMap[viewDef.type] != null) {\n      return buttonTextMap[viewDef.type]\n    }\n\n    if (buttonTextMap[singleUnit] != null) {\n      return buttonTextMap[singleUnit]\n    }\n  }\n\n  return {\n    type: viewDef.type,\n    class: viewDef.class,\n    duration,\n    durationUnit,\n    singleUnit,\n\n    options: {\n      ...globalDefaults,\n      ...viewDef.defaults,\n      ...optionsManager.dirDefaults,\n      ...optionsManager.localeDefaults,\n      ...optionsManager.overrides,\n      ...singleUnitOverrides,\n      ...viewDef.overrides,\n      ...optionsManager.dynamicOverrides\n    },\n\n    buttonTextOverride:\n      queryButtonText(optionsManager.dynamicOverrides) ||\n      queryButtonText(optionsManager.overrides) || // constructor-specified buttonText lookup hash takes precedence\n      viewDef.overrides.buttonText, // `buttonText` for view-specific options is a string\n\n    buttonTextDefault:\n      queryButtonText(optionsManager.localeDefaults) ||\n      queryButtonText(optionsManager.dirDefaults) ||\n      viewDef.defaults.buttonText ||\n      queryButtonText(globalDefaults) ||\n      viewDef.type // fall back to given view name\n  }\n}\n","import { htmlEscape } from './util/html'\nimport { htmlToElement, appendToElement, findElements, createElement, removeElement } from './util/dom-manip'\nimport Component, { ComponentContext } from './component/Component'\nimport { ViewSpec } from './structs/view-spec'\nimport { memoizeRendering } from './component/memoized-rendering'\n\n/* Toolbar with buttons and title\n----------------------------------------------------------------------------------------------------------------------*/\n\nexport interface ToolbarRenderProps {\n  layout: any\n  title: string\n  activeButton: string\n  isTodayEnabled: boolean\n  isPrevEnabled: boolean\n  isNextEnabled: boolean\n}\n\nexport default class Toolbar extends Component<ToolbarRenderProps> {\n\n  el: HTMLElement\n  viewsWithButtons: any\n\n  private _renderLayout = memoizeRendering(this.renderLayout, this.unrenderLayout)\n  private _updateTitle = memoizeRendering(this.updateTitle, null, [ this._renderLayout ])\n  private _updateActiveButton = memoizeRendering(this.updateActiveButton, null, [ this._renderLayout ])\n  private _updateToday = memoizeRendering(this.updateToday, null, [ this._renderLayout ])\n  private _updatePrev = memoizeRendering(this.updatePrev, null, [ this._renderLayout ])\n  private _updateNext = memoizeRendering(this.updateNext, null, [ this._renderLayout ])\n\n\n  constructor(context: ComponentContext, extraClassName) {\n    super(context)\n\n    this.el = createElement('div', { className: 'fc-toolbar ' + extraClassName })\n  }\n\n\n  destroy() {\n    super.destroy()\n\n    this._renderLayout.unrender() // should unrender everything else\n    removeElement(this.el)\n  }\n\n\n  render(props: ToolbarRenderProps) {\n    this._renderLayout(props.layout)\n    this._updateTitle(props.title)\n    this._updateActiveButton(props.activeButton)\n    this._updateToday(props.isTodayEnabled)\n    this._updatePrev(props.isPrevEnabled)\n    this._updateNext(props.isNextEnabled)\n  }\n\n\n  renderLayout(layout) {\n    let { el } = this\n\n    this.viewsWithButtons = []\n\n    appendToElement(el, this.renderSection('left', layout.left))\n    appendToElement(el, this.renderSection('center', layout.center))\n    appendToElement(el, this.renderSection('right', layout.right))\n  }\n\n\n  unrenderLayout() {\n    this.el.innerHTML = ''\n  }\n\n\n  renderSection(position, buttonStr) {\n    let { theme, calendar } = this\n    let optionsManager = calendar.optionsManager\n    let viewSpecs = calendar.viewSpecs\n    let sectionEl = createElement('div', { className: 'fc-' + position })\n    let calendarCustomButtons = optionsManager.computed.customButtons || {}\n    let calendarButtonTextOverrides = optionsManager.overrides.buttonText || {}\n    let calendarButtonText = optionsManager.computed.buttonText || {}\n\n    if (buttonStr) {\n      buttonStr.split(' ').forEach((buttonGroupStr, i) => {\n        let groupChildren = []\n        let isOnlyButtons = true\n        let groupEl\n\n        buttonGroupStr.split(',').forEach((buttonName, j) => {\n          let customButtonProps\n          let viewSpec: ViewSpec\n          let buttonClick\n          let buttonIcon // only one of these will be set\n          let buttonText // \"\n          let buttonInnerHtml\n          let buttonClasses\n          let buttonEl: HTMLElement\n          let buttonAriaAttr\n\n          if (buttonName === 'title') {\n            groupChildren.push(htmlToElement('<h2>&nbsp;</h2>')) // we always want it to take up height\n            isOnlyButtons = false\n          } else {\n\n            if ((customButtonProps = calendarCustomButtons[buttonName])) {\n              buttonClick = function(ev) {\n                if (customButtonProps.click) {\n                  customButtonProps.click.call(buttonEl, ev)\n                }\n              };\n              (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) ||\n              (buttonIcon = theme.getIconClass(buttonName)) ||\n              (buttonText = customButtonProps.text)\n            } else if ((viewSpec = viewSpecs[buttonName])) {\n              this.viewsWithButtons.push(buttonName)\n              buttonClick = function() {\n                calendar.changeView(buttonName)\n              };\n              (buttonText = viewSpec.buttonTextOverride) ||\n              (buttonIcon = theme.getIconClass(buttonName)) ||\n              (buttonText = viewSpec.buttonTextDefault)\n            } else if (calendar[buttonName]) { // a calendar method\n              buttonClick = function() {\n                calendar[buttonName]()\n              };\n              (buttonText = calendarButtonTextOverrides[buttonName]) ||\n              (buttonIcon = theme.getIconClass(buttonName)) ||\n              (buttonText = calendarButtonText[buttonName])\n              //            ^ everything else is considered default\n            }\n\n            if (buttonClick) {\n\n              buttonClasses = [\n                'fc-' + buttonName + '-button',\n                theme.getClass('button')\n              ]\n\n              if (buttonText) {\n                buttonInnerHtml = htmlEscape(buttonText)\n                buttonAriaAttr = ''\n              } else if (buttonIcon) {\n                buttonInnerHtml = \"<span class='\" + buttonIcon + \"'></span>\"\n                buttonAriaAttr = ' aria-label=\"' + buttonName + '\"'\n              }\n\n              buttonEl = htmlToElement( // type=\"button\" so that it doesn't submit a form\n                '<button type=\"button\" class=\"' + buttonClasses.join(' ') + '\"' +\n                  buttonAriaAttr +\n                '>' + buttonInnerHtml + '</button>'\n              )\n\n              buttonEl.addEventListener('click', buttonClick)\n\n              groupChildren.push(buttonEl)\n            }\n          }\n        })\n\n        if (groupChildren.length > 1) {\n          groupEl = document.createElement('div')\n\n          let buttonGroupClassName = theme.getClass('buttonGroup')\n          if (isOnlyButtons && buttonGroupClassName) {\n            groupEl.classList.add(buttonGroupClassName)\n          }\n\n          appendToElement(groupEl, groupChildren)\n          sectionEl.appendChild(groupEl)\n        } else {\n          appendToElement(sectionEl, groupChildren) // 1 or 0 children\n        }\n      })\n    }\n\n    return sectionEl\n  }\n\n\n  updateToday(isTodayEnabled) {\n    this.toggleButtonEnabled('today', isTodayEnabled)\n  }\n\n\n  updatePrev(isPrevEnabled) {\n    this.toggleButtonEnabled('prev', isPrevEnabled)\n  }\n\n\n  updateNext(isNextEnabled) {\n    this.toggleButtonEnabled('next', isNextEnabled)\n  }\n\n\n  updateTitle(text) {\n    findElements(this.el, 'h2').forEach(function(titleEl) {\n      titleEl.innerText = text\n    })\n  }\n\n\n  updateActiveButton(buttonName?) {\n    let className = this.theme.getClass('buttonActive')\n\n    findElements(this.el, 'button').forEach((buttonEl) => { // fyi, themed buttons don't have .fc-button\n      if (buttonName && buttonEl.classList.contains('fc-' + buttonName + '-button')) {\n        buttonEl.classList.add(className)\n      } else {\n        buttonEl.classList.remove(className)\n      }\n    })\n  }\n\n\n  toggleButtonEnabled(buttonName, bool) {\n    findElements(this.el, '.fc-' + buttonName + '-button').forEach((buttonEl: HTMLButtonElement) => {\n      buttonEl.disabled = !bool\n    })\n  }\n\n}\n","import Component, { ComponentContext } from './component/Component'\nimport { ViewSpec } from './structs/view-spec'\nimport View from './View'\nimport Toolbar from './Toolbar'\nimport DateProfileGenerator, { DateProfile } from './DateProfileGenerator'\nimport { prependToElement, createElement, removeElement, appendToElement, applyStyle } from './util/dom-manip'\nimport { rangeContainsMarker, DateRange } from './datelib/date-range'\nimport { EventStore } from './structs/event-store'\nimport { EventUiHash } from './component/event-ui'\nimport { BusinessHoursInput, parseBusinessHours } from './structs/business-hours'\nimport { memoize } from './util/memoize'\nimport { computeHeightAndMargins } from './util/dom-geom'\nimport { createFormatter } from './datelib/formatting'\nimport { diffWholeDays, DateMarker } from './datelib/marker'\nimport { memoizeRendering } from './component/memoized-rendering'\nimport { CalendarState } from './reducers/types'\nimport { ViewPropsTransformerClass } from './plugin-system'\nimport { __assign } from 'tslib'\n\nexport interface CalendarComponentProps extends CalendarState {\n  viewSpec: ViewSpec\n  dateProfileGenerator: DateProfileGenerator // for the current view\n  eventUiBases: EventUiHash\n}\n\nexport default class CalendarComponent extends Component<CalendarComponentProps> {\n\n  view: View\n  header: Toolbar\n  footer: Toolbar\n\n  computeTitle: (dateProfile, viewOptions) => string\n  parseBusinessHours: (input: BusinessHoursInput) => EventStore\n\n  el: HTMLElement\n  contentEl: HTMLElement\n\n  isHeightAuto: boolean\n  viewHeight: number\n\n  private _renderToolbars = memoizeRendering(this.renderToolbars)\n  private buildViewPropTransformers = memoize(buildViewPropTransformers)\n\n\n  constructor(context: ComponentContext, el: HTMLElement) {\n    super(context)\n\n    this.el = el\n\n    prependToElement(\n      el,\n      this.contentEl = createElement('div', { className: 'fc-view-container' })\n    )\n\n    let { calendar } = this\n    for (let modifyViewContainer of calendar.pluginSystem.hooks.viewContainerModifiers) {\n      modifyViewContainer(this.contentEl, calendar)\n    }\n\n    this.toggleElClassNames(true)\n\n    this.computeTitle = memoize(computeTitle)\n\n    this.parseBusinessHours = memoize((input) => {\n      return parseBusinessHours(input, this.calendar)\n    })\n  }\n\n  destroy() {\n    if (this.header) {\n      this.header.destroy()\n    }\n\n    if (this.footer) {\n      this.footer.destroy()\n    }\n\n    if (this.view) {\n      this.view.destroy()\n    }\n\n    removeElement(this.contentEl)\n    this.toggleElClassNames(false)\n\n    super.destroy()\n  }\n\n  toggleElClassNames(bool: boolean) {\n    let classList = this.el.classList\n    let dirClassName = 'fc-' + this.opt('dir')\n    let themeClassName = this.theme.getClass('widget')\n\n    if (bool) {\n      classList.add('fc')\n      classList.add(dirClassName)\n      classList.add(themeClassName)\n    } else {\n      classList.remove('fc')\n      classList.remove(dirClassName)\n      classList.remove(themeClassName)\n    }\n  }\n\n  render(props: CalendarComponentProps) {\n    this.freezeHeight()\n\n    let title = this.computeTitle(props.dateProfile, props.viewSpec.options)\n    this._renderToolbars(props.viewSpec, props.dateProfile, props.currentDate, props.dateProfileGenerator, title)\n    this.renderView(props, title)\n\n    this.updateSize()\n    this.thawHeight()\n  }\n\n  renderToolbars(viewSpec: ViewSpec, dateProfile: DateProfile, currentDate: DateMarker, dateProfileGenerator: DateProfileGenerator, title: string) {\n    let headerLayout = this.opt('header')\n    let footerLayout = this.opt('footer')\n\n    let now = this.calendar.getNow()\n    let todayInfo = dateProfileGenerator.build(now)\n    let prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate)\n    let nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate)\n\n    let toolbarProps = {\n      title,\n      activeButton: viewSpec.type,\n      isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n      isPrevEnabled: prevInfo.isValid,\n      isNextEnabled: nextInfo.isValid\n    }\n\n    if (headerLayout) {\n      if (!this.header) {\n        this.header = new Toolbar(this.context, 'fc-header-toolbar')\n        prependToElement(this.el, this.header.el)\n      }\n      this.header.receiveProps({\n        layout: headerLayout,\n        ...toolbarProps\n      })\n    } else if (this.header) {\n      this.header.destroy()\n      this.header = null\n    }\n\n    if (footerLayout) {\n      if (!this.footer) {\n        this.footer = new Toolbar(this.context, 'fc-footer-toolbar')\n        appendToElement(this.el, this.footer.el)\n      }\n      this.footer.receiveProps({\n        layout: footerLayout,\n        ...toolbarProps\n      })\n    } else if (this.footer) {\n      this.footer.destroy()\n      this.footer = null\n    }\n  }\n\n  renderView(props: CalendarComponentProps, title: string) {\n    let { view } = this\n    let { viewSpec, dateProfileGenerator } = props\n\n    if (!view || view.viewSpec !== viewSpec) {\n\n      if (view) {\n        view.destroy()\n      }\n\n      view = this.view = new viewSpec['class'](\n        {\n          calendar: this.calendar,\n          view: null, // HACK. will get populated by Component\n          dateEnv: this.dateEnv,\n          theme: this.theme,\n          options: viewSpec.options\n        },\n        viewSpec,\n        dateProfileGenerator,\n        this.contentEl\n      )\n    } else {\n      view.addScroll(view.queryScroll())\n    }\n\n    view.title = title // for the API\n\n    let viewProps = {\n      dateProfile: props.dateProfile,\n      businessHours: this.parseBusinessHours(viewSpec.options.businessHours),\n      eventStore: props.eventStore,\n      eventUiBases: props.eventUiBases,\n      dateSelection: props.dateSelection,\n      eventSelection: props.eventSelection,\n      eventDrag: props.eventDrag,\n      eventResize: props.eventResize\n    }\n\n    let transformers = this.buildViewPropTransformers(this.calendar.pluginSystem.hooks.viewPropsTransformers)\n\n    for (let transformer of transformers) {\n      __assign(\n        viewProps,\n        transformer.transform(viewProps, viewSpec, props, view)\n      )\n    }\n\n    view.receiveProps(viewProps)\n  }\n\n\n  // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n  updateSize(isResize = false) {\n    let { view } = this\n\n    if (isResize) {\n      view.addScroll(view.queryScroll())\n    }\n\n    if (isResize || this.isHeightAuto == null) {\n      this.computeHeightVars()\n    }\n\n    view.updateSize(isResize, this.viewHeight, this.isHeightAuto)\n    view.updateNowIndicator() // we need to guarantee this will run after updateSize\n    view.popScroll(isResize)\n  }\n\n  computeHeightVars() {\n    let { calendar } = this // yuck. need to handle dynamic options\n    let heightInput = calendar.opt('height')\n    let contentHeightInput = calendar.opt('contentHeight')\n\n    this.isHeightAuto = heightInput === 'auto' || contentHeightInput === 'auto'\n\n    if (typeof contentHeightInput === 'number') { // exists and not 'auto'\n      this.viewHeight = contentHeightInput\n    } else if (typeof contentHeightInput === 'function') { // exists and is a function\n      this.viewHeight = contentHeightInput()\n    } else if (typeof heightInput === 'number') { // exists and not 'auto'\n      this.viewHeight = heightInput - this.queryToolbarsHeight()\n    } else if (typeof heightInput === 'function') { // exists and is a function\n      this.viewHeight = heightInput() - this.queryToolbarsHeight()\n    } else if (heightInput === 'parent') { // set to height of parent element\n      let parentEl = this.el.parentNode as HTMLElement\n      this.viewHeight = parentEl.getBoundingClientRect().height - this.queryToolbarsHeight()\n    } else {\n      this.viewHeight = Math.round(\n        this.contentEl.getBoundingClientRect().width /\n        Math.max(calendar.opt('aspectRatio'), .5)\n      )\n    }\n  }\n\n  queryToolbarsHeight() {\n    let height = 0\n\n    if (this.header) {\n      height += computeHeightAndMargins(this.header.el)\n    }\n\n    if (this.footer) {\n      height += computeHeightAndMargins(this.footer.el)\n    }\n\n    return height\n  }\n\n\n  // Height \"Freezing\"\n  // -----------------------------------------------------------------------------------------------------------------\n\n  freezeHeight() {\n    applyStyle(this.el, {\n      height: this.el.getBoundingClientRect().height,\n      overflow: 'hidden'\n    })\n  }\n\n  thawHeight() {\n    applyStyle(this.el, {\n      height: '',\n      overflow: ''\n    })\n  }\n\n}\n\n\n// Title and Date Formatting\n// -----------------------------------------------------------------------------------------------------------------\n\n// Computes what the title at the top of the calendar should be for this view\nfunction computeTitle(dateProfile, viewOptions) {\n  let range: DateRange\n\n  // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n  if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n    range = dateProfile.currentRange\n  } else { // for day units or smaller, use the actual day range\n    range = dateProfile.activeRange\n  }\n\n  return this.dateEnv.formatRange(\n    range.start,\n    range.end,\n    createFormatter(\n      viewOptions.titleFormat || computeTitleFormat(dateProfile),\n      viewOptions.titleRangeSeparator\n    ),\n    { isEndExclusive: dateProfile.isRangeAllDay }\n  )\n}\n\n\n// Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\nfunction computeTitleFormat(dateProfile) {\n  let currentRangeUnit = dateProfile.currentRangeUnit\n\n  if (currentRangeUnit === 'year') {\n    return { year: 'numeric' }\n  } else if (currentRangeUnit === 'month') {\n    return { year: 'numeric', month: 'long' } // like \"September 2014\"\n  } else {\n    let days = diffWholeDays(\n      dateProfile.currentRange.start,\n      dateProfile.currentRange.end\n    )\n    if (days !== null && days > 1) {\n      // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n      return { year: 'numeric', month: 'short', day: 'numeric' }\n    } else {\n      // one day. longer, like \"September 9 2014\"\n      return { year: 'numeric', month: 'long', day: 'numeric' }\n    }\n  }\n}\n\n\n// Plugin\n// -----------------------------------------------------------------------------------------------------------------\n\nfunction buildViewPropTransformers(theClasses: ViewPropsTransformerClass[]) {\n  return theClasses.map(function(theClass) {\n    return new theClass()\n  })\n}\n","import DateComponent from '../component/DateComponent'\n\n\nexport abstract class Interaction {\n\n  component: DateComponent<any>\n\n  constructor(settings: InteractionSettings) {\n    this.component = settings.component\n  }\n\n  destroy() {\n  }\n\n}\n\nexport type InteractionClass = { new(settings: InteractionSettings): Interaction }\n\n\nexport interface InteractionSettingsInput {\n  el: HTMLElement\n  useEventCenter?: boolean\n  // TODO: add largeUnit\n}\n\nexport interface InteractionSettings {\n  component: DateComponent<any>\n  el: HTMLElement\n  useEventCenter: boolean\n}\n\nexport type InteractionSettingsStore = { [componenUid: string]: InteractionSettings }\n\nexport function parseInteractionSettings(component: DateComponent<any>, input: InteractionSettingsInput): InteractionSettings {\n  return {\n    component: component,\n    el: input.el,\n    useEventCenter: input.useEventCenter != null ? input.useEventCenter : true\n  }\n}\n\nexport function interactionSettingsToStore(settings: InteractionSettings) {\n  return {\n    [settings.component.uid]: settings\n  }\n}\n\n\n\n// global state\nexport let interactionSettingsStore: InteractionSettingsStore = {}\n","import { listenBySelector } from '../util/dom-event'\nimport EventApi from '../api/EventApi'\nimport { elementClosest } from '../util/dom-manip'\nimport { getElSeg } from '../component/event-rendering'\nimport { Interaction, InteractionSettings } from './interaction'\n\n/*\nDetects when the user clicks on an event within a DateComponent\n*/\nexport default class EventClicking extends Interaction {\n\n  constructor(settings: InteractionSettings) {\n    super(settings)\n    let { component } = settings\n\n    this.destroy = listenBySelector(\n      component.el,\n      'click',\n      component.fgSegSelector + ',' + component.bgSegSelector,\n      this.handleSegClick\n    )\n  }\n\n  handleSegClick = (ev: Event, segEl: HTMLElement) => {\n    let { component } = this\n    let seg = getElSeg(segEl)\n\n    if (\n      seg && // might be the <div> surrounding the more link\n      component.isValidSegDownEl(ev.target as HTMLElement)\n    ) {\n\n      // our way to simulate a link click for elements that can't be <a> tags\n      // grab before trigger fired in case trigger trashes DOM thru rerendering\n      let hasUrlContainer = elementClosest(ev.target as HTMLElement, '.fc-has-url')\n      let url = hasUrlContainer ? (hasUrlContainer.querySelector('a[href]') as any).href : ''\n\n      component.publiclyTrigger('eventClick', [\n        {\n          el: segEl,\n          event: new EventApi(\n            component.calendar,\n            seg.eventRange.def,\n            seg.eventRange.instance\n          ),\n          jsEvent: ev as MouseEvent, // Is this always a mouse event? See #4655\n          view: component.view\n        }\n      ])\n\n      if (url && !ev.defaultPrevented) {\n        window.location.href = url\n      }\n    }\n  }\n\n}\n","import { listenToHoverBySelector } from '../util/dom-event'\nimport EventApi from '../api/EventApi'\nimport { getElSeg } from '../component/event-rendering'\nimport { Interaction, InteractionSettings } from './interaction'\n\n/*\nTriggers events and adds/removes core classNames when the user's pointer\nenters/leaves event-elements of a component.\n*/\nexport default class EventHovering extends Interaction {\n\n  removeHoverListeners: () => void\n  currentSegEl: HTMLElement\n\n  constructor(settings: InteractionSettings) {\n    super(settings)\n    let { component } = settings\n\n    this.removeHoverListeners = listenToHoverBySelector(\n      component.el,\n      component.fgSegSelector + ',' + component.bgSegSelector,\n      this.handleSegEnter,\n      this.handleSegLeave\n    )\n\n    component.calendar.on('eventElRemove', this.handleEventElRemove)\n  }\n\n  destroy() {\n    this.removeHoverListeners()\n    this.component.calendar.off('eventElRemove', this.handleEventElRemove)\n  }\n\n  // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n  handleEventElRemove = (el: HTMLElement) => {\n    if (el === this.currentSegEl) {\n      this.handleSegLeave(null, this.currentSegEl)\n    }\n  }\n\n  handleSegEnter = (ev: Event, segEl: HTMLElement) => {\n    if (getElSeg(segEl)) { // TODO: better way to make sure not hovering over more+ link or its wrapper\n      segEl.classList.add('fc-allow-mouse-resize')\n      this.currentSegEl = segEl\n      this.triggerEvent('eventMouseEnter', ev, segEl)\n    }\n  }\n\n  handleSegLeave = (ev: Event | null, segEl: HTMLElement) => {\n    if (this.currentSegEl) {\n      segEl.classList.remove('fc-allow-mouse-resize')\n      this.currentSegEl = null\n      this.triggerEvent('eventMouseLeave', ev, segEl)\n    }\n  }\n\n  triggerEvent(publicEvName: 'eventMouseEnter' | 'eventMouseLeave', ev: Event | null, segEl: HTMLElement) {\n    let { component } = this\n    let seg = getElSeg(segEl)!\n\n    if (!ev || component.isValidSegDownEl(ev.target as HTMLElement)) {\n      component.publiclyTrigger(publicEvName, [\n        {\n          el: segEl,\n          event: new EventApi(\n            this.component.calendar,\n            seg.eventRange.def,\n            seg.eventRange.instance\n          ),\n          jsEvent: ev as MouseEvent, // Is this always a mouse event? See #4655\n          view: component.view\n        }\n      ])\n    }\n  }\n\n}\n","import Theme from './Theme'\n\nexport default class StandardTheme extends Theme {\n}\n\nStandardTheme.prototype.classes = {\n  widget: 'fc-unthemed',\n  widgetHeader: 'fc-widget-header',\n  widgetContent: 'fc-widget-content',\n\n  buttonGroup: 'fc-button-group',\n  button: 'fc-button fc-button-primary',\n  buttonActive: 'fc-button-active',\n\n  popoverHeader: 'fc-widget-header',\n  popoverContent: 'fc-widget-content',\n\n  // day grid\n  headerRow: 'fc-widget-header',\n  dayRow: 'fc-widget-content',\n\n  // list view\n  listView: 'fc-widget-content'\n}\n\nStandardTheme.prototype.baseIconClass = 'fc-icon'\nStandardTheme.prototype.iconClasses = {\n  close: 'fc-icon-x',\n  prev: 'fc-icon-chevron-left',\n  next: 'fc-icon-chevron-right',\n  prevYear: 'fc-icon-chevrons-left',\n  nextYear: 'fc-icon-chevrons-right'\n}\n\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons'\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon'\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-'\n","import { listenBySelector } from './util/dom-event'\nimport { capitaliseFirstLetter, debounce } from './util/misc'\nimport { default as EmitterMixin, EmitterInterface } from './common/EmitterMixin'\nimport OptionsManager from './OptionsManager'\nimport View from './View'\nimport Theme from './theme/Theme'\nimport { OptionsInput, EventHandlerName, EventHandlerArgs } from './types/input-types'\nimport { Locale, buildLocale, parseRawLocales, RawLocaleMap } from './datelib/locale'\nimport { DateEnv, DateInput } from './datelib/env'\nimport { DateMarker, startOfDay } from './datelib/marker'\nimport { createFormatter } from './datelib/formatting'\nimport { Duration, createDuration, DurationInput } from './datelib/duration'\nimport reduce from './reducers/main'\nimport { parseDateSpan, DateSpanInput, DateSpan, buildDateSpanApi, DateSpanApi, buildDatePointApi, DatePointApi } from './structs/date-span'\nimport { memoize, memoizeOutput } from './util/memoize'\nimport { mapHash, isPropsEqual } from './util/object'\nimport { DateRangeInput } from './datelib/date-range'\nimport DateProfileGenerator from './DateProfileGenerator'\nimport { EventSourceInput, parseEventSource, EventSourceHash } from './structs/event-source'\nimport { EventInput, parseEvent, EventDefHash } from './structs/event'\nimport { CalendarState, Action } from './reducers/types'\nimport EventSourceApi from './api/EventSourceApi'\nimport EventApi from './api/EventApi'\nimport { createEmptyEventStore, EventStore, eventTupleToStore } from './structs/event-store'\nimport { processScopedUiProps, EventUiHash, EventUi } from './component/event-ui'\nimport { buildViewSpecs, ViewSpecHash, ViewSpec } from './structs/view-spec'\nimport { PluginSystem } from './plugin-system'\nimport CalendarComponent from './CalendarComponent'\nimport { __assign } from 'tslib'\nimport { refinePluginDefs } from './options'\nimport DateComponent from './component/DateComponent'\nimport { PointerDragEvent } from './interactions/pointer'\nimport { InteractionSettingsInput, parseInteractionSettings, Interaction, interactionSettingsStore, InteractionClass } from './interactions/interaction'\nimport EventClicking from './interactions/EventClicking'\nimport EventHovering from './interactions/EventHovering'\nimport StandardTheme from './theme/StandardTheme'\nimport { CmdFormatterFunc } from './datelib/formatting-cmd'\nimport { NamedTimeZoneImplClass } from './datelib/timezone'\n\nexport interface DateClickApi extends DatePointApi {\n  dayEl: HTMLElement\n  jsEvent: UIEvent\n  view: View\n}\n\nexport interface DateSelectionApi extends DateSpanApi {\n  jsEvent: UIEvent\n  view: View\n}\n\nexport type DatePointTransform = (dateSpan: DateSpan, calendar: Calendar) => any\nexport type DateSpanTransform = (dateSpan: DateSpan, calendar: Calendar) => any\n\nexport type CalendarInteraction = { destroy() }\nexport type CalendarInteractionClass = { new(calendar: Calendar): CalendarInteraction }\n\nexport type OptionChangeHandler = (propValue: any, calendar: Calendar, deepEqual) => void\nexport type OptionChangeHandlerMap = { [propName: string]: OptionChangeHandler }\n\nexport default class Calendar {\n\n  // global handler registry\n  static on: EmitterInterface['on']\n  static off: EmitterInterface['off']\n  static trigger: EmitterInterface['trigger']\n\n  on: EmitterInterface['on']\n  one: EmitterInterface['one']\n  off: EmitterInterface['off']\n  trigger: EmitterInterface['trigger']\n  triggerWith: EmitterInterface['triggerWith']\n  hasHandlers: EmitterInterface['hasHandlers']\n\n  private parseRawLocales = memoize(parseRawLocales)\n  private buildLocale = memoize(buildLocale)\n  private buildDateEnv = memoize(buildDateEnv)\n  private buildTheme = memoize(buildTheme)\n  private buildEventUiSingleBase = memoize(this._buildEventUiSingleBase)\n  private buildSelectionConfig = memoize(this._buildSelectionConfig)\n  private buildEventUiBySource = memoizeOutput(buildEventUiBySource, isPropsEqual)\n  private buildEventUiBases = memoize(buildEventUiBases)\n\n  eventUiBases: EventUiHash // solely for validation system\n  selectionConfig: EventUi // doesn't need all the info EventUi provides. only validation-related. TODO: separate data structs\n\n  optionsManager: OptionsManager\n  viewSpecs: ViewSpecHash\n  dateProfileGenerators: { [viewName: string]: DateProfileGenerator }\n  theme: Theme\n  dateEnv: DateEnv\n  availableRawLocales: RawLocaleMap\n  pluginSystem: PluginSystem\n  defaultAllDayEventDuration: Duration\n  defaultTimedEventDuration: Duration\n\n  calendarInteractions: CalendarInteraction[]\n  interactionsStore: { [componentUid: string]: Interaction[] } = {}\n  removeNavLinkListener: any\n\n  windowResizeProxy: any\n  isHandlingWindowResize: boolean\n\n  state: CalendarState\n  actionQueue = []\n  isReducing: boolean = false\n\n  // isDisplaying: boolean = false // installed in DOM? accepting renders?\n  needsRerender: boolean = false // needs a render?\n  needsFullRerender: boolean = false\n  isRendering: boolean = false // currently in the executeRender function?\n  renderingPauseDepth: number = 0\n  renderableEventStore: EventStore\n  buildDelayedRerender = memoize(buildDelayedRerender)\n  delayedRerender: any\n  afterSizingTriggers: any = {}\n  isViewUpdated: boolean = false\n  isDatesUpdated: boolean = false\n  isEventsUpdated: boolean = false\n\n  el: HTMLElement\n  component: CalendarComponent\n\n\n  constructor(el: HTMLElement, overrides?: OptionsInput) {\n    this.el = el\n\n    this.optionsManager = new OptionsManager(overrides || {})\n    this.pluginSystem = new PluginSystem()\n\n    // only do once. don't do in handleOptions. because can't remove plugins\n    this.addPluginInputs(this.optionsManager.computed.plugins || [])\n\n    this.handleOptions(this.optionsManager.computed)\n    this.publiclyTrigger('_init') // for tests\n    this.hydrate()\n\n    this.calendarInteractions = this.pluginSystem.hooks.calendarInteractions\n      .map((calendarInteractionClass) => {\n        return new calendarInteractionClass(this)\n      })\n  }\n\n\n  addPluginInputs(pluginInputs) {\n    let pluginDefs = refinePluginDefs(pluginInputs)\n\n    for (let pluginDef of pluginDefs) {\n      this.pluginSystem.add(pluginDef)\n    }\n  }\n\n\n  // public API\n  get view(): View {\n    return this.component ? this.component.view : null\n  }\n\n\n  // Public API for rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  render() {\n    if (!this.component) {\n      this.renderableEventStore = createEmptyEventStore()\n      this.bindHandlers()\n      this.executeRender()\n    } else {\n      this.requestRerender(true)\n    }\n  }\n\n\n  destroy() {\n    if (this.component) {\n      this.unbindHandlers()\n      this.component.destroy() // don't null-out. in case API needs access\n      this.component = null // umm ???\n\n      for (let interaction of this.calendarInteractions) {\n        interaction.destroy()\n      }\n\n      this.publiclyTrigger('_destroyed')\n    }\n  }\n\n\n  // Handlers\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  bindHandlers() {\n\n    // event delegation for nav links\n    this.removeNavLinkListener = listenBySelector(this.el, 'click', 'a[data-goto]', (ev, anchorEl) => {\n      let gotoOptions: any = anchorEl.getAttribute('data-goto')\n      gotoOptions = gotoOptions ? JSON.parse(gotoOptions) : {}\n\n      let { dateEnv } = this\n      let dateMarker = dateEnv.createMarker(gotoOptions.date)\n      let viewType = gotoOptions.type\n\n      // property like \"navLinkDayClick\". might be a string or a function\n      let customAction = this.viewOpt('navLink' + capitaliseFirstLetter(viewType) + 'Click')\n\n      if (typeof customAction === 'function') {\n        customAction(dateEnv.toDate(dateMarker), ev)\n      } else {\n        if (typeof customAction === 'string') {\n          viewType = customAction\n        }\n        this.zoomTo(dateMarker, viewType)\n      }\n    })\n\n    if (this.opt('handleWindowResize')) {\n      window.addEventListener('resize',\n        this.windowResizeProxy = debounce( // prevents rapid calls\n          this.windowResize.bind(this),\n          this.opt('windowResizeDelay')\n        )\n      )\n    }\n  }\n\n  unbindHandlers() {\n    this.removeNavLinkListener()\n\n    if (this.windowResizeProxy) {\n      window.removeEventListener('resize', this.windowResizeProxy)\n      this.windowResizeProxy = null\n    }\n  }\n\n\n  // Dispatcher\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  hydrate() {\n    this.state = this.buildInitialState()\n\n    let rawSources = this.opt('eventSources') || []\n    let singleRawSource = this.opt('events')\n    let sources = [] // parsed\n\n    if (singleRawSource) {\n      rawSources.unshift(singleRawSource)\n    }\n\n    for (let rawSource of rawSources) {\n      let source = parseEventSource(rawSource, this)\n      if (source) {\n        sources.push(source)\n      }\n    }\n\n    this.batchRendering(() => {\n      this.dispatch({ type: 'INIT' }) // pass in sources here?\n      this.dispatch({ type: 'ADD_EVENT_SOURCES', sources })\n      this.dispatch({\n        type: 'SET_VIEW_TYPE',\n        viewType: this.opt('defaultView') || this.pluginSystem.hooks.defaultView\n      })\n    })\n  }\n\n\n  buildInitialState(): CalendarState {\n    return {\n      viewType: null,\n      loadingLevel: 0,\n      eventSourceLoadingLevel: 0,\n      currentDate: this.getInitialDate(),\n      dateProfile: null,\n      eventSources: {},\n      eventStore: createEmptyEventStore(),\n      dateSelection: null,\n      eventSelection: '',\n      eventDrag: null,\n      eventResize: null\n    }\n  }\n\n\n  dispatch(action: Action) {\n    this.actionQueue.push(action)\n\n    if (!this.isReducing) {\n      this.isReducing = true\n      let oldState = this.state\n\n      while (this.actionQueue.length) {\n        this.state = this.reduce(\n          this.state,\n          this.actionQueue.shift(),\n          this\n        )\n      }\n\n      let newState = this.state\n      this.isReducing = false\n\n      if (!oldState.loadingLevel && newState.loadingLevel) {\n        this.publiclyTrigger('loading', [ true ])\n      } else if (oldState.loadingLevel && !newState.loadingLevel) {\n        this.publiclyTrigger('loading', [ false ])\n      }\n\n      let view = this.component && this.component.view\n\n      if (oldState.eventStore !== newState.eventStore || this.needsFullRerender) {\n        if (oldState.eventStore) {\n          this.isEventsUpdated = true\n        }\n      }\n\n      if (oldState.dateProfile !== newState.dateProfile || this.needsFullRerender) {\n        if (oldState.dateProfile && view) { // why would view be null!?\n          this.publiclyTrigger('datesDestroy', [\n            {\n              view,\n              el: view.el\n            }\n          ])\n        }\n        this.isDatesUpdated = true\n      }\n\n      if (oldState.viewType !== newState.viewType || this.needsFullRerender) {\n        if (oldState.viewType && view) { // why would view be null!?\n          this.publiclyTrigger('viewSkeletonDestroy', [\n            {\n              view,\n              el: view.el\n            }\n          ])\n        }\n        this.isViewUpdated = true\n      }\n\n      this.requestRerender()\n    }\n  }\n\n\n  reduce(state: CalendarState, action: Action, calendar: Calendar): CalendarState {\n    return reduce(state, action, calendar)\n  }\n\n\n  // Render Queue\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  requestRerender(needsFull = false) {\n    this.needsRerender = true\n    this.needsFullRerender = this.needsFullRerender || needsFull\n    this.delayedRerender() // will call a debounced-version of tryRerender\n  }\n\n\n  tryRerender() {\n    if (\n      this.component && // must be accepting renders\n      this.needsRerender && // indicates that a rerender was requested\n      !this.renderingPauseDepth && // not paused\n      !this.isRendering // not currently in the render loop\n    ) {\n      this.executeRender()\n    }\n  }\n\n\n  batchRendering(func) {\n    this.renderingPauseDepth++\n    func()\n    this.renderingPauseDepth--\n\n    if (this.needsRerender) {\n      this.requestRerender()\n    }\n  }\n\n\n  // Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n  executeRender() {\n    let { needsFullRerender } = this // save before clearing\n\n    // clear these BEFORE the render so that new values will accumulate during render\n    this.needsRerender = false\n    this.needsFullRerender = false\n\n    this.isRendering = true\n    this.renderComponent(needsFullRerender)\n    this.isRendering = false\n\n    // received a rerender request while rendering\n    if (this.needsRerender) {\n      this.delayedRerender()\n    }\n  }\n\n  /*\n  don't call this directly. use executeRender instead\n  */\n  renderComponent(needsFull) {\n    let { state, component } = this\n    let { viewType } = state\n    let viewSpec = this.viewSpecs[viewType]\n    let savedScroll = (needsFull && component) ? component.view.queryScroll() : null\n\n    if (!viewSpec) {\n      throw new Error(`View type \"${viewType}\" is not valid`)\n    }\n\n    // if event sources are still loading and progressive rendering hasn't been enabled,\n    // keep rendering the last fully loaded set of events\n    let renderableEventStore = this.renderableEventStore =\n      (state.eventSourceLoadingLevel && !this.opt('progressiveEventRendering')) ?\n        this.renderableEventStore :\n        state.eventStore\n\n    let eventUiSingleBase = this.buildEventUiSingleBase(viewSpec.options)\n    let eventUiBySource = this.buildEventUiBySource(state.eventSources)\n    let eventUiBases = this.eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource)\n\n    if (needsFull || !component) {\n\n      if (component) {\n        component.freezeHeight() // next component will unfreeze it\n        component.destroy()\n      }\n\n      component = this.component = new CalendarComponent({\n        calendar: this,\n        view: null, // HACK. will get populated by Component\n        dateEnv: this.dateEnv,\n        theme: this.theme,\n        options: this.optionsManager.computed\n      }, this.el)\n\n      this.isViewUpdated = true\n      this.isDatesUpdated = true\n      this.isEventsUpdated = true\n    }\n\n    component.receiveProps({\n      ...state,\n      viewSpec,\n      dateProfile: state.dateProfile,\n      dateProfileGenerator: this.dateProfileGenerators[viewType],\n      eventStore: renderableEventStore,\n      eventUiBases,\n      dateSelection: state.dateSelection,\n      eventSelection: state.eventSelection,\n      eventDrag: state.eventDrag,\n      eventResize: state.eventResize\n    })\n\n    if (savedScroll) {\n      component.view.applyScroll(savedScroll, false)\n    }\n\n    if (this.isViewUpdated) {\n      this.isViewUpdated = false\n      this.publiclyTrigger('viewSkeletonRender', [\n        {\n          view: component.view,\n          el: component.view.el\n        }\n      ])\n    }\n\n    if (this.isDatesUpdated) {\n      this.isDatesUpdated = false\n      this.publiclyTrigger('datesRender', [\n        {\n          view: component.view,\n          el: component.view.el\n        }\n      ])\n    }\n\n    if (this.isEventsUpdated) {\n      this.isEventsUpdated = false\n    }\n\n    this.releaseAfterSizingTriggers()\n  }\n\n\n  // Options\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  setOption(name: string, val) {\n    this.mutateOptions({ [name]: val }, [], true)\n  }\n\n\n  getOption(name: string) { // getter, used externally\n    return this.optionsManager.computed[name]\n  }\n\n\n  opt(name: string) { // getter, used internally\n    return this.optionsManager.computed[name]\n  }\n\n\n  viewOpt(name: string) { // getter, used internally\n    return this.viewOpts()[name]\n  }\n\n\n  viewOpts() {\n    return this.viewSpecs[this.state.viewType].options\n  }\n\n  /*\n  handles option changes (like a diff)\n  */\n  mutateOptions(updates, removals: string[], isDynamic?: boolean, deepEqual?) {\n    let changeHandlers = this.pluginSystem.hooks.optionChangeHandlers\n    let normalUpdates = {}\n    let specialUpdates = {}\n    let oldDateEnv = this.dateEnv // do this before handleOptions\n    let isTimeZoneDirty = false\n    let isSizeDirty = false\n    let anyDifficultOptions = Boolean(removals.length)\n\n    for (let name in updates) {\n      if (changeHandlers[name]) {\n        specialUpdates[name] = updates[name]\n      } else {\n        normalUpdates[name] = updates[name]\n      }\n    }\n\n    for (let name in normalUpdates) {\n      if (/^(height|contentHeight|aspectRatio)$/.test(name)) {\n        isSizeDirty = true\n      } else if (/^(defaultDate|defaultView)$/.test(name)) {\n        // can't change date this way. use gotoDate instead\n      } else {\n        anyDifficultOptions = true\n\n        if (name === 'timeZone') {\n          isTimeZoneDirty = true\n        }\n      }\n    }\n\n    this.optionsManager.mutate(normalUpdates, removals, isDynamic)\n\n    if (anyDifficultOptions) {\n      this.handleOptions(this.optionsManager.computed)\n      this.needsFullRerender = true\n    }\n\n    this.batchRendering(() => {\n\n      if (anyDifficultOptions) {\n\n        if (isTimeZoneDirty) {\n          this.dispatch({\n            type: 'CHANGE_TIMEZONE',\n            oldDateEnv\n          })\n        }\n\n        /* HACK\n        has the same effect as calling this.requestRerender(true)\n        but recomputes the state's dateProfile\n        */\n        this.dispatch({\n          type: 'SET_VIEW_TYPE',\n          viewType: this.state.viewType\n        })\n\n      } else if (isSizeDirty) {\n        this.updateSize()\n      }\n\n      // special updates\n      if (deepEqual) {\n        for (let name in specialUpdates) {\n          changeHandlers[name](specialUpdates[name], this, deepEqual)\n        }\n      }\n\n    })\n  }\n\n  /*\n  rebuilds things based off of a complete set of refined options\n  */\n  handleOptions(options) {\n    let pluginHooks = this.pluginSystem.hooks\n\n    this.defaultAllDayEventDuration = createDuration(options.defaultAllDayEventDuration)\n    this.defaultTimedEventDuration = createDuration(options.defaultTimedEventDuration)\n    this.delayedRerender = this.buildDelayedRerender(options.rerenderDelay)\n    this.theme = this.buildTheme(options)\n\n    let available = this.parseRawLocales(options.locales)\n    this.availableRawLocales = available.map\n    let locale = this.buildLocale(options.locale || available.defaultCode, available.map)\n\n    this.dateEnv = this.buildDateEnv(\n      locale,\n      options.timeZone,\n      pluginHooks.namedTimeZonedImpl,\n      options.firstDay,\n      options.weekNumberCalculation,\n      options.weekLabel,\n      pluginHooks.cmdFormatter\n    )\n\n    this.selectionConfig = this.buildSelectionConfig(options) // needs dateEnv. do after :(\n\n    // ineffecient to do every time?\n    this.viewSpecs = buildViewSpecs(\n      pluginHooks.views,\n      this.optionsManager\n    )\n\n    // ineffecient to do every time?\n    this.dateProfileGenerators = mapHash(this.viewSpecs, (viewSpec) => {\n      return new viewSpec.class.prototype.dateProfileGeneratorClass(viewSpec, this)\n    })\n  }\n\n\n  getAvailableLocaleCodes() {\n    return Object.keys(this.availableRawLocales)\n  }\n\n\n  _buildSelectionConfig(rawOpts) {\n    return processScopedUiProps('select', rawOpts, this)\n  }\n\n\n  _buildEventUiSingleBase(rawOpts) {\n    if (rawOpts.editable) { // so 'editable' affected events\n      rawOpts = { ...rawOpts, eventEditable: true }\n    }\n    return processScopedUiProps('event', rawOpts, this)\n  }\n\n\n  // Trigger\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  hasPublicHandlers<T extends EventHandlerName>(name: T): boolean {\n    return this.hasHandlers(name) ||\n      this.opt(name) // handler specified in options\n  }\n\n\n  publiclyTrigger<T extends EventHandlerName>(name: T, args?: EventHandlerArgs<T>) {\n    let optHandler = this.opt(name)\n\n    this.triggerWith(name, this, args)\n\n    if (optHandler) {\n      return optHandler.apply(this, args)\n    }\n  }\n\n\n  publiclyTriggerAfterSizing<T extends EventHandlerName>(name: T, args: EventHandlerArgs<T>) {\n    let { afterSizingTriggers } = this;\n\n    (afterSizingTriggers[name] || (afterSizingTriggers[name] = [])).push(args)\n  }\n\n\n  releaseAfterSizingTriggers() {\n    let { afterSizingTriggers } = this\n\n    for (let name in afterSizingTriggers) {\n      for (let args of afterSizingTriggers[name]) {\n        this.publiclyTrigger(name as EventHandlerName, args)\n      }\n    }\n\n    this.afterSizingTriggers = {}\n  }\n\n\n  // View\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  // Returns a boolean about whether the view is okay to instantiate at some point\n  isValidViewType(viewType: string): boolean {\n    return Boolean(this.viewSpecs[viewType])\n  }\n\n\n  changeView(viewType: string, dateOrRange?: DateRangeInput | DateInput) {\n    let dateMarker = null\n\n    if (dateOrRange) {\n      if ((dateOrRange as DateRangeInput).start && (dateOrRange as DateRangeInput).end) { // a range\n        this.optionsManager.mutate({ visibleRange: dateOrRange }, []) // will not rerender\n        this.handleOptions(this.optionsManager.computed) // ...but yuck\n      } else { // a date\n        dateMarker = this.dateEnv.createMarker(dateOrRange as DateInput) // just like gotoDate\n      }\n    }\n\n    this.unselect()\n    this.dispatch({\n      type: 'SET_VIEW_TYPE',\n      viewType,\n      dateMarker\n    })\n  }\n\n\n  // Forces navigation to a view for the given date.\n  // `viewType` can be a specific view name or a generic one like \"week\" or \"day\".\n  // needs to change\n  zoomTo(dateMarker: DateMarker, viewType?: string) {\n    let spec\n\n    viewType = viewType || 'day' // day is default zoom\n    spec = this.viewSpecs[viewType] ||\n      this.getUnitViewSpec(viewType)\n\n    this.unselect()\n\n    if (spec) {\n      this.dispatch({\n        type: 'SET_VIEW_TYPE',\n        viewType: spec.type,\n        dateMarker\n      })\n    } else {\n      this.dispatch({\n        type: 'SET_DATE',\n        dateMarker\n      })\n    }\n  }\n\n\n  // Given a duration singular unit, like \"week\" or \"day\", finds a matching view spec.\n  // Preference is given to views that have corresponding buttons.\n  getUnitViewSpec(unit: string): ViewSpec | null {\n    let { component } = this\n    let viewTypes = []\n    let i\n    let spec\n\n    // put views that have buttons first. there will be duplicates, but oh\n    if (component.header) {\n      viewTypes.push(...component.header.viewsWithButtons)\n    }\n    if (component.footer) {\n      viewTypes.push(...component.footer.viewsWithButtons)\n    }\n\n    for (let viewType in this.viewSpecs) {\n      viewTypes.push(viewType)\n    }\n\n    for (i = 0; i < viewTypes.length; i++) {\n      spec = this.viewSpecs[viewTypes[i]]\n      if (spec) {\n        if (spec.singleUnit === unit) {\n          return spec\n        }\n      }\n    }\n  }\n\n\n  // Current Date\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  getInitialDate() {\n    let defaultDateInput = this.opt('defaultDate')\n\n    // compute the initial ambig-timezone date\n    if (defaultDateInput != null) {\n      return this.dateEnv.createMarker(defaultDateInput)\n    } else {\n      return this.getNow() // getNow already returns unzoned\n    }\n  }\n\n\n  prev() {\n    this.unselect()\n    this.dispatch({ type: 'PREV' })\n  }\n\n\n  next() {\n    this.unselect()\n    this.dispatch({ type: 'NEXT' })\n  }\n\n\n  prevYear() {\n    this.unselect()\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.addYears(this.state.currentDate, -1)\n    })\n  }\n\n\n  nextYear() {\n    this.unselect()\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.addYears(this.state.currentDate, 1)\n    })\n  }\n\n\n  today() {\n    this.unselect()\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.getNow()\n    })\n  }\n\n\n  gotoDate(zonedDateInput) {\n    this.unselect()\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.createMarker(zonedDateInput)\n    })\n  }\n\n\n  incrementDate(deltaInput) { // is public facing\n    let delta = createDuration(deltaInput)\n\n    if (delta) { // else, warn about invalid input?\n      this.unselect()\n      this.dispatch({\n        type: 'SET_DATE',\n        dateMarker: this.dateEnv.add(this.state.currentDate, delta)\n      })\n    }\n  }\n\n\n  // for external API\n  getDate(): Date {\n    return this.dateEnv.toDate(this.state.currentDate)\n  }\n\n\n  // Date Formatting Utils\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  formatDate(d: DateInput, formatter): string {\n    const { dateEnv } = this\n    return dateEnv.format(\n      dateEnv.createMarker(d),\n      createFormatter(formatter)\n    )\n  }\n\n\n  // `settings` is for formatter AND isEndExclusive\n  formatRange(d0: DateInput, d1: DateInput, settings) {\n    const { dateEnv } = this\n    return dateEnv.formatRange(\n      dateEnv.createMarker(d0),\n      dateEnv.createMarker(d1),\n      createFormatter(settings, this.opt('defaultRangeSeparator')),\n      settings\n    )\n  }\n\n\n  formatIso(d: DateInput, omitTime?: boolean) {\n    const { dateEnv } = this\n    return dateEnv.formatIso(dateEnv.createMarker(d), { omitTime })\n  }\n\n\n  // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  windowResize(ev: Event) {\n    if (\n      !this.isHandlingWindowResize &&\n      this.component && // why?\n      (ev as any).target === window // not a jqui resize event\n    ) {\n      this.isHandlingWindowResize = true\n      this.updateSize()\n      this.publiclyTrigger('windowResize', [ this.view ])\n      this.isHandlingWindowResize = false\n    }\n  }\n\n\n  updateSize() { // public\n    if (this.component) { // when?\n      this.component.updateSize(true)\n    }\n  }\n\n\n  // Component Registration\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  registerInteractiveComponent(component: DateComponent<any>, settingsInput: InteractionSettingsInput) {\n    let settings = parseInteractionSettings(component, settingsInput)\n    let DEFAULT_INTERACTIONS: InteractionClass[] = [\n      EventClicking,\n      EventHovering\n    ]\n    let interactionClasses: InteractionClass[] = DEFAULT_INTERACTIONS.concat(\n      this.pluginSystem.hooks.componentInteractions\n    )\n    let interactions = interactionClasses.map((interactionClass) => {\n      return new interactionClass(settings)\n    })\n\n    this.interactionsStore[component.uid] = interactions\n    interactionSettingsStore[component.uid] = settings\n  }\n\n\n  unregisterInteractiveComponent(component: DateComponent<any>) {\n\n    for (let listener of this.interactionsStore[component.uid]) {\n      listener.destroy()\n    }\n\n    delete this.interactionsStore[component.uid]\n    delete interactionSettingsStore[component.uid]\n  }\n\n\n  // Date Selection / Event Selection / DayClick\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  // this public method receives start/end dates in any format, with any timezone\n  // NOTE: args were changed from v3\n  select(dateOrObj: DateInput | any, endDate?: DateInput) {\n    let selectionInput: DateSpanInput\n\n    if (endDate == null) {\n      if (dateOrObj.start != null) {\n        selectionInput = dateOrObj as DateSpanInput\n      } else {\n        selectionInput = {\n          start: dateOrObj,\n          end: null\n        }\n      }\n    } else {\n      selectionInput = {\n        start: dateOrObj,\n        end: endDate\n      } as DateSpanInput\n    }\n\n    let selection = parseDateSpan(\n      selectionInput,\n      this.dateEnv,\n      createDuration({ days: 1 }) // TODO: cache this?\n    )\n\n    if (selection) { // throw parse error otherwise?\n      this.dispatch({ type: 'SELECT_DATES', selection })\n      this.triggerDateSelect(selection)\n    }\n  }\n\n\n  // public method\n  unselect(pev?: PointerDragEvent) {\n    if (this.state.dateSelection) {\n      this.dispatch({ type: 'UNSELECT_DATES' })\n      this.triggerDateUnselect(pev)\n    }\n  }\n\n\n  triggerDateSelect(selection: DateSpan, pev?: PointerDragEvent) {\n    const arg = {\n      ...this.buildDateSpanApi(selection),\n      jsEvent: pev ? pev.origEvent as MouseEvent : null, // Is this always a mouse event? See #4655\n      view: this.view\n    }\n    this.publiclyTrigger('select', [ arg ])\n  }\n\n\n  triggerDateUnselect(pev?: PointerDragEvent) {\n    this.publiclyTrigger('unselect', [\n      {\n        jsEvent: pev ? pev.origEvent : null,\n        view: this.view\n      }\n    ])\n  }\n\n\n  // TODO: receive pev?\n  triggerDateClick(dateSpan: DateSpan, dayEl: HTMLElement, view: View, ev: UIEvent) {\n    const arg = {\n      ...this.buildDatePointApi(dateSpan),\n      dayEl,\n      jsEvent: ev as MouseEvent, // Is this always a mouse event? See #4655\n      view\n    }\n\n    this.publiclyTrigger('dateClick', [ arg ])\n  }\n\n\n  buildDatePointApi(dateSpan: DateSpan) {\n    let props = {} as DatePointApi\n\n    for (let transform of this.pluginSystem.hooks.datePointTransforms) {\n      __assign(props, transform(dateSpan, this))\n    }\n\n    __assign(props, buildDatePointApi(dateSpan, this.dateEnv))\n\n    return props\n  }\n\n\n  buildDateSpanApi(dateSpan: DateSpan) {\n    let props = {} as DateSpanApi\n\n    for (let transform of this.pluginSystem.hooks.dateSpanTransforms) {\n      __assign(props, transform(dateSpan, this))\n    }\n\n    __assign(props, buildDateSpanApi(dateSpan, this.dateEnv))\n\n    return props\n  }\n\n\n  // Date Utils\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  // Returns a DateMarker for the current date, as defined by the client's computer or from the `now` option\n  getNow(): DateMarker {\n    let now = this.opt('now')\n\n    if (typeof now === 'function') {\n      now = now()\n    }\n\n    if (now == null) {\n      return this.dateEnv.createNowMarker()\n    }\n\n    return this.dateEnv.createMarker(now)\n  }\n\n\n  // Event-Date Utilities\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  // Given an event's allDay status and start date, return what its fallback end date should be.\n  // TODO: rename to computeDefaultEventEnd\n  getDefaultEventEnd(allDay: boolean, marker: DateMarker): DateMarker {\n    let end = marker\n\n    if (allDay) {\n      end = startOfDay(end)\n      end = this.dateEnv.add(end, this.defaultAllDayEventDuration)\n    } else {\n      end = this.dateEnv.add(end, this.defaultTimedEventDuration)\n    }\n\n    return end\n  }\n\n\n  // Public Events API\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  addEvent(eventInput: EventInput, sourceInput?: EventSourceApi | string | number): EventApi | null {\n\n    if (eventInput instanceof EventApi) {\n      let def = eventInput._def\n      let instance = eventInput._instance\n\n      // not already present? don't want to add an old snapshot\n      if (!this.state.eventStore.defs[def.defId]) {\n        this.dispatch({\n          type: 'ADD_EVENTS',\n          eventStore: eventTupleToStore({ def, instance }) // TODO: better util for two args?\n        })\n      }\n\n      return eventInput\n    }\n\n    let sourceId\n    if (sourceInput instanceof EventSourceApi) {\n      sourceId = sourceInput.internalEventSource.sourceId\n    } else if (sourceInput != null) {\n      let sourceApi = this.getEventSourceById(sourceInput) // TODO: use an internal function\n\n      if (!sourceApi) {\n        console.warn('Could not find an event source with ID \"' + sourceInput + '\"') // TODO: test\n        return null\n      } else {\n        sourceId = sourceApi.internalEventSource.sourceId\n      }\n    }\n\n    let tuple = parseEvent(eventInput, sourceId, this)\n\n    if (tuple) {\n\n      this.dispatch({\n        type: 'ADD_EVENTS',\n        eventStore: eventTupleToStore(tuple)\n      })\n\n      return new EventApi(\n        this,\n        tuple.def,\n        tuple.def.recurringDef ? null : tuple.instance\n      )\n    }\n\n    return null\n  }\n\n\n  // TODO: optimize\n  getEventById(id: string): EventApi | null {\n    let { defs, instances } = this.state.eventStore\n\n    id = String(id)\n\n    for (let defId in defs) {\n      let def = defs[defId]\n\n      if (def.publicId === id) {\n\n        if (def.recurringDef) {\n          return new EventApi(this, def, null)\n        } else {\n\n          for (let instanceId in instances) {\n            let instance = instances[instanceId]\n\n            if (instance.defId === def.defId) {\n              return new EventApi(this, def, instance)\n            }\n          }\n        }\n      }\n    }\n\n    return null\n  }\n\n\n  getEvents(): EventApi[] {\n    let { defs, instances } = this.state.eventStore\n    let eventApis: EventApi[] = []\n\n    for (let id in instances) {\n      let instance = instances[id]\n      let def = defs[instance.defId]\n\n      eventApis.push(new EventApi(this, def, instance))\n    }\n\n    return eventApis\n  }\n\n\n  removeAllEvents() {\n    this.dispatch({ type: 'REMOVE_ALL_EVENTS' })\n  }\n\n\n  rerenderEvents() { // API method. destroys old events if previously rendered.\n    this.dispatch({ type: 'RESET_EVENTS' })\n  }\n\n\n  // Public Event Sources API\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  getEventSources(): EventSourceApi[] {\n    let sourceHash = this.state.eventSources\n    let sourceApis: EventSourceApi[] = []\n\n    for (let internalId in sourceHash) {\n      sourceApis.push(new EventSourceApi(this, sourceHash[internalId]))\n    }\n\n    return sourceApis\n  }\n\n\n  getEventSourceById(id: string | number): EventSourceApi | null {\n    let sourceHash = this.state.eventSources\n\n    id = String(id)\n\n    for (let sourceId in sourceHash) {\n      if (sourceHash[sourceId].publicId === id) {\n        return new EventSourceApi(this, sourceHash[sourceId])\n      }\n    }\n\n    return null\n  }\n\n\n  addEventSource(sourceInput: EventSourceInput): EventSourceApi {\n\n    if (sourceInput instanceof EventSourceApi) {\n\n      // not already present? don't want to add an old snapshot\n      if (!this.state.eventSources[sourceInput.internalEventSource.sourceId]) {\n        this.dispatch({\n          type: 'ADD_EVENT_SOURCES',\n          sources: [ sourceInput.internalEventSource ]\n        })\n      }\n\n      return sourceInput\n    }\n\n    let eventSource = parseEventSource(sourceInput, this)\n\n    if (eventSource) { // TODO: error otherwise?\n      this.dispatch({ type: 'ADD_EVENT_SOURCES', sources: [ eventSource ] })\n\n      return new EventSourceApi(this, eventSource)\n    }\n\n    return null\n  }\n\n\n  removeAllEventSources() {\n    this.dispatch({ type: 'REMOVE_ALL_EVENT_SOURCES' })\n  }\n\n\n  refetchEvents() {\n    this.dispatch({ type: 'FETCH_EVENT_SOURCES' })\n  }\n\n\n  // Scroll\n  // -----------------------------------------------------------------------------------------------------------------\n\n  scrollToTime(timeInput: DurationInput) {\n    let duration = createDuration(timeInput)\n\n    if (duration) {\n      this.component.view.scrollToDuration(duration)\n    }\n  }\n\n}\n\nEmitterMixin.mixInto(Calendar)\n\n\n// for memoizers\n// -----------------------------------------------------------------------------------------------------------------\n\n\nfunction buildDateEnv(locale: Locale, timeZone, namedTimeZoneImpl: NamedTimeZoneImplClass, firstDay, weekNumberCalculation, weekLabel, cmdFormatter: CmdFormatterFunc) {\n  return new DateEnv({\n    calendarSystem: 'gregory', // TODO: make this a setting\n    timeZone,\n    namedTimeZoneImpl,\n    locale,\n    weekNumberCalculation,\n    firstDay,\n    weekLabel,\n    cmdFormatter\n  })\n}\n\n\nfunction buildTheme(this: Calendar, calendarOptions) {\n  let themeClass = this.pluginSystem.hooks.themeClasses[calendarOptions.themeSystem] || StandardTheme\n  return new themeClass(calendarOptions)\n}\n\n\nfunction buildDelayedRerender(this: Calendar, wait) {\n  let func = this.tryRerender.bind(this)\n\n  if (wait != null) {\n    func = debounce(func, wait)\n  }\n\n  return func\n}\n\n\nfunction buildEventUiBySource(eventSources: EventSourceHash): EventUiHash {\n  return mapHash(eventSources, function(eventSource) {\n    return eventSource.ui\n  })\n}\n\n\nfunction buildEventUiBases(eventDefs: EventDefHash, eventUiSingleBase: EventUi, eventUiBySource: EventUiHash) {\n  let eventUiBases: EventUiHash = { '': eventUiSingleBase }\n\n  for (let defId in eventDefs) {\n    let def = eventDefs[defId]\n\n    if (def.sourceId && eventUiBySource[def.sourceId]) {\n      eventUiBases[defId] = eventUiBySource[def.sourceId]\n    }\n  }\n\n  return eventUiBases\n}\n","import { parseFieldSpecs } from './util/misc'\nimport DateProfileGenerator, { DateProfile } from './DateProfileGenerator'\nimport { DateMarker, addMs } from './datelib/marker'\nimport { createDuration, Duration } from './datelib/duration'\nimport { default as EmitterMixin, EmitterInterface } from './common/EmitterMixin'\nimport { ViewSpec } from './structs/view-spec'\nimport { createElement } from './util/dom-manip'\nimport { ComponentContext } from './component/Component'\nimport DateComponent from './component/DateComponent'\nimport { EventStore } from './structs/event-store'\nimport { EventUiHash, EventUi } from './component/event-ui'\nimport { sliceEventStore, EventRenderRange } from './component/event-rendering'\nimport { DateSpan } from './structs/date-span'\nimport { EventInteractionState } from './interactions/event-interaction-state'\nimport { memoizeRendering } from './component/memoized-rendering'\nimport { __assign } from 'tslib'\nimport { EventDef } from './structs/event'\n\nexport interface ViewProps {\n  dateProfile: DateProfile\n  businessHours: EventStore\n  eventStore: EventStore\n  eventUiBases: EventUiHash\n  dateSelection: DateSpan | null\n  eventSelection: string\n  eventDrag: EventInteractionState | null\n  eventResize: EventInteractionState | null\n}\n\nexport default abstract class View extends DateComponent<ViewProps> {\n\n  // config properties, initialized after class on prototype\n  usesMinMaxTime: boolean // whether minTime/maxTime will affect the activeRange. Views must opt-in.\n  dateProfileGeneratorClass: any // initialized after class. used by Calendar\n\n  on: EmitterInterface['on']\n  one: EmitterInterface['one']\n  off: EmitterInterface['off']\n  trigger: EmitterInterface['trigger']\n  triggerWith: EmitterInterface['triggerWith']\n  hasHandlers: EmitterInterface['hasHandlers']\n\n  viewSpec: ViewSpec\n  dateProfileGenerator: DateProfileGenerator\n  type: string // subclass' view name (string). for the API\n  title: string // the text that will be displayed in the header's title. SET BY CALLER for API\n\n  queuedScroll: any\n\n  eventOrderSpecs: any // criteria for ordering events when they have same date/time\n  nextDayThreshold: Duration\n\n  // now indicator\n  isNowIndicatorRendered: boolean\n  initialNowDate: DateMarker // result first getNow call\n  initialNowQueriedMs: number // ms time the getNow was called\n  nowIndicatorTimeoutID: any // for refresh timing of now indicator\n  nowIndicatorIntervalID: any // \"\n\n  private renderDatesMem = memoizeRendering(this.renderDatesWrap, this.unrenderDatesWrap)\n  private renderBusinessHoursMem = memoizeRendering(this.renderBusinessHours, this.unrenderBusinessHours, [ this.renderDatesMem ])\n  private renderDateSelectionMem = memoizeRendering(this.renderDateSelectionWrap, this.unrenderDateSelectionWrap, [ this.renderDatesMem ])\n  private renderEventsMem = memoizeRendering(this.renderEvents, this.unrenderEvents, [ this.renderDatesMem ])\n  private renderEventSelectionMem = memoizeRendering(this.renderEventSelectionWrap, this.unrenderEventSelectionWrap, [ this.renderEventsMem ])\n  private renderEventDragMem = memoizeRendering(this.renderEventDragWrap, this.unrenderEventDragWrap, [ this.renderDatesMem ])\n  private renderEventResizeMem = memoizeRendering(this.renderEventResizeWrap, this.unrenderEventResizeWrap, [ this.renderDatesMem ])\n\n\n  constructor(context: ComponentContext, viewSpec: ViewSpec, dateProfileGenerator: DateProfileGenerator, parentEl: HTMLElement) {\n    super(\n      context,\n      createElement('div', { className: 'fc-view fc-' + viewSpec.type + '-view' }),\n      true // isView (HACK)\n    )\n\n    this.viewSpec = viewSpec\n    this.dateProfileGenerator = dateProfileGenerator\n    this.type = viewSpec.type\n    this.eventOrderSpecs = parseFieldSpecs(this.opt('eventOrder'))\n    this.nextDayThreshold = createDuration(this.opt('nextDayThreshold'))\n\n    parentEl.appendChild(this.el)\n    this.initialize()\n  }\n\n\n  initialize() { // convenient for sublcasses\n  }\n\n\n  // Date Setting/Unsetting\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  get activeStart(): Date {\n    return this.dateEnv.toDate(this.props.dateProfile.activeRange.start)\n  }\n\n  get activeEnd(): Date {\n    return this.dateEnv.toDate(this.props.dateProfile.activeRange.end)\n  }\n\n  get currentStart(): Date {\n    return this.dateEnv.toDate(this.props.dateProfile.currentRange.start)\n  }\n\n  get currentEnd(): Date {\n    return this.dateEnv.toDate(this.props.dateProfile.currentRange.end)\n  }\n\n\n  // General Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  render(props: ViewProps) {\n    this.renderDatesMem(props.dateProfile)\n    this.renderBusinessHoursMem(props.businessHours)\n    this.renderDateSelectionMem(props.dateSelection)\n    this.renderEventsMem(props.eventStore)\n    this.renderEventSelectionMem(props.eventSelection)\n    this.renderEventDragMem(props.eventDrag)\n    this.renderEventResizeMem(props.eventResize)\n  }\n\n\n  destroy() {\n    super.destroy()\n\n    this.renderDatesMem.unrender() // should unrender everything else\n  }\n\n\n  // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  updateSize(isResize: boolean, viewHeight: number, isAuto: boolean) {\n    let { calendar } = this\n\n    if (\n      isResize || // HACKS...\n      calendar.isViewUpdated ||\n      calendar.isDatesUpdated ||\n      calendar.isEventsUpdated\n    ) {\n      // sort of the catch-all sizing\n      // anything that might cause dimension changes\n      this.updateBaseSize(isResize, viewHeight, isAuto)\n    }\n  }\n\n\n  updateBaseSize(isResize: boolean, viewHeight: number, isAuto: boolean) {\n  }\n\n\n  // Date Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n  renderDatesWrap(dateProfile: DateProfile) {\n    this.renderDates(dateProfile)\n    this.addScroll({\n      duration: createDuration(this.opt('scrollTime'))\n    })\n    this.startNowIndicator(dateProfile) // shouldn't render yet because updateSize will be called soon\n  }\n\n  unrenderDatesWrap() {\n    this.stopNowIndicator()\n    this.unrenderDates()\n  }\n\n  renderDates(dateProfile: DateProfile) {}\n  unrenderDates() {}\n\n\n  // Business Hours\n  // -----------------------------------------------------------------------------------------------------------------\n\n  renderBusinessHours(businessHours: EventStore) {}\n  unrenderBusinessHours() {}\n\n\n  // Date Selection\n  // -----------------------------------------------------------------------------------------------------------------\n\n  renderDateSelectionWrap(selection: DateSpan) {\n    if (selection) {\n      this.renderDateSelection(selection)\n    }\n  }\n\n  unrenderDateSelectionWrap(selection: DateSpan) {\n    if (selection) {\n      this.unrenderDateSelection(selection)\n    }\n  }\n\n  renderDateSelection(selection: DateSpan) {}\n  unrenderDateSelection(selection: DateSpan) {}\n\n\n  // Event Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n  renderEvents(eventStore: EventStore) {}\n  unrenderEvents() {}\n\n  // util for subclasses\n  sliceEvents(eventStore: EventStore, allDay: boolean): EventRenderRange[] {\n    let { props } = this\n\n    return sliceEventStore(\n      eventStore,\n      props.eventUiBases,\n      props.dateProfile.activeRange,\n      allDay ? this.nextDayThreshold : null\n    ).fg\n  }\n\n  computeEventDraggable(eventDef: EventDef, eventUi: EventUi) {\n    let transformers = this.calendar.pluginSystem.hooks.isDraggableTransformers\n    let val = eventUi.startEditable\n\n    for (let transformer of transformers) {\n      val = transformer(val, eventDef, eventUi, this)\n    }\n\n    return val\n  }\n\n  computeEventStartResizable(eventDef: EventDef, eventUi: EventUi) {\n    return eventUi.durationEditable && this.opt('eventResizableFromStart')\n  }\n\n  computeEventEndResizable(eventDef: EventDef, eventUi: EventUi) {\n    return eventUi.durationEditable\n  }\n\n\n  // Event Selection\n  // -----------------------------------------------------------------------------------------------------------------\n\n  renderEventSelectionWrap(instanceId: string) {\n    if (instanceId) {\n      this.renderEventSelection(instanceId)\n    }\n  }\n\n  unrenderEventSelectionWrap(instanceId: string) {\n    if (instanceId) {\n      this.unrenderEventSelection(instanceId)\n    }\n  }\n\n  renderEventSelection(instanceId: string) {}\n  unrenderEventSelection(instanceId: string) {}\n\n\n  // Event Drag\n  // -----------------------------------------------------------------------------------------------------------------\n\n  renderEventDragWrap(state: EventInteractionState) {\n    if (state) {\n      this.renderEventDrag(state)\n    }\n  }\n\n  unrenderEventDragWrap(state: EventInteractionState) {\n    if (state) {\n      this.unrenderEventDrag(state)\n    }\n  }\n\n  renderEventDrag(state: EventInteractionState) {}\n  unrenderEventDrag(state: EventInteractionState) {}\n\n\n  // Event Resize\n  // -----------------------------------------------------------------------------------------------------------------\n\n  renderEventResizeWrap(state: EventInteractionState) {\n    if (state) {\n      this.renderEventResize(state)\n    }\n  }\n\n  unrenderEventResizeWrap(state: EventInteractionState) {\n    if (state) {\n      this.unrenderEventResize(state)\n    }\n  }\n\n  renderEventResize(state: EventInteractionState) {}\n  unrenderEventResize(state: EventInteractionState) {}\n\n\n  /* Now Indicator\n  ------------------------------------------------------------------------------------------------------------------*/\n\n\n  // Immediately render the current time indicator and begins re-rendering it at an interval,\n  // which is defined by this.getNowIndicatorUnit().\n  // TODO: somehow do this for the current whole day's background too\n  startNowIndicator(dateProfile: DateProfile) {\n    let { dateEnv } = this\n    let unit\n    let update\n    let delay // ms wait value\n\n    if (this.opt('nowIndicator')) {\n      unit = this.getNowIndicatorUnit(dateProfile)\n      if (unit) {\n        update = this.updateNowIndicator.bind(this)\n\n        this.initialNowDate = this.calendar.getNow()\n        this.initialNowQueriedMs = new Date().valueOf()\n\n        // wait until the beginning of the next interval\n        delay = dateEnv.add(\n          dateEnv.startOf(this.initialNowDate, unit),\n          createDuration(1, unit)\n        ).valueOf() - this.initialNowDate.valueOf()\n\n        // TODO: maybe always use setTimeout, waiting until start of next unit\n        this.nowIndicatorTimeoutID = setTimeout(() => {\n          this.nowIndicatorTimeoutID = null\n          update()\n\n          if (unit === 'second') {\n            delay = 1000 // every second\n          } else {\n            delay = 1000 * 60 // otherwise, every minute\n          }\n\n          this.nowIndicatorIntervalID = setInterval(update, delay) // update every interval\n        }, delay)\n      }\n\n      // rendering will be initiated in updateSize\n    }\n  }\n\n\n  // rerenders the now indicator, computing the new current time from the amount of time that has passed\n  // since the initial getNow call.\n  updateNowIndicator() {\n    if (\n      this.props.dateProfile && // a way to determine if dates were rendered yet\n      this.initialNowDate // activated before?\n    ) {\n      this.unrenderNowIndicator() // won't unrender if unnecessary\n      this.renderNowIndicator(\n        addMs(this.initialNowDate, new Date().valueOf() - this.initialNowQueriedMs)\n      )\n      this.isNowIndicatorRendered = true\n    }\n  }\n\n\n  // Immediately unrenders the view's current time indicator and stops any re-rendering timers.\n  // Won't cause side effects if indicator isn't rendered.\n  stopNowIndicator() {\n    if (this.isNowIndicatorRendered) {\n\n      if (this.nowIndicatorTimeoutID) {\n        clearTimeout(this.nowIndicatorTimeoutID)\n        this.nowIndicatorTimeoutID = null\n      }\n      if (this.nowIndicatorIntervalID) {\n        clearInterval(this.nowIndicatorIntervalID)\n        this.nowIndicatorIntervalID = null\n      }\n\n      this.unrenderNowIndicator()\n      this.isNowIndicatorRendered = false\n    }\n  }\n\n\n  getNowIndicatorUnit(dateProfile: DateProfile) {\n    // subclasses should implement\n  }\n\n\n  // Renders a current time indicator at the given datetime\n  renderNowIndicator(date) {\n    // SUBCLASSES MUST PASS TO CHILDREN!\n  }\n\n\n  // Undoes the rendering actions from renderNowIndicator\n  unrenderNowIndicator() {\n    // SUBCLASSES MUST PASS TO CHILDREN!\n  }\n\n\n  /* Scroller\n  ------------------------------------------------------------------------------------------------------------------*/\n\n\n  addScroll(scroll) {\n    let queuedScroll = this.queuedScroll || (this.queuedScroll = {})\n\n    __assign(queuedScroll, scroll)\n  }\n\n\n  popScroll(isResize: boolean) {\n    this.applyQueuedScroll(isResize)\n    this.queuedScroll = null\n  }\n\n\n  applyQueuedScroll(isResize: boolean) {\n    this.applyScroll(this.queuedScroll || {}, isResize)\n  }\n\n\n  queryScroll() {\n    let scroll = {} as any\n\n    if (this.props.dateProfile) { // dates rendered yet?\n      __assign(scroll, this.queryDateScroll())\n    }\n\n    return scroll\n  }\n\n\n  applyScroll(scroll, isResize: boolean) {\n    let { duration } = scroll\n\n    if (duration != null) {\n      delete scroll.duration\n\n      if (this.props.dateProfile) { // dates rendered yet?\n        __assign(scroll, this.computeDateScroll(duration))\n      }\n    }\n\n    if (this.props.dateProfile) { // dates rendered yet?\n      this.applyDateScroll(scroll)\n    }\n  }\n\n\n  computeDateScroll(duration: Duration) {\n    return {} // subclasses must implement\n  }\n\n\n  queryDateScroll() {\n    return {} // subclasses must implement\n  }\n\n\n  applyDateScroll(scroll) {\n     // subclasses must implement\n  }\n\n\n  // for API\n  scrollToDuration(duration: Duration) {\n    this.applyScroll({ duration }, false)\n  }\n\n}\n\nEmitterMixin.mixInto(View)\n\nView.prototype.usesMinMaxTime = false\nView.prototype.dateProfileGeneratorClass = DateProfileGenerator\n","import { DateMarker } from '../../datelib/marker'\nimport { createFormatter, DateFormatter } from '../../datelib/formatting'\nimport { htmlToElements } from '../../util/dom-manip'\nimport { compareByFieldSpecs } from '../../util/misc'\nimport { EventUi } from '../event-ui'\nimport { EventRenderRange, filterSegsViaEls } from '../event-rendering'\nimport { Seg } from '../DateComponent'\nimport { ComponentContext } from '../Component'\n\n\nexport default abstract class FgEventRenderer {\n\n  context: ComponentContext\n\n  // derived from options\n  eventTimeFormat: DateFormatter\n  displayEventTime: boolean\n  displayEventEnd: boolean\n\n  segs: Seg[] = []\n  isSizeDirty: boolean = false\n\n\n  constructor(context: ComponentContext) {\n    this.context = context\n  }\n\n\n  renderSegs(segs: Seg[], mirrorInfo?) {\n    this.rangeUpdated() // called too frequently :(\n\n    // render an `.el` on each seg\n    // returns a subset of the segs. segs that were actually rendered\n    segs = this.renderSegEls(segs, mirrorInfo)\n\n    this.segs = segs\n    this.attachSegs(segs, mirrorInfo)\n\n    this.isSizeDirty = true\n    this.context.view.triggerRenderedSegs(this.segs, Boolean(mirrorInfo))\n  }\n\n\n  unrender(_segs: Seg[], mirrorInfo?) {\n    this.context.view.triggerWillRemoveSegs(this.segs, Boolean(mirrorInfo))\n    this.detachSegs(this.segs)\n    this.segs = []\n  }\n\n\n  abstract renderSegHtml(seg: Seg, mirrorInfo): string\n  abstract attachSegs(segs: Seg[], mirrorInfo)\n  abstract detachSegs(segs: Seg[])\n\n\n  // Updates values that rely on options and also relate to range\n  rangeUpdated() {\n    let { options } = this.context\n    let displayEventTime\n    let displayEventEnd\n\n    this.eventTimeFormat = createFormatter(\n      options.eventTimeFormat || this.computeEventTimeFormat(),\n      options.defaultRangeSeparator\n    )\n\n    displayEventTime = options.displayEventTime\n    if (displayEventTime == null) {\n      displayEventTime = this.computeDisplayEventTime() // might be based off of range\n    }\n\n    displayEventEnd = options.displayEventEnd\n    if (displayEventEnd == null) {\n      displayEventEnd = this.computeDisplayEventEnd() // might be based off of range\n    }\n\n    this.displayEventTime = displayEventTime\n    this.displayEventEnd = displayEventEnd\n  }\n\n\n  // Renders and assigns an `el` property for each foreground event segment.\n  // Only returns segments that successfully rendered.\n  renderSegEls(segs: Seg[], mirrorInfo) {\n    let html = ''\n    let i\n\n    if (segs.length) { // don't build an empty html string\n\n      // build a large concatenation of event segment HTML\n      for (i = 0; i < segs.length; i++) {\n        html += this.renderSegHtml(segs[i], mirrorInfo)\n      }\n\n      // Grab individual elements from the combined HTML string. Use each as the default rendering.\n      // Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.\n      htmlToElements(html).forEach((el, i) => {\n        let seg = segs[i]\n\n        if (el) {\n          seg.el = el\n        }\n      })\n\n      segs = filterSegsViaEls(this.context.view, segs, Boolean(mirrorInfo))\n    }\n\n    return segs\n  }\n\n\n  // Generic utility for generating the HTML classNames for an event segment's element\n  getSegClasses(seg: Seg, isDraggable, isResizable, mirrorInfo) {\n    let classes = [\n      'fc-event',\n      seg.isStart ? 'fc-start' : 'fc-not-start',\n      seg.isEnd ? 'fc-end' : 'fc-not-end'\n    ].concat(seg.eventRange.ui.classNames)\n\n    if (isDraggable) {\n      classes.push('fc-draggable')\n    }\n\n    if (isResizable) {\n      classes.push('fc-resizable')\n    }\n\n    if (mirrorInfo) {\n      classes.push('fc-mirror')\n\n      if (mirrorInfo.isDragging) {\n        classes.push('fc-dragging')\n      }\n\n      if (mirrorInfo.isResizing) {\n        classes.push('fc-resizing')\n      }\n    }\n\n    return classes\n  }\n\n\n  // Compute the text that should be displayed on an event's element.\n  // `range` can be the Event object itself, or something range-like, with at least a `start`.\n  // If event times are disabled, or the event has no time, will return a blank string.\n  // If not specified, formatter will default to the eventTimeFormat setting,\n  // and displayEnd will default to the displayEventEnd setting.\n  getTimeText(eventRange: EventRenderRange, formatter?, displayEnd?) {\n    let { def, instance } = eventRange\n\n    return this._getTimeText(\n      instance.range.start,\n      def.hasEnd ? instance.range.end : null,\n      def.allDay,\n      formatter,\n      displayEnd,\n      instance.forcedStartTzo,\n      instance.forcedEndTzo\n    )\n  }\n\n\n  _getTimeText(\n    start: DateMarker,\n    end: DateMarker,\n    allDay,\n    formatter?,\n    displayEnd?,\n    forcedStartTzo?: number,\n    forcedEndTzo?: number\n) {\n    let { dateEnv } = this.context\n\n    if (formatter == null) {\n      formatter = this.eventTimeFormat\n    }\n\n    if (displayEnd == null) {\n      displayEnd = this.displayEventEnd\n    }\n\n    if (this.displayEventTime && !allDay) {\n      if (displayEnd && end) {\n        return dateEnv.formatRange(start, end, formatter, {\n          forcedStartTzo,\n          forcedEndTzo\n        })\n      } else {\n        return dateEnv.format(start, formatter, {\n          forcedTzo: forcedStartTzo\n        })\n      }\n    }\n\n    return ''\n  }\n\n\n  computeEventTimeFormat(): any {\n    return {\n      hour: 'numeric',\n      minute: '2-digit',\n      omitZeroMinute: true\n    }\n  }\n\n\n  computeDisplayEventTime() {\n    return true\n  }\n\n\n  computeDisplayEventEnd() {\n    return true\n  }\n\n\n  // Utility for generating event skin-related CSS properties\n  getSkinCss(ui: EventUi) {\n    return {\n      'background-color': ui.backgroundColor,\n      'border-color': ui.borderColor,\n      color: ui.textColor\n    }\n  }\n\n\n  sortEventSegs(segs): Seg[] {\n    let specs = this.context.view.eventOrderSpecs\n    let objs = segs.map(buildSegCompareObj)\n\n    objs.sort(function(obj0, obj1) {\n      return compareByFieldSpecs(obj0, obj1, specs)\n    })\n\n    return objs.map(function(c) {\n      return c._seg\n    })\n  }\n\n\n  computeSizes(force: boolean) {\n    if (force || this.isSizeDirty) {\n      this.computeSegSizes(this.segs)\n    }\n  }\n\n\n  assignSizes(force: boolean) {\n    if (force || this.isSizeDirty) {\n      this.assignSegSizes(this.segs)\n      this.isSizeDirty = false\n    }\n  }\n\n\n  computeSegSizes(segs: Seg[]) {\n  }\n\n\n  assignSegSizes(segs: Seg[]) {\n  }\n\n\n  // Manipulation on rendered segs\n\n\n  hideByHash(hash) {\n    if (hash) {\n      for (let seg of this.segs) {\n        if (hash[seg.eventRange.instance.instanceId]) {\n          seg.el.style.visibility = 'hidden'\n        }\n      }\n    }\n  }\n\n\n  showByHash(hash) {\n    if (hash) {\n      for (let seg of this.segs) {\n        if (hash[seg.eventRange.instance.instanceId]) {\n          seg.el.style.visibility = ''\n        }\n      }\n    }\n  }\n\n\n  selectByInstanceId(instanceId: string) {\n    if (instanceId) {\n      for (let seg of this.segs) {\n        let eventInstance = seg.eventRange.instance\n        if (\n          eventInstance && eventInstance.instanceId === instanceId &&\n          seg.el // necessary?\n        ) {\n          seg.el.classList.add('fc-selected')\n        }\n      }\n    }\n  }\n\n\n  unselectByInstanceId(instanceId: string) {\n    if (instanceId) {\n      for (let seg of this.segs) {\n        if (seg.el) { // necessary?\n          seg.el.classList.remove('fc-selected')\n        }\n      }\n    }\n  }\n\n}\n\n\n// returns a object with all primitive props that can be compared\nexport function buildSegCompareObj(seg: Seg) {\n  let eventDef = seg.eventRange.def\n  let range = seg.eventRange.instance.range\n  let start = range.start ? range.start.valueOf() : 0 // TODO: better support for open-range events\n  let end = range.end ? range.end.valueOf() : 0 // \"\n\n  return {\n    ...eventDef.extendedProps,\n    ...eventDef,\n    id: eventDef.publicId,\n    start,\n    end,\n    duration: end - start,\n    allDay: Number(eventDef.allDay),\n    _seg: seg // for later retrieval\n  }\n}\n","import { cssToStr } from '../../util/html'\nimport { htmlToElements, removeElement, elementMatches } from '../../util/dom-manip'\nimport { Seg } from '../DateComponent'\nimport { filterSegsViaEls } from '../event-rendering'\nimport { ComponentContext } from '../Component'\n\n\nexport default abstract class FillRenderer { // use for highlight, background events, business hours\n\n  context: ComponentContext\n  fillSegTag: string = 'div'\n  containerElsByType: any // a hash of element sets used for rendering each fill. Keyed by fill name.\n  segsByType: any\n  dirtySizeFlags: any = {}\n\n\n  constructor(context: ComponentContext) {\n    this.context = context\n    this.containerElsByType = {}\n    this.segsByType = {}\n  }\n\n\n  getSegsByType(type: string) {\n    return this.segsByType[type] || []\n  }\n\n\n  renderSegs(type, segs: Seg[]) {\n    let renderedSegs = this.renderSegEls(type, segs) // assignes `.el` to each seg. returns successfully rendered segs\n    let containerEls = this.attachSegs(type, renderedSegs)\n\n    if (containerEls) {\n      (this.containerElsByType[type] || (this.containerElsByType[type] = []))\n        .push(...containerEls)\n    }\n\n    this.segsByType[type] = renderedSegs\n\n    if (type === 'bgEvent') {\n      this.context.view.triggerRenderedSegs(renderedSegs, false) // isMirror=false\n    }\n\n    this.dirtySizeFlags[type] = true\n  }\n\n\n  // Unrenders a specific type of fill that is currently rendered on the grid\n  unrender(type) {\n    let segs = this.segsByType[type]\n\n    if (segs) {\n\n      if (type === 'bgEvent') {\n        this.context.view.triggerWillRemoveSegs(segs, false) // isMirror=false\n      }\n\n      this.detachSegs(type, segs)\n    }\n  }\n\n\n  // Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.\n  // Only returns segments that successfully rendered.\n  renderSegEls(type, segs: Seg[]) {\n    let html = ''\n    let i\n\n    if (segs.length) {\n\n      // build a large concatenation of segment HTML\n      for (i = 0; i < segs.length; i++) {\n        html += this.renderSegHtml(type, segs[i])\n      }\n\n      // Grab individual elements from the combined HTML string. Use each as the default rendering.\n      // Then, compute the 'el' for each segment.\n      htmlToElements(html).forEach((el, i) => {\n        let seg = segs[i]\n\n        if (el) {\n          seg.el = el\n        }\n      })\n\n      if (type === 'bgEvent') {\n        segs = filterSegsViaEls(\n          this.context.view,\n          segs,\n          false // isMirror. background events can never be mirror elements\n        )\n      }\n\n      // correct element type? (would be bad if a non-TD were inserted into a table for example)\n      segs = segs.filter((seg) => {\n        return elementMatches(seg.el, this.fillSegTag)\n      })\n    }\n\n    return segs\n  }\n\n\n  // Builds the HTML needed for one fill segment. Generic enough to work with different types.\n  renderSegHtml(type, seg: Seg) {\n    let css = null\n    let classNames = []\n\n    if (type !== 'highlight' && type !== 'businessHours') {\n      css = {\n        'background-color': seg.eventRange.ui.backgroundColor\n      }\n    }\n\n    if (type !== 'highlight') {\n      classNames = classNames.concat(seg.eventRange.ui.classNames)\n    }\n\n    if (type === 'businessHours') {\n      classNames.push('fc-bgevent')\n    } else {\n      classNames.push('fc-' + type.toLowerCase())\n    }\n\n    return '<' + this.fillSegTag +\n      (classNames.length ? ' class=\"' + classNames.join(' ') + '\"' : '') +\n      (css ? ' style=\"' + cssToStr(css) + '\"' : '') +\n      '></' + this.fillSegTag + '>'\n  }\n\n\n  abstract attachSegs(type, segs: Seg[]): HTMLElement[] | void\n\n\n  detachSegs(type, segs: Seg[]) {\n    let containerEls = this.containerElsByType[type]\n\n    if (containerEls) {\n      containerEls.forEach(removeElement)\n      delete this.containerElsByType[type]\n    }\n  }\n\n\n  computeSizes(force: boolean) {\n    for (let type in this.segsByType) {\n      if (force || this.dirtySizeFlags[type]) {\n        this.computeSegSizes(this.segsByType[type])\n      }\n    }\n  }\n\n\n  assignSizes(force: boolean) {\n    for (let type in this.segsByType) {\n      if (force || this.dirtySizeFlags[type]) {\n        this.assignSegSizes(this.segsByType[type])\n      }\n    }\n\n    this.dirtySizeFlags = {}\n  }\n\n\n  computeSegSizes(segs: Seg[]) {\n  }\n\n\n  assignSegSizes(segs: Seg[]) {\n  }\n\n}\n","\nexport abstract class NamedTimeZoneImpl {\n\n  timeZoneName: string\n\n  constructor(timeZoneName: string) {\n    this.timeZoneName = timeZoneName\n  }\n\n  abstract offsetForArray(a: number[]): number\n  abstract timestampToArray(ms: number): number[]\n}\n\nexport type NamedTimeZoneImplClass = { new(timeZoneName: string): NamedTimeZoneImpl }\n","import EmitterMixin from '../common/EmitterMixin'\n\n/*\nAn abstraction for a dragging interaction originating on an event.\nDoes higher-level things than PointerDragger, such as possibly:\n- a \"mirror\" that moves with the pointer\n- a minimum number of pixels or other criteria for a true drag to begin\n\nsubclasses must emit:\n- pointerdown\n- dragstart\n- dragmove\n- pointerup\n- dragend\n*/\nexport default abstract class ElementDragging { // TODO: rename to *Interface?\n\n  emitter: EmitterMixin\n\n  constructor(el: HTMLElement) {\n    this.emitter = new EmitterMixin()\n  }\n\n  destroy() {\n  }\n\n  // if given true, should prevent dragstart+dragmove+dragend from firing\n  abstract setIgnoreMove(bool: boolean): void\n\n  setMirrorIsVisible(bool: boolean) {\n    // optional if subclass doesn't want to support a mirror\n  }\n\n  setMirrorNeedsRevert(bool: boolean) {\n    // optional if subclass doesn't want to support a mirror\n  }\n\n  setAutoScrollEnabled(bool: boolean) {\n    // optional\n  }\n\n}\n\nexport type ElementDraggingClass = { new(el: HTMLElement): ElementDragging }\n","import { DateEnv, DateInput } from './datelib/env'\nimport { createFormatter } from './datelib/formatting'\nimport { parseRawLocales, buildLocale } from './datelib/locale'\nimport { globalDefaults } from './options'\n\nexport function formatDate(dateInput: DateInput, settings = {}) {\n  let dateEnv = buildDateEnv(settings)\n  let formatter = createFormatter(settings)\n  let dateMeta = dateEnv.createMarkerMeta(dateInput)\n\n  if (!dateMeta) { // TODO: warning?\n    return ''\n  }\n\n  return dateEnv.format(dateMeta.marker, formatter, {\n    forcedTzo: dateMeta.forcedTzo\n  })\n}\n\nexport function formatRange(\n  startInput: DateInput,\n  endInput: DateInput,\n  settings // mixture of env and formatter settings\n) {\n  let dateEnv = buildDateEnv(typeof settings === 'object' && settings ? settings : {}) // pass in if non-null object\n  let formatter = createFormatter(settings, globalDefaults.defaultRangeSeparator)\n  let startMeta = dateEnv.createMarkerMeta(startInput)\n  let endMeta = dateEnv.createMarkerMeta(endInput)\n\n  if (!startMeta || !endMeta) { // TODO: warning?\n    return ''\n  }\n\n  return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n    forcedStartTzo: startMeta.forcedTzo,\n    forcedEndTzo: endMeta.forcedTzo,\n    isEndExclusive: settings.isEndExclusive\n  })\n}\n\n// TODO: more DRY and optimized\nfunction buildDateEnv(settings) {\n  let locale = buildLocale(settings.locale || 'en', parseRawLocales([]).map) // TODO: don't hardcode 'en' everywhere\n\n  // ensure required settings\n  settings = {\n    timeZone: globalDefaults.timeZone,\n    calendarSystem: 'gregory',\n    ...settings,\n    locale\n  }\n\n  return new DateEnv(settings)\n}\n","import { createDuration, Duration, DurationInput } from '../datelib/duration'\nimport { refineProps } from '../util/misc'\nimport { EventNonDateInput } from '../structs/event'\n\n/*\nInformation about what will happen when an external element is dragged-and-dropped\nonto a calendar. Contains information for creating an event.\n*/\n\nexport interface DragMetaInput extends EventNonDateInput {\n  startTime?: DurationInput\n  duration?: DurationInput\n  create?: boolean\n  sourceId?: string\n}\n\nexport interface DragMeta {\n  startTime: Duration | null\n  duration: Duration | null\n  create: boolean // create an event when dropped?\n  sourceId: string // similar to addEvent's parameter\n  leftoverProps: object\n}\n\nconst DRAG_META_PROPS = {\n  startTime: createDuration,\n  duration: createDuration,\n  create: Boolean,\n  sourceId: String\n}\n\nconst DRAG_META_DEFAULTS = {\n  create: true\n}\n\nexport function parseDragMeta(raw: DragMetaInput): DragMeta {\n  let leftoverProps = {}\n  let refined = refineProps(raw, DRAG_META_PROPS, DRAG_META_DEFAULTS, leftoverProps) as DragMeta\n\n  refined.leftoverProps = leftoverProps\n\n  return refined\n}\n","import { rangeContainsMarker } from '../datelib/date-range'\nimport { htmlEscape } from '../util/html'\nimport { buildGotoAnchorHtml, getDayClasses } from '../component/date-rendering'\nimport { DateMarker, DAY_IDS } from '../datelib/marker'\nimport { DateProfile } from '../DateProfileGenerator'\nimport { ComponentContext } from '../component/Component'\n\n// Computes a default column header formatting string if `colFormat` is not explicitly defined\nexport function computeFallbackHeaderFormat(datesRepDistinctDays: boolean, dayCnt: number) {\n  // if more than one week row, or if there are a lot of columns with not much space,\n  // put just the day numbers will be in each cell\n  if (!datesRepDistinctDays || dayCnt > 10) {\n    return { weekday: 'short' } // \"Sat\"\n  } else if (dayCnt > 1) {\n    return { weekday: 'short', month: 'numeric', day: 'numeric', omitCommas: true } // \"Sat 11/12\"\n  } else {\n    return { weekday: 'long' } // \"Saturday\"\n  }\n}\n\nexport function renderDateCell(\n  dateMarker: DateMarker,\n  dateProfile: DateProfile,\n  datesRepDistinctDays,\n  colCnt,\n  colHeadFormat,\n  context: ComponentContext,\n  colspan?,\n  otherAttrs?\n): string {\n  let { view, dateEnv, theme, options } = context\n  let isDateValid = rangeContainsMarker(dateProfile.activeRange, dateMarker) // TODO: called too frequently. cache somehow.\n  let classNames = [\n    'fc-day-header',\n    theme.getClass('widgetHeader')\n  ]\n  let innerHtml\n\n  if (typeof options.columnHeaderHtml === 'function') {\n    innerHtml = options.columnHeaderHtml(\n      dateEnv.toDate(dateMarker)\n    )\n  } else if (typeof options.columnHeaderText === 'function') {\n    innerHtml = htmlEscape(\n      options.columnHeaderText(\n        dateEnv.toDate(dateMarker)\n      )\n    )\n  } else {\n    innerHtml = htmlEscape(dateEnv.format(dateMarker, colHeadFormat))\n  }\n\n  // if only one row of days, the classNames on the header can represent the specific days beneath\n  if (datesRepDistinctDays) {\n    classNames = classNames.concat(\n      // includes the day-of-week class\n      // noThemeHighlight=true (don't highlight the header)\n      getDayClasses(dateMarker, dateProfile, context, true)\n    )\n  } else {\n    classNames.push('fc-' + DAY_IDS[dateMarker.getUTCDay()]) // only add the day-of-week class\n  }\n\n  return '' +\n    '<th class=\"' + classNames.join(' ') + '\"' +\n      ((isDateValid && datesRepDistinctDays) ?\n        ' data-date=\"' + dateEnv.formatIso(dateMarker, { omitTime: true }) + '\"' :\n        '') +\n        (colspan > 1 ?\n          ' colspan=\"' + colspan + '\"' :\n          '') +\n        (otherAttrs ?\n          ' ' + otherAttrs :\n          '') +\n      '>' +\n      (isDateValid ?\n        // don't make a link if the heading could represent multiple days, or if there's only one day (forceOff)\n        buildGotoAnchorHtml(\n          view,\n          { date: dateMarker, forceOff: !datesRepDistinctDays || colCnt === 1 },\n          innerHtml\n        ) :\n        // if not valid, display text, but no link\n        innerHtml\n      ) +\n    '</th>'\n}\n","import Component, { ComponentContext } from '../component/Component'\nimport { htmlToElement, removeElement } from '../util/dom-manip'\nimport { DateMarker } from '../datelib/marker'\nimport { DateProfile } from '../DateProfileGenerator'\nimport { createFormatter } from '../datelib/formatting'\nimport { computeFallbackHeaderFormat, renderDateCell } from './table-utils'\n\nexport interface DayTableHeaderProps {\n  dates: DateMarker[]\n  dateProfile: DateProfile\n  datesRepDistinctDays: boolean\n  renderIntroHtml?: () => string\n}\n\nexport default class DayHeader extends Component<DayTableHeaderProps> {\n\n  el: HTMLElement\n  thead: HTMLElement\n\n  constructor(context: ComponentContext, parentEl: HTMLElement) {\n    super(context)\n\n    parentEl.innerHTML = '' // because might be nbsp\n    parentEl.appendChild(\n      this.el = htmlToElement(\n        '<div class=\"fc-row ' + this.theme.getClass('headerRow') + '\">' +\n          '<table class=\"' + this.theme.getClass('tableGrid') + '\">' +\n            '<thead></thead>' +\n          '</table>' +\n        '</div>'\n      )\n    )\n\n    this.thead = this.el.querySelector('thead')\n  }\n\n  destroy() {\n    removeElement(this.el)\n  }\n\n  render(props: DayTableHeaderProps) {\n    let { dates, datesRepDistinctDays } = props\n    let parts = []\n\n    if (props.renderIntroHtml) {\n      parts.push(props.renderIntroHtml())\n    }\n\n    let colHeadFormat = createFormatter(\n      this.opt('columnHeaderFormat') ||\n      computeFallbackHeaderFormat(datesRepDistinctDays, dates.length)\n    )\n\n    for (let date of dates) {\n      parts.push(\n        renderDateCell(\n          date,\n          props.dateProfile,\n          datesRepDistinctDays,\n          dates.length,\n          colHeadFormat,\n          this.context\n        )\n      )\n    }\n\n    if (this.isRtl) {\n      parts.reverse()\n    }\n\n    this.thead.innerHTML = '<tr>' + parts.join('') + '</tr>'\n  }\n\n}\n","import DateProfileGenerator from '../DateProfileGenerator'\nimport { DateMarker, addDays, diffDays } from '../datelib/marker'\nimport { DateRange } from '../datelib/date-range'\n\nexport interface DaySeriesSeg {\n  firstIndex: number\n  lastIndex: number\n  isStart: boolean\n  isEnd: boolean\n}\n\nexport default class DaySeries {\n\n  cnt: number\n  dates: DateMarker[] // whole-day dates for each column. left to right\n  indices: number[] // for each day from start, the offset\n\n  constructor(range: DateRange, dateProfileGenerator: DateProfileGenerator) {\n    let date: DateMarker = range.start\n    let end: DateMarker = range.end\n    let indices: number[] = []\n    let dates: DateMarker[] = []\n    let dayIndex = -1\n\n    while (date < end) { // loop each day from start to end\n      if (dateProfileGenerator.isHiddenDay(date)) {\n        indices.push(dayIndex + 0.5) // mark that it's between indices\n      } else {\n        dayIndex++\n        indices.push(dayIndex)\n        dates.push(date)\n      }\n      date = addDays(date, 1)\n    }\n\n    this.dates = dates\n    this.indices = indices\n    this.cnt = dates.length\n  }\n\n  sliceRange(range: DateRange): DaySeriesSeg | null {\n    let firstIndex = this.getDateDayIndex(range.start) // inclusive first index\n    let lastIndex = this.getDateDayIndex(addDays(range.end, -1)) // inclusive last index\n\n    let clippedFirstIndex = Math.max(0, firstIndex)\n    let clippedLastIndex = Math.min(this.cnt - 1, lastIndex)\n\n    // deal with in-between indices\n    clippedFirstIndex = Math.ceil(clippedFirstIndex) // in-between starts round to next cell\n    clippedLastIndex = Math.floor(clippedLastIndex) // in-between ends round to prev cell\n\n    if (clippedFirstIndex <= clippedLastIndex) {\n      return {\n        firstIndex: clippedFirstIndex,\n        lastIndex: clippedLastIndex,\n        isStart: firstIndex === clippedFirstIndex,\n        isEnd: lastIndex === clippedLastIndex\n      }\n    } else {\n      return null\n    }\n  }\n\n  // Given a date, returns its chronolocial cell-index from the first cell of the grid.\n  // If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.\n  // If before the first offset, returns a negative number.\n  // If after the last offset, returns an offset past the last cell offset.\n  // Only works for *start* dates of cells. Will not work for exclusive end dates for cells.\n  private getDateDayIndex(date: DateMarker) {\n    let indices = this.indices\n    let dayOffset = Math.floor(diffDays(this.dates[0], date))\n\n    if (dayOffset < 0) {\n      return indices[0] - 1\n    } else if (dayOffset >= indices.length) {\n      return indices[indices.length - 1] + 1\n    } else {\n      return indices[dayOffset]\n    }\n  }\n\n}\n","import DaySeries from './DaySeries'\nimport { DateRange } from '../datelib/date-range'\nimport { DateMarker } from '../datelib/marker'\nimport { Seg } from '../component/DateComponent'\n\nexport interface DayTableSeg extends Seg {\n  row: number\n  firstCol: number\n  lastCol: number\n}\n\nexport interface DayTableCell {\n  date: DateMarker\n  htmlAttrs?: string\n}\n\nexport default class DayTable {\n\n  rowCnt: number\n  colCnt: number\n  cells: DayTableCell[][]\n  headerDates: DateMarker[]\n\n  private daySeries: DaySeries\n\n  constructor(daySeries: DaySeries, breakOnWeeks: boolean) {\n    let { dates } = daySeries\n    let daysPerRow\n    let firstDay\n    let rowCnt\n\n    if (breakOnWeeks) {\n      // count columns until the day-of-week repeats\n      firstDay = dates[0].getUTCDay()\n      for (daysPerRow = 1; daysPerRow < dates.length; daysPerRow++) {\n        if (dates[daysPerRow].getUTCDay() === firstDay) {\n          break\n        }\n      }\n      rowCnt = Math.ceil(dates.length / daysPerRow)\n    } else {\n      rowCnt = 1\n      daysPerRow = dates.length\n    }\n\n    this.rowCnt = rowCnt\n    this.colCnt = daysPerRow\n    this.daySeries = daySeries\n    this.cells = this.buildCells()\n    this.headerDates = this.buildHeaderDates()\n  }\n\n  private buildCells() {\n    let rows = []\n\n    for (let row = 0; row < this.rowCnt; row++) {\n      let cells = []\n\n      for (let col = 0; col < this.colCnt; col++) {\n        cells.push(\n          this.buildCell(row, col)\n        )\n      }\n\n      rows.push(cells)\n    }\n\n    return rows\n  }\n\n  private buildCell(row, col) {\n    return {\n      date: this.daySeries.dates[row * this.colCnt + col]\n    }\n  }\n\n  private buildHeaderDates() {\n    let dates = []\n\n    for (let col = 0; col < this.colCnt; col++) {\n      dates.push(this.cells[0][col].date)\n    }\n\n    return dates\n  }\n\n  sliceRange(range: DateRange): DayTableSeg[] {\n    let { colCnt } = this\n    let seriesSeg = this.daySeries.sliceRange(range)\n    let segs: DayTableSeg[] = []\n\n    if (seriesSeg) {\n      let { firstIndex, lastIndex } = seriesSeg\n      let index = firstIndex\n\n      while (index <= lastIndex) {\n        let row = Math.floor(index / colCnt)\n        let nextIndex = Math.min((row + 1) * colCnt, lastIndex + 1)\n\n        segs.push({\n          row,\n          firstCol: index % colCnt,\n          lastCol: (nextIndex - 1) % colCnt,\n          isStart: seriesSeg.isStart && index === firstIndex,\n          isEnd: seriesSeg.isEnd && (nextIndex - 1) === lastIndex\n        })\n\n        index = nextIndex\n      }\n    }\n\n    return segs\n  }\n\n}\n","import { DateRange } from '../datelib/date-range'\nimport { EventStore, expandRecurring } from '../structs/event-store'\nimport { EventUiHash } from '../component/event-ui'\nimport { sliceEventStore, EventRenderRange } from '../component/event-rendering'\nimport { DateProfile } from '../DateProfileGenerator'\nimport DateComponent, { Seg, EventSegUiInteractionState } from '../component/DateComponent' // TODO: rename EventSegUiInteractionState, move here\nimport { DateSpan, fabricateEventRange } from '../structs/date-span'\nimport { EventInteractionState } from '../interactions/event-interaction-state'\nimport { Duration } from '../datelib/duration'\nimport { memoize } from '../util/memoize'\nimport { DateMarker, addMs } from '../datelib/marker'\n\nexport interface SliceableProps {\n  dateSelection: DateSpan\n  businessHours: EventStore\n  eventStore: EventStore\n  eventDrag: EventInteractionState | null\n  eventResize: EventInteractionState | null\n  eventSelection: string\n  eventUiBases: EventUiHash\n}\n\nexport interface SlicedProps<SegType extends Seg> {\n  dateSelectionSegs: SegType[]\n  businessHourSegs: SegType[]\n  fgEventSegs: SegType[]\n  bgEventSegs: SegType[]\n  eventDrag: EventSegUiInteractionState | null\n  eventResize: EventSegUiInteractionState | null\n  eventSelection: string\n}\n\nexport default abstract class Slicer<SegType extends Seg, ExtraArgs extends any[] = []> {\n\n  private sliceBusinessHours = memoize(this._sliceBusinessHours)\n  private sliceDateSelection = memoize(this._sliceDateSpan)\n  private sliceEventStore = memoize(this._sliceEventStore)\n  private sliceEventDrag = memoize(this._sliceInteraction)\n  private sliceEventResize = memoize(this._sliceInteraction)\n\n  abstract sliceRange(dateRange: DateRange, ...extraArgs: ExtraArgs): SegType[]\n\n  sliceProps(\n    props: SliceableProps,\n    dateProfile: DateProfile,\n    nextDayThreshold: Duration | null,\n    component: DateComponent<any>, // TODO: kill\n    ...extraArgs: ExtraArgs\n  ): SlicedProps<SegType> {\n    let { eventUiBases } = props\n    let eventSegs = this.sliceEventStore(props.eventStore, eventUiBases, dateProfile, nextDayThreshold, component, ...extraArgs)\n\n    return {\n      dateSelectionSegs: this.sliceDateSelection(props.dateSelection, eventUiBases, component, ...extraArgs),\n      businessHourSegs: this.sliceBusinessHours(props.businessHours, dateProfile, nextDayThreshold, component, ...extraArgs),\n      fgEventSegs: eventSegs.fg,\n      bgEventSegs: eventSegs.bg,\n      eventDrag: this.sliceEventDrag(props.eventDrag, eventUiBases, dateProfile, nextDayThreshold, component, ...extraArgs),\n      eventResize: this.sliceEventResize(props.eventResize, eventUiBases, dateProfile, nextDayThreshold, component, ...extraArgs),\n      eventSelection: props.eventSelection\n    } // TODO: give interactionSegs?\n  }\n\n  sliceNowDate( // does not memoize\n    date: DateMarker,\n    component: DateComponent<any>, // TODO: kill\n    ...extraArgs: ExtraArgs\n  ): SegType[] {\n    return this._sliceDateSpan(\n      { range: { start: date, end: addMs(date, 1) }, allDay: false }, // add 1 ms, protect against null range\n      {},\n      component,\n      ...extraArgs\n    )\n  }\n\n  private _sliceBusinessHours(\n    businessHours: EventStore,\n    dateProfile: DateProfile,\n    nextDayThreshold: Duration | null,\n    component: DateComponent<any>, // TODO: kill\n    ...extraArgs: ExtraArgs\n  ): SegType[] {\n    if (!businessHours) {\n      return []\n    }\n\n    return this._sliceEventStore(\n      expandRecurring(\n        businessHours,\n        computeActiveRange(dateProfile, Boolean(nextDayThreshold)),\n        component.calendar\n      ),\n      {},\n      dateProfile,\n      nextDayThreshold,\n      component,\n      ...extraArgs\n    ).bg\n  }\n\n  private _sliceEventStore(\n    eventStore: EventStore,\n    eventUiBases: EventUiHash,\n    dateProfile: DateProfile,\n    nextDayThreshold: Duration | null,\n    component: DateComponent<any>, // TODO: kill\n    ...extraArgs: ExtraArgs\n  ): { bg: SegType[], fg: SegType[] } {\n    if (eventStore) {\n      let rangeRes = sliceEventStore(\n        eventStore,\n        eventUiBases,\n        computeActiveRange(dateProfile, Boolean(nextDayThreshold)),\n        nextDayThreshold\n      )\n\n      return {\n        bg: this.sliceEventRanges(rangeRes.bg, component, extraArgs),\n        fg: this.sliceEventRanges(rangeRes.fg, component, extraArgs)\n      }\n\n    } else {\n      return { bg: [], fg: [] }\n    }\n  }\n\n  private _sliceInteraction(\n    interaction: EventInteractionState,\n    eventUiBases: EventUiHash,\n    dateProfile: DateProfile,\n    nextDayThreshold: Duration | null,\n    component: DateComponent<any>, // TODO: kill\n    ...extraArgs: ExtraArgs\n  ): EventSegUiInteractionState {\n    if (!interaction) {\n      return null\n    }\n\n    let rangeRes = sliceEventStore(\n      interaction.mutatedEvents,\n      eventUiBases,\n      computeActiveRange(dateProfile, Boolean(nextDayThreshold)),\n      nextDayThreshold\n    )\n\n    return {\n      segs: this.sliceEventRanges(rangeRes.fg, component, extraArgs),\n      affectedInstances: interaction.affectedEvents.instances,\n      isEvent: interaction.isEvent,\n      sourceSeg: interaction.origSeg\n    }\n  }\n\n  private _sliceDateSpan(\n    dateSpan: DateSpan,\n    eventUiBases: EventUiHash,\n    component: DateComponent<any>, // TODO: kill\n    ...extraArgs: ExtraArgs\n  ): SegType[] {\n    if (!dateSpan) {\n      return []\n    }\n\n    let eventRange = fabricateEventRange(dateSpan, eventUiBases, component.calendar)\n    let segs = this.sliceRange(dateSpan.range, ...extraArgs)\n\n    for (let seg of segs) {\n      seg.component = component\n      seg.eventRange = eventRange\n    }\n\n    return segs\n  }\n\n  /*\n  \"complete\" seg means it has component and eventRange\n  */\n  private sliceEventRanges(\n    eventRanges: EventRenderRange[],\n    component: DateComponent<any>, // TODO: kill\n    extraArgs: ExtraArgs\n  ): SegType[] {\n    let segs: SegType[] = []\n\n    for (let eventRange of eventRanges) {\n      segs.push(...this.sliceEventRange(eventRange, component, extraArgs))\n    }\n\n    return segs\n  }\n\n  /*\n  \"complete\" seg means it has component and eventRange\n  */\n  private sliceEventRange(\n    eventRange: EventRenderRange,\n    component: DateComponent<any>, // TODO: kill\n    extraArgs: ExtraArgs\n  ): SegType[] {\n    let segs = this.sliceRange(eventRange.range, ...extraArgs)\n\n    for (let seg of segs) {\n      seg.component = component\n      seg.eventRange = eventRange\n      seg.isStart = eventRange.isStart && seg.isStart\n      seg.isEnd = eventRange.isEnd && seg.isEnd\n    }\n\n    return segs\n  }\n\n}\n\n/*\nfor incorporating minTime/maxTime if appropriate\nTODO: should be part of DateProfile!\nTimelineDateProfile already does this btw\n*/\nfunction computeActiveRange(dateProfile: DateProfile, isComponentAllDay: boolean): DateRange {\n  let range = dateProfile.activeRange\n\n  if (isComponentAllDay) {\n    return range\n  }\n\n  return {\n    start: addMs(range.start, dateProfile.minTime.milliseconds),\n    end: addMs(range.end, dateProfile.maxTime.milliseconds - 864e5) // 864e5 = ms in a day\n  }\n}\n","\n// exports\n// --------------------------------------------------------------------------------------------------\n\nexport const version = '<%= version %>'\n\n// types\nexport { OptionsInput } from './types/input-types'\nexport {\n  EventInput, EventDef, EventDefHash, EventInstance, EventInstanceHash,\n  parseEventDef, createEventInstance, EventTuple\n} from './structs/event'\nexport { BusinessHoursInput, parseBusinessHours } from './structs/business-hours'\n\nexport {\n  applyAll,\n  debounce,\n  padStart,\n  isInt,\n  capitaliseFirstLetter,\n  parseFieldSpecs,\n  compareByFieldSpecs,\n  compareByFieldSpec,\n  flexibleCompare,\n  computeVisibleDayRange,\n  refineProps,\n  matchCellWidths, uncompensateScroll, compensateScroll, subtractInnerElHeight,\n  isMultiDayRange,\n  distributeHeight,\n  undistributeHeight,\n  preventSelection, allowSelection, preventContextMenu, allowContextMenu,\n  compareNumbers, enableCursor, disableCursor,\n  diffDates\n} from './util/misc'\n\nexport {\n  htmlEscape,\n  cssToStr\n} from './util/html'\n\nexport {\n  removeExact,\n  isArraysEqual\n} from './util/array'\n\nexport { memoize, memoizeOutput } from './util/memoize'\nexport { memoizeRendering, MemoizedRendering } from './component/memoized-rendering'\n\nexport {\n  intersectRects,\n  Rect, pointInsideRect,\n  constrainPoint,\n  getRectCenter, diffPoints, Point,\n  translateRect\n} from './util/geom'\n\nexport { mapHash, filterHash, isPropsEqual } from './util/object'\n\nexport {\n  findElements,\n  findChildren,\n  htmlToElement,\n  createElement,\n  insertAfterElement,\n  prependToElement,\n  removeElement,\n  appendToElement,\n  applyStyle,\n  applyStyleProp,\n  elementMatches,\n  elementClosest,\n  forceClassName\n} from './util/dom-manip'\n\nexport { EventStore, filterEventStoreDefs, createEmptyEventStore, mergeEventStores, getRelevantEvents, eventTupleToStore } from './structs/event-store'\nexport { EventUiHash, EventUi, processScopedUiProps, combineEventUis } from './component/event-ui'\nexport { default as Splitter, SplittableProps } from './component/event-splitting'\nexport { buildGotoAnchorHtml, getAllDayHtml, getDayClasses } from './component/date-rendering'\n\nexport {\n  preventDefault,\n  listenBySelector,\n  whenTransitionDone\n} from './util/dom-event'\n\nexport {\n  computeInnerRect,\n  computeEdges,\n  computeHeightAndMargins,\n  getClippingParents,\n  computeClippingRect,\n  computeRect\n} from './util/dom-geom'\n\nexport { unpromisify } from './util/promise'\n\nexport { default as EmitterMixin, EmitterInterface } from './common/EmitterMixin'\nexport { DateRange, rangeContainsMarker, intersectRanges, rangesEqual, rangesIntersect, rangeContainsRange } from './datelib/date-range'\nexport { default as Mixin } from './common/Mixin'\nexport { default as PositionCache } from './common/PositionCache'\nexport { default as ScrollComponent, ScrollbarWidths } from './common/ScrollComponent'\nexport { ScrollController, ElementScrollController, WindowScrollController } from './common/scroll-controller'\nexport { default as Theme } from './theme/Theme'\nexport { default as Component, ComponentContext } from './component/Component'\nexport { default as DateComponent, Seg, EventSegUiInteractionState } from './component/DateComponent'\nexport { default as Calendar, DatePointTransform, DateSpanTransform, DateSelectionApi } from './Calendar'\nexport { default as View, ViewProps } from './View'\nexport { default as FgEventRenderer, buildSegCompareObj } from './component/renderers/FgEventRenderer'\nexport { default as FillRenderer } from './component/renderers/FillRenderer'\n\nexport { default as DateProfileGenerator, DateProfile } from './DateProfileGenerator'\nexport { ViewDef } from './structs/view-def'\nexport { ViewSpec } from './structs/view-spec'\nexport { DateSpan, DateSpanApi, DatePointApi, isDateSpansEqual } from './structs/date-span'\n\nexport { DateMarker, addDays, startOfDay, addMs, addWeeks, diffWeeks, diffWholeWeeks, diffWholeDays, diffDayAndTime, diffDays, isValidDate } from './datelib/marker'\nexport {\n  Duration, createDuration,\n  isSingleDay, multiplyDuration, addDurations,\n  asRoughMinutes, asRoughSeconds, asRoughMs,\n  wholeDivideDurations, greatestDurationDenominator\n} from './datelib/duration'\nexport { DateEnv, DateMarkerMeta } from './datelib/env'\n\nexport {\n  DateFormatter,\n  createFormatter,\n  VerboseFormattingArg,\n  formatIsoTimeString\n} from './datelib/formatting'\nexport { NamedTimeZoneImpl } from './datelib/timezone'\nexport { parse as parseMarker } from './datelib/parsing'\n\nexport { EventSourceDef, EventSource, EventSourceHash } from './structs/event-source'\n\nexport { Interaction, InteractionSettings, interactionSettingsToStore, interactionSettingsStore, InteractionSettingsStore } from './interactions/interaction'\nexport { PointerDragEvent } from './interactions/pointer'\nexport { Hit } from './interactions/hit'\nexport { dateSelectionJoinTransformer } from './interactions/date-selecting'\nexport { eventDragMutationMassager, EventDropTransformers } from './interactions/event-dragging'\nexport { EventResizeJoinTransforms } from './interactions/event-resizing'\nexport { default as ElementDragging } from './interactions/ElementDragging'\n\nexport { formatDate, formatRange } from './formatting-api'\n\nexport { globalDefaults, config } from './options'\n\nexport { RecurringType, ParsedRecurring } from './structs/recurring-event'\n\nexport { DragMetaInput, DragMeta, parseDragMeta } from './structs/drag-meta'\n\nexport { createPlugin, PluginDef, PluginDefInput, ViewPropsTransformer, ViewContainerModifier } from './plugin-system'\nexport { reducerFunc, Action, CalendarState } from './reducers/types'\nexport { CalendarComponentProps } from './CalendarComponent'\n\nexport { default as DayHeader } from './common/DayHeader'\nexport { computeFallbackHeaderFormat, renderDateCell } from './common/table-utils'\n\nexport { default as DaySeries } from './common/DaySeries'\n\nexport { EventInteractionState } from './interactions/event-interaction-state'\nexport { EventRenderRange, sliceEventStore, hasBgRendering, getElSeg } from './component/event-rendering'\n\nexport { default as DayTable, DayTableSeg, DayTableCell } from './common/DayTable'\n\nexport { default as Slicer, SlicedProps } from './common/slicing-utils'\n\nexport { EventMutation, applyMutationToEventStore } from './structs/event-mutation'\nexport { Constraint, ConstraintInput, AllowFunc, isPropsValid, isInteractionValid } from './validation'\nexport { default as EventApi } from './api/EventApi'\n\nexport { default as requestJson } from './util/requestJson'\n"],"names":["tslib_1.__assign","tslib_1.__extends","uid","eventSourceDef","buildDateEnv"],"mappings":";;;;;;AAIA,IAAM,eAAe,GAAG;IACtB,SAAS,EAAE,IAAI;IACf,OAAO,EAAE,IAAI;IACb,OAAO,EAAE,IAAI;CACd,CAAA;AAED,IAAM,gBAAgB,GAAG;IACvB,KAAK,EAAE,OAAO;IACd,KAAK,EAAE,IAAI;CACZ,CAAA;AAED,SAAgB,aAAa,CAAC,OAAe,EAAE,KAAoB,EAAE,OAAwB;IAC3F,IAAI,EAAE,GAAgB,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;IAErD,IAAI,KAAK,EAAE;QACT,KAAK,IAAI,QAAQ,IAAI,KAAK,EAAE;YAC1B,IAAI,QAAQ,KAAK,OAAO,EAAE;gBACxB,UAAU,CAAC,EAAE,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAA;aAChC;iBAAM,IAAI,eAAe,CAAC,QAAQ,CAAC,EAAE;gBACpC,EAAE,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAA;aAC/B;iBAAM;gBACL,EAAE,CAAC,YAAY,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAA;aAC3C;SACF;KACF;IAED,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;QAC/B,EAAE,CAAC,SAAS,GAAG,OAAO,CAAA;KACvB;SAAM,IAAI,OAAO,IAAI,IAAI,EAAE;QAC1B,eAAe,CAAC,EAAE,EAAE,OAAO,CAAC,CAAA;KAC7B;IAED,OAAO,EAAE,CAAA;CACV;AAED,SAAgB,aAAa,CAAC,IAAY;IACxC,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,CAAA;IAClB,IAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAA;IACjE,SAAS,CAAC,SAAS,GAAG,IAAI,CAAA;IAC1B,OAAO,SAAS,CAAC,UAAyB,CAAA;CAC3C;AAED,SAAgB,cAAc,CAAC,IAAY;IACzC,OAAO,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAA;CACxD;AAED,SAAS,cAAc,CAAC,IAAY;IAClC,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,CAAA;IAClB,IAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC,CAAA;IACjE,SAAS,CAAC,SAAS,GAAG,IAAI,CAAA;IAC1B,OAAO,SAAS,CAAC,UAAU,CAAA;CAC5B;AAGD,SAAS,mBAAmB,CAAC,IAAY;IACvC,OAAO,gBAAgB,CACrB,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;KAClB,IAAI,KAAK,CAAA;CACX;AAQD,SAAgB,eAAe,CAAC,EAAe,EAAE,OAAuB;IACtE,IAAI,UAAU,GAAG,gBAAgB,CAAC,OAAO,CAAC,CAAA;IAE1C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAC1C,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAA;KAC9B;CACF;AAED,SAAgB,gBAAgB,CAAC,MAAmB,EAAE,OAAuB;IAC3E,IAAI,MAAM,GAAG,gBAAgB,CAAC,OAAO,CAAC,CAAA;IACtC,IAAI,OAAO,GAAG,MAAM,CAAC,UAAU,IAAI,IAAI,CAAA;IAEvC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACtC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAA;KACxC;CACF;AAED,SAAgB,kBAAkB,CAAC,KAAkB,EAAE,OAAuB;IAC5E,IAAI,MAAM,GAAG,gBAAgB,CAAC,OAAO,CAAC,CAAA;IACtC,IAAI,OAAO,GAAG,KAAK,CAAC,WAAW,IAAI,IAAI,CAAA;IAEvC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACtC,KAAK,CAAC,UAAU,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAA;KAClD;CACF;AAED,SAAS,gBAAgB,CAAC,OAAuB;IAC/C,IAAI,GAAG,CAAA;IACP,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;QAC/B,GAAG,GAAG,cAAc,CAAC,OAAO,CAAC,CAAA;KAC9B;SAAM,IAAI,OAAO,YAAY,IAAI,EAAE;QAClC,GAAG,GAAG,CAAE,OAAO,CAAE,CAAA;KAClB;SAAM;QACL,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;KAC1C;IACD,OAAO,GAAG,CAAA;CACX;AAED,SAAgB,aAAa,CAAC,EAAe;IAC3C,IAAI,EAAE,CAAC,UAAU,EAAE;QACjB,EAAE,CAAC,UAAU,CAAC,WAAW,CAAC,EAAE,CAAC,CAAA;KAC9B;CACF;AAOD,IAAM,aAAa,GACjB,OAAO,CAAC,SAAS,CAAC,OAAO;IACxB,OAAO,CAAC,SAAiB,CAAC,eAAe;IACzC,OAAO,CAAC,SAAiB,CAAC,iBAAiB,CAAA;AAE9C,IAAM,aAAa,GAAG,OAAO,CAAC,SAAS,CAAC,OAAO,IAAI,UAAS,QAAQ;IAElE,IAAI,EAAE,GAAG,IAAI,CAAA;IACb,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE;QAC1C,OAAO,IAAI,CAAA;KACZ;IACD,GAAG;QACD,IAAI,cAAc,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAE;YAChC,OAAO,EAAE,CAAA;SACV;QACD,EAAE,GAAG,EAAE,CAAC,aAAa,IAAI,EAAE,CAAC,UAAU,CAAA;KACvC,QAAQ,EAAE,KAAK,IAAI,IAAI,EAAE,CAAC,QAAQ,KAAK,CAAC,EAAC;IAC1C,OAAO,IAAI,CAAA;CACZ,CAAA;AAED,SAAgB,cAAc,CAAC,EAAe,EAAE,QAAgB;IAC9D,OAAO,aAAa,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAA;CACxC;AAED,SAAgB,cAAc,CAAC,EAAe,EAAE,QAAgB;IAC9D,OAAO,aAAa,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAA;CACxC;AAID,SAAgB,YAAY,CAAC,SAAgE,EAAE,QAAgB;IAC7G,IAAI,UAAU,GAAG,SAAS,YAAY,WAAW,GAAG,CAAE,SAAS,CAAE,GAAG,SAAS,CAAA;IAC7E,IAAI,UAAU,GAAkB,EAAE,CAAA;IAElC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAC1C,IAAI,OAAO,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAA;QAEtD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACvC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAgB,CAAC,CAAA;SAC3C;KACF;IAED,OAAO,UAAU,CAAA;CAClB;AAID,SAAgB,YAAY,CAAC,MAAmC,EAAE,QAAiB;IACjF,IAAI,OAAO,GAAG,MAAM,YAAY,WAAW,GAAG,CAAE,MAAM,CAAE,GAAG,MAAM,CAAA;IACjE,IAAI,UAAU,GAAG,EAAE,CAAA;IAEnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACvC,IAAI,UAAU,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAA;QAEpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC1C,IAAI,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAA;YAE7B,IAAI,CAAC,QAAQ,IAAI,cAAc,CAAC,SAAwB,EAAE,QAAQ,CAAC,EAAE;gBACnE,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;aAC3B;SACF;KACF;IAED,OAAO,UAAU,CAAA;CAClB;AAMD,SAAgB,cAAc,CAAC,EAAe,EAAE,SAAiB,EAAE,IAAI;IACrE,IAAI,IAAI,EAAE;QACR,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAA;KAC5B;SAAM;QACL,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAA;KAC/B;CACF;AAMD,IAAM,aAAa,GAAG,wCAAwC,CAAA;AAE9D,SAAgB,UAAU,CAAC,EAAe,EAAE,KAAa;IACvD,KAAK,IAAI,QAAQ,IAAI,KAAK,EAAE;QAC1B,cAAc,CAAC,EAAE,EAAE,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAA;KAC9C;CACF;AAED,SAAgB,cAAc,CAAC,EAAe,EAAE,IAAY,EAAE,GAAG;IAC/D,IAAI,GAAG,IAAI,IAAI,EAAE;QACf,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,CAAA;KACpB;SAAM,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;QAC9D,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,IAAI,CAAA;KAC5B;SAAM;QACL,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,GAAG,CAAA;KACrB;CACF;;SC3Me,eAAe,CAAC,KAAY,EAAE,IAAU;IACtD,OAAO,KAAK,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI;QAC5B,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK;QACvB,KAAK,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG;QACrB,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,CAAA;CAC1B;AAID,SAAgB,cAAc,CAAC,KAAW,EAAE,KAAW;IACrD,IAAI,GAAG,GAAG;QACR,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC;QACtC,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC;QACzC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC;QACnC,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC;KAC7C,CAAA;IAED,IAAI,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,MAAM,EAAE;QAChD,OAAO,GAAG,CAAA;KACX;IAED,OAAO,KAAK,CAAA;CACb;AAGD,SAAgB,aAAa,CAAC,IAAU,EAAE,MAAc,EAAE,MAAc;IACtE,OAAO;QACL,IAAI,EAAE,IAAI,CAAC,IAAI,GAAG,MAAM;QACxB,KAAK,EAAE,IAAI,CAAC,KAAK,GAAG,MAAM;QAC1B,GAAG,EAAE,IAAI,CAAC,GAAG,GAAG,MAAM;QACtB,MAAM,EAAE,IAAI,CAAC,MAAM,GAAG,MAAM;KAC7B,CAAA;CACF;AAID,SAAgB,cAAc,CAAC,KAAY,EAAE,IAAU;IACrD,OAAO;QACL,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC;QAC3D,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC;KAC1D,CAAA;CACF;AAID,SAAgB,aAAa,CAAC,IAAU;IACtC,OAAO;QACL,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,IAAI,CAAC;QAClC,GAAG,EAAE,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,IAAI,CAAC;KAClC,CAAA;CACF;AAID,SAAgB,UAAU,CAAC,MAAa,EAAE,MAAa;IACrD,OAAO;QACL,IAAI,EAAE,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI;QAC/B,GAAG,EAAE,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG;KAC7B,CAAA;CACF;;ACpED,IAAI,oBAAoB,GAAmB,IAAI,CAAA;AAE/C,SAAgB,uBAAuB;IACrC,IAAI,oBAAoB,KAAK,IAAI,EAAE;QACjC,oBAAoB,GAAG,2BAA2B,EAAE,CAAA;KACrD;IACD,OAAO,oBAAoB,CAAA;CAC5B;AAED,SAAS,2BAA2B;IAClC,IAAI,OAAO,GAAG,aAAa,CAAC,KAAK,EAAE;QACjC,KAAK,EAAE;YACL,QAAQ,EAAE,UAAU;YACpB,GAAG,EAAE,CAAC,IAAI;YACV,IAAI,EAAE,CAAC;YACP,MAAM,EAAE,CAAC;YACT,OAAO,EAAE,CAAC;YACV,QAAQ,EAAE,QAAQ;YAClB,SAAS,EAAE,KAAK;SACjB;KACF,EAAE,aAAa,CAAC,CAAA;IAEjB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAA;IAClC,IAAI,OAAO,GAAG,OAAO,CAAC,UAAyB,CAAA;IAC/C,IAAI,GAAG,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC,IAAI,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC,IAAI,CAAA;IAErF,aAAa,CAAC,OAAO,CAAC,CAAA;IACtB,OAAO,GAAG,CAAA;CACX;AAKD,SAAgB,sBAAsB,CAAC,KAAa;IAClD,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAA;IAC1B,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;IACzB,OAAO,KAAK,CAAA;CACb;;SCxBe,YAAY,CAAC,EAAE,EAAE,UAAkB;IAAlB,2BAAA,EAAA,kBAAkB;IACjD,IAAI,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAA;IAC/C,IAAI,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,eAAe,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;IACjE,IAAI,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,gBAAgB,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;IACnE,IAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,cAAc,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;IAC/D,IAAI,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,iBAAiB,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;IAGrE,IAAI,kBAAkB,GAAG,sBAAsB,CAAC,EAAE,CAAC,WAAW,GAAG,EAAE,CAAC,WAAW,GAAG,UAAU,GAAG,WAAW,CAAC,CAAA;IAC3G,IAAI,eAAe,GAAG,sBAAsB,CAAC,EAAE,CAAC,YAAY,GAAG,EAAE,CAAC,YAAY,GAAG,SAAS,GAAG,YAAY,CAAC,CAAA;IAE1G,IAAI,GAAG,GAAa;QAClB,UAAU,YAAA;QACV,WAAW,aAAA;QACX,SAAS,WAAA;QACT,YAAY,cAAA;QACZ,eAAe,iBAAA;QACf,aAAa,EAAE,CAAC;QAChB,cAAc,EAAE,CAAC;KAClB,CAAA;IAED,IAAI,uBAAuB,EAAE,IAAI,aAAa,CAAC,SAAS,KAAK,KAAK,EAAE;QAClE,GAAG,CAAC,aAAa,GAAG,kBAAkB,CAAA;KACvC;SAAM;QACL,GAAG,CAAC,cAAc,GAAG,kBAAkB,CAAA;KACxC;IAED,IAAI,UAAU,EAAE;QACd,GAAG,CAAC,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;QAC9D,GAAG,CAAC,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,YAAY,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;QAChE,GAAG,CAAC,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;QAC5D,GAAG,CAAC,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,EAAE,EAAE,CAAC,IAAI,CAAC,CAAA;KACnE;IAED,OAAO,GAAG,CAAA;CACX;AAGD,SAAgB,gBAAgB,CAAC,EAAE,EAAE,eAAuB;IAAvB,gCAAA,EAAA,uBAAuB;IAC1D,IAAI,SAAS,GAAG,WAAW,CAAC,EAAE,CAAC,CAAA;IAC/B,IAAI,KAAK,GAAG,YAAY,CAAC,EAAE,EAAE,eAAe,CAAC,CAAA;IAC7C,IAAI,GAAG,GAAG;QACR,IAAI,EAAE,SAAS,CAAC,IAAI,GAAG,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC,aAAa;QAC7D,KAAK,EAAE,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,cAAc;QACjE,GAAG,EAAE,SAAS,CAAC,GAAG,GAAG,KAAK,CAAC,SAAS;QACpC,MAAM,EAAE,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,eAAe;KACtE,CAAA;IAED,IAAI,eAAe,EAAE;QACnB,GAAG,CAAC,IAAI,IAAI,KAAK,CAAC,WAAW,CAAA;QAC7B,GAAG,CAAC,KAAK,IAAI,KAAK,CAAC,YAAY,CAAA;QAC/B,GAAG,CAAC,GAAG,IAAI,KAAK,CAAC,UAAU,CAAA;QAC3B,GAAG,CAAC,MAAM,IAAI,KAAK,CAAC,aAAa,CAAA;KAClC;IAED,OAAO,GAAG,CAAA;CACX;AAGD,SAAgB,WAAW,CAAC,EAAE;IAC5B,IAAI,IAAI,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAA;IAErC,OAAO;QACL,IAAI,EAAE,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,WAAW;QACpC,GAAG,EAAE,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,WAAW;QAClC,KAAK,EAAE,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,WAAW;QACtC,MAAM,EAAE,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,WAAW;KACzC,CAAA;CACF;AAGD,SAAS,mBAAmB;IAC1B,OAAO;QACL,IAAI,EAAE,MAAM,CAAC,WAAW;QACxB,KAAK,EAAE,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC,eAAe,CAAC,WAAW;QAChE,GAAG,EAAE,MAAM,CAAC,WAAW;QACvB,MAAM,EAAE,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC,eAAe,CAAC,YAAY;KACnE,CAAA;CACF;AAGD,SAAgB,uBAAuB,CAAC,EAAe;IACrD,OAAO,EAAE,CAAC,qBAAqB,EAAE,CAAC,MAAM,GAAG,eAAe,CAAC,EAAE,CAAC,CAAA;CAC/D;AAGD,SAAgB,eAAe,CAAC,EAAe;IAC7C,IAAI,QAAQ,GAAG,MAAM,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAA;IAE1C,OAAO,QAAQ,CAAC,QAAQ,CAAC,SAAS,EAAE,EAAE,CAAC;QACrC,QAAQ,CAAC,QAAQ,CAAC,YAAY,EAAE,EAAE,CAAC,CAAA;CACtC;AAID,SAAgB,kBAAkB,CAAC,EAAe;IAChD,IAAI,OAAO,GAAkB,EAAE,CAAA;IAE/B,OAAO,EAAE,YAAY,WAAW,EAAE;QAChC,IAAI,aAAa,GAAG,MAAM,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAA;QAE/C,IAAI,aAAa,CAAC,QAAQ,KAAK,OAAO,EAAE;YACtC,MAAK;SACN;QAED,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,aAAa,CAAC,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC,EAAE;YACtG,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;SACjB;QAED,EAAE,GAAG,EAAE,CAAC,UAAyB,CAAA;KAClC;IAED,OAAO,OAAO,CAAA;CACf;AAGD,SAAgB,mBAAmB,CAAC,EAAe;IACjD,OAAO,kBAAkB,CAAC,EAAE,CAAC;SAC1B,GAAG,CAAC,UAAS,EAAE;QACd,OAAO,gBAAgB,CAAC,EAAE,CAAC,CAAA;KAC5B,CAAC;SACD,MAAM,CAAC,mBAAmB,EAAE,CAAC;SAC7B,MAAM,CAAC,UAAS,KAAK,EAAE,KAAK;QAC3B,OAAO,cAAc,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,KAAK,CAAA;KAC7C,CAAC,CAAA;CACL;;SC3Ie,cAAc,CAAC,EAAE;IAC/B,EAAE,CAAC,cAAc,EAAE,CAAA;CACpB;AAMD,SAAgB,gBAAgB,CAC9B,SAAsB,EACtB,SAAiB,EACjB,QAAgB,EAChB,OAAwD;IAExD,SAAS,WAAW,CAAC,EAAS;QAC5B,IAAI,YAAY,GAAG,cAAc,CAAC,EAAE,CAAC,MAAqB,EAAE,QAAQ,CAAC,CAAA;QACrE,IAAI,YAAY,EAAE;YAChB,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,EAAE,EAAE,YAAY,CAAC,CAAA;SAC7C;KACF;IAED,SAAS,CAAC,gBAAgB,CAAC,SAAS,EAAE,WAAW,CAAC,CAAA;IAElD,OAAO;QACL,SAAS,CAAC,mBAAmB,CAAC,SAAS,EAAE,WAAW,CAAC,CAAA;KACtD,CAAA;CACF;AAED,SAAgB,uBAAuB,CACrC,SAAsB,EACtB,QAAgB,EAChB,YAA6D,EAC7D,YAA6D;IAE7D,IAAI,mBAAmB,CAAA;IAEvB,OAAO,gBAAgB,CAAC,SAAS,EAAE,WAAW,EAAE,QAAQ,EAAE,UAAS,EAAE,EAAE,YAAY;QACjF,IAAI,YAAY,KAAK,mBAAmB,EAAE;YACxC,mBAAmB,GAAG,YAAY,CAAA;YAClC,YAAY,CAAC,EAAE,EAAE,YAAY,CAAC,CAAA;YAE9B,IAAI,kBAAgB,GAAG,UAAC,EAAE;gBACxB,mBAAmB,GAAG,IAAI,CAAA;gBAC1B,YAAY,CAAC,EAAE,EAAE,YAAY,CAAC,CAAA;gBAC9B,YAAY,CAAC,mBAAmB,CAAC,YAAY,EAAE,kBAAgB,CAAC,CAAA;aACjE,CAAA;YAGD,YAAY,CAAC,gBAAgB,CAAC,YAAY,EAAE,kBAAgB,CAAC,CAAA;SAC9D;KACF,CAAC,CAAA;CACH;AAMD,IAAM,oBAAoB,GAAG;IAC3B,qBAAqB;IACrB,gBAAgB;IAChB,gBAAgB;IAChB,iBAAiB;IACjB,eAAe;CAChB,CAAA;AAGD,SAAgB,kBAAkB,CAAC,EAAe,EAAE,QAA6B;IAC/E,IAAI,YAAY,GAAG,UAAS,EAAE;QAC5B,QAAQ,CAAC,EAAE,CAAC,CAAA;QACZ,oBAAoB,CAAC,OAAO,CAAC,UAAS,SAAS;YAC7C,EAAE,CAAC,mBAAmB,CAAC,SAAS,EAAE,YAAY,CAAC,CAAA;SAChD,CAAC,CAAA;KACH,CAAA;IAED,oBAAoB,CAAC,OAAO,CAAC,UAAS,SAAS;QAC7C,EAAE,CAAC,gBAAgB,CAAC,SAAS,EAAE,YAAY,CAAC,CAAA;KAC7C,CAAC,CAAA;CACH;;AC7EM,IAAM,OAAO,GAAG,CAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAE,CAAA;AAK1E,SAAgB,QAAQ,CAAC,CAAa,EAAE,CAAS;IAC/C,IAAI,CAAC,GAAG,cAAc,CAAC,CAAC,CAAC,CAAA;IACzB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IACb,OAAO,cAAc,CAAC,CAAC,CAAC,CAAA;CACzB;AAED,SAAgB,OAAO,CAAC,CAAa,EAAE,CAAS;IAC9C,IAAI,CAAC,GAAG,cAAc,CAAC,CAAC,CAAC,CAAA;IACzB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;IACT,OAAO,cAAc,CAAC,CAAC,CAAC,CAAA;CACzB;AAED,SAAgB,KAAK,CAAC,CAAa,EAAE,CAAS;IAC5C,IAAI,CAAC,GAAG,cAAc,CAAC,CAAC,CAAC,CAAA;IACzB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;IACT,OAAO,cAAc,CAAC,CAAC,CAAC,CAAA;CACzB;AAKD,SAAgB,SAAS,CAAC,EAAE,EAAE,EAAE;IAC9B,OAAO,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,GAAG,CAAC,CAAA;CAC5B;AAED,SAAgB,QAAQ,CAAC,EAAE,EAAE,EAAE;IAC7B,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,EAAE,KAAK,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAA;CAC7D;AAED,SAAgB,SAAS,CAAC,EAAE,EAAE,EAAE;IAC9B,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,EAAE,KAAK,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,CAAA;CACxD;AAED,SAAgB,WAAW,CAAC,EAAE,EAAE,EAAE;IAChC,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,EAAE,KAAK,IAAI,GAAG,EAAE,CAAC,CAAA;CACnD;AAED,SAAgB,WAAW,CAAC,EAAE,EAAE,EAAE;IAChC,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,EAAE,IAAI,IAAI,CAAA;CAC5C;AAED,SAAgB,cAAc,CAAC,EAAc,EAAE,EAAc;IAC3D,IAAI,KAAK,GAAG,UAAU,CAAC,EAAE,CAAC,CAAA;IAC1B,IAAI,KAAK,GAAG,UAAU,CAAC,EAAE,CAAC,CAAA;IAE1B,OAAO;QACL,KAAK,EAAE,CAAC;QACR,MAAM,EAAE,CAAC;QACT,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QACxC,YAAY,EAAE,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,KAAK,CAAC,OAAO,EAAE,KAAK,EAAE,CAAC,OAAO,EAAE,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;KAClF,CAAA;CACF;AAKD,SAAgB,cAAc,CAAC,EAAc,EAAE,EAAc;IAC3D,IAAI,CAAC,GAAG,aAAa,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;IAE7B,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;QAC7B,OAAO,CAAC,GAAG,CAAC,CAAA;KACb;IAED,OAAO,IAAI,CAAA;CACZ;AAED,SAAgB,aAAa,CAAC,EAAc,EAAE,EAAc;IAC1D,IAAI,QAAQ,CAAC,EAAE,CAAC,KAAK,QAAQ,CAAC,EAAE,CAAC,EAAE;QACjC,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAA;KACpC;IACD,OAAO,IAAI,CAAA;CACZ;AAKD,SAAgB,UAAU,CAAC,CAAa;IACtC,OAAO,cAAc,CAAC;QACpB,CAAC,CAAC,cAAc,EAAE;QAClB,CAAC,CAAC,WAAW,EAAE;QACf,CAAC,CAAC,UAAU,EAAE;KACf,CAAC,CAAA;CACH;AAED,SAAgB,WAAW,CAAC,CAAa;IACvC,OAAO,cAAc,CAAC;QACpB,CAAC,CAAC,cAAc,EAAE;QAClB,CAAC,CAAC,WAAW,EAAE;QACf,CAAC,CAAC,UAAU,EAAE;QACd,CAAC,CAAC,WAAW,EAAE;KAChB,CAAC,CAAA;CACH;AAED,SAAgB,aAAa,CAAC,CAAa;IACzC,OAAO,cAAc,CAAC;QACpB,CAAC,CAAC,cAAc,EAAE;QAClB,CAAC,CAAC,WAAW,EAAE;QACf,CAAC,CAAC,UAAU,EAAE;QACd,CAAC,CAAC,WAAW,EAAE;QACf,CAAC,CAAC,aAAa,EAAE;KAClB,CAAC,CAAA;CACH;AAED,SAAgB,aAAa,CAAC,CAAa;IACzC,OAAO,cAAc,CAAC;QACpB,CAAC,CAAC,cAAc,EAAE;QAClB,CAAC,CAAC,WAAW,EAAE;QACf,CAAC,CAAC,UAAU,EAAE;QACd,CAAC,CAAC,WAAW,EAAE;QACf,CAAC,CAAC,aAAa,EAAE;QACjB,CAAC,CAAC,aAAa,EAAE;KAClB,CAAC,CAAA;CACH;AAKD,SAAgB,UAAU,CAAC,MAAM,EAAE,GAAG,EAAE,GAAG;IACzC,IAAI,CAAC,GAAG,MAAM,CAAC,cAAc,EAAE,CAAA;IAC/B,IAAI,CAAC,GAAG,eAAe,CAAC,MAAM,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,CAAA;IAE5C,IAAI,CAAC,GAAG,CAAC,EAAE;QACT,OAAO,eAAe,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,CAAA;KAChD;IAED,IAAI,KAAK,GAAG,eAAe,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC,CAAA;IACpD,IAAI,KAAK,IAAI,CAAC,EAAE;QACd,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAA;KAC1B;IAED,OAAO,CAAC,CAAA;CACT;AAED,SAAS,eAAe,CAAC,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG;IAC7C,IAAI,cAAc,GAAG,cAAc,CAAC,CAAE,IAAI,EAAE,CAAC,EAAE,CAAC,GAAG,eAAe,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAE,CAAC,CAAA;IACrF,IAAI,QAAQ,GAAG,UAAU,CAAC,MAAM,CAAC,CAAA;IACjC,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC,CAAA;IAEzD,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,CAAA;CAChC;AAGD,SAAS,eAAe,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG;IAGrC,IAAI,GAAG,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,CAAA;IAGvB,IAAI,KAAK,GAAG,CAAC,CAAC,GAAG,cAAc,CAAC,CAAE,IAAI,EAAE,CAAC,EAAE,GAAG,CAAE,CAAC,CAAC,SAAS,EAAE,GAAG,GAAG,IAAI,CAAC,CAAA;IAExE,OAAO,CAAC,KAAK,GAAG,GAAG,GAAG,CAAC,CAAA;CACxB;AAKD,SAAgB,gBAAgB,CAAC,IAAI;IACnC,OAAO;QACL,IAAI,CAAC,WAAW,EAAE;QAClB,IAAI,CAAC,QAAQ,EAAE;QACf,IAAI,CAAC,OAAO,EAAE;QACd,IAAI,CAAC,QAAQ,EAAE;QACf,IAAI,CAAC,UAAU,EAAE;QACjB,IAAI,CAAC,UAAU,EAAE;QACjB,IAAI,CAAC,eAAe,EAAE;KACvB,CAAA;CACF;AAED,SAAgB,gBAAgB,CAAC,CAAC;IAChC,OAAO,IAAI,IAAI,CACb,CAAC,CAAC,CAAC,CAAC,EACJ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EACT,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACvB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EACT,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EACT,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CACV,CAAA;CACF;AAED,SAAgB,cAAc,CAAC,IAAI;IACjC,OAAO;QACL,IAAI,CAAC,cAAc,EAAE;QACrB,IAAI,CAAC,WAAW,EAAE;QAClB,IAAI,CAAC,UAAU,EAAE;QACjB,IAAI,CAAC,WAAW,EAAE;QAClB,IAAI,CAAC,aAAa,EAAE;QACpB,IAAI,CAAC,aAAa,EAAE;QACpB,IAAI,CAAC,kBAAkB,EAAE;KAC1B,CAAA;CACF;AAED,SAAgB,cAAc,CAAC,CAAC;IAI9B,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;QAClB,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAE,CAAC,CAAE,CAAC,CAAA;KACpB;IAED,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAA;CACzC;AAKD,SAAgB,WAAW,CAAC,CAAa;IACvC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAA;CAC3B;AAED,SAAgB,QAAQ,CAAC,CAAa;IACpC,OAAO,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,GAAG,EAAE,GAAG,EAAE;QACrC,CAAC,CAAC,aAAa,EAAE,GAAG,IAAI,GAAG,EAAE;QAC7B,CAAC,CAAC,aAAa,EAAE,GAAG,IAAI;QACxB,CAAC,CAAC,kBAAkB,EAAE,CAAA;CACzB;;AChMD,IAAM,cAAc,GAAG,CAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,cAAc,CAAE,CAAA;AACpE,IAAM,QAAQ,GAAG,0DAA0D,CAAA;AAK3E,SAAgB,cAAc,CAAC,KAAoB,EAAE,IAAa;;IAChE,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;QAC7B,OAAO,WAAW,CAAC,KAAK,CAAC,CAAA;KAC1B;SAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,EAAE;QAC7C,OAAO,eAAe,CAAC,KAAK,CAAC,CAAA;KAC9B;SAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;QACpC,OAAO,eAAe,WAAG,GAAC,IAAI,IAAI,cAAc,IAAG,KAAK,MAAG,CAAA;KAC5D;SAAM;QACL,OAAO,IAAI,CAAA;KACZ;CACF;AAED,SAAS,WAAW,CAAC,CAAS;IAC5B,IAAI,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;IACxB,IAAI,CAAC,EAAE;QACL,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAA;QACxB,OAAO;YACL,KAAK,EAAE,CAAC;YACR,MAAM,EAAE,CAAC;YACT,IAAI,EAAE,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC;YAC5C,YAAY,EAAE,IAAI,IAChB,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,IAAI;gBAChD,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,IAAI;gBAC3C,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,IAAI;iBACrC,CAAC,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC;aAChC;SACF,CAAA;KACF;IACD,OAAO,IAAI,CAAA;CACZ;AAED,SAAS,eAAe,CAAC,GAAwB;IAC/C,OAAO;QACL,KAAK,EAAE,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,IAAI,IAAI,CAAC;QACjC,MAAM,EAAE,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,KAAK,IAAI,CAAC;QACpC,IAAI,EACF,CAAC,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC;YACzB,iBAAiB,CAAC,GAAG,CAAC,GAAG,CAAC;QAC5B,YAAY,EACV,CAAC,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,IAAI,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,IAAI;YAC7C,CAAC,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,IAAI,CAAC,IAAI,EAAE,GAAG,IAAI;YAC5C,CAAC,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,MAAM,IAAI,CAAC,IAAI,IAAI;aACtC,GAAG,CAAC,YAAY,IAAI,GAAG,CAAC,WAAW,IAAI,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;KACvD,CAAA;CACF;AAED,SAAgB,iBAAiB,CAAC,GAAwB;IACxD,OAAO,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,IAAI,IAAI,CAAC,CAAA;CAClC;AAKD,SAAgB,cAAc,CAAC,EAAY,EAAE,EAAY;IACvD,OAAO,EAAE,CAAC,KAAK,KAAK,EAAE,CAAC,KAAK;QAC1B,EAAE,CAAC,MAAM,KAAK,EAAE,CAAC,MAAM;QACvB,EAAE,CAAC,IAAI,KAAK,EAAE,CAAC,IAAI;QACnB,EAAE,CAAC,YAAY,KAAK,EAAE,CAAC,YAAY,CAAA;CACtC;AAED,SAAgB,WAAW,CAAC,GAAa;IACvC,OAAO,GAAG,CAAC,KAAK,KAAK,CAAC,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,CAAC,IAAI,KAAK,CAAC,IAAI,GAAG,CAAC,YAAY,KAAK,CAAC,CAAA;CACvF;AAKD,SAAgB,YAAY,CAAC,EAAY,EAAE,EAAY;IACrD,OAAO;QACL,KAAK,EAAE,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC,KAAK;QAC1B,MAAM,EAAE,EAAE,CAAC,MAAM,GAAG,EAAE,CAAC,MAAM;QAC7B,IAAI,EAAE,EAAE,CAAC,IAAI,GAAG,EAAE,CAAC,IAAI;QACvB,YAAY,EAAE,EAAE,CAAC,YAAY,GAAG,EAAE,CAAC,YAAY;KAChD,CAAA;CACF;AAED,SAAgB,iBAAiB,CAAC,EAAY,EAAE,EAAY;IAC1D,OAAO;QACL,KAAK,EAAE,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC,KAAK;QAC1B,MAAM,EAAE,EAAE,CAAC,MAAM,GAAG,EAAE,CAAC,MAAM;QAC7B,IAAI,EAAE,EAAE,CAAC,IAAI,GAAG,EAAE,CAAC,IAAI;QACvB,YAAY,EAAE,EAAE,CAAC,YAAY,GAAG,EAAE,CAAC,YAAY;KAChD,CAAA;CACF;AAED,SAAgB,gBAAgB,CAAC,CAAW,EAAE,CAAS;IACrD,OAAO;QACL,KAAK,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC;QAClB,MAAM,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC;QACpB,IAAI,EAAE,CAAC,CAAC,IAAI,GAAG,CAAC;QAChB,YAAY,EAAE,CAAC,CAAC,YAAY,GAAG,CAAC;KACjC,CAAA;CACF;AAMD,SAAgB,YAAY,CAAC,GAAa;IACxC,OAAO,WAAW,CAAC,GAAG,CAAC,GAAG,GAAG,CAAA;CAC9B;AAED,SAAgB,aAAa,CAAC,GAAa;IACzC,OAAO,WAAW,CAAC,GAAG,CAAC,GAAG,EAAE,CAAA;CAC7B;AAED,SAAgB,WAAW,CAAC,GAAa;IACvC,OAAO,SAAS,CAAC,GAAG,CAAC,GAAG,KAAK,CAAA;CAC9B;AAED,SAIgB,cAAc,CAAC,GAAa;IAC1C,OAAO,SAAS,CAAC,GAAG,CAAC,IAAI,IAAI,GAAG,EAAE,CAAC,CAAA;CACpC;AAED,SAAgB,cAAc,CAAC,GAAa;IAC1C,OAAO,SAAS,CAAC,GAAG,CAAC,GAAG,IAAI,CAAA;CAC7B;AAED,SAAgB,SAAS,CAAC,GAAa;IACrC,OAAO,GAAG,CAAC,KAAK,IAAI,GAAG,GAAG,KAAK,CAAC;QAC9B,GAAG,CAAC,MAAM,IAAI,EAAE,GAAG,KAAK,CAAC;QACzB,GAAG,CAAC,IAAI,GAAG,KAAK;QAChB,GAAG,CAAC,YAAY,CAAA;CACnB;AAKD,SAAgB,oBAAoB,CAAC,SAAmB,EAAE,WAAqB;IAC7E,IAAI,GAAG,GAAG,IAAI,CAAA;IAEd,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAC9C,IAAI,IAAI,GAAG,cAAc,CAAC,CAAC,CAAC,CAAA;QAE5B,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;YACrB,IAAI,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,GAAG,WAAW,CAAC,IAAI,CAAC,CAAA;YAElD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,GAAG,KAAK,IAAI,IAAI,GAAG,KAAK,QAAQ,CAAC,EAAE;gBAC1D,OAAO,IAAI,CAAA;aACZ;YAED,GAAG,GAAG,QAAQ,CAAA;SAEf;aAAM,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE;YAE1B,OAAO,IAAI,CAAA;SACZ;KACF;IAED,OAAO,GAAG,CAAA;CACX;AAED,SAAgB,2BAA2B,CAAC,GAAa,EAAE,eAAyB;IAClF,IAAI,EAAE,GAAG,GAAG,CAAC,YAAY,CAAA;IACzB,IAAI,EAAE,EAAE;QACN,IAAI,EAAE,GAAG,IAAI,KAAK,CAAC,EAAE;YACnB,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,KAAK,EAAE,EAAE,EAAE,CAAA;SAC1C;QACD,IAAI,EAAE,IAAI,IAAI,GAAG,EAAE,CAAC,KAAK,CAAC,EAAE;YAC1B,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE,GAAG,IAAI,EAAE,CAAA;SAC5C;QACD,IAAI,EAAE,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,KAAK,CAAC,EAAE;YAC/B,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE,IAAI,IAAI,GAAG,EAAE,CAAC,EAAE,CAAA;SACnD;QACD,IAAI,EAAE,EAAE;YACN,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,CAAA;SACtD;KACF;IACD,IAAI,GAAG,CAAC,IAAI,EAAE;QACZ,IAAI,CAAC,eAAe,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,KAAK,CAAC,EAAE;YAC1C,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAC,IAAI,GAAG,CAAC,EAAE,CAAA;SAC7C;QACD,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,CAAC,IAAI,EAAE,CAAA;KACxC;IACD,IAAI,GAAG,CAAC,MAAM,EAAE;QACd,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,CAAC,MAAM,EAAE,CAAA;KAC5C;IACD,IAAI,GAAG,CAAC,KAAK,EAAE;QACb,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,CAAA;KAC1C;IACD,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;CACzC;;SC/Me,gBAAgB,CAAC,KAAkB,EAAE,eAAe;IAClE,IAAI,eAAe,CAAC,IAAI,EAAE;QACxB,UAAU,CAAC,KAAK,EAAE;YAChB,eAAe,EAAE,CAAC;YAClB,UAAU,EAAE,eAAe,CAAC,IAAI,GAAG,CAAC;SACrC,CAAC,CAAA;KACH;IACD,IAAI,eAAe,CAAC,KAAK,EAAE;QACzB,UAAU,CAAC,KAAK,EAAE;YAChB,gBAAgB,EAAE,CAAC;YACnB,WAAW,EAAE,eAAe,CAAC,KAAK,GAAG,CAAC;SACvC,CAAC,CAAA;KACH;CACF;AAID,SAAgB,kBAAkB,CAAC,KAAkB;IACnD,UAAU,CAAC,KAAK,EAAE;QAChB,UAAU,EAAE,EAAE;QACd,WAAW,EAAE,EAAE;QACf,eAAe,EAAE,EAAE;QACnB,gBAAgB,EAAE,EAAE;KACrB,CAAC,CAAA;CACH;AAID,SAAgB,aAAa;IAC3B,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAA;CAC9C;AAID,SAAgB,YAAY;IAC1B,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAA;CACjD;AAOD,SAAgB,gBAAgB,CAAC,GAAkB,EAAE,eAAe,EAAE,kBAAkB;IAKtF,IAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,GAAG,CAAC,MAAM,CAAC,CAAA;IACzD,IAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,UAAU,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAA;IAC5E,IAAI,OAAO,GAAG,EAAE,CAAA;IAChB,IAAI,WAAW,GAAG,EAAE,CAAA;IACpB,IAAI,WAAW,GAAG,EAAE,CAAA;IACpB,IAAI,UAAU,GAAG,CAAC,CAAA;IAElB,kBAAkB,CAAC,GAAG,CAAC,CAAA;IAIvB,GAAG,CAAC,OAAO,CAAC,UAAS,EAAE,EAAE,CAAC;QACxB,IAAI,SAAS,GAAG,CAAC,KAAK,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,UAAU,GAAG,UAAU,CAAA;QAC9D,IAAI,aAAa,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAC,MAAM,CAAA;QACrD,IAAI,aAAa,GAAG,aAAa,GAAG,eAAe,CAAC,EAAE,CAAC,CAAA;QAEvD,IAAI,aAAa,GAAG,SAAS,EAAE;YAC7B,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;YAChB,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;YAC/B,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;SAChC;aAAM;YAEL,UAAU,IAAI,aAAa,CAAA;SAC5B;KACF,CAAC,CAAA;IAGF,IAAI,kBAAkB,EAAE;QACtB,eAAe,IAAI,UAAU,CAAA;QAC7B,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,OAAO,CAAC,MAAM,CAAC,CAAA;QACzD,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,UAAU,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAA;KAC7E;IAGD,OAAO,CAAC,OAAO,CAAC,UAAS,EAAE,EAAE,CAAC;QAC5B,IAAI,SAAS,GAAG,CAAC,KAAK,OAAO,CAAC,MAAM,GAAG,CAAC,GAAG,UAAU,GAAG,UAAU,CAAA;QAClE,IAAI,aAAa,GAAG,WAAW,CAAC,CAAC,CAAC,CAAA;QAClC,IAAI,aAAa,GAAG,WAAW,CAAC,CAAC,CAAC,CAAA;QAClC,IAAI,SAAS,GAAG,SAAS,IAAI,aAAa,GAAG,aAAa,CAAC,CAAA;QAE3D,IAAI,aAAa,GAAG,SAAS,EAAE;YAC7B,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,SAAS,GAAG,IAAI,CAAA;SACnC;KACF,CAAC,CAAA;CACH;AAID,SAAgB,kBAAkB,CAAC,GAAkB;IACnD,GAAG,CAAC,OAAO,CAAC,UAAS,EAAE;QACrB,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAA;KACrB,CAAC,CAAA;CACH;AAMD,SAAgB,eAAe,CAAC,GAAkB;IAChD,IAAI,aAAa,GAAG,CAAC,CAAA;IAErB,GAAG,CAAC,OAAO,CAAC,UAAS,EAAE;QACrB,IAAI,OAAO,GAAG,EAAE,CAAC,UAAU,CAAA;QAC3B,IAAI,OAAO,YAAY,WAAW,EAAE;YAClC,IAAI,YAAU,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC,KAAK,CAAA;YACtD,IAAI,YAAU,GAAG,aAAa,EAAE;gBAC9B,aAAa,GAAG,YAAU,CAAA;aAC3B;SACF;KACF,CAAC,CAAA;IAEF,aAAa,EAAE,CAAA;IAEf,GAAG,CAAC,OAAO,CAAC,UAAS,EAAE;QACrB,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,aAAa,GAAG,IAAI,CAAA;KACtC,CAAC,CAAA;IAEF,OAAO,aAAa,CAAA;CACrB;AAKD,SAAgB,qBAAqB,CAAC,OAAoB,EAAE,OAAoB;IAG9E,IAAI,gBAAgB,GAAG;QACrB,QAAQ,EAAE,UAAU;QACpB,IAAI,EAAE,CAAC,CAAC;KACT,CAAA;IACD,UAAU,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAAA;IACrC,UAAU,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAAA;IAErC,IAAI,IAAI;KACN,OAAO,CAAC,qBAAqB,EAAE,CAAC,MAAM;QACtC,OAAO,CAAC,qBAAqB,EAAE,CAAC,MAAM,CAAA;IAGxC,IAAI,eAAe,GAAG,EAAE,QAAQ,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,CAAA;IAChD,UAAU,CAAC,OAAO,EAAE,eAAe,CAAC,CAAA;IACpC,UAAU,CAAC,OAAO,EAAE,eAAe,CAAC,CAAA;IAEpC,OAAO,IAAI,CAAA;CACZ;AAOD,SAAgB,gBAAgB,CAAC,EAAe;IAC9C,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAA;IACnC,EAAE,CAAC,gBAAgB,CAAC,aAAa,EAAE,cAAc,CAAC,CAAA;CACnD;AAGD,SAAgB,cAAc,CAAC,EAAe;IAC5C,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAA;IACtC,EAAE,CAAC,mBAAmB,CAAC,aAAa,EAAE,cAAc,CAAC,CAAA;CACtD;AAOD,SAAgB,kBAAkB,CAAC,EAAe;IAChD,EAAE,CAAC,gBAAgB,CAAC,aAAa,EAAE,cAAc,CAAC,CAAA;CACnD;AAGD,SAAgB,gBAAgB,CAAC,EAAe;IAC9C,EAAE,CAAC,mBAAmB,CAAC,aAAa,EAAE,cAAc,CAAC,CAAA;CACtD;AAMD,SAAgB,eAAe,CAAC,KAAK;IACnC,IAAI,KAAK,GAAG,EAAE,CAAA;IACd,IAAI,MAAM,GAAG,EAAE,CAAA;IACf,IAAI,CAAC,CAAA;IACL,IAAI,KAAK,CAAA;IAET,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;QAC7B,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;KAChC;SAAM,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;QACtC,MAAM,GAAG,CAAE,KAAK,CAAE,CAAA;KACnB;SAAM,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;QAC/B,MAAM,GAAG,KAAK,CAAA;KACf;IAED,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAClC,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAA;QAEjB,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC7B,KAAK,CAAC,IAAI,CACR,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG;gBACrB,EAAE,KAAK,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,EAAE;gBACxC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,CAC7B,CAAA;SACF;aAAM,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;YACtC,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAA;SAC5B;KACF;IAED,OAAO,KAAK,CAAA;CACb;AAGD,SAAgB,mBAAmB,CAAC,IAAI,EAAE,IAAI,EAAE,UAAU;IACxD,IAAI,CAAC,CAAA;IACL,IAAI,GAAG,CAAA;IAEP,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACtC,GAAG,GAAG,kBAAkB,CAAC,IAAI,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,CAAA;QACnD,IAAI,GAAG,EAAE;YACP,OAAO,GAAG,CAAA;SACX;KACF;IAED,OAAO,CAAC,CAAA;CACT;AAGD,SAAgB,kBAAkB,CAAC,IAAI,EAAE,IAAI,EAAE,SAAS;IACtD,IAAI,SAAS,CAAC,IAAI,EAAE;QAClB,OAAO,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;KAClC;IAED,OAAO,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;WAC/D,SAAS,CAAC,KAAK,IAAI,CAAC,CAAC,CAAA;CAC3B;AAGD,SAAgB,eAAe,CAAC,CAAC,EAAE,CAAC;IAClC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE;QACZ,OAAO,CAAC,CAAA;KACT;IACD,IAAI,CAAC,IAAI,IAAI,EAAE;QACb,OAAO,CAAC,CAAC,CAAA;KACV;IACD,IAAI,CAAC,IAAI,IAAI,EAAE;QACb,OAAO,CAAC,CAAA;KACT;IACD,IAAI,OAAO,CAAC,KAAK,QAAQ,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE;QAClD,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;KAC1C;IACD,OAAO,CAAC,GAAG,CAAC,CAAA;CACb;AAOD,SAAgB,qBAAqB,CAAC,GAAG;IACvC,OAAO,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;CAClD;AAGD,SAAgB,QAAQ,CAAC,GAAG,EAAE,GAAG;IAC/B,IAAI,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;IACnB,OAAO,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;CAC3C;AAOD,SAAgB,cAAc,CAAC,CAAC,EAAE,CAAC;IACjC,OAAO,CAAC,GAAG,CAAC,CAAA;CACb;AAGD,SAAgB,KAAK,CAAC,CAAC;IACrB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;CACnB;AAOD,SAAgB,QAAQ,CAAC,SAAS,EAAE,OAAO,EAAE,IAAI;IAC/C,IAAI,OAAO,SAAS,KAAK,UAAU,EAAE;QACnC,SAAS,GAAG,CAAE,SAAS,CAAE,CAAA;KAC1B;IACD,IAAI,SAAS,EAAE;QACb,IAAI,CAAC,SAAA,CAAA;QACL,IAAI,GAAG,SAAA,CAAA;QACP,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACrC,GAAG,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,GAAG,CAAA;SAC/C;QACD,OAAO,GAAG,CAAA;KACX;CACF;AAGD,SAAgB,YAAY;IAAC,cAAO;SAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;QAAP,yBAAO;;IAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACpC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;YACzB,OAAO,IAAI,CAAC,CAAC,CAAC,CAAA;SACf;KACF;CACF;AAQD,SAAgB,QAAQ,CAAC,IAAI,EAAE,IAAI;IACjC,IAAI,OAAO,CAAA;IACX,IAAI,IAAI,CAAA;IACR,IAAI,OAAO,CAAA;IACX,IAAI,SAAS,CAAA;IACb,IAAI,MAAM,CAAA;IAEV,IAAI,KAAK,GAAG;QACV,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,SAAS,CAAA;QAC3C,IAAI,IAAI,GAAG,IAAI,EAAE;YACf,OAAO,GAAG,UAAU,CAAC,KAAK,EAAE,IAAI,GAAG,IAAI,CAAC,CAAA;SACzC;aAAM;YACL,OAAO,GAAG,IAAI,CAAA;YACd,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;YAClC,OAAO,GAAG,IAAI,GAAG,IAAI,CAAA;SACtB;KACF,CAAA;IAED,OAAO;QACL,OAAO,GAAG,IAAI,CAAA;QACd,IAAI,GAAG,SAAS,CAAA;QAChB,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAA;QAChC,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,GAAG,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAA;SAClC;QACD,OAAO,MAAM,CAAA;KACd,CAAA;CACF;AAWD,SAAgB,WAAW,CAAC,QAAqB,EAAE,UAAuB,EAAE,QAA0B,EAAE,aAA2B;IAAvD,yBAAA,EAAA,aAA0B;IACpG,IAAI,OAAO,GAAgB,EAAE,CAAA;IAE7B,KAAK,IAAI,GAAG,IAAI,UAAU,EAAE;QAC1B,IAAI,SAAS,GAAG,UAAU,CAAC,GAAG,CAAC,CAAA;QAE/B,IAAI,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;YAE/B,IAAI,SAAS,KAAK,QAAQ,EAAE;gBAC1B,OAAO,CAAC,GAAG,CAAC,GAAG,OAAO,QAAQ,CAAC,GAAG,CAAC,KAAK,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,GAAG,IAAI,CAAA;aAC1E;iBAAM,IAAI,SAAS,EAAE;gBACpB,OAAO,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;aACxC;iBAAM;gBACL,OAAO,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAA;aAC7B;SACF;aAAM,IAAI,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;YAEtC,OAAO,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAA;SAC7B;aAAM;YAEL,IAAI,SAAS,KAAK,MAAM,EAAE;gBACxB,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,CAAA;aAClB;iBAAM,IAAI,CAAC,SAAS,IAAI,SAAS,KAAK,MAAM,IAAI,SAAS,KAAK,OAAO,IAAI,SAAS,KAAK,QAAQ,EAAE;gBAChG,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,CAAA;aACpB;iBAAM;gBACL,OAAO,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,IAAI,CAAC,CAAA;aAC/B;SACF;KACF;IAED,IAAI,aAAa,EAAE;QACjB,KAAK,IAAI,GAAG,IAAI,QAAQ,EAAE;YACxB,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;gBACjC,aAAa,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAA;aACnC;SACF;KACF;IAED,OAAO,OAAO,CAAA;CACf;AASD,SAAgB,sBAAsB,CAAC,UAAqB;IAC1D,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,KAAK,EAAE,UAAU,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAA;IACxE,IAAI,KAAK,GAAG,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;IACxC,IAAI,GAAG,GAAG,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAA;IAChC,OAAO,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,CAAA;CACtB;AAKD,SAAgB,sBAAsB,CAAC,UAAyB,EAAE,gBAA8C;IAA9C,iCAAA,EAAA,mBAA6B,cAAc,CAAC,CAAC,CAAC;IAC9G,IAAI,QAAQ,GAAe,IAAI,CAAA;IAC/B,IAAI,MAAM,GAAe,IAAI,CAAA;IAE7B,IAAI,UAAU,CAAC,GAAG,EAAE;QAClB,MAAM,GAAG,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC,CAAA;QAEnC,IAAI,SAAS,GAAW,UAAU,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,MAAM,CAAC,OAAO,EAAE,CAAA;QAKnE,IAAI,SAAS,IAAI,SAAS,IAAI,SAAS,CAAC,gBAAgB,CAAC,EAAE;YACzD,MAAM,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAA;SAC5B;KACF;IAED,IAAI,UAAU,CAAC,KAAK,EAAE;QACpB,QAAQ,GAAG,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;QAGvC,IAAI,MAAM,IAAI,MAAM,IAAI,QAAQ,EAAE;YAChC,MAAM,GAAG,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAA;SAC9B;KACF;IAED,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,CAAA;CACxC;AAID,SAAgB,eAAe,CAAC,KAAgB;IAC9C,IAAI,YAAY,GAAG,sBAAsB,CAAC,KAAK,CAAC,CAAA;IAEhD,OAAO,QAAQ,CAAC,YAAY,CAAC,KAAK,EAAE,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;CAC1D;AAGD,SAAgB,SAAS,CAAC,KAAiB,EAAE,KAAiB,EAAE,OAAgB,EAAE,SAAkB;IAClG,IAAI,SAAS,KAAK,MAAM,EAAE;QACxB,OAAO,cAAc,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE,MAAM,CAAE,CAAA;KACrE;SAAM,IAAI,SAAS,KAAK,OAAO,EAAE;QAChC,OAAO,cAAc,CAAC,OAAO,CAAC,eAAe,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE,OAAO,CAAE,CAAA;KACvE;SAAM;QACL,OAAO,cAAc,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;KACpC;CACF;;AChdD,IAAI,aAAa,GAAG,SAAS,CAAC,EAAE,CAAC,EAAE;IAC/B,aAAa,GAAG,MAAM,CAAC,cAAc;SAChC,EAAE,SAAS,EAAE,EAAE,EAAE,YAAY,KAAK,IAAI,UAAU,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC;QAC5E,UAAU,CAAC,EAAE,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;IAC/E,OAAO,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;CAC9B,CAAC;AAEF,AAAO,SAAS,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE;IAC5B,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACpB,SAAS,EAAE,GAAG,EAAE,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE;IACvC,CAAC,CAAC,SAAS,GAAG,CAAC,KAAK,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;CACxF;AAED,AAAO,IAAI,QAAQ,GAAG,WAAW;IAC7B,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,SAAS,QAAQ,CAAC,CAAC,EAAE;QAC7C,KAAK,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YACjD,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;YACjB,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;SAChF;QACD,OAAO,CAAC,CAAC;MACZ;IACD,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;CAC1C;;SCfe,cAAc,CAC5B,UAAsB,EACtB,aAA6B,EAC7B,OAAgB,EAChB,cAA+B,EAC/B,SAAc;IAEd,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAC9C,IAAI,cAAc,GAAG,EAAS,CAAA;QAC9B,IAAI,MAAM,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,UAAU,EAAE,cAAc,EAAE,OAAO,CAAoB,CAAA;QAE5F,IAAI,MAAM,EAAE;YAEV,IAAI,MAAM,GAAG,cAAc,CAAC,MAAM,CAAA;YAClC,OAAO,cAAc,CAAC,MAAM,CAAA;YAC5B,IAAI,MAAM,IAAI,IAAI,EAAE;gBAClB,MAAM,GAAG,aAAa,CAAA;gBACtB,IAAI,MAAM,IAAI,IAAI,EAAE;oBAClB,MAAM,GAAG,MAAM,CAAC,WAAW,CAAA;oBAC3B,IAAI,MAAM,IAAI,IAAI,EAAE;wBAClB,MAAM,GAAG,KAAK,CAAA;qBACf;iBACF;aACF;YAED,QAAQ,CAAC,SAAS,EAAE,cAAc,CAAC,CAAA;YAEnC,OAAO;gBACL,MAAM,QAAA;gBACN,QAAQ,EAAE,MAAM,CAAC,QAAQ;gBACzB,QAAQ,EAAE,MAAM,CAAC,QAAQ;gBACzB,MAAM,EAAE,CAAC;aACV,CAAA;SAEF;KACF;IAED,OAAO,IAAI,CAAA;CACZ;AAMD,SAAgB,qBAAqB,CACnC,QAAkB,EAClB,QAAkB,EAClB,YAAuB,EACvB,OAAgB,EAChB,cAA+B;IAE/B,IAAI,OAAO,GAAG,cAAc,CAAC,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,CAAA;IAC1D,IAAI,OAAO,GAAG,OAAO,CAAC,MAAM,CAC1B,QAAQ,CAAC,YAAY,CAAC,QAAQ,EAC9B;QACE,KAAK,EAAE,OAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,KAAK,EAAE,QAAQ,CAAC;QACrD,GAAG,EAAE,YAAY,CAAC,GAAG;KACtB,EACD,OAAO,CACR,CAAA;IAGD,IAAI,QAAQ,CAAC,MAAM,EAAE;QACnB,OAAO,GAAG,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAA;KAClC;IAED,OAAO,OAAO,CAAA;CACf;;ACzFD,IAAM,cAAc,GAAG,MAAM,CAAC,SAAS,CAAC,cAAc,CAAA;AAItD,SAAgB,UAAU,CAAC,QAAQ,EAAE,YAAa;IAChD,IAAI,IAAI,GAAG,EAAE,CAAA;IACb,IAAI,CAAC,CAAA;IACL,IAAI,IAAI,CAAA;IACR,IAAI,WAAW,CAAA;IACf,IAAI,CAAC,CAAA;IACL,IAAI,GAAG,CAAA;IACP,IAAI,KAAK,CAAA;IAET,IAAI,YAAY,EAAE;QAChB,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACxC,IAAI,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;YACtB,WAAW,GAAG,EAAE,CAAA;YAGhB,KAAK,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;gBACzC,GAAG,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;gBAEvB,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,EAAE;oBAClC,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;iBACzB;qBAAM,IAAI,GAAG,KAAK,SAAS,EAAE;oBAC5B,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAA;oBAChB,MAAK;iBACN;aACF;YAGD,IAAI,WAAW,CAAC,MAAM,EAAE;gBACtB,IAAI,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC,WAAW,CAAC,CAAA;aACrC;SACF;KACF;IAGD,KAAK,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;QACzC,KAAK,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAA;QAEnB,KAAK,IAAI,IAAI,KAAK,EAAE;YAClB,IAAI,EAAE,IAAI,IAAI,IAAI,CAAC,EAAE;gBACnB,IAAI,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,CAAA;aACzB;SACF;KACF;IAED,OAAO,IAAI,CAAA;CACZ;AAGD,SAAgB,UAAU,CAAC,IAAI,EAAE,IAAI;IACnC,IAAI,QAAQ,GAAG,EAAE,CAAA;IAEjB,KAAK,IAAI,GAAG,IAAI,IAAI,EAAE;QACpB,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,EAAE;YACxB,QAAQ,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAA;SAC1B;KACF;IAED,OAAO,QAAQ,CAAA;CAChB;AAGD,SAAgB,OAAO,CACrB,IAAkC,EAClC,IAAmD;IAEnD,IAAI,OAAO,GAAG,EAAE,CAAA;IAEhB,KAAK,IAAI,GAAG,IAAI,IAAI,EAAE;QACpB,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,CAAA;KACpC;IAED,OAAO,OAAO,CAAA;CACf;AAGD,SAAgB,WAAW,CAAC,CAAC;IAC3B,IAAI,IAAI,GAAG,EAAE,CAAA;IAEb,KAAiB,UAAC,EAAD,OAAC,EAAD,eAAC,EAAD,IAAC,EAAE;QAAf,IAAI,IAAI,UAAA;QACX,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAA;KAClB;IAED,OAAO,IAAI,CAAA;CACZ;AAGD,SAAgB,iBAAiB,CAAC,GAAG;IACnC,IAAI,CAAC,GAAG,EAAE,CAAA;IAEV,KAAK,IAAI,GAAG,IAAI,GAAG,EAAE;QACnB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAA;KACjB;IAED,OAAO,CAAC,CAAA;CACT;AAGD,SAAgB,YAAY,CAAC,IAAI,EAAE,IAAI;IAErC,KAAK,IAAI,GAAG,IAAI,IAAI,EAAE;QACpB,IAAI,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE;YAClC,IAAI,EAAE,GAAG,IAAI,IAAI,CAAC,EAAE;gBAClB,OAAO,KAAK,CAAA;aACb;SACF;KACF;IAED,KAAK,IAAI,GAAG,IAAI,IAAI,EAAE;QACpB,IAAI,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE;YAClC,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE;gBAC3B,OAAO,KAAK,CAAA;aACb;SACF;KACF;IAED,OAAO,IAAI,CAAA;CACZ;;SC9Fe,WAAW,CACzB,SAAuB,EACvB,QAAgB,EAChB,QAAkB,EAClB,cAAwB;IAExB,IAAI,UAAU,GAAG,qBAAqB,EAAE,CAAA;IAExC,KAAqB,UAAS,EAAT,uBAAS,EAAT,uBAAS,EAAT,IAAS,EAAE;QAA3B,IAAI,QAAQ,kBAAA;QACf,IAAI,KAAK,GAAG,UAAU,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,cAAc,CAAC,CAAA;QAEpE,IAAI,KAAK,EAAE;YACT,iBAAiB,CAAC,KAAK,EAAE,UAAU,CAAC,CAAA;SACrC;KACF;IAED,OAAO,UAAU,CAAA;CAClB;AAED,SAAgB,iBAAiB,CAAC,KAAiB,EAAE,UAAgD;IAAhD,2BAAA,EAAA,aAAyB,qBAAqB,EAAE;IACnG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,CAAA;IAE5C,IAAI,KAAK,CAAC,QAAQ,EAAE;QAClB,UAAU,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAA;KACjE;IAED,OAAO,UAAU,CAAA;CAClB;AAED,SAAgB,eAAe,CAAC,UAAsB,EAAE,YAAuB,EAAE,QAAkB;IACjG,IAAI,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAA;IACxB,IAAA,sBAAI,EAAE,gCAAS,CAAe;IAGpC,SAAS,GAAG,UAAU,CAAC,SAAS,EAAE,UAAS,QAAuB;QAChE,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,YAAY,CAAA;KAC1C,CAAC,CAAA;IAEF,KAAK,IAAI,KAAK,IAAI,IAAI,EAAE;QACtB,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAA;QAErB,IAAI,GAAG,CAAC,YAAY,EAAE;YACpB,IAAI,QAAQ,GAAG,GAAG,CAAC,YAAY,CAAC,QAAQ,CAAA;YAExC,IAAI,CAAC,QAAQ,EAAE;gBACb,QAAQ,GAAG,GAAG,CAAC,MAAM;oBACnB,QAAQ,CAAC,0BAA0B;oBACnC,QAAQ,CAAC,yBAAyB,CAAA;aACrC;YAED,IAAI,MAAM,GAAG,qBAAqB,CAAC,GAAG,EAAE,QAAQ,EAAE,YAAY,EAAE,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,cAAc,CAAC,CAAA;YAE7H,KAAkB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM,EAAE;gBAArB,IAAI,KAAK,eAAA;gBACZ,IAAI,QAAQ,GAAG,mBAAmB,CAAC,KAAK,EAAE;oBACxC,KAAK,OAAA;oBACL,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC;iBAClC,CAAC,CAAA;gBACF,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAA;aAC1C;SACF;KACF;IAED,OAAO,EAAE,IAAI,MAAA,EAAE,SAAS,WAAA,EAAE,CAAA;CAC3B;AAKD,SAAgB,iBAAiB,CAAC,UAAsB,EAAE,UAAkB;IAC1E,IAAI,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;IAE/C,IAAI,QAAQ,EAAE;QACZ,IAAI,KAAG,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;QAGzC,IAAI,QAAQ,GAAG,oBAAoB,CAAC,UAAU,EAAE,UAAS,OAAO;YAC9D,OAAO,kBAAkB,CAAC,KAAG,EAAE,OAAO,CAAC,CAAA;SACxC,CAAC,CAAA;QAIF,QAAQ,CAAC,IAAI,CAAC,KAAG,CAAC,KAAK,CAAC,GAAG,KAAG,CAAA;QAC9B,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAA;QAElD,OAAO,QAAQ,CAAA;KAChB;IAED,OAAO,qBAAqB,EAAE,CAAA;CAC/B;AAED,SAAS,kBAAkB,CAAC,IAAc,EAAE,IAAc;IACxD,OAAO,OAAO,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,CAAC,CAAA;CAC9D;AAED,SAAgB,kBAAkB,CAAC,SAAS,EAAE,WAAwB,EAAE,QAAkB;IACxF,IAAI,gBAAgB,GAAG,QAAQ,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAA;IACzD,IAAI,mBAAmB,GAAG,WAAW,GAAG,WAAW,CAAC,kBAAkB,GAAG,IAAI,CAAA;IAE7E,IAAI,mBAAmB,EAAE;QACvB,SAAS,GAAG,qBAAqB,CAAC,SAAS,EAAE,mBAAmB,CAAC,CAAA;KAClE;IAED,IAAI,gBAAgB,EAAE;QACpB,SAAS,GAAG,qBAAqB,CAAC,SAAS,EAAE,gBAAgB,CAAC,CAAA;KAC/D;IAED,OAAO,SAAS,CAAA;CACjB;AAED,SAAS,qBAAqB,CAAC,SAAS,EAAE,IAAI;IAC5C,IAAI,aAAa,CAAA;IAEjB,IAAI,CAAC,IAAI,EAAE;QACT,aAAa,GAAG,SAAS,CAAA;KAC1B;SAAM;QACL,aAAa,GAAG,EAAE,CAAA;QAElB,KAAqB,UAAS,EAAT,uBAAS,EAAT,uBAAS,EAAT,IAAS,EAAE;YAA3B,IAAI,QAAQ,kBAAA;YACf,IAAI,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAA;YAEjC,IAAI,YAAY,EAAE;gBAChB,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;aACjC;iBAAM,IAAI,YAAY,IAAI,IAAI,EAAE;gBAC/B,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;aAC7B;SACF;KACF;IAED,OAAO,aAAa,CAAA;CACrB;AAED,SAAgB,qBAAqB;IACnC,OAAO,EAAE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE,CAAA;CACnC;AAED,SAAgB,gBAAgB,CAAC,MAAkB,EAAE,MAAkB;IACrE,OAAO;QACL,IAAI,eAAO,MAAM,CAAC,IAAI,EAAK,MAAM,CAAC,IAAI,CAAE;QACxC,SAAS,eAAO,MAAM,CAAC,SAAS,EAAK,MAAM,CAAC,SAAS,CAAE;KACxD,CAAA;CACF;AAED,SAAgB,oBAAoB,CAAC,UAAsB,EAAE,UAA2C;IACtG,IAAI,IAAI,GAAG,UAAU,CAAC,UAAU,CAAC,IAAI,EAAE,UAAU,CAAC,CAAA;IAClD,IAAI,SAAS,GAAG,UAAU,CAAC,UAAU,CAAC,SAAS,EAAE,UAAS,QAAuB;QAC/E,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;KAC5B,CAAC,CAAA;IACF,OAAO,EAAE,IAAI,MAAA,EAAE,SAAS,WAAA,EAAE,CAAA;CAC3B;;SC7Je,UAAU,CAAC,KAAqB,EAAE,OAAgB;IAChE,IAAI,KAAK,GAAG,IAAI,CAAA;IAChB,IAAI,GAAG,GAAG,IAAI,CAAA;IAEd,IAAI,KAAK,CAAC,KAAK,EAAE;QACf,KAAK,GAAG,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;KAC1C;IAED,IAAI,KAAK,CAAC,GAAG,EAAE;QACb,GAAG,GAAG,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;KACtC;IAED,IAAI,CAAC,KAAK,IAAI,CAAC,GAAG,EAAE;QAClB,OAAO,IAAI,CAAA;KACZ;IAED,IAAI,KAAK,IAAI,GAAG,IAAI,GAAG,GAAG,KAAK,EAAE;QAC/B,OAAO,IAAI,CAAA;KACZ;IAED,OAAO,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,CAAA;CACtB;AAID,SAAgB,YAAY,CAAC,MAAmB,EAAE,eAA0B;IAC1E,IAAI,cAAc,GAAgB,EAAE,CAAA;IACpC,IAAI,KAAK,GAAG,eAAe,CAAC,KAAK,CAAA;IACjC,IAAI,CAAC,CAAA;IACL,IAAI,SAAS,CAAA;IAGb,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;IAE1B,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QAClC,SAAS,GAAG,MAAM,CAAC,CAAC,CAAC,CAAA;QAGrB,IAAI,SAAS,CAAC,KAAK,GAAG,KAAK,EAAE;YAC3B,cAAc,CAAC,IAAI,CAAC,EAAE,KAAK,OAAA,EAAE,GAAG,EAAE,SAAS,CAAC,KAAK,EAAE,CAAC,CAAA;SACrD;QAED,IAAI,SAAS,CAAC,GAAG,GAAG,KAAK,EAAE;YACzB,KAAK,GAAG,SAAS,CAAC,GAAG,CAAA;SACtB;KACF;IAGD,IAAI,KAAK,GAAG,eAAe,CAAC,GAAG,EAAE;QAC/B,cAAc,CAAC,IAAI,CAAC,EAAE,KAAK,OAAA,EAAE,GAAG,EAAE,eAAe,CAAC,GAAG,EAAE,CAAC,CAAA;KACzD;IAED,OAAO,cAAc,CAAA;CACtB;AAED,SAAS,aAAa,CAAC,MAAiB,EAAE,MAAiB;IACzD,OAAO,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,CAAA;CACvD;AAED,SAAgB,eAAe,CAAC,MAAqB,EAAE,MAAqB;IAC1E,IAAI,KAAK,GAAG,MAAM,CAAC,KAAK,CAAA;IACxB,IAAI,GAAG,GAAG,MAAM,CAAC,GAAG,CAAA;IACpB,IAAI,QAAQ,GAAG,IAAI,CAAA;IAEnB,IAAI,MAAM,CAAC,KAAK,KAAK,IAAI,EAAE;QACzB,IAAI,KAAK,KAAK,IAAI,EAAE;YAClB,KAAK,GAAG,MAAM,CAAC,KAAK,CAAA;SACrB;aAAM;YACL,KAAK,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,CAAA;SACpE;KACF;IAED,IAAI,MAAM,CAAC,GAAG,IAAI,IAAI,EAAE;QACtB,IAAI,GAAG,KAAK,IAAI,EAAE;YAChB,GAAG,GAAG,MAAM,CAAC,GAAG,CAAA;SACjB;aAAM;YACL,GAAG,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC,CAAA;SAC9D;KACF;IAED,IAAI,KAAK,KAAK,IAAI,IAAI,GAAG,KAAK,IAAI,IAAI,KAAK,GAAG,GAAG,EAAE;QACjD,QAAQ,GAAG,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,CAAA;KAC1B;IAED,OAAO,QAAQ,CAAA;CAChB;AAED,SAAgB,WAAW,CAAC,MAAqB,EAAE,MAAqB;IACtE,OAAO,CAAC,MAAM,CAAC,KAAK,KAAK,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,OAAO,MAAM,CAAC,KAAK,KAAK,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QACxH,CAAC,MAAM,CAAC,GAAG,KAAK,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,OAAO,MAAM,CAAC,GAAG,KAAK,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAA;CAC9G;AAED,SAAgB,eAAe,CAAC,MAAqB,EAAE,MAAqB;IAC1E,OAAO,CAAC,MAAM,CAAC,GAAG,KAAK,IAAI,IAAI,MAAM,CAAC,KAAK,KAAK,IAAI,IAAI,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,KAAK;SAC9E,MAAM,CAAC,KAAK,KAAK,IAAI,IAAI,MAAM,CAAC,GAAG,KAAK,IAAI,IAAI,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAA;CAC9E;AAED,SAAgB,kBAAkB,CAAC,UAAyB,EAAE,UAAyB;IACrF,OAAO,CAAC,UAAU,CAAC,KAAK,KAAK,IAAI,KAAK,UAAU,CAAC,KAAK,KAAK,IAAI,IAAI,UAAU,CAAC,KAAK,IAAI,UAAU,CAAC,KAAK,CAAC;SACrG,UAAU,CAAC,GAAG,KAAK,IAAI,KAAK,UAAU,CAAC,GAAG,KAAK,IAAI,IAAI,UAAU,CAAC,GAAG,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC,CAAA;CAC7F;AAED,SAAgB,mBAAmB,CAAC,KAAoB,EAAE,IAAyB;IACjF,OAAO,CAAC,KAAK,CAAC,KAAK,KAAK,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,KAAK;SAChD,KAAK,CAAC,GAAG,KAAK,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,CAAA;CAC3C;AAID,SAAgB,sBAAsB,CAAC,IAAgB,EAAE,KAAgB;IACvE,IAAI,KAAK,CAAC,KAAK,IAAI,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,KAAK,EAAE;QAC7C,OAAO,KAAK,CAAC,KAAK,CAAA;KACnB;IAED,IAAI,KAAK,CAAC,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,CAAC,GAAG,EAAE;QAC1C,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAA;KACzC;IAED,OAAO,IAAI,CAAA;CACZ;;SCvHe,WAAW,CAAC,KAAK,EAAE,QAAQ;IACzC,IAAI,SAAS,GAAG,CAAC,CAAA;IACjB,IAAI,CAAC,GAAG,CAAC,CAAA;IAET,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE;QACvB,IAAI,KAAK,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;YACzB,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;YAClB,SAAS,EAAE,CAAA;SACZ;aAAM;YACL,CAAC,EAAE,CAAA;SACJ;KACF;IAED,OAAO,SAAS,CAAA;CACjB;AAED,SAAgB,aAAa,CAAC,EAAE,EAAE,EAAE;IAClC,IAAI,GAAG,GAAG,EAAE,CAAC,MAAM,CAAA;IACnB,IAAI,CAAC,CAAA;IAEL,IAAI,GAAG,KAAK,EAAE,CAAC,MAAM,EAAE;QACrB,OAAO,KAAK,CAAA;KACb;IAED,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;QACxB,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE;YACnB,OAAO,KAAK,CAAA;SACb;KACF;IAED,OAAO,IAAI,CAAA;CACZ;;SC/Ce,OAAO,CAAI,UAAa;IACtC,IAAI,IAAI,CAAA;IACR,IAAI,GAAG,CAAA;IAEP,OAAO;QACL,IAAI,CAAC,IAAI,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,SAAS,CAAC,EAAE;YAC5C,IAAI,GAAG,SAAS,CAAA;YAChB,GAAG,GAAI,UAAkB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;SACjD;QAED,OAAO,GAAG,CAAA;KACJ,CAAA;CACT;AAMD,SAAgB,aAAa,CAAI,UAAa,EAAE,YAA2C;IACzF,IAAI,SAAS,GAAG,IAAI,CAAA;IAEpB,OAAO;QACL,IAAI,MAAM,GAAI,UAAkB,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;QAEvD,IAAI,SAAS,KAAK,IAAI,IAAI,EAAE,SAAS,KAAK,MAAM,IAAI,YAAY,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,EAAE;YACpF,SAAS,GAAG,MAAM,CAAA;SACnB;QAED,OAAO,SAAS,CAAA;KACV,CAAA;CACT;;AC1BD,IAAM,gCAAgC,GAAG;IACvC,IAAI,EAAE,CAAC;IACP,SAAS,EAAE,CAAC;IACZ,cAAc,EAAE,CAAC;IACjB,QAAQ,EAAE,CAAC;IACX,UAAU,EAAE,CAAC;CACd,CAAA;AAED,IAAM,6BAA6B,GAAG;IACpC,YAAY,EAAE,CAAC;IACf,GAAG,EAAE,CAAC;IACN,IAAI,EAAE,CAAC;IACP,KAAK,EAAE,CAAC;IACR,GAAG,EAAE,CAAC;IACN,OAAO,EAAE,CAAC;IACV,IAAI,EAAE,CAAC;IACP,MAAM,EAAE,CAAC;IACT,MAAM,EAAE,CAAC;CACV,CAAA;AAED,IAAM,WAAW,GAAG,mBAAmB,CAAA;AACvC,IAAM,QAAQ,GAAG,IAAI,CAAA;AACrB,IAAM,cAAc,GAAG,MAAM,CAAA;AAC7B,IAAM,MAAM,GAAG,SAAS,CAAA;AACxB,IAAM,MAAM,GAAG,SAAS,CAAA;AAExB;IAOE,yBAAY,cAAc;QACxB,IAAI,iBAAiB,GAAQ,EAAE,CAAA;QAC/B,IAAI,gBAAgB,GAAQ,EAAE,CAAA;QAC9B,IAAI,QAAQ,GAAG,CAAC,CAAA;QAEhB,KAAK,IAAI,MAAI,IAAI,cAAc,EAAE;YAC/B,IAAI,MAAI,IAAI,gCAAgC,EAAE;gBAC5C,gBAAgB,CAAC,MAAI,CAAC,GAAG,cAAc,CAAC,MAAI,CAAC,CAAA;gBAC7C,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,gCAAgC,CAAC,MAAI,CAAC,EAAE,QAAQ,CAAC,CAAA;aACtE;iBAAM;gBACL,iBAAiB,CAAC,MAAI,CAAC,GAAG,cAAc,CAAC,MAAI,CAAC,CAAA;gBAE9C,IAAI,MAAI,IAAI,6BAA6B,EAAE;oBACzC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,6BAA6B,CAAC,MAAI,CAAC,EAAE,QAAQ,CAAC,CAAA;iBACnE;aACF;SACF;QAED,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAA;QAC1C,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAA;QACxC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;QAExB,IAAI,CAAC,mBAAmB,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAA;KACxD;IAED,gCAAM,GAAN,UAAO,IAAiB,EAAE,OAA8B;QACtD,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAA;KAC9F;IAED,qCAAW,GAAX,UAAY,KAAkB,EAAE,GAAgB,EAAE,OAA8B;QAC1E,IAAA,SAA8C,EAA5C,wCAAiB,EAAE,sCAAyB,CAAA;QAElD,IAAI,YAAY,GAAG,yBAAyB,CAAC,KAAK,CAAC,MAAM,EAAE,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,cAAc,CAAC,CAAA;QAC9F,IAAI,CAAC,YAAY,EAAE;YACjB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,CAAA;SACnC;QAED,IAAI,qBAAqB,GAAG,YAAY,CAAA;QACxC,IACE,qBAAqB,GAAG,CAAC;aACxB,iBAAiB,CAAC,IAAI,KAAK,SAAS,IAAI,iBAAiB,CAAC,IAAI,KAAK,SAAS,CAAC;aAC7E,iBAAiB,CAAC,KAAK,KAAK,SAAS,IAAI,iBAAiB,CAAC,KAAK,KAAK,SAAS,CAAC;aAC/E,iBAAiB,CAAC,GAAG,KAAK,SAAS,IAAI,iBAAiB,CAAC,GAAG,KAAK,SAAS,CAAC,EAC5E;YACA,qBAAqB,GAAG,CAAC,CAAA;SAC1B;QAED,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,CAAA;QACvC,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;QAErC,IAAI,KAAK,KAAK,KAAK,EAAE;YACnB,OAAO,KAAK,CAAA;SACb;QAED,IAAI,gBAAgB,GAAG,+BAA+B,CAAC,iBAAiB,EAAE,qBAAqB,CAAC,CAAA;QAChG,IAAI,qBAAqB,GAAG,mBAAmB,CAAC,gBAAgB,EAAE,gBAAgB,EAAE,OAAO,CAAC,CAAA;QAC5F,IAAI,QAAQ,GAAG,qBAAqB,CAAC,KAAK,CAAC,CAAA;QAC3C,IAAI,QAAQ,GAAG,qBAAqB,CAAC,GAAG,CAAC,CAAA;QAEzC,IAAI,SAAS,GAAG,mBAAmB,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAA;QACrE,IAAI,SAAS,GAAG,gBAAgB,CAAC,SAAS,IAAI,EAAE,CAAA;QAEhD,IAAI,SAAS,EAAE;YACb,OAAO,SAAS,CAAC,MAAM,GAAG,QAAQ,GAAG,SAAS,GAAG,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAA;SAC5E;QAED,OAAO,KAAK,GAAG,SAAS,GAAG,KAAK,CAAA;KACjC;IAED,wCAAc,GAAd;QACE,QAAQ,IAAI,CAAC,QAAQ;YACnB,KAAK,CAAC,CAAC;YACP,KAAK,CAAC,CAAC;YACP,KAAK,CAAC;gBACJ,OAAO,MAAM,CAAA;YACf,KAAK,CAAC;gBACJ,OAAO,OAAO,CAAA;YAChB,KAAK,CAAC;gBACJ,OAAO,MAAM,CAAA;YACf;gBACE,OAAO,KAAK,CAAA;SACf;KACF;IAEH,sBAAC;CAAA,IAAA;AAED,SAAS,mBAAmB,CAC1B,iBAAiB,EACjB,gBAAgB,EAChB,OAA8B;IAE9B,IAAI,mBAAmB,GAAG,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,MAAM,CAAA;IAE/D,IAAI,mBAAmB,KAAK,CAAC,IAAI,iBAAiB,CAAC,YAAY,KAAK,OAAO,EAAE;QAC3E,OAAO,UAAS,IAAiB;YAC/B,OAAO,oBAAoB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;SACjD,CAAA;KACF;IAED,IAAI,mBAAmB,KAAK,CAAC,IAAI,gBAAgB,CAAC,IAAI,EAAE;QACtD,OAAO,UAAS,IAAiB;YAC/B,OAAO,gBAAgB,CACrB,OAAO,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,EACtC,OAAO,CAAC,SAAS,EACjB,OAAO,CAAC,MAAM,EACd,gBAAgB,CAAC,IAAI,CACtB,CAAA;SACF,CAAA;KACF;IAED,OAAO,yBAAyB,CAAC,iBAAiB,EAAE,gBAAgB,EAAE,OAAO,CAAC,CAAA;CAC/E;AAED,SAAS,yBAAyB,CAChC,iBAAiB,EACjB,gBAAgB,EAChB,OAA8B;IAE9B,iBAAiB,gBAAQ,iBAAiB,CAAE,CAAA;IAC5C,gBAAgB,gBAAQ,gBAAgB,CAAE,CAAA;IAE1C,gBAAgB,CAAC,iBAAiB,EAAE,gBAAgB,CAAC,CAAA;IAErD,iBAAiB,CAAC,QAAQ,GAAG,KAAK,CAAA;IAElC,IAAI,YAAY,GAAG,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,iBAAiB,CAAC,CAAA;IACnF,IAAI,UAAU,CAAA;IAEd,IAAI,gBAAgB,CAAC,cAAc,EAAE;QACnC,IAAI,SAAS,gBAAQ,iBAAiB,CAAE,CAAA;QACxC,OAAO,SAAS,CAAC,MAAM,CAAA;QACvB,UAAU,GAAG,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,CAAC,CAAA;KACtE;IAED,OAAO,UAAS,IAAiB;QAC/B,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAA;QACxB,IAAI,MAAM,CAAA;QAEV,IAAI,UAAU,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE;YACzC,MAAM,GAAG,UAAU,CAAA;SACpB;aAAM;YACL,MAAM,GAAG,YAAY,CAAA;SACtB;QAED,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAA;QAE7B,OAAO,WAAW,CAAC,CAAC,EAAE,IAAI,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,OAAO,CAAC,CAAA;KAC1E,CAAA;CACF;AAED,SAAS,gBAAgB,CAAC,iBAAiB,EAAE,gBAAgB;IAI3D,IAAI,iBAAiB,CAAC,YAAY,EAAE;QAClC,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE;YAC3B,iBAAiB,CAAC,IAAI,GAAG,SAAS,CAAA;SACnC;QACD,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE;YAC7B,iBAAiB,CAAC,MAAM,GAAG,SAAS,CAAA;SACrC;KACF;IAGD,IAAI,iBAAiB,CAAC,YAAY,KAAK,MAAM,EAAE;QAC7C,iBAAiB,CAAC,YAAY,GAAG,OAAO,CAAA;KACzC;IAGD,IAAI,gBAAgB,CAAC,cAAc,KAAK,iBAAiB,CAAC,MAAM,IAAI,iBAAiB,CAAC,WAAW,CAAC,EAAE;QAClG,OAAO,gBAAgB,CAAC,cAAc,CAAA;KACvC;CACF;AAED,SAAS,WAAW,CAAC,CAAS,EAAE,IAAiB,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,OAA8B;IAEpH,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAA;IAEzB,IAAI,iBAAiB,CAAC,YAAY,KAAK,OAAO,EAAE;QAC9C,CAAC,GAAG,YAAY,CACd,CAAC,EACD,CAAC,OAAO,CAAC,QAAQ,KAAK,KAAK,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI;YACxD,KAAK;YACL,oBAAoB,CAAC,IAAI,CAAC,cAAc,CAAC,CAC5C,CAAA;KACF;IAED,IAAI,gBAAgB,CAAC,UAAU,EAAE;QAC/B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAA;KACnC;IAED,IAAI,gBAAgB,CAAC,cAAc,EAAE;QACnC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAA;KACzB;IAKD,IAAI,gBAAgB,CAAC,QAAQ,KAAK,KAAK,EAAE;QACvC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAA;KACtC;SAAM,IAAI,gBAAgB,CAAC,QAAQ,KAAK,QAAQ,EAAE;QACjD,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,UAAS,EAAE,EAAE,EAAE;YACxC,OAAO,EAAE,CAAC,iBAAiB,EAAE,CAAA;SAC9B,CAAC,CAAA;KACH;SAAM,IAAI,gBAAgB,CAAC,QAAQ,KAAK,OAAO,EAAE;QAChD,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,UAAS,EAAE,EAAE,EAAE;YACxC,OAAO,EAAE,CAAC,iBAAiB,EAAE,GAAG,GAAG,CAAA;SACpC,CAAC,CAAA;KACH;SAAM,IAAI,gBAAgB,CAAC,QAAQ,KAAK,WAAW,EAAE;QACpD,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,UAAS,EAAE;YACpC,OAAO,EAAE,CAAC,iBAAiB,EAAE,CAAA;SAC9B,CAAC,CAAA;KACH;IAED,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,cAAc,EAAE,GAAG,CAAC,CAAA;IAClC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAA;IAEZ,OAAO,CAAC,CAAA;CACT;AAED,SAAS,YAAY,CAAC,CAAS,EAAE,MAAc;IAC7C,IAAI,QAAQ,GAAG,KAAK,CAAA;IAEpB,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE;QACpB,QAAQ,GAAG,IAAI,CAAA;QACf,OAAO,MAAM,CAAA;KACd,CAAC,CAAA;IAGF,IAAI,CAAC,QAAQ,EAAE;QACb,CAAC,IAAI,GAAG,GAAG,MAAM,CAAA;KAClB;IAED,OAAO,CAAC,CAAA;CACT;AAED,SAAS,gBAAgB,CAAC,GAAW,EAAE,SAAiB,EAAE,MAAc,EAAE,OAAwC;IAChH,IAAI,KAAK,GAAG,EAAE,CAAA;IAEd,IAAI,OAAO,KAAK,QAAQ,EAAE;QACxB,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;KACtB;SAAM,IAAI,OAAO,KAAK,OAAO,EAAE;QAC9B,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,CAAA;KAC3B;IAGD,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAA;IAEjD,IAAI,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE;QACxB,KAAK,CAAC,OAAO,EAAE,CAAA;KAChB;IAED,OAAO,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;CACtB;AAQD,SAAS,yBAAyB,CAAC,EAAc,EAAE,EAAc,EAAE,EAAkB;IACnF,IAAI,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE;QACjD,OAAO,CAAC,CAAA;KACT;IACD,IAAI,EAAE,CAAC,cAAc,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC,cAAc,CAAC,EAAE,CAAC,EAAE;QACnD,OAAO,CAAC,CAAA;KACT;IACD,IAAI,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,EAAE;QAC/C,OAAO,CAAC,CAAA;KACT;IACD,IAAI,QAAQ,CAAC,EAAE,CAAC,KAAK,QAAQ,CAAC,EAAE,CAAC,EAAE;QACjC,OAAO,CAAC,CAAA;KACT;IACD,OAAO,CAAC,CAAA;CACT;AAED,SAAS,+BAA+B,CAAC,OAAO,EAAE,WAAW;IAC3D,IAAI,cAAc,GAAG,EAAE,CAAA;IAEvB,KAAK,IAAI,MAAI,IAAI,OAAO,EAAE;QACxB,IACE,EAAE,MAAI,IAAI,6BAA6B,CAAC;YACxC,6BAA6B,CAAC,MAAI,CAAC,IAAI,WAAW,EAClD;YACA,cAAc,CAAC,MAAI,CAAC,GAAG,OAAO,CAAC,MAAI,CAAC,CAAA;SACrC;KACF;IAED,OAAO,cAAc,CAAA;CACtB;AAED,SAAS,mBAAmB,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ;IAE3D,IAAI,EAAE,GAAG,CAAC,CAAA;IACV,OAAO,EAAE,GAAG,KAAK,CAAC,MAAM,EAAE;QAExB,IAAI,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAA;QACxC,IAAI,MAAM,KAAK,CAAC,CAAC,EAAE;YACjB,MAAK;SACN;QAED,IAAI,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,CAAA;QACrC,EAAE,GAAG,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAA;QAC7B,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAA;QAE7B,IAAI,EAAE,GAAG,CAAC,CAAA;QACV,OAAO,EAAE,GAAG,KAAK,CAAC,MAAM,EAAE;YAExB,IAAI,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAA;YACxC,IAAI,MAAM,KAAK,CAAC,CAAC,EAAE;gBACjB,MAAK;aACN;YAED,IAAI,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,CAAA;YACrC,EAAE,GAAG,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAA;YAC7B,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAA;YAE7B,IAAI,OAAO,KAAK,OAAO,IAAI,MAAM,KAAK,MAAM,EAAE;gBAC5C,OAAO;oBACL,MAAM,EAAE,OAAO;oBACf,KAAK,EAAE,MAAM;iBACd,CAAA;aACF;SACF;KACF;IAED,OAAO,IAAI,CAAA;CACZ;;AChWD;IAKE,sBAAY,MAAc,EAAE,SAAkB;QAC5C,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;QACpB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;KAC3B;IAED,6BAAM,GAAN,UAAO,IAAiB,EAAE,OAA8B;QACtD,OAAO,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,EAAE,0BAA0B,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAA;KAC1G;IAED,kCAAW,GAAX,UAAY,KAAkB,EAAE,GAAgB,EAAE,OAA8B;QAC9E,OAAO,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,EAAE,0BAA0B,CAAC,KAAK,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAA;KAC1G;IAEH,mBAAC;CAAA,IAAA;;ACzBD;IAIE,uBAAY,IAAuB;QACjC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;KACjB;IAED,8BAAM,GAAN,UAAO,IAAiB,EAAE,OAA8B;QACtD,OAAO,IAAI,CAAC,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,CAAA;KAClE;IAED,mCAAW,GAAX,UAAY,KAAkB,EAAE,GAAgB,EAAE,OAA8B;QAC9E,OAAO,IAAI,CAAC,IAAI,CAAC,0BAA0B,CAAC,KAAK,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC,CAAA;KAClE;IAEH,oBAAC;CAAA,IAAA;;SC6Be,eAAe,CAAC,KAAqB,EAAE,gBAAyB;IAC9E,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,EAAE;QACtC,IAAI,OAAO,gBAAgB,KAAK,QAAQ,EAAE;YACxC,KAAK,cAAK,SAAS,EAAE,gBAAgB,IAAK,KAAK,CAAE,CAAA;SAClD;QACD,OAAO,IAAI,eAAe,CAAC,KAAK,CAAC,CAAA;KAElC;SAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;QACpC,OAAO,IAAI,YAAY,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAA;KAEjD;SAAM,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;QACtC,OAAO,IAAI,aAAa,CAAC,KAA0B,CAAC,CAAA;KACrD;CACF;AAMD,SAAgB,cAAc,CAAC,MAAkB,EAAE,cAAuB,EAAE,aAA8B;IAA9B,8BAAA,EAAA,qBAA8B;IACxG,IAAI,CAAC,GAAG,MAAM,CAAC,WAAW,EAAE,CAAA;IAE5B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAA;IAEzB,IAAI,aAAa,EAAE;QACjB,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CAAA;KAChC;IAED,IAAI,CAAC,CAAC,MAAM,GAAG,EAAE,EAAE;QACjB,IAAI,cAAc,IAAI,IAAI,EAAE;YAC1B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,CAAA;SACvB;aAAM,IAAI,cAAc,KAAK,CAAC,EAAE;YAC/B,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,oBAAoB,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC,CAAA;SAC/D;KAEF;IAED,OAAO,CAAC,CAAA;CACT;AAED,SAAgB,mBAAmB,CAAC,MAAkB;IACpD,OAAO,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,GAAG,GAAG;QAC5C,QAAQ,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,GAAG,GAAG;QACzC,QAAQ,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,CAAA;CACtC;AAED,SAAgB,oBAAoB,CAAC,OAAe,EAAE,KAAa;IAAb,sBAAA,EAAA,aAAa;IACjE,IAAI,IAAI,GAAG,OAAO,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,CAAA;IAClC,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAA;IAC3B,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,EAAE,CAAC,CAAA;IAChC,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,EAAE,CAAC,CAAA;IAE/B,IAAI,KAAK,EAAE;QACT,OAAO,IAAI,GAAG,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC,GAAG,GAAG,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAA;KAC3D;SAAM;QACL,OAAO,KAAK,GAAG,IAAI,GAAG,KAAK,IAAI,IAAI,GAAG,GAAG,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAA;KACpE;CACF;AAKD,SAAgB,0BAA0B,CAAC,KAAkB,EAAE,GAAgB,EAAE,OAA8B,EAAE,SAAkB;IACjI,IAAI,SAAS,GAAG,iBAAiB,CAAC,KAAK,EAAE,OAAO,CAAC,cAAc,CAAC,CAAA;IAChE,IAAI,OAAO,GAAG,GAAG,GAAG,iBAAiB,CAAC,GAAG,EAAE,OAAO,CAAC,cAAc,CAAC,GAAG,IAAI,CAAA;IAEzE,OAAO;QACL,IAAI,EAAE,SAAS;QACf,KAAK,EAAE,SAAS;QAChB,GAAG,EAAE,OAAO;QACZ,QAAQ,EAAE,OAAO,CAAC,QAAQ;QAC1B,WAAW,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK;QACjC,SAAS,WAAA;KACV,CAAA;CACF;AAED,SAAS,iBAAiB,CAAC,QAAqB,EAAE,cAA8B;IAC9E,IAAI,CAAC,GAAG,cAAc,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAA;IAErD,OAAO;QACL,MAAM,EAAE,QAAQ,CAAC,MAAM;QACvB,cAAc,EAAE,QAAQ,CAAC,cAAc;QACvC,KAAK,EAAE,CAAC;QACR,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;QACV,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;QACX,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;QACT,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;QACV,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QACZ,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QACZ,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;KAClB,CAAA;CACF;;AC7ID;IAKE,wBAAY,QAAkB,EAAE,mBAAgC;QAC9D,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;QACxB,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAA;KAC/C;IAED,+BAAM,GAAN;QACE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;YACrB,IAAI,EAAE,qBAAqB;YAC3B,QAAQ,EAAE,IAAI,CAAC,mBAAmB,CAAC,QAAQ;SAC5C,CAAC,CAAA;KACH;IAED,gCAAO,GAAP;QACE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;YACrB,IAAI,EAAE,qBAAqB;YAC3B,SAAS,EAAE,CAAE,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAE;SACjD,CAAC,CAAA;KACH;IAED,sBAAI,8BAAE;aAAN;YACE,OAAO,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAA;SACzC;;;OAAA;IAGD,sBAAI,+BAAG;aAAP;YACE,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAA;SACzC;;;OAAA;IAEH,qBAAC;CAAA,IAAA;;AC1BD;IAME,kBAAY,QAAkB,EAAE,GAAa,EAAE,QAAwB;QACrE,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAA;QACzB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAA;QACf,IAAI,CAAC,SAAS,GAAG,QAAQ,IAAI,IAAI,CAAA;KAClC;IAKD,0BAAO,GAAP,UAAQ,IAAY,EAAE,GAAW;;QAC/B,IAAI,IAAI,IAAI,UAAU,EAAE,CAGvB;aAAM,IAAI,IAAI,IAAI,cAAc,EAAE;YAEjC,IAAI,OAAO,cAAc,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;gBAC9C,GAAG,GAAG,cAAc,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAA;aAChC;YAED,IAAI,CAAC,MAAM,CAAC;gBACV,aAAa,YAAI,GAAC,IAAI,IAAG,GAAG,KAAE;aAC/B,CAAC,CAAA;SAEH;aAAM,IAAI,IAAI,IAAI,uBAAuB,EAAE;YAC1C,IAAI,EAAE,SAAA,CAAA;YAEN,IAAI,OAAO,uBAAuB,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;gBACvD,GAAG,GAAG,uBAAuB,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAA;aACzC;YAED,IAAI,IAAI,KAAK,OAAO,EAAE;gBACpB,EAAE,GAAG,EAAE,eAAe,EAAE,GAAG,EAAE,WAAW,EAAE,GAAG,EAAE,CAAA;aAChD;iBAAM,IAAI,IAAI,KAAK,UAAU,EAAE;gBAC9B,EAAE,GAAG,EAAE,aAAa,EAAE,GAAG,EAAE,gBAAgB,EAAE,GAAG,EAAE,CAAA;aACnD;iBAAM;gBACL,EAAE,aAAK,GAAC,IAAI,IAAG,GAAG,KAAE,CAAA;aACrB;YAED,IAAI,CAAC,MAAM,CAAC;gBACV,aAAa,EAAE,EAAE,EAAE,IAAA,EAAE;aACtB,CAAC,CAAA;SAEH,AAEA;KACF;IAED,kCAAe,GAAf,UAAgB,IAAY,EAAE,GAAQ;;QACpC,IAAI,CAAC,MAAM,CAAC;YACV,aAAa,YAAI,GAAC,IAAI,IAAG,GAAG,KAAE;SAC/B,CAAC,CAAA;KACH;IAED,2BAAQ,GAAR,UAAS,UAAqB,EAAE,OAAkE;QAAlE,wBAAA,EAAA,YAAkE;QAC1F,IAAA,gCAAO,CAAmB;QAChC,IAAI,KAAK,GAAG,OAAO,CAAC,YAAY,CAAC,UAAU,CAAC,CAAA;QAE5C,IAAI,KAAK,IAAI,IAAI,CAAC,SAAS,EAAE;YAC3B,IAAI,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAA;YACxC,IAAI,UAAU,GAAG,SAAS,CAAC,aAAa,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,WAAW,CAAC,CAAA;YAEpF,IAAI,OAAO,CAAC,gBAAgB,EAAE;gBAC5B,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAA;aACxC;iBAAM;gBACL,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,YAAA,EAAE,CAAC,CAAA;aAC5B;SACF;KACF;IAED,yBAAM,GAAN,UAAO,QAA0B,EAAE,OAAsC;QAAtC,wBAAA,EAAA,YAAsC;QACjE,IAAA,gCAAO,CAAmB;QAChC,IAAI,GAAG,CAAA;QAEP,IAAI,QAAQ,IAAI,IAAI,EAAE;YACpB,GAAG,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAA;YAEpC,IAAI,CAAC,GAAG,EAAE;gBACR,OAAM;aACP;SACF;QAED,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,GAAG,EAAE;gBACP,IAAI,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,CAAC,WAAW,CAAC,CAAA;gBACrF,IAAI,CAAC,MAAM,CAAC,EAAE,QAAQ,UAAA,EAAE,CAAC,CAAA;aAC1B;iBAAM;gBACL,IAAI,CAAC,MAAM,CAAC,EAAE,aAAa,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,CAAC,CAAA;aAClD;SACF;KACF;IAED,2BAAQ,GAAR,UAAS,UAAqB,EAAE,QAA0B,EAAE,OAAwD;QAAxD,wBAAA,EAAA,YAAwD;QAC5G,IAAA,gCAAO,CAAmB;QAChC,IAAI,aAAa,GAAG,EAAE,MAAM,EAAE,OAAO,CAAC,MAAM,EAAS,CAAA;QACrD,IAAI,KAAK,GAAG,OAAO,CAAC,YAAY,CAAC,UAAU,CAAC,CAAA;QAC5C,IAAI,GAAG,CAAA;QAEP,IAAI,CAAC,KAAK,EAAE;YACV,OAAM;SACP;QAED,IAAI,QAAQ,IAAI,IAAI,EAAE;YACpB,GAAG,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAA;YAEpC,IAAI,CAAC,GAAG,EAAE;gBACR,OAAM;aACP;SACF;QAED,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAA;YAIxC,IAAI,OAAO,CAAC,MAAM,KAAK,IAAI,EAAE;gBAC3B,aAAa,GAAG,sBAAsB,CAAC,aAAa,CAAC,CAAA;aACtD;YAED,IAAI,UAAU,GAAG,SAAS,CAAC,aAAa,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,WAAW,CAAC,CAAA;YAEpF,IAAI,GAAG,EAAE;gBACP,IAAI,QAAQ,GAAG,SAAS,CAAC,aAAa,CAAC,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,CAAC,WAAW,CAAC,CAAA;gBAE9E,IAAI,cAAc,CAAC,UAAU,EAAE,QAAQ,CAAC,EAAE;oBACxC,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,EAAE,UAAU,EAAE,aAAa,eAAA,EAAE,CAAC,CAAA;iBACvD;qBAAM;oBACL,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,YAAA,EAAE,QAAQ,UAAA,EAAE,aAAa,eAAA,EAAE,CAAC,CAAA;iBACrD;aAEF;iBAAM;gBACL,aAAa,CAAC,MAAM,GAAG,KAAK,CAAA;gBAC5B,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,EAAE,UAAU,EAAE,aAAa,eAAA,EAAE,CAAC,CAAA;aACvD;SACF;KACF;IAED,4BAAS,GAAT,UAAU,UAAyB;QACjC,IAAI,KAAK,GAAG,cAAc,CAAC,UAAU,CAAC,CAAA;QAEtC,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC,CAAA;SACnC;KACF;IAED,0BAAO,GAAP,UAAQ,UAAyB;QAC/B,IAAI,KAAK,GAAG,cAAc,CAAC,UAAU,CAAC,CAAA;QAEtC,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,MAAM,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAA;SACjC;KACF;IAED,4BAAS,GAAT,UAAU,UAAyB;QACjC,IAAI,KAAK,GAAG,cAAc,CAAC,UAAU,CAAC,CAAA;QAEtC,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC,CAAA;SACnC;KACF;IAED,4BAAS,GAAT,UAAU,MAAe,EAAE,OAA4C;QAA5C,wBAAA,EAAA,YAA4C;QACrE,IAAI,aAAa,GAAG,EAAE,MAAM,QAAA,EAAS,CAAA;QACrC,IAAI,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,CAAA;QAE/C,IAAI,gBAAgB,IAAI,IAAI,EAAE;YAC5B,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAA;SAChE;QAED,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,MAAM,EAAE;YAC/B,aAAa,CAAC,MAAM,GAAG,gBAAgB,CAAA;SACxC;QAED,IAAI,CAAC,MAAM,CAAC,EAAE,aAAa,eAAA,EAAE,CAAC,CAAA;KAC/B;IAED,8BAAW,GAAX,UAAY,WAA2B;QAC/B,IAAA,gCAAO,CAAmB;QAChC,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAA;QAC7B,IAAI,SAAS,GAAG,eAAe,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC,CAAA;QAEzF,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YACpB,OAAO,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,EAAE,QAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE;gBAC9E,cAAc,EAAE,QAAQ,CAAC,cAAc;gBACvC,YAAY,EAAE,QAAQ,CAAC,YAAY;aACpC,CAAC,CAAA;SACH;aAAM;YACL,OAAO,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,EAAE,SAAS,EAAE;gBACrD,SAAS,EAAE,QAAQ,CAAC,cAAc;aACnC,CAAC,CAAA;SACH;KACF;IAED,yBAAM,GAAN,UAAO,QAAuB;QAC5B,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAA;QACnB,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAA;QAE7B,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;gBACtB,IAAI,EAAE,eAAe;gBACrB,UAAU,EAAE,QAAQ,CAAC,UAAU;gBAC/B,QAAQ,UAAA;gBACR,OAAO,EAAE,IAAI;aACd,CAAC,CAAA;YAEF,IAAI,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,UAAU,CAAA;YAChD,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;YACtC,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;SAC3D;KACF;IAED,yBAAM,GAAN;QACE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;YACtB,IAAI,EAAE,kBAAkB;YACxB,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK;SACvB,CAAC,CAAA;KACH;IAED,sBAAI,4BAAM;aAAV;YACE,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAA;YAEjC,IAAI,QAAQ,EAAE;gBACZ,OAAO,IAAI,cAAc,CACvB,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,CAC5C,CAAA;aACF;YACD,OAAO,IAAI,CAAA;SACZ;;;OAAA;IAED,sBAAI,2BAAK;aAAT;YACE,OAAO,IAAI,CAAC,SAAS;gBACnB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC;gBACzD,IAAI,CAAA;SACP;;;OAAA;IAED,sBAAI,yBAAG;aAAP;YACE,OAAO,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM;gBACxC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC;gBACvD,IAAI,CAAA;SACP;;;OAAA;IAID,sBAAI,wBAAE;aAAN,cAAmB,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAA,EAAE;;;OAAA;IAC9C,sBAAI,6BAAO;aAAX,cAAwB,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAA,EAAE;;;OAAA;IAClD,sBAAI,4BAAM;aAAV,cAAwB,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAA,EAAE;;;OAAA;IACjD,sBAAI,2BAAK;aAAT,cAAsB,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAA,EAAE;;;OAAA;IAC9C,sBAAI,yBAAG;aAAP,cAAoB,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAA,EAAE;;;OAAA;IAC1C,sBAAI,+BAAS;aAAb,cAA0B,OAAO,IAAI,CAAC,IAAI,CAAC,SAAS,CAAA,EAAE;;;OAAA;IACtD,sBAAI,mCAAa;aAAjB,cAA+B,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAA,EAAE;;;OAAA;IAClE,sBAAI,sCAAgB;aAApB,cAAkC,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,CAAA,EAAE;;;OAAA;IACxE,sBAAI,gCAAU;aAAd,cAAwB,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,IAAI,CAAA,EAAE;;;OAAA;IACpE,sBAAI,6BAAO;aAAX,cAAqB,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAA,EAAE;;;OAAA;IAClD,sBAAI,2BAAK;aAAT,cAAmB,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,IAAI,CAAA,EAAE;;;OAAA;IAC1D,sBAAI,qCAAe;aAAnB,cAAgC,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAA,EAAE;;;OAAA;IACrE,sBAAI,iCAAW;aAAf,cAA4B,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW,CAAA,EAAE;;;OAAA;IAC7D,sBAAI,+BAAS;aAAb,cAA0B,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,SAAS,CAAA,EAAE;;;OAAA;IAGzD,sBAAI,gCAAU;aAAd,cAA6B,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,CAAA,EAAE;;;OAAA;IAC7D,sBAAI,mCAAa;aAAjB,cAA2B,OAAO,IAAI,CAAC,IAAI,CAAC,aAAa,CAAA,EAAE;;;OAAA;IAE7D,eAAC;CAAA,IAAA;;SCjQe,eAAe,CAAC,UAAsB,EAAE,YAAyB,EAAE,YAAuB,EAAE,gBAA2B;IACrI,IAAI,kBAAkB,GAAuC,EAAE,CAAA;IAC/D,IAAI,gBAAgB,GAAqC,EAAE,CAAA;IAC3D,IAAI,YAAY,GAAoC,EAAE,CAAA;IACtD,IAAI,QAAQ,GAAuB,EAAE,CAAA;IACrC,IAAI,QAAQ,GAAuB,EAAE,CAAA;IACrC,IAAI,QAAQ,GAAG,eAAe,CAAC,UAAU,CAAC,IAAI,EAAE,YAAY,CAAC,CAAA;IAE7D,KAAK,IAAI,KAAK,IAAI,UAAU,CAAC,IAAI,EAAE;QACjC,IAAI,GAAG,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;QAEhC,IAAI,GAAG,CAAC,SAAS,KAAK,oBAAoB,EAAE;YAC1C,IAAI,GAAG,CAAC,OAAO,EAAE;gBACf,kBAAkB,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,CAAA;gBAEpC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;oBAC9B,YAAY,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,GAAG,CAAA;iBAChC;aACF;iBAAM;gBACL,gBAAgB,CAAC,KAAK,CAAC,GAAG,EAAE,CAAA;aAC7B;SACF;KACF;IAED,KAAK,IAAI,UAAU,IAAI,UAAU,CAAC,SAAS,EAAE;QAC3C,IAAI,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;QAC/C,IAAI,GAAG,GAAG,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;QACzC,IAAI,EAAE,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;QAC5B,IAAI,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAA;QAE9B,IAAI,WAAW,GAAG,CAAC,CAAC,GAAG,CAAC,MAAM,IAAI,gBAAgB;YAChD,sBAAsB,CAAC,SAAS,EAAE,gBAAgB,CAAC;YACnD,SAAS,CAAA;QAEX,IAAI,WAAW,GAAG,eAAe,CAAC,WAAW,EAAE,YAAY,CAAC,CAAA;QAE5D,IAAI,WAAW,EAAE;YACf,IAAI,GAAG,CAAC,SAAS,KAAK,oBAAoB,EAAE;gBAC1C,IAAI,GAAG,CAAC,OAAO,EAAE;oBACf,kBAAkB,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;iBAClD;qBAAM;oBACL,gBAAgB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;iBACnD;aACF;iBAAM;gBACL,CAAC,GAAG,CAAC,SAAS,KAAK,YAAY,GAAG,QAAQ,GAAG,QAAQ,EAAE,IAAI,CAAC;oBAC1D,GAAG,KAAA;oBACH,EAAE,IAAA;oBACF,QAAQ,UAAA;oBACR,KAAK,EAAE,WAAW;oBAClB,OAAO,EAAE,WAAW,CAAC,KAAK,IAAI,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,WAAW,CAAC,KAAK,CAAC,OAAO,EAAE;oBACzF,KAAK,EAAE,WAAW,CAAC,GAAG,IAAI,WAAW,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,WAAW,CAAC,GAAG,CAAC,OAAO,EAAE;iBAClF,CAAC,CAAA;aACH;SACF;KACF;IAED,KAAK,IAAI,OAAO,IAAI,kBAAkB,EAAE;QACtC,IAAI,MAAM,GAAG,kBAAkB,CAAC,OAAO,CAAC,CAAA;QACxC,IAAI,cAAc,GAAG,YAAY,CAAC,MAAM,EAAE,YAAY,CAAC,CAAA;QAEvD,KAA0B,UAAc,EAAd,iCAAc,EAAd,4BAAc,EAAd,IAAc,EAAE;YAArC,IAAI,aAAa,uBAAA;YACpB,IAAI,GAAG,GAAG,YAAY,CAAC,OAAO,CAAC,CAAA;YAC/B,IAAI,EAAE,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;YAE5B,QAAQ,CAAC,IAAI,CAAC;gBACZ,GAAG,KAAA;gBACH,EAAE,IAAA;gBACF,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,aAAa;gBACpB,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,KAAK;aACb,CAAC,CAAA;SACH;KACF;IAED,KAAK,IAAI,KAAK,IAAI,gBAAgB,EAAE;QAClC,IAAI,MAAM,GAAG,gBAAgB,CAAC,KAAK,CAAC,CAAA;QACpC,IAAI,cAAc,GAAG,YAAY,CAAC,MAAM,EAAE,YAAY,CAAC,CAAA;QAEvD,KAA0B,UAAc,EAAd,iCAAc,EAAd,4BAAc,EAAd,IAAc,EAAE;YAArC,IAAI,aAAa,uBAAA;YACpB,QAAQ,CAAC,IAAI,CAAC;gBACZ,GAAG,EAAE,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC;gBAC3B,EAAE,EAAE,QAAQ,CAAC,KAAK,CAAC;gBACnB,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,aAAa;gBACpB,OAAO,EAAE,KAAK;gBACd,KAAK,EAAE,KAAK;aACb,CAAC,CAAA;SACH;KACF;IAED,OAAO,EAAE,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,QAAQ,EAAE,CAAA;CACtC;AAED,SAAgB,cAAc,CAAC,GAAa;IAC1C,OAAO,GAAG,CAAC,SAAS,KAAK,YAAY,IAAI,GAAG,CAAC,SAAS,KAAK,oBAAoB,CAAA;CAChF;AAED,SAAgB,gBAAgB,CAAC,IAAU,EAAE,IAAW,EAAE,QAAiB;IAEzE,IAAI,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,EAAE;QACzC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,UAAS,GAAG;YAC7B,IAAI,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE;gBAC/C;oBACE,KAAK,EAAE,IAAI,QAAQ,CACjB,IAAI,CAAC,QAAQ,EACb,GAAG,CAAC,UAAU,CAAC,GAAG,EAClB,GAAG,CAAC,UAAU,CAAC,QAAQ,CACxB;oBACD,QAAQ,UAAA;oBACR,OAAO,EAAE,GAAG,CAAC,OAAO;oBACpB,KAAK,EAAE,GAAG,CAAC,KAAK;oBAEhB,EAAE,EAAE,GAAG,CAAC,EAAE;oBACV,IAAI,MAAA;iBACL;aACF,CAAC,CAAA;YAEF,IAAI,MAAM,KAAK,KAAK,EAAE;gBACpB,OAAO,KAAK,CAAA;aACb;iBAAM,IAAI,MAAM,IAAI,MAAM,KAAK,IAAI,EAAE;gBACpC,GAAG,CAAC,EAAE,GAAG,MAAM,CAAA;aAChB;YAED,OAAO,IAAI,CAAA;SACZ,CAAC,CAAA;KACH;IAED,KAAgB,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,EAAE;QAAjB,IAAI,GAAG,aAAA;QACV,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAA;KACtB;IAED,OAAO,IAAI,CAAA;CACZ;AAED,SAAS,QAAQ,CAAC,EAAe,EAAE,GAAQ;IACxC,EAAU,CAAC,KAAK,GAAG,GAAG,CAAA;CACxB;AAED,SAAgB,QAAQ,CAAC,EAAe;IACtC,OAAQ,EAAU,CAAC,KAAK,IAAI,IAAI,CAAA;CACjC;AAKD,SAAgB,eAAe,CAAC,SAAuB,EAAE,YAAyB;IAChF,OAAO,OAAO,CAAC,SAAS,EAAE,UAAS,QAAkB;QACnD,OAAO,cAAc,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAA;KAC9C,CAAC,CAAA;CACH;AAED,SAAgB,cAAc,CAAC,QAAkB,EAAE,YAAyB;IAC1E,IAAI,GAAG,GAAG,EAAE,CAAA;IAEZ,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;QACpB,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,CAAA;KAC3B;IAED,IAAI,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;QAChC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAA;KACvC;IAED,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAA;IAErB,OAAO,eAAe,CAAC,GAAG,CAAC,CAAA;CAC5B;;SCrKe,yBAAyB,CAAC,UAAsB,EAAE,eAA4B,EAAE,QAAuB,EAAE,QAAkB;IACzI,IAAI,YAAY,GAAG,eAAe,CAAC,UAAU,CAAC,IAAI,EAAE,eAAe,CAAC,CAAA;IACpE,IAAI,IAAI,GAAG,qBAAqB,EAAE,CAAA;IAElC,KAAK,IAAI,KAAK,IAAI,UAAU,CAAC,IAAI,EAAE;QACjC,IAAI,GAAG,GAAG,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;QAEhC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,uBAAuB,CAAC,GAAG,EAAE,YAAY,CAAC,KAAK,CAAC,EAAE,QAAQ,EAAE,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,wBAAwB,EAAE,QAAQ,CAAC,CAAA;KAC/I;IAED,KAAK,IAAI,UAAU,IAAI,UAAU,CAAC,SAAS,EAAE;QAC3C,IAAI,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;QAC/C,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;QAEnC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,4BAA4B,CAAC,QAAQ,EAAE,GAAG,EAAE,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAA;KAC3H;IAED,OAAO,IAAI,CAAA;CACZ;AAKD,SAAS,uBAAuB,CAAC,QAAkB,EAAE,WAAoB,EAAE,QAAuB,EAAE,QAAmC,EAAE,QAAkB;IACzJ,IAAI,aAAa,GAAG,QAAQ,CAAC,aAAa,IAAI,EAAE,CAAA;IAKhD,IACE,aAAa,CAAC,MAAM,IAAI,IAAI;QAC5B,WAAW,CAAC,gBAAgB;SAC3B,QAAQ,CAAC,UAAU,IAAI,QAAQ,CAAC,QAAQ,CAAC,EAC1C;QACA,aAAa,CAAC,MAAM,GAAG,IAAI,CAAA;KAC5B;IAED,IAAI,IAAI,gBACH,QAAQ,EACR,aAAa,IAChB,EAAE,eAAO,QAAQ,CAAC,EAAE,EAAK,aAAa,CAAC,EAAE,IAC1C,CAAA;IAED,IAAI,QAAQ,CAAC,aAAa,EAAE;QAC1B,IAAI,CAAC,aAAa,gBAAQ,IAAI,CAAC,aAAa,EAAK,QAAQ,CAAC,aAAa,CAAE,CAAA;KAC1E;IAED,KAAoB,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAE;QAAzB,IAAI,OAAO,iBAAA;QACd,OAAO,CAAC,IAAI,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAA;KAClC;IAED,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,QAAQ,CAAC,GAAG,CAAC,oBAAoB,CAAC,EAAE;QACtD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;KACnB;IAED,OAAO,IAAI,CAAA;CACZ;AAGD,SAAS,4BAA4B,CACnC,aAA4B,EAC5B,QAAkB;AAClB,WAAoB,EACpB,QAAuB,EACvB,QAAkB;IAElB,IAAI,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAA;IAC9B,IAAI,WAAW,GAAG,QAAQ,CAAC,aAAa,IAAI,QAAQ,CAAC,aAAa,CAAC,MAAM,KAAK,IAAI,CAAA;IAClF,IAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,IAAI,QAAQ,CAAC,aAAa,CAAC,MAAM,KAAK,KAAK,CAAA;IAChF,IAAI,IAAI,GAAGA,aAAK,aAAa,CAAmB,CAAA;IAEhD,IAAI,WAAW,EAAE;QACf,IAAI,CAAC,KAAK,GAAG,sBAAsB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;KAChD;IAED,IAAI,QAAQ,CAAC,UAAU,IAAI,WAAW,CAAC,aAAa,EAAE;QACpD,IAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,QAAQ,CAAC,UAAU,CAAC;YACzD,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,QAAQ,CAAC,UAAU,CAAC;SACtD,CAAA;KACF;IAED,IAAI,QAAQ,CAAC,UAAU,IAAI,WAAW,CAAC,gBAAgB,EAAE;QACvD,IAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,QAAQ,CAAC,UAAU,CAAC;YACzD,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG;SACpB,CAAA;KACF;IAED,IAAI,QAAQ,CAAC,QAAQ,IAAI,WAAW,CAAC,gBAAgB,EAAE;QACrD,IAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK;YACvB,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,QAAQ,CAAC,QAAQ,CAAC;SACpD,CAAA;KACF;IAED,IAAI,QAAQ,EAAE;QACZ,IAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK;YACvB,GAAG,EAAE,QAAQ,CAAC,kBAAkB,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;SACpE,CAAA;KACF;IAID,IAAI,QAAQ,CAAC,MAAM,EAAE;QACnB,IAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;YACnC,GAAG,EAAE,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;SAChC,CAAA;KACF;IAGD,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;QACrC,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,QAAQ,CAAC,kBAAkB,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;KAChF;IAED,OAAO,IAAI,CAAA;CACZ;;2BCtHuB,UAAsB,EAAE,MAAc,EAAE,YAA6B,EAAE,WAAwB,EAAE,QAAkB;IACzI,QAAQ,MAAM,CAAC,IAAI;QAEjB,KAAK,gBAAgB;YACnB,OAAO,gBAAgB,CACrB,UAAU,EACV,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,EAC7B,MAAM,CAAC,OAAO,EACd,MAAM,CAAC,UAAU,EACjB,MAAM,CAAC,SAAS,EAChB,QAAQ,CACT,CAAA;QAEH,KAAK,YAAY;YACf,OAAO,QAAQ,CACb,UAAU,EACV,MAAM,CAAC,UAAU;YACjB,WAAW,GAAG,WAAW,CAAC,WAAW,GAAG,IAAI,EAC5C,QAAQ,CACT,CAAA;QAEH,KAAK,cAAc;YACjB,OAAO,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,UAAU,CAAC,CAAA;QAExD,KAAK,MAAM,CAAC;QACZ,KAAK,MAAM,CAAC;QACZ,KAAK,UAAU,CAAC;QAChB,KAAK,eAAe;YAClB,IAAI,WAAW,EAAE;gBACf,OAAO,eAAe,CAAC,UAAU,EAAE,WAAW,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;aACtE;iBAAM;gBACL,OAAO,UAAU,CAAA;aAClB;QAEH,KAAK,iBAAiB;YACpB,OAAO,WAAW,CAAC,UAAU,EAAE,MAAM,CAAC,UAAU,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAA;QAErE,KAAK,eAAe;YAClB,OAAO,sBAAsB,CAAC,UAAU,EAAE,MAAM,CAAC,UAAU,EAAE,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAA;QAEzG,KAAK,wBAAwB;YAC3B,OAAO,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,SAAS,CAAC,CAAA;QAEvD,KAAK,kBAAkB;YACrB,OAAO,oBAAoB,CAAC,UAAU,EAAE,UAAS,QAAQ;gBACvD,OAAO,QAAQ,CAAC,KAAK,KAAK,MAAM,CAAC,KAAK,CAAA;aACvC,CAAC,CAAA;QAEJ,KAAK,qBAAqB;YACxB,OAAO,uBAAuB,CAAC,UAAU,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAA;QAE7D,KAAK,0BAA0B;YAC7B,OAAO,oBAAoB,CAAC,UAAU,EAAE,UAAS,QAAkB;gBACjE,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAA;aAC1B,CAAC,CAAA;QAEJ,KAAK,mBAAmB;YACtB,OAAO,qBAAqB,EAAE,CAAA;QAEhC,KAAK,cAAc;YACjB,OAAO;gBACL,IAAI,EAAE,UAAU,CAAC,IAAI;gBACrB,SAAS,EAAE,UAAU,CAAC,SAAS;aAChC,CAAA;QAEH;YACE,OAAO,UAAU,CAAA;KACpB;CACF;AAGD,SAAS,gBAAgB,CACvB,UAAsB,EACtB,WAAwB,EACxB,OAAe,EACf,UAA4B,EAC5B,SAAuB,EACvB,QAAkB;IAGlB,IACE,WAAW;QACX,OAAO,KAAK,WAAW,CAAC,aAAa;MACrC;QAEA,IAAI,MAAM,GAAG,WAAW,CACtB,kBAAkB,CAAC,SAAS,EAAE,WAAW,EAAE,QAAQ,CAAC,EACpD,WAAW,CAAC,QAAQ,EACpB,QAAQ,CACT,CAAA;QAED,IAAI,UAAU,EAAE;YACd,MAAM,GAAG,eAAe,CAAC,MAAM,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAA;SACvD;QAED,OAAO,gBAAgB,CACrB,uBAAuB,CAAC,UAAU,EAAE,WAAW,CAAC,QAAQ,CAAC,EACzD,MAAM,CACP,CAAA;KACF;IAED,OAAO,UAAU,CAAA;CAClB;AAGD,SAAS,QAAQ,CAAC,UAAsB,EAAE,MAAkB,EAAE,WAA6B,EAAE,QAAkB;IAE7G,IAAI,WAAW,EAAE;QACf,MAAM,GAAG,eAAe,CAAC,MAAM,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAA;KACxD;IAED,OAAO,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAA;CAC5C;AAGD,SAAS,WAAW,CAAC,UAAsB,EAAE,UAAmB,EAAE,UAAmB;IACnF,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI,CAAA;IAE1B,IAAI,SAAS,GAAG,OAAO,CAAC,UAAU,CAAC,SAAS,EAAE,UAAS,QAAuB;QAC5E,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;QAE9B,IAAI,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,YAAY,EAAE;YAClC,OAAO,QAAQ,CAAA;SAChB;aAAM;YACL,oBACK,QAAQ,IACX,KAAK,EAAE;oBACL,KAAK,EAAE,UAAU,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,EAAE,QAAQ,CAAC,cAAc,CAAC,CAAC;oBAChG,GAAG,EAAE,UAAU,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,QAAQ,CAAC,YAAY,CAAC,CAAC;iBAC3F,EACD,cAAc,EAAE,UAAU,CAAC,gBAAgB,GAAG,IAAI,GAAG,QAAQ,CAAC,cAAc,EAC5E,YAAY,EAAE,UAAU,CAAC,gBAAgB,GAAG,IAAI,GAAG,QAAQ,CAAC,YAAY,IACzE;SACF;KACF,CAAC,CAAA;IAEF,OAAO,EAAE,IAAI,MAAA,EAAE,SAAS,WAAA,EAAE,CAAA;CAC3B;AAGD,SAAS,sBAAsB,CAAC,UAAsB,EAAE,UAAkB,EAAE,QAAuB,EAAE,OAAgB,EAAE,QAAkB;IACvI,IAAI,QAAQ,GAAG,iBAAiB,CAAC,UAAU,EAAE,UAAU,CAAC,CAAA;IACxD,IAAI,eAAe,GAAG,OAAO;QAC3B,EAAE,EAAE,EAAE;gBACJ,aAAa,EAAE,IAAI;gBACnB,gBAAgB,EAAE,IAAI;gBACtB,WAAW,EAAE,EAAE;gBACf,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE,EAAE;gBACV,eAAe,EAAE,EAAE;gBACnB,WAAW,EAAE,EAAE;gBACf,SAAS,EAAE,EAAE;gBACb,UAAU,EAAE,EAAE;aACf,EAAiB;QAClB,QAAQ,CAAC,YAAY,CAAA;IAGvB,QAAQ,GAAG,yBAAyB,CAAC,QAAQ,EAAE,eAAe,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAA;IAEnF,OAAO,gBAAgB,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAA;CAC9C;AAGD,SAAS,uBAAuB,CAAC,UAAU,EAAE,QAAQ;IACnD,OAAO,oBAAoB,CAAC,UAAU,EAAE,UAAS,QAAkB;QACjE,OAAO,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAA;KACtC,CAAC,CAAA;CACH;AAID,SAAgB,gBAAgB,CAAC,UAAsB,EAAE,QAA2B;IAClF,OAAO;QACL,IAAI,EAAE,UAAU,CAAC,IAAI;QACrB,SAAS,EAAE,UAAU,CAAC,UAAU,CAAC,SAAS,EAAE,UAAS,QAAuB;YAC1E,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;SACtC,CAAC;KACH,CAAA;CACF;;SCjLe,kBAAkB,CAAC,WAAkC,EAAE,QAAkB;IACvF,OAAO,eAAe,CAAC,EAAE,SAAS,EAAE,WAAW,EAAE,EAAE,QAAQ,CAAC,CAAA;CAC7D;AAED,SAAgB,oBAAoB,CAAC,aAAuB,EAAE,QAAkB;IAC9E,OAAO,eAAe,CAAC,EAAE,aAAa,eAAA,EAAE,EAAE,QAAQ,CAAC,CAAA;CACpD;AAED,SAAS,eAAe,CAAC,QAAQ,EAAE,QAAkB;IACnD,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAA;IAExB,IAAI,KAAK,cACP,aAAa,EAAE,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,qBAAqB,EAAE,EACxE,aAAa,EAAE,EAAE,EACjB,UAAU,EAAE,QAAQ,CAAC,KAAK,CAAC,UAAU,EACrC,YAAY,EAAE,QAAQ,CAAC,YAAY,EACnC,cAAc,EAAE,EAAE,EAClB,SAAS,EAAE,IAAI,EACf,WAAW,EAAE,IAAI,IACd,QAAQ,CACZ,CAAA;IAED,OAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,YAAY,IAAI,YAAY,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAA;CACnF;AAED,SAAgB,YAAY,CAAC,KAAsB,EAAE,QAAkB,EAAE,YAAiB,EAAE,YAAa;IAAhC,6BAAA,EAAA,iBAAiB;IAExF,IAAI,KAAK,CAAC,SAAS,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,QAAQ,EAAE,YAAY,EAAE,YAAY,CAAC,EAAE;QAC5F,OAAO,KAAK,CAAA;KACb;IAED,IAAI,KAAK,CAAC,aAAa,IAAI,CAAC,yBAAyB,CAAC,KAAK,EAAE,QAAQ,EAAE,YAAY,EAAE,YAAY,CAAC,EAAE;QAClG,OAAO,KAAK,CAAA;KACb;IAED,OAAO,IAAI,CAAA;CACZ;AAMD,SAAS,uBAAuB,CAAC,KAAsB,EAAE,QAAkB,EAAE,YAAiB,EAAE,YAAY;IAC1G,IAAI,WAAW,GAAG,KAAK,CAAC,SAAS,CAAA;IAEjC,IAAI,iBAAiB,GAAG,WAAW,CAAC,aAAa,CAAA;IACjD,IAAI,WAAW,GAAG,iBAAiB,CAAC,IAAI,CAAA;IACxC,IAAI,gBAAgB,GAAG,iBAAiB,CAAC,SAAS,CAAA;IAClD,IAAI,cAAc,GAAG,eAAe,CAClC,WAAW,EACX,WAAW,CAAC,OAAO;QACjB,KAAK,CAAC,YAAY;QAClB,EAAE,EAAE,EAAE,QAAQ,CAAC,eAAe,EAAE;KACnC,CAAA;IAED,IAAI,YAAY,EAAE;QAChB,cAAc,GAAG,OAAO,CAAC,cAAc,EAAE,YAAY,CAAC,CAAA;KACvD;IAED,IAAI,eAAe,GAAG,gBAAgB,CAAC,KAAK,CAAC,UAAU,EAAE,WAAW,CAAC,cAAc,CAAC,SAAS,CAAC,CAAA;IAC9F,IAAI,SAAS,GAAG,eAAe,CAAC,IAAI,CAAA;IACpC,IAAI,cAAc,GAAG,eAAe,CAAC,SAAS,CAAA;IAC9C,IAAI,YAAY,GAAG,eAAe,CAAC,SAAS,EAAE,KAAK,CAAC,YAAY,CAAC,CAAA;IAEjE,KAAK,IAAI,iBAAiB,IAAI,gBAAgB,EAAE;QAC9C,IAAI,eAAe,GAAG,gBAAgB,CAAC,iBAAiB,CAAC,CAAA;QACzD,IAAI,YAAY,GAAG,eAAe,CAAC,KAAK,CAAA;QACxC,IAAI,aAAa,GAAG,cAAc,CAAC,eAAe,CAAC,KAAK,CAAC,CAAA;QACzD,IAAI,UAAU,GAAG,WAAW,CAAC,eAAe,CAAC,KAAK,CAAC,CAAA;QAGnD,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,WAAW,EAAE,YAAY,EAAE,eAAe,EAAE,KAAK,CAAC,aAAa,EAAE,QAAQ,CAAC,EAAE;YAChH,OAAO,KAAK,CAAA;SACb;QAID,IAAI,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;QAC9C,IAAI,OAAO,WAAW,KAAK,UAAU,EAAE;YAAE,WAAW,GAAG,IAAI,CAAA;SAAE;QAE7D,KAAK,IAAI,eAAe,IAAI,cAAc,EAAE;YAC1C,IAAI,aAAa,GAAG,cAAc,CAAC,eAAe,CAAC,CAAA;YAGnD,IAAI,eAAe,CAAC,YAAY,EAAE,aAAa,CAAC,KAAK,CAAC,EAAE;gBACtD,IAAI,YAAY,GAAG,YAAY,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,OAAO,CAAA;gBAG5D,IAAI,YAAY,KAAK,KAAK,IAAI,WAAW,CAAC,OAAO,EAAE;oBACjD,OAAO,KAAK,CAAA;iBACb;gBAED,IAAI,aAAa,CAAC,OAAO,KAAK,KAAK,EAAE;oBACnC,OAAO,KAAK,CAAA;iBACb;gBAED,IAAI,WAAW,IAAI,CAAC,WAAW,CAC7B,IAAI,QAAQ,CAAC,QAAQ,EAAE,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE,aAAa,CAAC;gBACrE,IAAI,QAAQ,CAAC,QAAQ,EAAE,UAAU,EAAE,eAAe,CAAC;iBACpD,EAAE;oBACD,OAAO,KAAK,CAAA;iBACb;aACF;SACF;QAID,IAAI,kBAAkB,GAAG,QAAQ,CAAC,KAAK,CAAC,UAAU,CAAA;QAElD,KAAyB,UAAoB,EAApB,KAAA,aAAa,CAAC,MAAM,EAApB,cAAoB,EAApB,IAAoB,EAAE;YAA1C,IAAI,YAAY,SAAA;YAEnB,IAAI,eAAe,gBACd,YAAY,IACf,KAAK,EAAE,eAAe,CAAC,KAAK,EAC5B,MAAM,EAAE,UAAU,CAAC,MAAM,GAC1B,CAAA;YAED,IAAI,OAAO,GAAG,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;YACvD,IAAI,YAAY,GAAG,kBAAkB,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAA;YAClE,IAAI,QAAQ,SAAA,CAAA;YAEZ,IAAI,OAAO,EAAE;gBACX,QAAQ,GAAG,IAAI,QAAQ,CAAC,QAAQ,EAAE,OAAO,EAAE,YAAY,CAAC,CAAA;aACzD;iBAAM;gBACL,QAAQ,GAAG,IAAI,QAAQ,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAA;aAC9C;YAED,IAAI,CAAC,YAAY,CACf,QAAQ,CAAC,gBAAgB,CAAC,eAAe,CAAC,EAC1C,QAAQ,CACT,EAAE;gBACD,OAAO,KAAK,CAAA;aACb;SACF;KAEF;IAED,OAAO,IAAI,CAAA;CACZ;AAMD,SAAS,yBAAyB,CAAC,KAAsB,EAAE,QAAkB,EAAE,YAAiB,EAAE,YAAY;IAC5G,IAAI,kBAAkB,GAAG,KAAK,CAAC,UAAU,CAAA;IACzC,IAAI,YAAY,GAAG,kBAAkB,CAAC,IAAI,CAAA;IAC1C,IAAI,iBAAiB,GAAG,kBAAkB,CAAC,SAAS,CAAA;IAEpD,IAAI,SAAS,GAAG,KAAK,CAAC,aAAa,CAAA;IACnC,IAAI,cAAc,GAAG,SAAS,CAAC,KAAK,CAAA;IAC9B,IAAA,0CAAe,CAAa;IAElC,IAAI,YAAY,EAAE;QAChB,eAAe,GAAG,YAAY,CAAC,eAAe,CAAC,CAAA;KAChD;IAGD,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,WAAW,EAAE,cAAc,EAAE,kBAAkB,EAAE,KAAK,CAAC,aAAa,EAAE,QAAQ,CAAC,EAAE;QACvH,OAAO,KAAK,CAAA;KACb;IAID,IAAI,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC,CAAA;IAC/C,IAAI,OAAO,WAAW,KAAK,UAAU,EAAE;QAAE,WAAW,GAAG,IAAI,CAAA;KAAE;IAE7D,KAAK,IAAI,kBAAkB,IAAI,iBAAiB,EAAE;QAChD,IAAI,gBAAgB,GAAG,iBAAiB,CAAC,kBAAkB,CAAC,CAAA;QAG5D,IAAI,eAAe,CAAC,cAAc,EAAE,gBAAgB,CAAC,KAAK,CAAC,EAAE;YAE3D,IAAI,eAAe,CAAC,OAAO,KAAK,KAAK,EAAE;gBACrC,OAAO,KAAK,CAAA;aACb;YAED,IAAI,WAAW,IAAI,CAAC,WAAW,CAC7B,IAAI,QAAQ,CAAC,QAAQ,EAAE,YAAY,CAAC,gBAAgB,CAAC,KAAK,CAAC,EAAE,gBAAgB,CAAC,CAC/E,EAAE;gBACD,OAAO,KAAK,CAAA;aACb;SACF;KACF;IAGD,KAA2B,UAAsB,EAAtB,KAAA,eAAe,CAAC,MAAM,EAAtB,cAAsB,EAAtB,IAAsB,EAAE;QAA9C,IAAI,cAAc,SAAA;QAErB,IAAI,YAAY,gBAAQ,YAAY,EAAK,SAAS,CAAE,CAAA;QAEpD,IAAI,CAAC,cAAc,CACjB,QAAQ,CAAC,gBAAgB,CAAC,YAAY,CAAC,EACvC,IAAI,CACL,EAAE;YACD,OAAO,KAAK,CAAA;SACb;KACF;IAED,OAAO,IAAI,CAAA;CACZ;AAMD,SAAS,kBAAkB,CACzB,WAAyB,EACzB,YAAuB,EACvB,eAA2B,EAC3B,uBAAmC,EACnC,QAAkB;IAElB,KAAuB,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAW,EAAE;QAA/B,IAAI,UAAU,oBAAA;QACjB,IAAI,CAAC,qBAAqB,CACxB,kBAAkB,CAAC,UAAU,EAAE,YAAY,EAAE,eAAe,EAAE,uBAAuB,EAAE,QAAQ,CAAC,EAChG,YAAY,CACb,EAAE;YACD,OAAO,KAAK,CAAA;SACb;KACF;IAED,OAAO,IAAI,CAAA;CACZ;AAED,SAAS,kBAAkB,CACzB,UAAsB,EACtB,YAAuB;AACvB,eAA2B;AAC3B,uBAAmC;AACnC,QAAkB;;IAGlB,IAAI,UAAU,KAAK,eAAe,EAAE;QAClC,OAAO,kBAAkB,CACvB,eAAe,CAAC,uBAAuB,EAAE,YAAY,EAAE,QAAQ,CAAC,CACjE,CAAA;KAEF;SAAM,IAAI,OAAO,UAAU,KAAK,QAAQ,EAAE;QACzC,OAAO,kBAAkB,CACvB,oBAAoB,CAAC,eAAe,EAAE,UAAS,QAAQ;YACrD,OAAO,QAAQ,CAAC,OAAO,KAAK,UAAU,CAAA;SACvC,CAAC,CACH,CAAA;KAEF;SAAM,IAAI,OAAO,UAAU,KAAK,QAAQ,IAAI,UAAU,EAAE;QACvD,OAAO,kBAAkB,CACvB,eAAe,CAAC,UAAU,EAAE,YAAY,EAAE,QAAQ,CAAC,CACpD,CAAA;KACF;IAED,OAAO,EAAE,CAAA;CACV;AAGD,SAAS,kBAAkB,CAAC,UAAsB;IAC1C,IAAA,gCAAS,CAAe;IAC9B,IAAI,MAAM,GAAgB,EAAE,CAAA;IAE5B,KAAK,IAAI,UAAU,IAAI,SAAS,EAAE;QAChC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,CAAA;KACzC;IAED,OAAO,MAAM,CAAA;CACd;AAGD,SAAS,qBAAqB,CAAC,WAAwB,EAAE,UAAqB;IAE5E,KAAuB,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAW,EAAE;QAA/B,IAAI,UAAU,oBAAA;QACjB,IAAI,kBAAkB,CAAC,UAAU,EAAE,UAAU,CAAC,EAAE;YAC9C,OAAO,IAAI,CAAA;SACZ;KACF;IAED,OAAO,KAAK,CAAA;CACb;AAMD,SAAgB,mBAAmB,CAAC,KAAsB,EAAE,QAAkB;IAC5E,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;QACxB,OAAO,WAAW,CAAC,KAAK,EAAE,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAA;KAE9C;SAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,EAAE;QAC7C,OAAO,WAAW,CAAC,CAAE,KAAK,CAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAA;KAElD;SAAM,IAAI,KAAK,IAAI,IAAI,EAAE;QACxB,OAAO,MAAM,CAAC,KAAK,CAAC,CAAA;KAErB;SAAM;QACL,OAAO,IAAI,CAAA;KACZ;CACF;;SC5Te,UAAU,CAAC,CAAC;IAC1B,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC;SACnC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;SACrB,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;SACrB,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;SACvB,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;SACvB,OAAO,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAA;CAC5B;AAKD,SAAgB,QAAQ,CAAC,QAAQ;IAC/B,IAAI,UAAU,GAAG,EAAE,CAAA;IAEnB,KAAK,IAAI,MAAI,IAAI,QAAQ,EAAE;QACzB,IAAI,GAAG,GAAG,QAAQ,CAAC,MAAI,CAAC,CAAA;QACxB,IAAI,GAAG,IAAI,IAAI,IAAI,GAAG,KAAK,EAAE,EAAE;YAC7B,UAAU,CAAC,IAAI,CAAC,MAAI,GAAG,GAAG,GAAG,GAAG,CAAC,CAAA;SAClC;KACF;IAED,OAAO,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;CAC5B;AAKD,SAAgB,UAAU,CAAC,KAAK;IAC9B,IAAI,KAAK,GAAG,EAAE,CAAA;IAEd,KAAK,IAAI,MAAI,IAAI,KAAK,EAAE;QACtB,IAAI,GAAG,GAAG,KAAK,CAAC,MAAI,CAAC,CAAA;QACrB,IAAI,GAAG,IAAI,IAAI,EAAE;YACf,KAAK,CAAC,IAAI,CAAC,MAAI,GAAG,IAAI,GAAG,UAAU,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAA;SAChD;KACF;IAED,OAAO,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;CACvB;AAKD,SAAgB,cAAc,CAAC,GAAmB;IAChD,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;QACtB,OAAO,GAAG,CAAA;KACX;SAAM,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;QAClC,OAAO,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;KACxB;SAAM;QACL,OAAO,EAAE,CAAA;KACV;CACF;;ACfM,IAAM,uBAAuB,GAAG;IACrC,QAAQ,EAAE,OAAO;IACjB,aAAa,EAAE,OAAO;IACtB,gBAAgB,EAAE,OAAO;IACzB,UAAU,EAAE,IAAI;IAChB,OAAO,EAAE,IAAI;IACb,KAAK,EAAE,IAAI;IACX,SAAS,EAAE,cAAc;IACzB,UAAU,EAAE,cAAc;IAC1B,KAAK,EAAE,MAAM;IACb,eAAe,EAAE,MAAM;IACvB,WAAW,EAAE,MAAM;IACnB,SAAS,EAAE,MAAM;CAClB,CAAA;AAED,SAAgB,sBAAsB,CAAC,QAA8B,EAAE,QAAkB,EAAE,SAAU;IACnG,IAAI,KAAK,GAAG,WAAW,CAAC,QAAQ,EAAE,uBAAuB,EAAE,EAAE,EAAE,SAAS,CAAC,CAAA;IACzE,IAAI,UAAU,GAAG,mBAAmB,CAAC,KAAK,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAA;IAEhE,OAAO;QACL,aAAa,EAAE,KAAK,CAAC,aAAa,IAAI,IAAI,GAAG,KAAK,CAAC,aAAa,GAAG,KAAK,CAAC,QAAQ;QACjF,gBAAgB,EAAE,KAAK,CAAC,gBAAgB,IAAI,IAAI,GAAG,KAAK,CAAC,gBAAgB,GAAG,KAAK,CAAC,QAAQ;QAC1F,WAAW,EAAE,UAAU,IAAI,IAAI,GAAG,CAAE,UAAU,CAAE,GAAG,EAAE;QACrD,OAAO,EAAE,KAAK,CAAC,OAAO;QACtB,MAAM,EAAE,KAAK,CAAC,KAAK,IAAI,IAAI,GAAG,CAAE,KAAK,CAAC,KAAK,CAAE,GAAG,EAAE;QAClD,eAAe,EAAE,KAAK,CAAC,eAAe,IAAI,KAAK,CAAC,KAAK;QACrD,WAAW,EAAE,KAAK,CAAC,WAAW,IAAI,KAAK,CAAC,KAAK;QAC7C,SAAS,EAAE,KAAK,CAAC,SAAS;QAC1B,UAAU,EAAE,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC;KACrD,CAAA;CACF;AAED,SAAgB,oBAAoB,CAAC,MAAc,EAAE,SAAc,EAAE,QAAkB,EAAE,SAAU;IACjG,IAAI,WAAW,GAAG,EAAS,CAAA;IAC3B,IAAI,QAAQ,GAAG,EAAS,CAAA;IAExB,KAAK,IAAI,GAAG,IAAI,uBAAuB,EAAE;QACvC,IAAI,SAAS,GAAG,MAAM,GAAG,qBAAqB,CAAC,GAAG,CAAC,CAAA;QACnD,WAAW,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,SAAS,CAAC,CAAA;QACvC,QAAQ,CAAC,SAAS,CAAC,GAAG,IAAI,CAAA;KAC3B;IAED,IAAI,MAAM,KAAK,OAAO,EAAE;QACtB,WAAW,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAA;KAC1C;IAED,IAAI,SAAS,EAAE;QACb,KAAK,IAAI,GAAG,IAAI,SAAS,EAAE;YACzB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;gBAClB,SAAS,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,CAAA;aAChC;SACF;KACF;IAED,OAAO,sBAAsB,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;CACrD;AAED,IAAM,cAAc,GAAY;IAC9B,aAAa,EAAE,IAAI;IACnB,gBAAgB,EAAE,IAAI;IACtB,WAAW,EAAE,EAAE;IACf,OAAO,EAAE,IAAI;IACb,MAAM,EAAE,EAAE;IACV,eAAe,EAAE,EAAE;IACnB,WAAW,EAAE,EAAE;IACf,SAAS,EAAE,EAAE;IACb,UAAU,EAAE,EAAE;CACf,CAAA;AAGD,SAAgB,eAAe,CAAC,GAAc;IAC5C,OAAO,GAAG,CAAC,MAAM,CAAC,kBAAkB,EAAE,cAAc,CAAC,CAAA;CACtD;AAED,SAAS,kBAAkB,CAAC,KAAc,EAAE,KAAc;IACxD,OAAO;QACL,aAAa,EAAE,KAAK,CAAC,aAAa,IAAI,IAAI,GAAG,KAAK,CAAC,aAAa,GAAG,KAAK,CAAC,aAAa;QACtF,gBAAgB,EAAE,KAAK,CAAC,gBAAgB,IAAI,IAAI,GAAG,KAAK,CAAC,gBAAgB,GAAG,KAAK,CAAC,gBAAgB;QAClG,WAAW,EAAE,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC;QACxD,OAAO,EAAE,OAAO,KAAK,CAAC,OAAO,KAAK,SAAS,GAAG,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO;QAC3E,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC;QACzC,eAAe,EAAE,KAAK,CAAC,eAAe,IAAI,KAAK,CAAC,eAAe;QAC/D,WAAW,EAAE,KAAK,CAAC,WAAW,IAAI,KAAK,CAAC,WAAW;QACnD,SAAS,EAAE,KAAK,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS;QAC7C,UAAU,EAAE,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC;KACtD,CAAA;CACF;;ACzDM,IAAM,cAAc,GAAG;IAC5B,EAAE,EAAE,MAAM;IACV,OAAO,EAAE,MAAM;IACf,KAAK,EAAE,MAAM;IACb,GAAG,EAAE,MAAM;IACX,SAAS,EAAE,MAAM;IACjB,aAAa,EAAE,IAAI;CACpB,CAAA;AAED,AAAO,IAAM,UAAU,GAAG;IACxB,KAAK,EAAE,IAAI;IACX,IAAI,EAAE,IAAI;IACV,GAAG,EAAE,IAAI;IACT,MAAM,EAAE,IAAI;CACb,CAAA;AAED,IAAI,GAAG,GAAG,CAAC,CAAA;AAGX,SAAgB,UAAU,CAAC,GAAe,EAAE,QAAgB,EAAE,QAAkB,EAAE,cAAwB;IACxG,IAAI,aAAa,GAAG,sBAAsB,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAA;IAC9D,IAAI,UAAU,GAAG,EAAE,CAAA;IACnB,IAAI,YAAY,GAAG,cAAc,CAC/B,GAAG;IACH,aAAa,EACb,QAAQ,CAAC,OAAO,EAChB,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,cAAc,EAC1C,UAAU;KACX,CAAA;IAED,IAAI,YAAY,EAAE;QAChB,IAAI,GAAG,GAAG,aAAa,CAAC,UAAU,EAAE,QAAQ,EAAE,YAAY,CAAC,MAAM,EAAE,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAE,QAAQ,CAAC,CAAA;QAE5G,GAAG,CAAC,YAAY,GAAG;YACjB,MAAM,EAAE,YAAY,CAAC,MAAM;YAC3B,QAAQ,EAAE,YAAY,CAAC,QAAQ;YAC/B,QAAQ,EAAE,YAAY,CAAC,QAAQ;SAChC,CAAA;QAED,OAAO,EAAE,GAAG,KAAA,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAA;KAE/B;SAAM;QACL,IAAI,UAAU,GAAG,EAAE,CAAA;QACnB,IAAI,SAAS,GAAG,WAAW,CAAC,GAAG,EAAE,aAAa,EAAE,QAAQ,EAAE,UAAU,EAAE,cAAc,CAAC,CAAA;QAErF,IAAI,SAAS,EAAE;YACb,IAAI,GAAG,GAAG,aAAa,CAAC,UAAU,EAAE,QAAQ,EAAE,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAA;YAC3F,IAAI,QAAQ,GAAG,mBAAmB,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,cAAc,EAAE,SAAS,CAAC,YAAY,CAAC,CAAA;YAEhH,OAAO,EAAE,GAAG,KAAA,EAAE,QAAQ,UAAA,EAAE,CAAA;SACzB;KACF;IAED,OAAO,IAAI,CAAA;CACZ;AAQD,SAAgB,aAAa,CAAC,GAAsB,EAAE,QAAgB,EAAE,MAAe,EAAE,MAAe,EAAE,QAAkB;IAC1H,IAAI,SAAS,GAAG,EAAE,CAAA;IAClB,IAAI,GAAG,GAAG,iBAAiB,CAAC,GAAG,EAAE,QAAQ,EAAE,SAAS,CAAa,CAAA;IAEjE,GAAG,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,EAAE,CAAC,CAAA;IACzB,GAAG,CAAC,QAAQ,GAAG,QAAQ,CAAA;IACvB,GAAG,CAAC,MAAM,GAAG,MAAM,CAAA;IACnB,GAAG,CAAC,MAAM,GAAG,MAAM,CAAA;IAEnB,KAA2B,UAA2C,EAA3C,KAAA,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,eAAe,EAA3C,cAA2C,EAA3C,IAA2C,EAAE;QAAnE,IAAI,cAAc,SAAA;QACrB,IAAI,YAAY,GAAG,EAAE,CAAA;QACrB,cAAc,CAAC,GAAG,EAAE,SAAS,EAAE,YAAY,CAAC,CAAA;QAC5C,SAAS,GAAG,YAAY,CAAA;KACzB;IAED,GAAG,CAAC,aAAa,GAAG,QAAQ,CAAC,SAAS,EAAE,GAAG,CAAC,aAAa,IAAI,EAAE,CAAC,CAAA;IAGhE,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,UAAU,CAAC,CAAA;IAChC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC,CAAA;IAEhC,OAAO,GAAG,CAAA;CACX;AAKD,SAAgB,mBAAmB,CACjC,KAAa,EACb,KAAgB,EAChB,cAAuB,EACvB,YAAqB;IAErB,OAAO;QACL,UAAU,EAAE,MAAM,CAAC,GAAG,EAAE,CAAC;QACzB,KAAK,OAAA;QACL,KAAK,OAAA;QACL,cAAc,EAAE,cAAc,IAAI,IAAI,GAAG,IAAI,GAAG,cAAc;QAC9D,YAAY,EAAE,YAAY,IAAI,IAAI,GAAG,IAAI,GAAG,YAAY;KACzD,CAAA;CACF;AAGD,SAAS,WAAW,CAAC,GAAe,EAAE,aAA6B,EAAE,QAAkB,EAAE,SAAU,EAAE,cAAwB;IAC3H,IAAI,KAAK,GAAG,cAAc,CAAC,GAAG,EAAE,SAAS,CAAC,CAAA;IAC1C,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAA;IACzB,IAAI,SAAS,CAAA;IACb,IAAI,WAAW,GAAG,IAAI,CAAA;IACtB,IAAI,MAAM,GAAG,KAAK,CAAA;IAClB,IAAI,OAAO,CAAA;IACX,IAAI,SAAS,GAAG,IAAI,CAAA;IAEpB,SAAS,GAAG,QAAQ,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;IAE1D,IAAI,SAAS,EAAE;QACb,WAAW,GAAG,SAAS,CAAC,MAAM,CAAA;KAC/B;SAAM,IAAI,CAAC,cAAc,EAAE;QAC1B,OAAO,IAAI,CAAA;KACZ;IAED,IAAI,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE;QACrB,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;KACvD;IAED,IAAI,MAAM,IAAI,IAAI,EAAE;QAClB,IAAI,aAAa,IAAI,IAAI,EAAE;YACzB,MAAM,GAAG,aAAa,CAAA;SACvB;aAAM;YAEL,MAAM,GAAG,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,iBAAiB;iBAChD,CAAC,OAAO,IAAI,OAAO,CAAC,iBAAiB,CAAC,CAAA;SAC1C;KACF;IAED,IAAI,MAAM,IAAI,WAAW,EAAE;QACzB,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC,CAAA;KACtC;IAED,IAAI,OAAO,EAAE;QACX,SAAS,GAAG,OAAO,CAAC,MAAM,CAAA;QAE1B,IAAI,MAAM,EAAE;YACV,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,CAAA;SAClC;QAED,IAAI,WAAW,IAAI,SAAS,IAAI,WAAW,EAAE;YAC3C,SAAS,GAAG,IAAI,CAAA;SACjB;KACF;IAED,IAAI,SAAS,EAAE;QACb,MAAM,GAAG,IAAI,CAAA;KACd;SAAM,IAAI,CAAC,cAAc,EAAE;QAC1B,MAAM,GAAG,QAAQ,CAAC,GAAG,CAAC,oBAAoB,CAAC,IAAI,KAAK,CAAA;QAEpD,SAAS,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,CAC9B,WAAW,EACX,MAAM;YACJ,QAAQ,CAAC,0BAA0B;YACnC,QAAQ,CAAC,yBAAyB,CACrC,CAAA;KACF;IAED,OAAO;QACL,MAAM,QAAA;QACN,MAAM,QAAA;QACN,KAAK,EAAE,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,EAAE,SAAS,EAAE;QAC7C,cAAc,EAAE,SAAS,GAAG,SAAS,CAAC,SAAS,GAAG,IAAI;QACtD,YAAY,EAAE,OAAO,GAAG,OAAO,CAAC,SAAS,GAAG,IAAI;KACjD,CAAA;CACF;AAGD,SAAS,cAAc,CAAC,GAAe,EAAE,SAAc;IACrD,IAAI,KAAK,GAAG,WAAW,CAAC,GAAG,EAAE,UAAU,EAAE,EAAE,EAAE,SAAS,CAAC,CAAA;IAEvD,KAAK,CAAC,KAAK,GAAG,CAAC,KAAK,CAAC,KAAK,KAAK,IAAI,IAAI,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,IAAI,CAAA;IAC/D,OAAO,KAAK,CAAC,IAAI,CAAA;IAEjB,OAAO,KAAK,CAAA;CACb;AAGD,SAAS,iBAAiB,CAAC,GAAe,EAAE,QAAkB,EAAE,SAAU;IACxE,IAAI,YAAY,GAAG,EAAE,CAAA;IACrB,IAAI,KAAK,GAAG,WAAW,CAAC,GAAG,EAAE,cAAc,EAAE,EAAE,EAAE,YAAY,CAAC,CAAA;IAC9D,IAAI,EAAE,GAAG,sBAAsB,CAAC,YAAY,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAA;IAElE,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,EAAE,CAAA;IACzB,OAAO,KAAK,CAAC,EAAE,CAAA;IAEf,KAAK,CAAC,EAAE,GAAG,EAAE,CAAA;IAEb,OAAO,KAAK,CAAA;CACb;AAGD,SAAS,sBAAsB,CAAC,QAAgB,EAAE,QAAkB;IAClE,IAAI,GAAG,GAAG,IAAI,CAAA;IAEd,IAAI,QAAQ,EAAE;QACZ,IAAI,MAAM,GAAG,QAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAA;QAClD,GAAG,GAAG,MAAM,CAAC,aAAa,CAAA;KAC3B;IAED,IAAI,GAAG,IAAI,IAAI,EAAE;QACf,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC,CAAA;KACpC;IAED,OAAO,GAAG,CAAA;CACX;;AC3QD,IAAM,YAAY,GAAG;IACnB,SAAS,EAAE,OAAO;IAClB,OAAO,EAAE,OAAO;IAChB,UAAU,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE;IAC7B,SAAS,EAAE,oBAAoB;IAC/B,UAAU,EAAE,gBAAgB;IAC5B,OAAO,EAAE,gBAAgB;CAC1B,CAAA;AAKD,SAAgB,kBAAkB,CAAC,KAAyB,EAAE,QAAkB;IAC9E,OAAO,WAAW,CAChB,YAAY,CAAC,KAAK,CAAC,EACnB,EAAE,EACF,QAAQ,CACT,CAAA;CACF;AAED,SAAS,YAAY,CAAC,KAAyB;IAC7C,IAAI,OAAO,CAAA;IAEX,IAAI,KAAK,KAAK,IAAI,EAAE;QAClB,OAAO,GAAG,CAAE,EAAE,CAAE,CAAA;KACjB;SAAM,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;QAE/B,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,UAAS,MAAM;YACpC,OAAO,MAAM,CAAC,UAAU,CAAA;SACzB,CAAC,CAAA;KACH;SAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,EAAE;QAC7C,OAAO,GAAG,CAAE,KAAK,CAAE,CAAA;KACpB;SAAM;QACL,OAAO,GAAG,EAAE,CAAA;KACb;IAED,OAAO,GAAG,OAAO,CAAC,GAAG,CAAC,UAAS,MAAM;QACnC,oBAAY,YAAY,EAAK,MAAM,EAAE;KACtC,CAAC,CAAA;IAEF,OAAO,OAAO,CAAA;CACf;;SC7Ce,gBAAgB,CAC9B,UAAuC,EACvC,YAA0C,EAC1C,YAA2C;IAA3C,6BAAA,EAAA,iBAA2C;IAG3C,IAAI,UAAU,GAA6B,EAAE,CAAA;IAC7C,IAAI,WAAW,CAAA;IACf,IAAI,QAAQ,CAAA;IAEZ,SAAS,QAAQ;QACf,IAAI,QAAQ,EAAE;YAEZ,KAAsB,UAAU,EAAV,yBAAU,EAAV,wBAAU,EAAV,IAAU,EAAE;gBAA7B,IAAI,SAAS,mBAAA;gBAChB,SAAS,CAAC,QAAQ,EAAE,CAAA;aACrB;YAED,IAAI,YAAY,EAAE;gBAChB,YAAY,CAAC,KAAK,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;aAC1C;YAED,QAAQ,GAAG,IAAI,CAAA;SAChB;KACF;IAED,SAAS,GAAG;QACV,IAAI,CAAC,QAAQ,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,SAAS,CAAC,EAAE;YACpD,QAAQ,EAAE,CAAA;YACV,WAAW,GAAG,IAAI,CAAA;YAClB,QAAQ,GAAG,SAAS,CAAA;YACpB,UAAU,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;SAClC;KACF;IAED,GAAG,CAAC,UAAU,GAAG,UAAU,CAAA;IAC3B,GAAG,CAAC,QAAQ,GAAG,QAAQ,CAAA;IAEvB,KAAuB,UAAY,EAAZ,6BAAY,EAAZ,0BAAY,EAAZ,IAAY,EAAE;QAAhC,IAAI,UAAU,qBAAA;QACjB,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;KAChC;IAED,OAAO,GAAG,CAAA;CACX;;AC/BD,IAAM,iBAAiB,GAAG,qBAAqB,EAAE,CAAA;AAEjD;IAAA;QAEU,wBAAmB,GAAG,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAA;QACxD,uBAAkB,GAAG,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;QACjD,oBAAe,GAAG,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;QAChD,sBAAiB,GAAG,OAAO,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAA;QACpD,mBAAc,GAAG,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;QAChD,qBAAgB,GAAG,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;QAClD,oBAAe,GAAG,EAAE,CAAA;KAgJ7B;IA1IC,6BAAU,GAAV,UAAW,KAAgB;QAA3B,iBAgCC;QA9BC,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;QACrC,IAAI,OAAO,GAAG,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,UAAU,CAAC,CAAA;QACxD,IAAI,cAAc,GAAG,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;QACjE,IAAI,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,YAAY,EAAE,OAAO,CAAC,CAAA;QACtE,IAAI,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,UAAU,EAAE,OAAO,CAAC,CAAA;QACjE,IAAI,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;QACrD,IAAI,YAAY,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;QAC3D,IAAI,UAAU,GAAuC,EAAE,CAAA;QAEvD,IAAI,CAAC,eAAe,GAAG,OAAO,CAAC,QAAQ,EAAE,UAAC,IAAI,EAAE,GAAG;YACjD,OAAO,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,IAAI,OAAO,CAAC,kBAAkB,CAAC,CAAA;SAChE,CAAC,CAAA;QAEF,KAAK,IAAI,GAAG,IAAI,QAAQ,EAAE;YACxB,IAAI,OAAO,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAA;YAC3B,IAAI,UAAU,GAAG,WAAW,CAAC,GAAG,CAAC,IAAI,iBAAiB,CAAA;YACtD,IAAI,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAA;YAE5C,UAAU,CAAC,GAAG,CAAC,GAAG;gBAChB,aAAa,EAAE,OAAO,CAAC,aAAa,IAAI,KAAK,CAAC,aAAa;gBAC3D,aAAa,EAAE,cAAc,CAAC,GAAG,CAAC,IAAI,IAAI;gBAC1C,UAAU,YAAA;gBACV,YAAY,EAAE,YAAY,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,YAAY,CAAC,GAAG,CAAC,CAAC;gBACjF,cAAc,EAAE,UAAU,CAAC,SAAS,CAAC,KAAK,CAAC,cAAc,CAAC,GAAG,KAAK,CAAC,cAAc,GAAG,EAAE;gBACtF,SAAS,EAAE,UAAU,CAAC,GAAG,CAAC,IAAI,IAAI;gBAClC,WAAW,EAAE,YAAY,CAAC,GAAG,CAAC,IAAI,IAAI;aACvC,CAAA;SACF;QAED,OAAO,UAAU,CAAA;KAClB;IAEO,iCAAc,GAAtB,UAAuB,QAAyB;QAC9C,IAAI,SAAS,GAAG,EAAE,CAAA;QAElB,IAAI,QAAQ,EAAE;YACZ,IAAI,IAAI,GAAG,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAA;YAE5C,KAAgB,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,EAAE;gBAAjB,IAAI,GAAG,aAAA;gBACV,SAAS,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAA;aAC1B;SACF;QAED,OAAO,SAAS,CAAA;KACjB;IAEO,uCAAoB,GAA5B,UAA6B,UAAsB;QAAnD,iBAIC;QAHC,OAAO,OAAO,CAAC,UAAU,CAAC,IAAI,EAAE,UAAC,QAAkB;YACjD,OAAO,KAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAA;SACzC,CAAC,CAAA;KACH;IAEO,mCAAgB,GAAxB,UAAyB,UAAsB,EAAE,OAAO;QAChD,IAAA,sBAAI,EAAE,gCAAS,CAAe;QACpC,IAAI,WAAW,GAAG,EAAE,CAAA;QAEpB,KAAK,IAAI,KAAK,IAAI,IAAI,EAAE;YACtB,KAAgB,UAAc,EAAd,KAAA,OAAO,CAAC,KAAK,CAAC,EAAd,cAAc,EAAd,IAAc,EAAE;gBAA3B,IAAI,GAAG,SAAA;gBAEV,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE;oBACrB,WAAW,CAAC,GAAG,CAAC,GAAG,qBAAqB,EAAE,CAAA;iBAC3C;gBAED,WAAW,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAA;aAC3C;SACF;QAED,KAAK,IAAI,UAAU,IAAI,SAAS,EAAE;YAChC,IAAI,QAAQ,GAAG,SAAS,CAAC,UAAU,CAAC,CAAA;YAEpC,KAAgB,UAAuB,EAAvB,KAAA,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAvB,cAAuB,EAAvB,IAAuB,EAAE;gBAApC,IAAI,GAAG,SAAA;gBAEV,IAAI,WAAW,CAAC,GAAG,CAAC,EAAE;oBACpB,WAAW,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAA;iBAClD;aACF;SACF;QAED,OAAO,WAAW,CAAA;KACnB;IAEO,qCAAkB,GAA1B,UAA2B,YAAyB,EAAE,OAAO;QAC3D,IAAI,WAAW,GAAmC,EAAE,CAAA;QAEpD,KAAK,IAAI,KAAK,IAAI,YAAY,EAAE;YAC9B,IAAI,KAAK,EAAE;gBACT,KAAgB,UAAc,EAAd,KAAA,OAAO,CAAC,KAAK,CAAC,EAAd,cAAc,EAAd,IAAc,EAAE;oBAA3B,IAAI,GAAG,SAAA;oBAEV,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE;wBACrB,WAAW,CAAC,GAAG,CAAC,GAAG,EAAE,CAAA;qBACtB;oBAED,WAAW,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,YAAY,CAAC,KAAK,CAAC,CAAA;iBAC9C;aACF;SACF;QAED,OAAO,WAAW,CAAA;KACnB;IAEO,oCAAiB,GAAzB,UAA0B,WAAyC;QACjE,IAAI,WAAW,GAA6C,EAAE,CAAA;QAE9D,IAAI,WAAW,EAAE;YACf,IAAI,gBAAc,GAAG,IAAI,CAAC,gBAAgB,CACxC,WAAW,CAAC,cAAc,EAC1B,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,cAAc,CAAC;aACtD,CAAA;YAGD,IAAI,kBAAkB,GAAG,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,aAAa,CAAC,CAAA;YAC7E,IAAI,eAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,aAAa,EAAE,kBAAkB,CAAC,CAAA;YAExF,IAAI,QAAQ,GAAG,UAAS,GAAG;gBACzB,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE;oBACrB,WAAW,CAAC,GAAG,CAAC,GAAG;wBACjB,cAAc,EAAE,gBAAc,CAAC,GAAG,CAAC,IAAI,iBAAiB;wBACxD,aAAa,EAAE,eAAa,CAAC,GAAG,CAAC,IAAI,iBAAiB;wBACtD,OAAO,EAAE,WAAW,CAAC,OAAO;wBAC5B,OAAO,EAAE,WAAW,CAAC,OAAO;qBAC7B,CAAA;iBACF;aACF,CAAA;YAED,KAAK,IAAI,GAAG,IAAI,gBAAc,EAAE;gBAC9B,QAAQ,CAAC,GAAG,CAAC,CAAA;aACd;YAED,KAAK,IAAI,GAAG,IAAI,eAAa,EAAE;gBAC7B,QAAQ,CAAC,GAAG,CAAC,CAAA;aACd;SACF;QAED,OAAO,WAAW,CAAA;KACnB;IAEH,eAAC;CAAA,IAAA;AAED,SAAS,kBAAkB,CAAC,KAAqB,EAAE,aAA6B,EAAE,YAAgC;IAChH,IAAI,SAAS,GAAG,EAAE,CAAA;IAElB,IAAI,KAAK,EAAE;QACT,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;KACtB;IAED,IAAI,aAAa,EAAE;QACjB,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;KAC9B;IAED,IAAI,KAAK,GAAG;QACV,EAAE,EAAE,eAAe,CAAC,SAAS,CAAC;KAC/B,CAAA;IAED,IAAI,YAAY,EAAE;QAChB,QAAQ,CAAC,KAAK,EAAE,YAAY,CAAC,CAAA;KAC9B;IAED,OAAO,KAAK,CAAA;CACb;;SCtLe,mBAAmB,CAAC,SAAyB,EAAE,WAAW,EAAE,KAAK,EAAE,SAAU;IACrF,IAAA,2BAAO,CAAc;IAC3B,IAAI,IAAI,CAAA;IACR,IAAI,IAAI,CAAA;IACR,IAAI,QAAQ,CAAA;IACZ,IAAI,YAAY,CAAA;IAEhB,IAAI,WAAW,YAAY,IAAI,EAAE;QAC/B,IAAI,GAAG,WAAW,CAAA;KACnB;SAAM;QACL,IAAI,GAAG,WAAW,CAAC,IAAI,CAAA;QACvB,IAAI,GAAG,WAAW,CAAC,IAAI,CAAA;QACvB,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAA;KAChC;IAED,YAAY,GAAG;QACb,IAAI,EAAE,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;QACjD,IAAI,EAAE,IAAI,IAAI,KAAK;KACpB,CAAA;IAED,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;QAC7B,SAAS,GAAG,KAAK,CAAA;QACjB,KAAK,GAAG,IAAI,CAAA;KACb;IAED,KAAK,GAAG,KAAK,GAAG,GAAG,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,EAAE,CAAA;IAC5C,SAAS,GAAG,SAAS,IAAI,EAAE,CAAA;IAE3B,IAAI,CAAC,QAAQ,IAAI,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;QAC1C,OAAO,IAAI,GAAG,KAAK;YACjB,cAAc,GAAG,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,GAAG,IAAI;YAChE,SAAS;YACT,MAAM,CAAA;KACT;SAAM;QACL,OAAO,OAAO,GAAG,KAAK,GAAG,GAAG;YAC1B,SAAS;YACT,SAAS,CAAA;KACZ;CACF;AAGD,SAAgB,aAAa,CAAC,SAAyB;IACrD,OAAO,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAA;CAC9E;AAID,SAAgB,aAAa,CAAC,IAAgB,EAAE,WAAwB,EAAE,OAAyB,EAAE,gBAAiB;IAC9G,IAAA,2BAAQ,EAAE,mBAAI,EAAE,qBAAK,EAAE,yBAAO,CAAY;IAChD,IAAI,OAAO,GAAG,EAAE,CAAA;IAChB,IAAI,UAAsB,CAAA;IAC1B,IAAI,QAAoB,CAAA;IAExB,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,WAAW,EAAE,IAAI,CAAC,EAAE;QACvD,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;KAChC;SAAM;QACL,OAAO,CAAC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAA;QAE/C,IACE,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;YACrB,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,YAAY,CAAC,KAAK,CAAC,EAC3E;YACA,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;SAC/B;QAED,UAAU,GAAG,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAA;QAC1C,QAAQ,GAAG,OAAO,CAAC,UAAU,EAAE,CAAC,CAAC,CAAA;QAEjC,IAAI,IAAI,GAAG,UAAU,EAAE;YACrB,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;SACxB;aAAM,IAAI,IAAI,IAAI,QAAQ,EAAE;YAC3B,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;SAC1B;aAAM;YACL,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;YAExB,IAAI,gBAAgB,KAAK,IAAI,EAAE;gBAC7B,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAA;aACtC;SACF;KACF;IAED,OAAO,OAAO,CAAA;CACf;;SC1Fe,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE,OAAQ;IAIjD,IAAI,UAAU,GAAG,KAAK,CAAA;IACtB,IAAI,cAAc,GAAG;QACnB,IAAI,CAAC,UAAU,EAAE;YACf,UAAU,GAAG,IAAI,CAAA;YACjB,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;SAC/B;KACF,CAAA;IACD,IAAI,cAAc,GAAG;QACnB,IAAI,CAAC,UAAU,EAAE;YACf,UAAU,GAAG,IAAI,CAAA;YACjB,IAAI,OAAO,EAAE;gBACX,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;aAC/B;SACF;KACF,CAAA;IAED,IAAI,GAAG,GAAG,IAAI,CAAC,cAAc,EAAE,cAAc,CAAC,CAAA;IAC9C,IAAI,GAAG,IAAI,OAAO,GAAG,CAAC,IAAI,KAAK,UAAU,EAAE;QACzC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,cAAc,CAAC,CAAA;KACzC;CACF;;AC5BD;IAAA;KA0BC;IAvBQ,aAAO,GAAd,UAAe,SAAS;QACtB,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,SAAS,CAAC,CAAA;KACrC;IAGM,gBAAU,GAAjB,UAAkB,OAAO;QAAzB,iBAMC;QALC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI;YACtD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBAClB,OAAO,CAAC,IAAI,CAAC,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAA;aACrC;SACF,CAAC,CAAA;KACH;IAMM,aAAO,GAAd,UAAe,SAAS;QAAxB,iBAIC;QAHC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI;YACtD,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAA;SACjD,CAAC,CAAA;KACH;IAEH,YAAC;CAAA,IAAA;;ACDD;IAA0CC,gCAAK;IAA/C;;KAuDC;IAlDC,yBAAE,GAAF,UAAG,IAAI,EAAE,OAAO;QACd,SAAS,CACP,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC,EACvC,IAAI,EACJ,OAAO,CACR,CAAA;QACD,OAAO,IAAI,CAAA;KACZ;IAGD,0BAAG,GAAH,UAAI,IAAI,EAAE,OAAO;QACf,SAAS,CACP,IAAI,CAAC,YAAY,KAAK,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,EAC7C,IAAI,EACJ,OAAO,CACR,CAAA;QACD,OAAO,IAAI,CAAA;KACZ;IAED,0BAAG,GAAH,UAAI,IAAI,EAAE,OAAQ;QAChB,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,cAAc,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,OAAO,CAAC,CAAA;SAC9C;QACD,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,cAAc,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,EAAE,OAAO,CAAC,CAAA;SACjD;QACD,OAAO,IAAI,CAAA;KACZ;IAED,8BAAO,GAAP,UAAQ,IAAI;QAAE,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,6BAAO;;QACnB,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAA;QAClC,OAAO,IAAI,CAAA;KACZ;IAED,kCAAW,GAAX,UAAY,IAAI,EAAE,OAAO,EAAE,IAAI;QAC7B,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,CAAA;SAC9C;QACD,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,CAAA;YAChD,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAA;SAC/B;QACD,OAAO,IAAI,CAAA;KACZ;IAED,kCAAW,GAAX,UAAY,IAAI;QACd,OAAO,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,MAAM;aAC1E,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAA;KACnF;IAEH,mBAAC;CAvDD,CAA0C,KAAK,GAuD9C;AAED,SAAS,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO;IACpC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;SAC7B,IAAI,CAAC,OAAO,CAAC,CAAA;CACjB;AAED,SAAS,cAAc,CAAC,IAAI,EAAE,IAAI,EAAE,OAAQ;IAC1C,IAAI,OAAO,EAAE;QACX,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE;YACd,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,UAAS,IAAI;gBAC1C,OAAO,IAAI,KAAK,OAAO,CAAA;aACxB,CAAC,CAAA;SACH;KACF;SAAM;QACL,OAAO,IAAI,CAAC,IAAI,CAAC,CAAA;KAClB;CACF;;AC5FD;IAgBE,uBAAY,QAAqB,EAAE,GAAkB,EAAE,YAAqB,EAAE,UAAmB;QAC/F,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;QACxB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAA;QACd,IAAI,CAAC,YAAY,GAAG,YAAY,CAAA;QAChC,IAAI,CAAC,UAAU,GAAG,UAAU,CAAA;KAC7B;IAKD,6BAAK,GAAL;QACE,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;QAC5B,IAAI,gBAAgB,GAAG,IAAI,CAAC,gBAAgB;YAC1C,QAAQ,CAAC,qBAAqB,EAAE,CAAA;QAElC,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAA;SAC/C;QAED,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAA;SAC5C;KACF;IAID,0CAAkB,GAAlB,UAAmB,gBAAwB;QACzC,IAAI,KAAK,GAAG,EAAE,CAAA;QACd,IAAI,MAAM,GAAG,EAAE,CAAA;QAEf,KAAe,UAAQ,EAAR,KAAA,IAAI,CAAC,GAAG,EAAR,cAAQ,EAAR,IAAQ,EAAE;YAApB,IAAI,EAAE,SAAA;YACT,IAAI,IAAI,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAA;YACrC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,gBAAgB,CAAC,CAAA;YACxC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,gBAAgB,CAAC,CAAA;SAC3C;QAED,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAClB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;KACrB;IAID,wCAAgB,GAAhB,UAAiB,eAAuB;QACtC,IAAI,IAAI,GAAG,EAAE,CAAA;QACb,IAAI,OAAO,GAAG,EAAE,CAAA;QAEhB,KAAe,UAAQ,EAAR,KAAA,IAAI,CAAC,GAAG,EAAR,cAAQ,EAAR,IAAQ,EAAE;YAApB,IAAI,EAAE,SAAA;YACT,IAAI,IAAI,GAAG,EAAE,CAAC,qBAAqB,EAAE,CAAA;YACrC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,eAAe,CAAC,CAAA;YACrC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,eAAe,CAAC,CAAA;SAC5C;QAED,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;QAChB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;KACvB;IAKD,mCAAW,GAAX,UAAY,YAAoB;QAC9B,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAA;QACtB,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAA;QACxB,IAAI,GAAG,GAAG,KAAK,CAAC,MAAM,CAAA;QACtB,IAAI,CAAC,CAAA;QAEL,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;YACxB,IAAI,YAAY,IAAI,KAAK,CAAC,CAAC,CAAC,IAAI,YAAY,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE;gBACxD,OAAO,CAAC,CAAA;aACT;SACF;KACF;IAKD,kCAAU,GAAV,UAAW,WAAmB;QAC5B,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAA;QACpB,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAA;QAC1B,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,CAAA;QACrB,IAAI,CAAC,CAAA;QAEL,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;YACxB,IAAI,WAAW,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,WAAW,GAAG,OAAO,CAAC,CAAC,CAAC,EAAE;gBACtD,OAAO,CAAC,CAAA;aACT;SACF;KACF;IAID,gCAAQ,GAAR,UAAS,SAAiB;QACxB,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;KACtD;IAID,iCAAS,GAAT,UAAU,QAAgB;QACxB,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;KACpD;IAEH,oBAAC;CAAA,IAAA;;;ICpHD;KA2CC;IAhCC,0CAAe,GAAf;QACE,OAAO,IAAI,CAAC,eAAe,EAAE,GAAG,IAAI,CAAC,eAAe,EAAE,CAAA;KACvD;IAED,2CAAgB,GAAhB;QACE,OAAO,IAAI,CAAC,cAAc,EAAE,GAAG,IAAI,CAAC,cAAc,EAAE,CAAA;KACrD;IAED,8CAAmB,GAAnB;QACE,OAAO,IAAI,CAAC,eAAe,EAAE,GAAG,CAAC,CAAA;KAClC;IAED,gDAAqB,GAArB;QACE,OAAO,IAAI,CAAC,gBAAgB,EAAE,GAAG,CAAC,CAAA;KACnC;IAED,sCAAW,GAAX;QACE,OAAO,IAAI,CAAC,YAAY,EAAE,GAAG,CAAC,CAAA;KAC/B;IAED,wCAAa,GAAb;QACE,OAAO,IAAI,CAAC,YAAY,EAAE,GAAG,IAAI,CAAC,eAAe,EAAE,CAAA;KACpD;IAED,wCAAa,GAAb;QACE,OAAO,IAAI,CAAC,aAAa,EAAE,GAAG,CAAC,CAAA;KAChC;IAED,yCAAc,GAAd;QACE,OAAO,IAAI,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAA;KACtD;IAEH,uBAAC;CAAA,IAAA;;IAE4CA,2CAAgB;IAI3D,iCAAY,EAAe;QAA3B,YACE,iBAAO,SAER;QADC,KAAI,CAAC,EAAE,GAAG,EAAE,CAAA;;KACb;IAED,8CAAY,GAAZ;QACE,OAAO,IAAI,CAAC,EAAE,CAAC,SAAS,CAAA;KACzB;IAED,+CAAa,GAAb;QACE,OAAO,IAAI,CAAC,EAAE,CAAC,UAAU,CAAA;KAC1B;IAED,8CAAY,GAAZ,UAAa,GAAW;QACtB,IAAI,CAAC,EAAE,CAAC,SAAS,GAAG,GAAG,CAAA;KACxB;IAED,+CAAa,GAAb,UAAc,IAAY;QACxB,IAAI,CAAC,EAAE,CAAC,UAAU,GAAG,IAAI,CAAA;KAC1B;IAED,gDAAc,GAAd;QACE,OAAO,IAAI,CAAC,EAAE,CAAC,WAAW,CAAA;KAC3B;IAED,iDAAe,GAAf;QACE,OAAO,IAAI,CAAC,EAAE,CAAC,YAAY,CAAA;KAC5B;IAED,iDAAe,GAAf;QACE,OAAO,IAAI,CAAC,EAAE,CAAC,YAAY,CAAA;KAC5B;IAED,gDAAc,GAAd;QACE,OAAO,IAAI,CAAC,EAAE,CAAC,WAAW,CAAA;KAC3B;IAEH,8BAAC;CAzCD,CAA6C,gBAAgB,GAyC5D;;IAE2CA,0CAAgB;IAA5D;;KAkCC;IAhCC,6CAAY,GAAZ;QACE,OAAO,MAAM,CAAC,WAAW,CAAA;KAC1B;IAED,8CAAa,GAAb;QACE,OAAO,MAAM,CAAC,WAAW,CAAA;KAC1B;IAED,6CAAY,GAAZ,UAAa,CAAS;QACpB,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC,CAAA;KACrC;IAED,8CAAa,GAAb,UAAc,CAAS;QACrB,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,WAAW,CAAC,CAAA;KACrC;IAED,+CAAc,GAAd;QACE,OAAO,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAA;KAC5C;IAED,gDAAe,GAAf;QACE,OAAO,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAA;KAC7C;IAED,gDAAe,GAAf;QACE,OAAO,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAA;KAC7C;IAED,+CAAc,GAAd;QACE,OAAO,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAA;KAC5C;IAEH,6BAAC;CAlCD,CAA4C,gBAAgB;;ACjF5D;IAA6CA,mCAAuB;IAKlE,yBAAY,SAAiB,EAAE,SAAiB;QAAhD,YACE,kBACE,aAAa,CAAC,KAAK,EAAE;YACnB,SAAS,EAAE,aAAa;SACzB,CAAC,CACH,SAIF;QAHC,KAAI,CAAC,SAAS,GAAG,SAAS,CAAA;QAC1B,KAAI,CAAC,SAAS,GAAG,SAAS,CAAA;QAC1B,KAAI,CAAC,aAAa,EAAE,CAAA;;KACrB;IAID,+BAAK,GAAL;QACE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA;QACtB,IAAI,CAAC,aAAa,EAAE,CAAA;KACrB;IAGD,iCAAO,GAAP;QACE,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;KACvB;IAOD,uCAAa,GAAb;QACE,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE;YAClB,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,SAAS,EAAE,IAAI,CAAC,SAAS;SAC1B,CAAC,CAAA;KACH;IAMD,sCAAY,GAAZ,UAAa,eAAgC;QAC3C,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAA;QAC9B,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAA;QAE9B,eAAe,GAAG,eAAe,IAAI,IAAI,CAAC,kBAAkB,EAAE,CAAA;QAE9D,IAAI,SAAS,KAAK,MAAM,EAAE;YACxB,SAAS,GAAG,CACR,eAAe,CAAC,MAAM;gBACtB,IAAI,CAAC,qBAAqB,EAAE;gBAC1B,QAAQ,GAAG,QAAQ,CAAA;SAC1B;QAED,IAAI,SAAS,KAAK,MAAM,EAAE;YACxB,SAAS,GAAG,CACR,eAAe,CAAC,IAAI,IAAI,eAAe,CAAC,KAAK;gBAC7C,IAAI,CAAC,mBAAmB,EAAE;gBACxB,QAAQ,GAAG,QAAQ,CAAA;SAC1B;QAED,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,SAAS,WAAA,EAAE,SAAS,WAAA,EAAE,CAAC,CAAA;KAC9C;IAGD,mCAAS,GAAT,UAAU,MAAuB;QAC/B,cAAc,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAA;KAC1C;IAGD,4CAAkB,GAAlB;QACE,IAAI,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;QACjC,OAAO;YACL,IAAI,EAAE,KAAK,CAAC,aAAa;YACzB,KAAK,EAAE,KAAK,CAAC,cAAc;YAC3B,MAAM,EAAE,KAAK,CAAC,eAAe;SAC9B,CAAA;KACF;IAEH,sBAAC;CAlFD,CAA6C,uBAAuB,GAkFnE;;AC9FD;IAaE,eAAY,eAAe;QACzB,IAAI,CAAC,eAAe,GAAG,eAAe,CAAA;QACtC,IAAI,CAAC,mBAAmB,EAAE,CAAA;KAC3B;IAGD,mCAAmB,GAAnB;QACE,IAAI,IAAI,CAAC,kBAAkB,EAAE;YAC3B,IAAI,CAAC,eAAe,CAClB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAC9C,CAAA;SACF;KACF;IAGD,+BAAe,GAAf,UAAgB,gBAAgB;QAC9B,IAAI,eAAe,CAAA;QACnB,IAAI,UAAU,CAAA;QAEd,IAAI,OAAO,gBAAgB,KAAK,QAAQ,IAAI,gBAAgB,EAAE;YAC5D,eAAe,gBAAQ,IAAI,CAAC,WAAW,CAAE,CAAA;YAEzC,KAAK,UAAU,IAAI,gBAAgB,EAAE;gBACnC,eAAe,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,uBAAuB,CACxD,gBAAgB,CAAC,UAAU,CAAC,CAC7B,CAAA;aACF;YAED,IAAI,CAAC,WAAW,GAAG,eAAe,CAAA;SACnC;aAAM,IAAI,gBAAgB,KAAK,KAAK,EAAE;YACrC,IAAI,CAAC,WAAW,GAAG,EAAE,CAAA;SACtB;KACF;IAGD,uCAAuB,GAAvB,UAAwB,SAAS;QAC/B,IAAI,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAA;QAEpC,IAAI,MAAM,IAAI,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;YAC7C,SAAS,GAAG,MAAM,GAAG,SAAS,CAAA;SAC/B;QAED,OAAO,SAAS,CAAA;KACjB;IAGD,wBAAQ,GAAR,UAAS,GAAG;QACV,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,CAAA;KAC/B;IAGD,4BAAY,GAAZ,UAAa,UAAU;QACrB,IAAI,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAA;QAE5C,IAAI,SAAS,EAAE;YACb,OAAO,IAAI,CAAC,aAAa,GAAG,GAAG,GAAG,SAAS,CAAA;SAC5C;QAED,OAAO,EAAE,CAAA;KACV;IAGD,wCAAwB,GAAxB,UAAyB,iBAAiB;QACxC,IAAI,SAAS,CAAA;QAEb,IAAI,IAAI,CAAC,8BAA8B,EAAE;YACvC,SAAS,GAAG,iBAAiB,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAA;YAElE,IAAI,SAAS,EAAE;gBACb,OAAO,IAAI,CAAC,aAAa,GAAG,GAAG,GAAG,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAA;aAC1E;SACF;QAED,OAAO,EAAE,CAAA;KACV;IAEH,YAAC;CAAA,IAAA;AAED,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG,EAAE,CAAA;AAC5B,KAAK,CAAC,SAAS,CAAC,WAAW,GAAG,EAAE,CAAA;AAChC,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,EAAE,CAAA;AAClC,KAAK,CAAC,SAAS,CAAC,kBAAkB,GAAG,EAAE,CAAA;;AC1FvC,IAAI,IAAI,GAAG,CAAC,CAAA;AAYZ;IAeE,mBAAY,OAAyB,EAAE,MAAgB;QAGrD,IAAI,MAAM,EAAE;YACV,OAAO,CAAC,IAAI,GAAG,IAAW,CAAA;SAC3B;QAED,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,IAAI,EAAE,CAAC,CAAA;QACzB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;QACtB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAA;QAC9B,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAA;QAC1B,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAA;QACxB,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAA;QAChC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,KAAK,CAAA;KACvC;IAEM,0BAAgB,GAAvB,UAAwB,QAA0B;QAChD,IAAI,CAAC,SAAS,CAAC,aAAa,gBACvB,IAAI,CAAC,SAAS,CAAC,aAAa,EAC5B,QAAQ,CACZ,CAAA;KACF;IAED,uBAAG,GAAH,UAAI,IAAI;QACN,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;KAClC;IAED,gCAAY,GAAZ,UAAa,KAAgB;QACvB,IAAA,8DAAsF,EAApF,0BAAU,EAAE,0BAAwE,CAAA;QAE1F,IAAI,CAAC,KAAK,GAAG,UAAU,CAAA;QAEvB,IAAI,UAAU,EAAE;YACd,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAA;SACxB;KACF;IAES,0BAAM,GAAhB,UAAiB,KAAgB;KAChC;IAGD,2BAAO,GAAP;KACC;IAEH,gBAAC;CAAA,IAAA;AAED,SAAS,CAAC,SAAS,CAAC,aAAa,GAAG,EAAE,CAAA;AAOtC,SAAS,YAAY,CAAC,QAAQ,EAAE,QAAQ,EAAE,aAA+B;IACvE,IAAI,UAAU,GAAG,EAAS,CAAA;IAC1B,IAAI,UAAU,GAAG,KAAK,CAAA;IAEtB,KAAK,IAAI,GAAG,IAAI,QAAQ,EAAE;QACxB,IACE,GAAG,IAAI,QAAQ,KACb,QAAQ,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC,GAAG,CAAC;aAC9B,aAAa,CAAC,GAAG,CAAC,IAAI,aAAa,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CACzE,EACD;YAEA,UAAU,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAA;SAChC;aAAM;YACL,UAAU,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAA;YAC/B,UAAU,GAAG,IAAI,CAAA;SAClB;KACF;IAED,KAAK,IAAI,GAAG,IAAI,QAAQ,EAAE;QACxB,IAAI,EAAE,GAAG,IAAI,QAAQ,CAAC,EAAE;YACtB,UAAU,GAAG,IAAI,CAAA;YACjB,MAAK;SACN;KACF;IAED,OAAO,EAAE,UAAU,YAAA,EAAE,UAAU,YAAA,EAAE,CAAA;CAClC;;ACxED;IAAsDA,iCAAoB;IAmBxE,uBAAY,OAAyB,EAAE,EAAe,EAAE,MAAgB;QAAxE,YACE,kBAAM,OAAO,EAAE,MAAM,CAAC,SAGvB;QADC,KAAI,CAAC,EAAE,GAAG,EAAE,CAAA;;KACb;IAED,+BAAO,GAAP;QACE,iBAAM,OAAO,WAAE,CAAA;QAEf,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;KACvB;IAyCD,2CAAmB,GAAnB;KACC;IAGD,gCAAQ,GAAR,UAAS,YAAoB,EAAE,WAAmB,EAAE,OAAe,EAAE,QAAgB;QACnF,OAAO,IAAI,CAAA;KACZ;IAMD,0CAAkB,GAAlB,UAAmB,WAAkC;QAC7C,IAAA,wBAAQ,CAAS;QACvB,IAAI,WAAW,GAAI,IAAI,CAAC,KAAa,CAAC,WAAW,CAAA;QACjD,IAAI,SAAS,GAAG,WAAW,CAAC,aAAa,CAAC,SAAS,CAAA;QAEnD,IAAI,WAAW,EAAE;YACf,KAAK,IAAI,UAAU,IAAI,SAAS,EAAE;gBAChC,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,UAAU,EAAE,SAAS,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,EAAE;oBAC5E,OAAO,KAAK,CAAA;iBACb;aACF;SACF;QAED,OAAO,kBAAkB,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;KACjD;IAED,4CAAoB,GAApB,UAAqB,SAAmB;QACtC,IAAI,WAAW,GAAI,IAAI,CAAC,KAAa,CAAC,WAAW,CAAA;QAEjD,IACE,WAAW;YACX,CAAC,kBAAkB,CAAC,WAAW,CAAC,UAAU,EAAE,SAAS,CAAC,KAAK,CAAC,EAC5D;YACA,OAAO,KAAK,CAAA;SACb;QAED,OAAO,oBAAoB,CAAC,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAA;KACtD;IAQD,uCAAe,GAAf,UAA4C,IAAO,EAAE,IAA0B;QAC7E,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;QAE5B,OAAO,QAAQ,CAAC,eAAe,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;KAC5C;IAGD,kDAA0B,GAA1B,UAAuD,IAAO,EAAE,IAAyB;QACvF,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;QAE5B,OAAO,QAAQ,CAAC,0BAA0B,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;KACvD;IAGD,yCAAiB,GAAjB,UAA8C,IAAO;QACnD,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;QAE5B,OAAO,QAAQ,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAA;KACxC;IAGD,2CAAmB,GAAnB,UAAoB,IAAW,EAAE,SAAkB;QAC3C,IAAA,wBAAQ,CAAS;QAEvB,IAAI,IAAI,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,EAAE;YAE7C,KAAgB,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,EAAE;gBAAjB,IAAI,GAAG,aAAA;gBACV,IAAI,CAAC,0BAA0B,CAAC,iBAAiB,EAAE;oBACjD;wBACE,KAAK,EAAE,IAAI,QAAQ,CACjB,QAAQ,EACR,GAAG,CAAC,UAAU,CAAC,GAAG,EAClB,GAAG,CAAC,UAAU,CAAC,QAAQ,CACxB;wBACD,QAAQ,EAAE,SAAS;wBACnB,OAAO,EAAE,GAAG,CAAC,OAAO;wBACpB,KAAK,EAAE,GAAG,CAAC,KAAK;wBAChB,EAAE,EAAE,GAAG,CAAC,EAAE;wBACV,IAAI,EAAE,IAAuB;qBAC9B;iBACF,CAAC,CAAA;aACH;SACF;QAED,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,YAAY,EAAE;YAChC,QAAQ,CAAC,mBAAmB,CAAC,iBAAiB,GAAG,CAAE,IAAI,CAAE,CAAA;SAC1D;KACF;IAED,6CAAqB,GAArB,UAAsB,IAAW,EAAE,SAAkB;QAC7C,IAAA,wBAAQ,CAAS;QAEvB,KAAgB,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,EAAE;YAAjB,IAAI,GAAG,aAAA;YACV,QAAQ,CAAC,OAAO,CAAC,eAAe,EAAE,GAAG,CAAC,EAAE,CAAC,CAAA;SAC1C;QAED,IAAI,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,EAAE;YAE1C,KAAgB,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,EAAE;gBAAjB,IAAI,GAAG,aAAA;gBACV,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE;oBACnC;wBACE,KAAK,EAAE,IAAI,QAAQ,CACjB,QAAQ,EACR,GAAG,CAAC,UAAU,CAAC,GAAG,EAClB,GAAG,CAAC,UAAU,CAAC,QAAQ,CACxB;wBACD,QAAQ,EAAE,SAAS;wBACnB,EAAE,EAAE,GAAG,CAAC,EAAE;wBACV,IAAI,EAAE,IAAuB;qBAC9B;iBACF,CAAC,CAAA;aACH;SACF;KACF;IAMD,wCAAgB,GAAhB,UAAiB,EAAe;QAC9B,OAAO,CAAE,IAAI,CAAC,KAAa,CAAC,SAAS;YACnC,CAAE,IAAI,CAAC,KAAa,CAAC,WAAW;YAChC,CAAC,cAAc,CAAC,EAAE,EAAE,YAAY,CAAC;aAChC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAA;KAG9C;IAGD,yCAAiB,GAAjB,UAAkB,EAAe;QAC/B,IAAI,KAAK,GAAG,cAAc,CAAC,EAAE,EAAE,IAAI,CAAC,aAAa,CAAC,CAAA;QAElD,OAAO,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC;YACrD,CAAC,cAAc,CAAC,EAAE,EAAE,UAAU,CAAC;YAC/B,CAAC,cAAc,CAAC,EAAE,EAAE,cAAc,CAAC;YACnC,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,CAAA;KACxB;IAGD,iCAAS,GAAT;QACE,OAAO,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAA;KAChD;IAGD,mCAAW,GAAX,UAAY,EAAe;QACzB,OAAO,OAAO,CAAC,cAAc,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC,CAAA;KAClD;IAEH,oBAAC;CAjOD,CAAsD,SAAS,GAiO9D;AAED,aAAa,CAAC,SAAS,CAAC,aAAa,GAAG,yBAAyB,CAAA;AACjE,aAAa,CAAC,SAAS,CAAC,aAAa,GAAG,kCAAkC,CAAA;;AC9K1E,IAAIC,KAAG,GAAG,CAAC,CAAA;AAEX,SAAgB,YAAY,CAAC,KAAqB;IAChD,OAAO;QACL,EAAE,EAAE,MAAM,CAACA,KAAG,EAAE,CAAC;QACjB,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,EAAE;QACtB,QAAQ,EAAE,KAAK,CAAC,QAAQ,IAAI,EAAE;QAC9B,eAAe,EAAE,KAAK,CAAC,eAAe,IAAI,EAAE;QAC5C,uBAAuB,EAAE,KAAK,CAAC,uBAAuB,IAAI,EAAE;QAC5D,0BAA0B,EAAE,KAAK,CAAC,0BAA0B,IAAI,EAAE;QAClE,wBAAwB,EAAE,KAAK,CAAC,wBAAwB,IAAI,EAAE;QAC9D,yBAAyB,EAAE,KAAK,CAAC,yBAAyB,IAAI,EAAE;QAChE,mBAAmB,EAAE,KAAK,CAAC,mBAAmB,IAAI,EAAE;QACpD,kBAAkB,EAAE,KAAK,CAAC,kBAAkB,IAAI,EAAE;QAClD,KAAK,EAAE,KAAK,CAAC,KAAK,IAAI,EAAE;QACxB,qBAAqB,EAAE,KAAK,CAAC,qBAAqB,IAAI,EAAE;QACxD,YAAY,EAAE,KAAK,CAAC,YAAY,IAAI,IAAI;QACxC,qBAAqB,EAAE,KAAK,CAAC,qBAAqB,IAAI,EAAE;QACxD,yBAAyB,EAAE,KAAK,CAAC,yBAAyB,IAAI,EAAE;QAChE,sBAAsB,EAAE,KAAK,CAAC,sBAAsB,IAAI,EAAE;QAC1D,qBAAqB,EAAE,KAAK,CAAC,qBAAqB,IAAI,EAAE;QACxD,qBAAqB,EAAE,KAAK,CAAC,qBAAqB,IAAI,EAAE;QACxD,oBAAoB,EAAE,KAAK,CAAC,oBAAoB,IAAI,EAAE;QACtD,YAAY,EAAE,KAAK,CAAC,YAAY,IAAI,EAAE;QACtC,eAAe,EAAE,KAAK,CAAC,eAAe,IAAI,EAAE;QAC5C,YAAY,EAAE,KAAK,CAAC,YAAY;QAChC,cAAc,EAAE,KAAK,CAAC,cAAc,IAAI,EAAE;QAC1C,kBAAkB,EAAE,KAAK,CAAC,kBAAkB;QAC5C,WAAW,EAAE,KAAK,CAAC,WAAW,IAAI,EAAE;QACpC,mBAAmB,EAAE,KAAK,CAAC,mBAAmB;QAC9C,oBAAoB,EAAE,KAAK,CAAC,oBAAoB,IAAI,EAAE;KACvD,CAAA;CACF;AAED;IAKE;QACE,IAAI,CAAC,KAAK,GAAG;YACX,QAAQ,EAAE,EAAE;YACZ,eAAe,EAAE,EAAE;YACnB,uBAAuB,EAAE,EAAE;YAC3B,0BAA0B,EAAE,EAAE;YAC9B,wBAAwB,EAAE,EAAE;YAC5B,yBAAyB,EAAE,EAAE;YAC7B,mBAAmB,EAAE,EAAE;YACvB,kBAAkB,EAAE,EAAE;YACtB,KAAK,EAAE,EAAE;YACT,qBAAqB,EAAE,EAAE;YACzB,YAAY,EAAE,IAAI;YAClB,qBAAqB,EAAE,EAAE;YACzB,yBAAyB,EAAE,EAAE;YAC7B,sBAAsB,EAAE,EAAE;YAC1B,qBAAqB,EAAE,EAAE;YACzB,qBAAqB,EAAE,EAAE;YACzB,oBAAoB,EAAE,EAAE;YACxB,YAAY,EAAE,EAAE;YAChB,eAAe,EAAE,EAAE;YACnB,YAAY,EAAE,IAAI;YAClB,cAAc,EAAE,EAAE;YAClB,kBAAkB,EAAE,IAAI;YACxB,WAAW,EAAE,EAAE;YACf,mBAAmB,EAAE,IAAI;YACzB,oBAAoB,EAAE,EAAE;SACzB,CAAA;QACD,IAAI,CAAC,SAAS,GAAG,EAAE,CAAA;KACpB;IAED,0BAAG,GAAH,UAAI,MAAiB;QACnB,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;YAC9B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,IAAI,CAAA;YAEhC,KAAgB,UAAW,EAAX,KAAA,MAAM,CAAC,IAAI,EAAX,cAAW,EAAX,IAAW,EAAE;gBAAxB,IAAI,GAAG,SAAA;gBACV,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;aACd;YAED,IAAI,CAAC,KAAK,GAAG,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,MAAM,CAAC,CAAA;SAC9C;KACF;IAEH,mBAAC;CAAA,IAAA;AAED,SAAS,YAAY,CAAC,MAAmB,EAAE,MAAmB;IAC5D,OAAO;QACL,QAAQ,EAAE,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC;QACjD,eAAe,EAAE,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,MAAM,CAAC,eAAe,CAAC;QACtE,uBAAuB,EAAE,MAAM,CAAC,uBAAuB,CAAC,MAAM,CAAC,MAAM,CAAC,uBAAuB,CAAC;QAC9F,0BAA0B,EAAE,MAAM,CAAC,0BAA0B,CAAC,MAAM,CAAC,MAAM,CAAC,0BAA0B,CAAC;QACvG,wBAAwB,EAAE,MAAM,CAAC,wBAAwB,CAAC,MAAM,CAAC,MAAM,CAAC,wBAAwB,CAAC;QACjG,yBAAyB,EAAE,MAAM,CAAC,yBAAyB,CAAC,MAAM,CAAC,MAAM,CAAC,yBAAyB,CAAC;QACpG,mBAAmB,EAAE,MAAM,CAAC,mBAAmB,CAAC,MAAM,CAAC,MAAM,CAAC,mBAAmB,CAAC;QAClF,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC;QAC/E,KAAK,eAAO,MAAM,CAAC,KAAK,EAAK,MAAM,CAAC,KAAK,CAAE;QAC3C,qBAAqB,EAAE,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC;QACxF,YAAY,EAAE,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,YAAY;QACxD,qBAAqB,EAAE,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC;QACxF,yBAAyB,EAAE,MAAM,CAAC,yBAAyB,CAAC,MAAM,CAAC,MAAM,CAAC,yBAAyB,CAAC;QACpG,sBAAsB,EAAE,MAAM,CAAC,sBAAsB,CAAC,MAAM,CAAC,MAAM,CAAC,sBAAsB,CAAC;QAC3F,qBAAqB,EAAE,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC;QACxF,oBAAoB,EAAE,MAAM,CAAC,oBAAoB,CAAC,MAAM,CAAC,MAAM,CAAC,oBAAoB,CAAC;QACrF,qBAAqB,EAAE,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC;QACxF,YAAY,eAAO,MAAM,CAAC,YAAY,EAAK,MAAM,CAAC,YAAY,CAAE;QAChE,eAAe,EAAE,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,MAAM,CAAC,eAAe,CAAC;QACtE,YAAY,EAAE,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,YAAY;QACxD,cAAc,EAAE,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC;QACnE,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,IAAI,MAAM,CAAC,kBAAkB;QAC1E,WAAW,EAAE,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,WAAW;QACrD,mBAAmB,EAAE,MAAM,CAAC,mBAAmB,IAAI,MAAM,CAAC,mBAAmB;QAC7E,oBAAoB,eAAO,MAAM,CAAC,oBAAoB,EAAK,MAAM,CAAC,oBAAoB,CAAE;KACzF,CAAA;CACF;;AC1MD,IAAI,cAAc,GAAmB;IACnC,WAAW,EAAE,IAAI;IAEjB,SAAS,EAAT,UAAU,GAAQ;QAChB,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YACtB,OAAO,GAAG,CAAA;SACX;aAAM,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;YACpC,OAAO,GAAG,CAAC,MAAM,CAAA;SAClB;QACD,OAAO,IAAI,CAAA;KACZ;IAED,KAAK,EAAL,UAAM,GAAG,EAAE,OAAO;QAChB,OAAO,CAAC;YACN,SAAS,EAAE,GAAG,CAAC,WAAW,CAAC,IAAoB;SAChD,CAAC,CAAA;KACH;CACF,CAAA;AAED,6BAAe,YAAY,CAAC;IAC1B,eAAe,EAAE,CAAE,cAAc,CAAE;CACpC,CAAC,CAAA;;ACTF,IAAIC,gBAAc,GAAmB;IAEnC,SAAS,EAAT,UAAU,GAAQ;QAChB,IAAI,OAAO,GAAG,KAAK,UAAU,EAAE;YAC7B,OAAO,GAAG,CAAA;SACX;aAAM,IAAI,OAAO,GAAG,CAAC,MAAM,KAAK,UAAU,EAAE;YAC3C,OAAO,GAAG,CAAC,MAAM,CAAA;SAClB;QACD,OAAO,IAAI,CAAA;KACZ;IAED,KAAK,EAAL,UAAM,GAAG,EAAE,OAAO,EAAE,OAAO;QACzB,IAAI,OAAO,GAAG,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAA;QAClC,IAAI,IAAI,GAAG,GAAG,CAAC,WAAW,CAAC,IAAuB,CAAA;QAElD,WAAW,CACT,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACd,KAAK,EAAE,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC;YACtC,GAAG,EAAE,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC;YAClC,QAAQ,EAAE,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC;YAC5C,MAAM,EAAE,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC;YACxC,QAAQ,EAAE,OAAO,CAAC,QAAQ;SAC3B,CAAC,EACF,UAAS,SAAS;YAChB,OAAO,CAAC,EAAE,SAAS,WAAA,EAAE,CAAC,CAAA;SACvB,EACD,OAAO;SACR,CAAA;KACF;CAEF,CAAA;AAED,4BAAe,YAAY,CAAC;IAC1B,eAAe,EAAE,CAAEA,gBAAc,CAAE;CACpC,CAAC,CAAA;;SCjDsB,WAAW,CAAC,MAAc,EAAE,GAAW,EAAE,MAAc,EAAE,eAAe,EAAE,eAAe;IAC/G,MAAM,GAAG,MAAM,CAAC,WAAW,EAAE,CAAA;IAE7B,IAAI,IAAI,GAAG,IAAI,CAAA;IAEf,IAAI,MAAM,KAAK,KAAK,EAAE;QACpB,GAAG,GAAG,uBAAuB,CAAC,GAAG,EAAE,MAAM,CAAC,CAAA;KAC3C;SAAM;QACL,IAAI,GAAG,YAAY,CAAC,MAAM,CAAC,CAAA;KAC5B;IAED,IAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAA;IAC9B,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAA;IAE3B,IAAI,MAAM,KAAK,KAAK,EAAE;QACpB,GAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE,mCAAmC,CAAC,CAAA;KAC1E;IAED,GAAG,CAAC,MAAM,GAAG;QACX,IAAI,GAAG,CAAC,MAAM,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,GAAG,EAAE;YACzC,IAAI;gBACF,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;gBACtC,eAAe,CAAC,GAAG,EAAE,GAAG,CAAC,CAAA;aAC1B;YAAC,OAAO,GAAG,EAAE;gBACZ,eAAe,CAAC,sBAAsB,EAAE,GAAG,CAAC,CAAA;aAC7C;SACF;aAAM;YACL,eAAe,CAAC,gBAAgB,EAAE,GAAG,CAAC,CAAA;SACvC;KACF,CAAA;IAED,GAAG,CAAC,OAAO,GAAG;QACZ,eAAe,CAAC,gBAAgB,EAAE,GAAG,CAAC,CAAA;KACvC,CAAA;IAED,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;CACf;AAED,SAAS,uBAAuB,CAAC,GAAW,EAAE,MAAM;IAClD,OAAO,GAAG;SACP,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC;QACrC,YAAY,CAAC,MAAM,CAAC,CAAA;CACvB;AAED,SAAS,YAAY,CAAC,MAAM;IAC1B,IAAI,KAAK,GAAG,EAAE,CAAA;IAEd,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;QACtB,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,kBAAkB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;KAC5E;IAED,OAAO,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;CACvB;;ACrCD,IAAIA,gBAAc,GAAmB;IAEnC,SAAS,EAAT,UAAU,GAAQ;QAChB,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;YAC3B,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAA;SACnB;aAAM,IAAI,CAAC,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE;YACtD,OAAO,IAAI,CAAA;SACZ;QAED,OAAO;YACL,GAAG,EAAE,GAAG,CAAC,GAAG;YACZ,MAAM,EAAE,CAAC,GAAG,CAAC,MAAM,IAAI,KAAK,EAAE,WAAW,EAAE;YAC3C,WAAW,EAAE,GAAG,CAAC,WAAW;YAC5B,UAAU,EAAE,GAAG,CAAC,UAAU;YAC1B,QAAQ,EAAE,GAAG,CAAC,QAAQ;YACtB,aAAa,EAAE,GAAG,CAAC,aAAa;SACjC,CAAA;KACF;IAED,KAAK,EAAL,UAAM,GAAG,EAAE,OAAO,EAAE,OAAO;QACzB,IAAI,IAAI,GAAiB,GAAG,CAAC,WAAW,CAAC,IAAI,CAAA;QAC7C,IAAI,aAAa,GAAG,kBAAkB,CAAC,IAAI,EAAE,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAA;QAErE,WAAW,CACT,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,GAAG,EAAE,aAAa,EACpC,UAAS,SAAS,EAAE,GAAG;YACrB,OAAO,CAAC,EAAE,SAAS,WAAA,EAAE,GAAG,KAAA,EAAE,CAAC,CAAA;SAC5B,EACD,UAAS,YAAY,EAAE,GAAG;YACxB,OAAO,CAAC,EAAE,OAAO,EAAE,YAAY,EAAE,GAAG,KAAA,EAAE,CAAC,CAAA;SACxC,CACF,CAAA;KACF;CAEF,CAAA;AAED,gCAAe,YAAY,CAAC;IAC1B,eAAe,EAAE,CAAEA,gBAAc,CAAE;CACpC,CAAC,CAAA;AAEF,SAAS,kBAAkB,CAAC,IAAkB,EAAE,KAAgB,EAAE,QAAkB;IAClF,IAAM,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAA;IAChC,IAAI,UAAU,CAAA;IACd,IAAI,QAAQ,CAAA;IACZ,IAAI,aAAa,CAAA;IACjB,IAAI,mBAAmB,CAAA;IACvB,IAAI,MAAM,GAAG,EAAE,CAAA;IAEf,UAAU,GAAG,IAAI,CAAC,UAAU,CAAA;IAC5B,IAAI,UAAU,IAAI,IAAI,EAAE;QACtB,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;KACxC;IAED,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAA;IACxB,IAAI,QAAQ,IAAI,IAAI,EAAE;QACpB,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,CAAA;KACpC;IAED,aAAa,GAAG,IAAI,CAAC,aAAa,CAAA;IAClC,IAAI,aAAa,IAAI,IAAI,EAAE;QACzB,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC,CAAA;KAC9C;IAGD,IAAI,OAAO,IAAI,CAAC,WAAW,KAAK,UAAU,EAAE;QAE1C,mBAAmB,GAAG,IAAI,CAAC,WAAW,EAAE,CAAA;KACzC;SAAM;QAEL,mBAAmB,GAAG,IAAI,CAAC,WAAW,IAAI,EAAE,CAAA;KAC7C;IAED,QAAQ,CAAC,MAAM,EAAE,mBAAmB,CAAC,CAAA;IAErC,MAAM,CAAC,UAAU,CAAC,GAAG,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;IACnD,MAAM,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;IAE/C,IAAI,OAAO,CAAC,QAAQ,KAAK,OAAO,EAAE;QAChC,MAAM,CAAC,aAAa,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAA;KACzC;IAED,OAAO,MAAM,CAAA;CACd;;ACxED,IAAI,SAAS,GAAkB;IAE7B,KAAK,EAAL,UAAM,QAAoB,EAAE,aAAkB,EAAE,OAAgB;QAC9D,IAAI,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;QACrD,IAAI,UAAU,GAAG;YACf,UAAU,EAAE,IAAI;YAChB,SAAS,EAAE,cAAc;YACzB,OAAO,EAAE,cAAc;YACvB,UAAU,EAAE,YAAY;YACxB,QAAQ,EAAE,YAAY;SACvB,CAAA;QAED,IAAI,KAAK,GAAG,WAAW,CAAC,QAAQ,EAAE,UAAU,EAAE,EAAE,EAAE,aAAa,CAAwB,CAAA;QACvF,IAAI,QAAQ,GAAG,KAAK,CAAA;QAEpB,KAAK,IAAI,QAAQ,IAAI,KAAK,EAAE;YAC1B,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,IAAI,EAAE;gBAC3B,QAAQ,GAAG,IAAI,CAAA;gBACf,MAAK;aACN;SACF;QAED,IAAI,QAAQ,EAAE;YACZ,IAAI,QAAQ,GAAa,IAAI,CAAA;YAE7B,IAAI,UAAU,IAAI,aAAa,EAAE;gBAC/B,QAAQ,GAAG,cAAc,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAA;gBACjD,OAAO,aAAa,CAAC,QAAQ,CAAA;aAC9B;YACD,IAAI,CAAC,QAAQ,IAAI,KAAK,CAAC,SAAS,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjD,QAAQ,GAAG,iBAAiB,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,SAAS,CAAC,CAAA;aAC7D;YAED,OAAO;gBACL,WAAW,EAAE,OAAO,CAAC,CAAC,KAAK,CAAC,SAAS,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;gBACxD,QAAQ,UAAA;gBACR,QAAQ,EAAE,KAAK;aAChB,CAAA;SACF;QAED,OAAO,IAAI,CAAA;KACZ;IAED,MAAM,EAAN,UAAO,QAA6B,EAAE,YAAuB,EAAE,OAAgB;QAC7E,IAAI,mBAAmB,GAAG,eAAe,CACvC,YAAY,EACZ,EAAE,KAAK,EAAE,QAAQ,CAAC,UAAU,EAAE,GAAG,EAAE,QAAQ,CAAC,QAAQ,EAAE,CACvD,CAAA;QAED,IAAI,mBAAmB,EAAE;YACvB,OAAO,YAAY,CACjB,QAAQ,CAAC,UAAU,EACnB,QAAQ,CAAC,SAAS,EAClB,mBAAmB,EACnB,OAAO,CACR,CAAA;SACF;aAAM;YACL,OAAO,EAAE,CAAA;SACV;KACF;CAEF,CAAA;AAED,6BAAe,YAAY,CAAC;IAC1B,cAAc,EAAE,CAAE,SAAS,CAAE;CAC9B,CAAC,CAAA;AAEF,SAAS,YAAY,CACnB,UAA2B,EAC3B,SAA0B,EAC1B,YAAuB,EACvB,OAAgB;IAEhB,IAAI,OAAO,GAAmC,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC,GAAG,IAAI,CAAA;IACzF,IAAI,SAAS,GAAG,UAAU,CAAC,YAAY,CAAC,KAAK,CAAC,CAAA;IAC9C,IAAI,SAAS,GAAG,YAAY,CAAC,GAAG,CAAA;IAChC,IAAI,cAAc,GAAiB,EAAE,CAAA;IAErC,OAAO,SAAS,GAAG,SAAS,EAAE;QAC5B,IAAI,aAAa;gBAAA,CAAA;QAGjB,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC,EAAE;YAE9C,IAAI,SAAS,EAAE;gBACb,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAA;aAClD;iBAAM;gBACL,aAAa,GAAG,SAAS,CAAA;aAC1B;YAED,cAAc,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;SACnC;QAED,SAAS,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC,CAAA;KAClC;IAED,OAAO,cAAc,CAAA;CACtB;;ACtHD,kCAAe,YAAY,CAAC;IAC1B,oBAAoB,EAAE;QACpB,MAAM,YAAC,MAAM,EAAE,QAAQ,EAAE,SAAS;YAChC,kBAAkB,CAAC,CAAE,MAAM,CAAE,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAA;SACpD;QACD,YAAY,EAAE,kBAAkB;QAChC,OAAO,EAAE,aAAa;KACvB;CACF,CAAC,CAAA;AAEF,SAAS,kBAAkB,CAAC,MAAM,EAAE,QAAkB,EAAE,SAAS;IAC/D,IAAI,cAAc,GAAkB,iBAAiB,CAAC,QAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,CAAA;IAClF,IAAI,SAAS,GAAG,EAAE,CAAA;IAElB,KAAkB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM,EAAE;QAArB,IAAI,KAAK,eAAA;QACZ,IAAI,UAAU,GAAG,KAAK,CAAA;QAEtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC9C,IAAI,SAAS,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE;gBAC5C,cAAc,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;gBAC3B,UAAU,GAAG,IAAI,CAAA;gBACjB,MAAK;aACN;SACF;QAED,IAAI,CAAC,UAAU,EAAE;YACf,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;SACtB;KACF;IAED,KAA0B,UAAc,EAAd,iCAAc,EAAd,4BAAc,EAAd,IAAc,EAAE;QAArC,IAAI,aAAa,uBAAA;QACpB,QAAQ,CAAC,QAAQ,CAAC;YAChB,IAAI,EAAE,qBAAqB;YAC3B,QAAQ,EAAE,aAAa,CAAC,QAAQ;SACjC,CAAC,CAAA;KACH;IAED,KAAqB,UAAS,EAAT,uBAAS,EAAT,uBAAS,EAAT,IAAS,EAAE;QAA3B,IAAI,QAAQ,kBAAA;QACf,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAA;KAClC;CACF;AAGD,SAAS,aAAa,CAAC,MAAM,EAAE,QAAkB;IAC/C,QAAQ,CAAC,eAAe,CAAC,MAAM,CAAC,CAAA;CACjC;;ICzCY,MAAM,GAAG,EAAS,CAAA;AAE/B,IAAa,cAAc,GAAG;IAE5B,qBAAqB,EAAE,KAAK;IAC5B,mBAAmB,EAAE,UAAU;IAE/B,yBAAyB,EAAE,UAAU;IACrC,0BAA0B,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE;IACtC,kBAAkB,EAAE,KAAK;IACzB,gBAAgB,EAAE,UAAU;IAG5B,YAAY,EAAE,IAAI;IAClB,WAAW,EAAE,EAAE;IACf,WAAW,EAAE,IAAI;IACjB,MAAM,EAAE;QACN,IAAI,EAAE,OAAO;QACb,MAAM,EAAE,EAAE;QACV,KAAK,EAAE,iBAAiB;KACzB;IACD,QAAQ,EAAE,IAAI;IACd,WAAW,EAAE,KAAK;IAClB,qBAAqB,EAAE,OAAO;IAE9B,QAAQ,EAAE,KAAK;IAIf,UAAU,EAAE,UAAU;IACtB,OAAO,EAAE,UAAU;IACnB,OAAO,EAAE,UAAU;IACnB,mBAAmB,EAAE,IAAI;IAGzB,YAAY,EAAE,IAAI;IAClB,UAAU,EAAE,OAAO;IACnB,QAAQ,EAAE,KAAK;IACf,aAAa,EAAE,UAAU;IAEzB,QAAQ,EAAE,OAAO;IAKjB,OAAO,EAAE,EAAE;IACX,MAAM,EAAE,EAAE;IAKV,sBAAsB,EAAE,CAAC;IAEzB,WAAW,EAAE,UAAU;IAGvB,kBAAkB,EAAE,GAAG;IACvB,UAAU,EAAE,IAAI;IAEhB,sBAAsB,EAAE,KAAK;IAG7B,YAAY,EAAE,IAAI;IAGlB,UAAU,EAAE,GAAG;IAEf,UAAU,EAAE,8BAA8B;IAK1C,UAAU,EAAE,KAAK;IACjB,eAAe,EAAE,SAAS;IAC1B,gBAAgB,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE;IAEpE,kBAAkB,EAAE,IAAI;IACxB,iBAAiB,EAAE,GAAG;IAEtB,cAAc,EAAE,IAAI;IACpB,oBAAoB,EAAE,CAAC;CAExB,CAAA;AAGD,AAAO,IAAM,WAAW,GAAG;IACzB,MAAM,EAAE;QACN,IAAI,EAAE,iBAAiB;QACvB,MAAM,EAAE,EAAE;QACV,KAAK,EAAE,OAAO;KACf;IACD,WAAW,EAAE;QAEX,IAAI,EAAE,uBAAuB;QAC7B,IAAI,EAAE,sBAAsB;QAC5B,QAAQ,EAAE,wBAAwB;QAClC,QAAQ,EAAE,uBAAuB;KAClC;CACF,CAAA;AAGD,IAAI,cAAc,GAAG;IACnB,QAAQ;IACR,QAAQ;IACR,YAAY;IACZ,aAAa;CACd,CAAA;AAID,SAAgB,YAAY,CAAC,UAAU;IACrC,OAAO,UAAU,CAAC,UAAU,EAAE,cAAc,CAAC,CAAA;CAC9C;AAMD,IAAM,gBAAgB,GAAgB;IACpC,sBAAsB;IACtB,qBAAqB;IACrB,yBAAyB;IACzB,sBAAsB;IACtB,2BAA2B;CAC5B,CAAA;AAED,SAAgB,gBAAgB,CAAC,YAAmB;IAClD,IAAI,OAAO,GAAG,EAAE,CAAA;IAEhB,KAAwB,UAAY,EAAZ,6BAAY,EAAZ,0BAAY,EAAZ,IAAY,EAAE;QAAjC,IAAI,WAAW,qBAAA;QAElB,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;YACnC,IAAI,UAAU,GAAG,cAAc,GAAG,qBAAqB,CAAC,WAAW,CAAC,CAAA;YAEpE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE;gBACvB,OAAO,CAAC,IAAI,CAAC,6BAA6B,GAAG,WAAW,CAAC,CAAA;aAC1D;iBAAM;gBACL,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAA;aACzC;SAEF;aAAM;YACL,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;SAC1B;KACF;IAED,OAAO,gBAAgB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAA;CACxC;;ACjID,IAAM,aAAa,GAAG;IACpB,IAAI,EAAE,IAAI;IACV,IAAI,EAAE;QACJ,GAAG,EAAE,CAAC;QACN,GAAG,EAAE,CAAC;KACP;IACD,GAAG,EAAE,KAAK;IACV,UAAU,EAAE;QACV,IAAI,EAAE,MAAM;QACZ,IAAI,EAAE,MAAM;QACZ,QAAQ,EAAE,WAAW;QACrB,QAAQ,EAAE,WAAW;QACrB,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,OAAO;QACd,KAAK,EAAE,OAAO;QACd,IAAI,EAAE,MAAM;QACZ,GAAG,EAAE,KAAK;QACV,IAAI,EAAE,MAAM;KACb;IACD,SAAS,EAAE,GAAG;IACd,UAAU,EAAE,SAAS;IACrB,cAAc,EAAE,MAAM;IACtB,eAAe,EAAE,sBAAsB;CACxC,CAAA;AAED,SAAgB,eAAe,CAAC,kBAA+B;IAC7D,IAAI,WAAW,GAAG,kBAAkB,CAAC,MAAM,GAAG,CAAC,GAAG,kBAAkB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,CAAA;IACnF,IAAI,WAAW,GAAG,MAAM,CAAC,wBAAwB,CAAC,IAAI,EAAE,CAAA;IACxD,IAAI,YAAY,GAAG,MAAM,CAAC,qBAAqB,CAAC,IAAI,EAAE,CAAA;IACtD,IAAI,aAAa,GAAG,WAAW,CAAC,MAAM;IACpC,iBAAiB,CAAC,YAAY,CAAC;IAC/B,kBAAkB;KACnB,CAAA;IACD,IAAI,YAAY,GAAG;QACjB,EAAE,EAAE,aAAa;KAClB,CAAA;IAED,KAAsB,UAAa,EAAb,+BAAa,EAAb,2BAAa,EAAb,IAAa,EAAE;QAAhC,IAAI,SAAS,sBAAA;QAChB,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,SAAS,CAAA;KACzC;IAED,OAAO;QACL,GAAG,EAAE,YAAY;QACjB,WAAW,aAAA;KACZ,CAAA;CACF;AAED,SAAgB,WAAW,CAAC,aAAgC,EAAE,SAAuB;IACnF,IAAI,OAAO,aAAa,KAAK,QAAQ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE;QACtE,OAAO,WAAW,CAChB,aAAa,CAAC,IAAI,EAClB,CAAE,aAAa,CAAC,IAAI,CAAE,EACtB,aAAa,CACd,CAAA;KACF;SAAM;QACL,OAAO,WAAW,CAAC,aAAa,EAAE,SAAS,CAAC,CAAA;KAC7C;CACF;AAED,SAAS,WAAW,CAAC,OAAsB,EAAE,SAAuB;IAClE,IAAI,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC,CAAA;IACpC,IAAI,GAAG,GAAG,cAAc,CAAC,KAAK,EAAE,SAAS,CAAC,IAAI,aAAa,CAAA;IAE3D,OAAO,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,CAAC,CAAA;CACxC;AAED,SAAS,cAAc,CAAC,KAAe,EAAE,SAAuB;IAC9D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;QACrC,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,iBAAiB,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;QAEnD,KAAK,IAAI,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YACrC,IAAI,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;YAE1C,IAAI,SAAS,CAAC,QAAQ,CAAC,EAAE;gBACvB,OAAO,SAAS,CAAC,QAAQ,CAAC,CAAA;aAC3B;SACF;KACF;IACD,OAAO,IAAI,CAAA;CACZ;AAED,SAAS,WAAW,CAAC,OAAsB,EAAE,KAAe,EAAE,GAAc;IAC1E,IAAI,MAAM,GAAG,UAAU,CAAC,CAAE,aAAa,EAAE,GAAG,CAAE,EAAE,CAAE,YAAY,CAAE,CAAC,CAAA;IAEjE,OAAO,MAAM,CAAC,IAAI,CAAA;IAElB,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAA;IACtB,OAAO,MAAM,CAAC,IAAI,CAAA;IAElB,OAAO;QACL,OAAO,SAAA;QACP,KAAK,OAAA;QACL,IAAI,MAAA;QACJ,kBAAkB,EAAE,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC;QAClD,OAAO,EAAE,MAAM;KAChB,CAAA;CACF;;ACpHD;IASE,wBAAY,SAAS;QACnB,IAAI,CAAC,SAAS,gBAAQ,SAAS,CAAE,CAAA;QACjC,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAA;QAC1B,IAAI,CAAC,OAAO,EAAE,CAAA;KACf;IAGD,+BAAM,GAAN,UAAO,OAAO,EAAE,QAAkB,EAAE,SAAmB;QACrD,IAAI,YAAY,GAAG,SAAS,GAAG,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAA;QAErE,QAAQ,CAAC,YAAY,EAAE,OAAO,CAAC,CAAA;QAE/B,KAAqB,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAE;YAA1B,IAAI,QAAQ,iBAAA;YACf,OAAO,YAAY,CAAC,QAAQ,CAAC,CAAA;SAC9B;QAED,IAAI,CAAC,OAAO,EAAE,CAAA;KACf;IAKD,gCAAO,GAAP;QAGE,IAAI,OAAO,GAAG,YAAY;QACxB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAC7B,IAAI,CAAC,SAAS,CAAC,OAAO,EACtB,cAAc,CAAC,OAAO,CACvB,CAAA;QACD,IAAI,MAAM,GAAG,YAAY;QACvB,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAC5B,IAAI,CAAC,SAAS,CAAC,MAAM,EACrB,cAAc,CAAC,MAAM,CACtB,CAAA;QACD,IAAI,SAAS,GAAG,eAAe,CAAC,OAAO,CAAC,CAAA;QACxC,IAAI,cAAc,GAAG,WAAW,CAAC,MAAM,IAAI,SAAS,CAAC,WAAW,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC,OAAO,CAAA;QAExF,IAAI,GAAG,GAAG,YAAY;QACpB,IAAI,CAAC,gBAAgB,CAAC,GAAG,EACzB,IAAI,CAAC,SAAS,CAAC,GAAG,EAClB,cAAc,CAAC,GAAG,CACnB,CAAA;QAED,IAAI,WAAW,GAAG,GAAG,KAAK,KAAK,GAAG,WAAW,GAAG,EAAE,CAAA;QAElD,IAAI,CAAC,WAAW,GAAG,WAAW,CAAA;QAC9B,IAAI,CAAC,cAAc,GAAG,cAAc,CAAA;QAEpC,IAAI,CAAC,QAAQ,GAAG,YAAY,CAAC;YAC3B,cAAc;YACd,WAAW;YACX,cAAc;YACd,IAAI,CAAC,SAAS;YACd,IAAI,CAAC,gBAAgB;SACtB,CAAC,CAAA;KACH;IAEH,qBAAC;CAAA,IAAA;;AC9DD,IAAI,sBAAsB,GAAG,EAAE,CAAA;AAE/B,SAAgB,sBAAsB,CAAC,IAAI,EAAE,QAAQ;IACnD,sBAAsB,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAA;CACxC;AAED,SAAgB,oBAAoB,CAAC,IAAI;IACvC,OAAO,IAAI,sBAAsB,CAAC,IAAI,CAAC,EAAE,CAAA;CAC1C;AAGD;IAAA;KAsBC;IApBC,+CAAa,GAAb,UAAc,CAAa;QACzB,OAAO,CAAC,CAAC,cAAc,EAAE,CAAA;KAC1B;IAED,gDAAc,GAAd,UAAe,CAAa;QAC1B,OAAO,CAAC,CAAC,WAAW,EAAE,CAAA;KACvB;IAED,8CAAY,GAAZ,UAAa,CAAa;QACxB,OAAO,CAAC,CAAC,UAAU,EAAE,CAAA;KACtB;IAED,+CAAa,GAAb,UAAc,GAAG;QACf,OAAO,cAAc,CAAC,GAAG,CAAC,CAAA;KAC3B;IAED,+CAAa,GAAb,UAAc,MAAM;QAClB,OAAO,cAAc,CAAC,MAAM,CAAC,CAAA;KAC9B;IAEH,8BAAC;CAAA,IAAA;AAED,sBAAsB,CAAC,SAAS,EAAE,uBAAuB,CAAC,CAAA;;AC3C1D,IAAM,MAAM,GAAG,+GAA+G,CAAA;AAE9H,SAAgB,KAAK,CAAC,GAAG;IACvB,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;IAExB,IAAI,CAAC,EAAE;QACL,IAAI,MAAM,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAC5B,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EACZ,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAC3B,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EACjB,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EACjB,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EACjB,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,EAClB,CAAC,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,IAAI,GAAG,CAAC,CACxC,CAAC,CAAA;QAEF,IAAI,WAAW,CAAC,MAAM,CAAC,EAAE;YACvB,IAAI,cAAc,GAAG,IAAI,CAAA;YAEzB,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE;gBACT,cAAc,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,KACtC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE;oBACvB,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CACnB,CAAA;aACF;YAED,OAAO;gBACL,MAAM,QAAA;gBACN,iBAAiB,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;gBACxB,cAAc,gBAAA;aACf,CAAA;SACF;KACF;IAED,OAAO,IAAI,CAAA;CACZ;;;ICYC,iBAAY,QAAyB;QACnC,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAA;QAChD,IAAI,eAAe,GAAG,QAAQ,KAAK,OAAO,IAAI,QAAQ,KAAK,KAAK,CAAA;QAEhE,IAAI,QAAQ,CAAC,iBAAiB,IAAI,eAAe,EAAE;YACjD,IAAI,CAAC,iBAAiB,GAAG,IAAI,QAAQ,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAA;SAClE;QAED,IAAI,CAAC,gBAAgB,GAAG,OAAO,CAAC,CAAC,eAAe,IAAI,IAAI,CAAC,iBAAiB,CAAC,CAAA;QAE3E,IAAI,CAAC,cAAc,GAAG,oBAAoB,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAA;QACnE,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAA;QAC7B,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAA;QACvC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAA;QAEvC,IAAI,QAAQ,CAAC,qBAAqB,KAAK,KAAK,EAAE;YAC5C,IAAI,CAAC,OAAO,GAAG,CAAC,CAAA;YAChB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAA;SACjB;QAED,IAAI,OAAO,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;YACzC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,QAAQ,CAAA;SACjC;QAED,IAAI,OAAO,QAAQ,CAAC,qBAAqB,KAAK,UAAU,EAAE;YACxD,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC,qBAAqB,CAAA;SACrD;QAED,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,SAAS,IAAI,IAAI,GAAG,QAAQ,CAAC,SAAS,GAAG,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAA;QAEpG,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC,YAAY,CAAA;KAC1C;IAKD,8BAAY,GAAZ,UAAa,KAAgB;QAC3B,IAAI,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAA;QACvC,IAAI,IAAI,KAAK,IAAI,EAAE;YACjB,OAAO,IAAI,CAAA;SACZ;QACD,OAAO,IAAI,CAAC,MAAM,CAAA;KACnB;IAED,iCAAe,GAAf;QACE,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACzB,OAAO,IAAI,CAAC,iBAAiB,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,CAAA;SACpD;aAAM;YAGL,OAAO,cAAc,CAAC,gBAAgB,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,CAAA;SACpD;KACF;IAED,kCAAgB,GAAhB,UAAiB,KAAgB;QAE/B,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC7B,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;SACzB;QAED,IAAI,MAAM,GAAG,IAAI,CAAA;QAEjB,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC7B,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAA;SACvC;aAAM,IAAI,KAAK,YAAY,IAAI,EAAE;YAChC,KAAK,GAAG,KAAK,CAAC,OAAO,EAAE,CAAA;YAEvB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;gBACjB,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAA;aACvC;SACF;aAAM,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YAC/B,MAAM,GAAG,cAAc,CAAC,KAAK,CAAC,CAAA;SAC/B;QAED,IAAI,MAAM,KAAK,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE;YAC3C,OAAO,IAAI,CAAA;SACZ;QAED,OAAO,EAAE,MAAM,QAAA,EAAE,iBAAiB,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE,CAAA;KAC7D;IAED,uBAAK,GAAL,UAAM,CAAS;QACb,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAA;QACpB,IAAI,KAAK,KAAK,IAAI,EAAE;YAClB,OAAO,IAAI,CAAA;SACZ;QAED,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAA;QACzB,IAAI,SAAS,GAAG,IAAI,CAAA;QAEpB,IAAI,KAAK,CAAC,cAAc,KAAK,IAAI,EAAE;YACjC,IAAI,IAAI,CAAC,gBAAgB,EAAE;gBACzB,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,GAAG,KAAK,CAAC,cAAc,GAAG,EAAE,GAAG,IAAI,CAAC,CAAA;aACrF;iBAAM;gBACL,SAAS,GAAG,KAAK,CAAC,cAAc,CAAA;aACjC;SACF;QAED,OAAO,EAAE,MAAM,QAAA,EAAE,iBAAiB,EAAE,KAAK,CAAC,iBAAiB,EAAE,SAAS,WAAA,EAAE,CAAA;KACzE;IAKD,yBAAO,GAAP,UAAQ,MAAkB;QACxB,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,CAAA;KACjD;IAED,0BAAQ,GAAR,UAAS,MAAkB;QACzB,OAAO,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,MAAM,CAAC,CAAA;KAClD;IAKD,qBAAG,GAAH,UAAI,MAAkB,EAAE,GAAa;QACnC,IAAI,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,CAAA;QACjD,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,KAAK,CAAA;QACjB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,MAAM,CAAA;QAClB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,IAAI,CAAA;QAChB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,YAAY,CAAA;QACxB,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC,CAAA;KAC5C;IAED,0BAAQ,GAAR,UAAS,MAAkB,EAAE,GAAa;QACxC,IAAI,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,CAAA;QACjD,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,KAAK,CAAA;QACjB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,MAAM,CAAA;QAClB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,IAAI,CAAA;QAChB,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,YAAY,CAAA;QACxB,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC,CAAA;KAC5C;IAED,0BAAQ,GAAR,UAAS,MAAkB,EAAE,CAAS;QACpC,IAAI,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,CAAA;QACjD,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;QACT,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC,CAAA;KAC5C;IAED,2BAAS,GAAT,UAAU,MAAkB,EAAE,CAAS;QACrC,IAAI,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,CAAA;QACjD,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;QACT,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC,CAAA;KAC5C;IAKD,gCAAc,GAAd,UAAe,EAAc,EAAE,EAAc;QACrC,IAAA,oCAAc,CAAS;QAE7B,IACE,QAAQ,CAAC,EAAE,CAAC,KAAK,QAAQ,CAAC,EAAE,CAAC;YAC7B,cAAc,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,cAAc,CAAC,YAAY,CAAC,EAAE,CAAC;YACnE,cAAc,CAAC,cAAc,CAAC,EAAE,CAAC,KAAK,cAAc,CAAC,cAAc,CAAC,EAAE,CAAC,EACvE;YACA,OAAO,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,CAAA;SAC3E;QACD,OAAO,IAAI,CAAA;KACZ;IAED,iCAAe,GAAf,UAAgB,EAAc,EAAE,EAAc;QACtC,IAAA,oCAAc,CAAS;QAE7B,IACE,QAAQ,CAAC,EAAE,CAAC,KAAK,QAAQ,CAAC,EAAE,CAAC;YAC7B,cAAc,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,cAAc,CAAC,YAAY,CAAC,EAAE,CAAC,EACnE;YACA,OAAO,CAAC,cAAc,CAAC,cAAc,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,cAAc,CAAC,EAAE,CAAC;gBACzE,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,EAAE,CAAA;SAC/E;QACD,OAAO,IAAI,CAAA;KACZ;IAKD,mCAAiB,GAAjB,UAAkB,EAAc,EAAE,EAAc;QAC9C,IAAI,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QAEnC,IAAI,CAAC,KAAK,IAAI,EAAE;YACd,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;SAClC;QAED,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QAEhC,IAAI,CAAC,KAAK,IAAI,EAAE;YACd,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;SACnC;QAED,CAAC,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QAE1B,IAAI,CAAC,KAAK,IAAI,EAAE;YACd,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;SAClC;QAED,CAAC,GAAG,aAAa,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QAEzB,IAAI,CAAC,KAAK,IAAI,EAAE;YACd,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;SACjC;QAED,CAAC,GAAG,SAAS,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QAErB,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;YACZ,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;SAClC;QAED,CAAC,GAAG,WAAW,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QAEvB,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;YACZ,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;SACpC;QAED,CAAC,GAAG,WAAW,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;QAEvB,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;YACZ,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,EAAE,CAAA;SACpC;QAED,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,KAAK,EAAE,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,EAAE,EAAE,CAAA;KACnE;IAED,uCAAqB,GAArB,UAAsB,EAAc,EAAE,EAAc,EAAE,CAAW;QAE/D,IAAI,IAAI,CAAA;QAER,IAAI,CAAC,CAAC,KAAK,EAAE;YACX,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;YAClC,IAAI,IAAI,KAAK,IAAI,EAAE;gBACjB,OAAO,IAAI,GAAG,YAAY,CAAC,CAAC,CAAC,CAAA;aAC9B;SACF;QAED,IAAI,CAAC,CAAC,MAAM,EAAE;YACZ,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;YACnC,IAAI,IAAI,KAAK,IAAI,EAAE;gBACjB,OAAO,IAAI,GAAG,aAAa,CAAC,CAAC,CAAC,CAAA;aAC/B;SACF;QAED,IAAI,CAAC,CAAC,IAAI,EAAE;YACV,IAAI,GAAG,aAAa,CAAC,EAAE,EAAE,EAAE,CAAC,CAAA;YAC5B,IAAI,IAAI,KAAK,IAAI,EAAE;gBACjB,OAAO,IAAI,GAAG,WAAW,CAAC,CAAC,CAAC,CAAA;aAC7B;SACF;QAED,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,EAAE,IAAI,SAAS,CAAC,CAAC,CAAC,CAAA;KACpD;IAKD,yBAAO,GAAP,UAAQ,CAAa,EAAE,IAAY;QACjC,IAAI,IAAI,KAAK,MAAM,EAAE;YACnB,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAA;SAC3B;aAAM,IAAI,IAAI,KAAK,OAAO,EAAE;YAC3B,OAAO,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAA;SAC5B;aAAM,IAAI,IAAI,KAAK,MAAM,EAAE;YAC1B,OAAO,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAA;SAC3B;aAAM,IAAI,IAAI,KAAK,KAAK,EAAE;YACzB,OAAO,UAAU,CAAC,CAAC,CAAC,CAAA;SACrB;aAAM,IAAI,IAAI,KAAK,MAAM,EAAE;YAC1B,OAAO,WAAW,CAAC,CAAC,CAAC,CAAA;SACtB;aAAM,IAAI,IAAI,KAAK,QAAQ,EAAE;YAC5B,OAAO,aAAa,CAAC,CAAC,CAAC,CAAA;SACxB;aAAM,IAAI,IAAI,KAAK,QAAQ,EAAE;YAC5B,OAAO,aAAa,CAAC,CAAC,CAAC,CAAA;SACxB;KACF;IAED,6BAAW,GAAX,UAAY,CAAa;QACvB,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;YACvC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC;SACrC,CAAC,CAAA;KACH;IAED,8BAAY,GAAZ,UAAa,CAAa;QACxB,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;YACvC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC;YACpC,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,CAAC;SACtC,CAAC,CAAA;KACH;IAED,6BAAW,GAAX,UAAY,CAAa;QACvB,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC;YACvC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC;YACpC,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,CAAC;YACrC,CAAC,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,CAAC;SAC1D,CAAC,CAAA;KACH;IAKD,mCAAiB,GAAjB,UAAkB,MAAkB;QAClC,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAA;SAChD;aAAM;YACL,OAAO,UAAU,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;SACtD;KACF;IAGD,wBAAM,GAAN,UAAO,MAAkB,EAAE,SAAwB,EAAE,WAAwC;QAAxC,4BAAA,EAAA,gBAAwC;QAC3F,OAAO,SAAS,CAAC,MAAM,CACrB;YACE,MAAM,EAAE,MAAM;YACd,cAAc,EAAE,WAAW,CAAC,SAAS,IAAI,IAAI;gBAC3C,WAAW,CAAC,SAAS;gBACrB,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;SAC/B,EACD,IAAI,CACL,CAAA;KACF;IAED,6BAAW,GAAX,UAAY,KAAiB,EAAE,GAAe,EAAE,SAAwB,EAAE,WAA8F;QAA9F,4BAAA,EAAA,gBAA8F;QAEtK,IAAI,WAAW,CAAC,cAAc,EAAE;YAC9B,GAAG,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAA;SACrB;QAED,OAAO,SAAS,CAAC,WAAW,CAC1B;YACE,MAAM,EAAE,KAAK;YACb,cAAc,EAAE,WAAW,CAAC,cAAc,IAAI,IAAI;gBAChD,WAAW,CAAC,cAAc;gBAC1B,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC;SAC9B,EACD;YACE,MAAM,EAAE,GAAG;YACX,cAAc,EAAE,WAAW,CAAC,YAAY,IAAI,IAAI;gBAC9C,WAAW,CAAC,YAAY;gBACxB,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC;SAC5B,EACD,IAAI,CACL,CAAA;KACF;IAED,2BAAS,GAAT,UAAU,MAAkB,EAAE,YAAsB;QAAtB,6BAAA,EAAA,iBAAsB;QAClD,IAAI,cAAc,GAAG,IAAI,CAAA;QAEzB,IAAI,CAAC,YAAY,CAAC,kBAAkB,EAAE;YACpC,IAAI,YAAY,CAAC,SAAS,IAAI,IAAI,EAAE;gBAClC,cAAc,GAAG,YAAY,CAAC,SAAS,CAAA;aACxC;iBAAM;gBACL,cAAc,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAA;aAC9C;SACF;QAED,OAAO,cAAc,CAAC,MAAM,EAAE,cAAc,EAAE,YAAY,CAAC,QAAQ,CAAC,CAAA;KACrE;IAKD,mCAAiB,GAAjB,UAAkB,EAAU;QAC1B,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;YAC7B,OAAO,cAAc,CAAC,gBAAgB,CAAC,IAAI,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAA;SACtD;aAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,KAAK,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;YAC7D,OAAO,IAAI,IAAI,CAAC,EAAE,CAAC,CAAA;SACpB;aAAM;YACL,OAAO,cAAc,CAAC,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,CAAA;SACnE;KACF;IAED,iCAAe,GAAf,UAAgB,CAAa;QAC3B,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;YAC7B,OAAO,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,iBAAiB,EAAE,CAAA;SAChE;aAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,KAAK,EAAE;YAClC,OAAO,CAAC,CAAA;SACT;aAAM,IAAI,IAAI,CAAC,iBAAiB,EAAE;YACjC,OAAO,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAA;SAChE;QACD,OAAO,IAAI,CAAA;KACZ;IAKD,wBAAM,GAAN,UAAO,CAAa,EAAE,SAAkB;QACtC,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;YAC7B,OAAO,gBAAgB,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAA;SAC3C;aAAM,IAAI,IAAI,CAAC,QAAQ,KAAK,KAAK,EAAE;YAClC,OAAO,IAAI,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAA;SAC7B;aAAM,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;YAClC,OAAO,IAAI,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,IAAI,SAAS,IAAI,CAAC,CAAC,CAAC,CAAA;SAChD;aAAM;YACL,OAAO,IAAI,IAAI,CACb,CAAC,CAAC,OAAO,EAAE;gBACX,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,GAAG,EAAE;aACrE,CAAA;SACF;KACF;IAEH,cAAC;CAAA;;ACzVD,IAAM,mBAAmB,GAAG;IAC1B,EAAE,EAAE,MAAM;IACV,aAAa,EAAE,OAAO;IACtB,kBAAkB,EAAE,QAAQ;IAC5B,OAAO,EAAE,QAAQ;IACjB,OAAO,EAAE,QAAQ;CAClB,CAAA;AAED,IAAID,KAAG,GAAG,CAAC,CAAA;AAEX,SAAgB,mBAAmB,CAAC,WAAwB,EAAE,QAAkB;IAC9E,IAAI,IAAI,GAAG,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,eAAe,CAAA;IAEtD,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,WAAW,CAAA;CAClD;AAED,SAAgB,gBAAgB,CAAC,GAAqB,EAAE,QAAkB;IACxE,IAAI,IAAI,GAAG,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,eAAe,CAAA;IAEtD,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;QACzC,IAAI,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;QACjB,IAAI,IAAI,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA;QAE7B,IAAI,IAAI,EAAE;YACR,IAAI,GAAG,GAAG,qBAAqB,CAC7B,OAAO,GAAG,KAAK,QAAQ,GAAG,GAAG,GAAG,EAAE,EAClC,IAAI,EACJ,CAAC,EACD,QAAQ,CACT,CAAA;YAED,GAAG,CAAC,IAAI,GAAG,GAAG,CAAA;YACd,OAAO,GAAG,CAAA;SACX;KACF;IAED,OAAO,IAAI,CAAA;CACZ;AAED,SAAS,qBAAqB,CAAC,GAA6B,EAAE,IAAY,EAAE,WAAmB,EAAE,QAAkB;IACjH,IAAI,UAAU,GAAG,EAAE,CAAA;IACnB,IAAI,KAAK,GAAG,WAAW,CAAC,GAAG,EAAE,mBAAmB,EAAE,EAAE,EAAE,UAAU,CAAC,CAAA;IACjE,IAAI,UAAU,GAAG,EAAE,CAAA;IACnB,IAAI,EAAE,GAAG,sBAAsB,CAAC,UAAU,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAA;IAEjE,KAAK,CAAC,UAAU,GAAG,KAAK,CAAA;IACxB,KAAK,CAAC,aAAa,GAAG,EAAE,CAAA;IACxB,KAAK,CAAC,UAAU,GAAG,IAAI,CAAA;IACvB,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC,CAAA;IACrC,KAAK,CAAC,QAAQ,GAAG,MAAM,CAACA,KAAG,EAAE,CAAC,CAAA;IAC9B,KAAK,CAAC,WAAW,GAAG,WAAW,CAAA;IAC/B,KAAK,CAAC,IAAI,GAAG,IAAI,CAAA;IACjB,KAAK,CAAC,EAAE,GAAG,EAAE,CAAA;IACb,KAAK,CAAC,aAAa,GAAG,UAAU,CAAA;IAEhC,OAAO,KAAoB,CAAA;CAC5B;;6BCtJuB,YAA6B,EAAE,MAAc,EAAE,WAA+B,EAAE,QAAkB;IACxH,QAAQ,MAAM,CAAC,IAAI;QAEjB,KAAK,mBAAmB;YACtB,OAAO,UAAU,CAAC,YAAY,EAAE,MAAM,CAAC,OAAO,EAAE,WAAW,GAAG,WAAW,CAAC,WAAW,GAAG,IAAI,EAAE,QAAQ,CAAC,CAAA;QAEzG,KAAK,qBAAqB;YACxB,OAAO,YAAY,CAAC,YAAY,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAA;QAEpD,KAAK,MAAM,CAAC;QACZ,KAAK,MAAM,CAAC;QACZ,KAAK,UAAU,CAAC;QAChB,KAAK,eAAe;YAClB,IAAI,WAAW,EAAE;gBACf,OAAO,iBAAiB,CAAC,YAAY,EAAE,WAAW,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;aAC1E;iBAAM;gBACL,OAAO,YAAY,CAAA;aACpB;QAEH,KAAK,qBAAqB,CAAC;QAC3B,KAAK,iBAAiB;YACpB,OAAO,iBAAiB,CACtB,YAAY,EACX,MAAc,CAAC,SAAS;gBACvB,WAAW,CAAE,MAAc,CAAC,SAAS,CAAC;gBACtC,oBAAoB,CAAC,YAAY,EAAE,QAAQ,CAAC,EAC9C,WAAW,GAAG,WAAW,CAAC,WAAW,GAAG,IAAI,EAC5C,QAAQ,CACT,CAAA;QAEH,KAAK,gBAAgB,CAAC;QACtB,KAAK,qBAAqB;YACxB,OAAO,eAAe,CAAC,YAAY,EAAE,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,UAAU,CAAC,CAAA;QAE1F,KAAK,0BAA0B;YAC7B,OAAO,EAAE,CAAA;QAEX;YACE,OAAO,YAAY,CAAA;KACtB;CACF;AAGD,IAAIA,KAAG,GAAG,CAAC,CAAA;AAGX,SAAS,UAAU,CAAC,eAAgC,EAAE,OAAsB,EAAE,UAA4B,EAAE,QAAkB;IAC5H,IAAI,IAAI,GAAoB,EAAE,CAAA;IAE9B,KAAmB,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAO,EAAE;QAAvB,IAAI,MAAM,gBAAA;QACb,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAA;KAC/B;IAED,IAAI,UAAU,EAAE;QACd,IAAI,GAAG,iBAAiB,CAAC,IAAI,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAA;KACrD;IAED,oBAAY,eAAe,EAAK,IAAI,EAAE;CACvC;AAGD,SAAS,YAAY,CAAC,eAAgC,EAAE,QAAgB;IACtE,OAAO,UAAU,CAAC,eAAe,EAAE,UAAS,WAAwB;QAClE,OAAO,WAAW,CAAC,QAAQ,KAAK,QAAQ,CAAA;KACzC,CAAC,CAAA;CACH;AAGD,SAAS,iBAAiB,CAAC,UAA2B,EAAE,UAAqB,EAAE,QAAkB;IAC/F,OAAO,iBAAiB,CACtB,UAAU,EACV,UAAU,CAAC,UAAU,EAAE,UAAS,WAAW;QACzC,OAAO,aAAa,CAAC,WAAW,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAA;KACxD,CAAC,EACF,UAAU,EACV,QAAQ,CACT,CAAA;CACF;AAGD,SAAS,aAAa,CAAC,WAAwB,EAAE,UAAqB,EAAE,QAAkB;IAExF,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,QAAQ,CAAC,EAAE;QAC/C,OAAO,CAAC,WAAW,CAAC,aAAa,CAAA;KAClC;SAAM;QACL,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,cAAc,CAAC;YAClC,CAAC,WAAW,CAAC,UAAU;YACvB,UAAU,CAAC,KAAK,GAAG,WAAW,CAAC,UAAU,CAAC,KAAK;YAC/C,UAAU,CAAC,GAAG,GAAG,WAAW,CAAC,UAAU,CAAC,GAAG,CAAA;KAC9C;CACF;AAGD,SAAS,iBAAiB,CACxB,WAA4B,EAC5B,YAAyC,EACzC,UAAqB,EACrB,QAAkB;IAElB,IAAI,WAAW,GAAoB,EAAE,CAAA;IAErC,KAAK,IAAI,QAAQ,IAAI,WAAW,EAAE;QAChC,IAAI,MAAM,GAAG,WAAW,CAAC,QAAQ,CAAC,CAAA;QAElC,IAAI,YAAY,CAAC,QAAQ,CAAC,EAAE;YAC1B,WAAW,CAAC,QAAQ,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAA;SAClE;aAAM;YACL,WAAW,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAA;SAC/B;KACF;IAED,OAAO,WAAW,CAAA;CACnB;AAGD,SAAS,WAAW,CAAC,WAAwB,EAAE,UAAqB,EAAE,QAAkB;IACtF,IAAI,SAAS,GAAG,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,eAAe,CAAC,WAAW,CAAC,WAAW,CAAC,CAAA;IACpF,IAAI,OAAO,GAAG,MAAM,CAACA,KAAG,EAAE,CAAC,CAAA;IAE3B,SAAS,CAAC,KAAK,CACb;QACE,WAAW,aAAA;QACX,QAAQ,UAAA;QACR,KAAK,EAAE,UAAU;KAClB,EACD,UAAS,GAAG;QACJ,IAAA,yBAAS,CAAQ;QACvB,IAAI,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAA;QACnD,IAAI,aAAa,CAAA;QACjB,IAAI,gBAAgB,CAAA;QAEpB,IAAI,WAAW,CAAC,OAAO,EAAE;YACvB,gBAAgB,GAAG,WAAW,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,CAAC,GAAG,CAAC,CAAA;SAC3D;QACD,IAAI,UAAU,EAAE;YACd,aAAa,GAAG,UAAU,CAAC,SAAS,EAAE,GAAG,CAAC,GAAG,CAAC,CAAA;SAC/C;QAED,SAAS,GAAG,gBAAgB,IAAI,aAAa,IAAI,SAAS,CAAA;QAE1D,QAAQ,CAAC,QAAQ,CAAC;YAChB,IAAI,EAAE,gBAAgB;YACtB,QAAQ,EAAE,WAAW,CAAC,QAAQ;YAC9B,OAAO,SAAA;YACP,UAAU,YAAA;YACV,SAAS,WAAA;SACV,CAAC,CAAA;KACH,EACD,UAAS,KAAK;QACZ,IAAI,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAA;QAEpD,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,CAAA;QAElC,IAAI,WAAW,CAAC,OAAO,EAAE;YACvB,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAA;SAC3B;QACD,IAAI,WAAW,EAAE;YACf,WAAW,CAAC,KAAK,CAAC,CAAA;SACnB;QAED,QAAQ,CAAC,QAAQ,CAAC;YAChB,IAAI,EAAE,qBAAqB;YAC3B,QAAQ,EAAE,WAAW,CAAC,QAAQ;YAC9B,OAAO,SAAA;YACP,UAAU,YAAA;YACV,KAAK,OAAA;SACN,CAAC,CAAA;KACH,CACF,CAAA;IAED,oBACK,WAAW,IACd,UAAU,EAAE,IAAI,EAChB,aAAa,EAAE,OAAO,IACvB;CACF;AAGD,SAAS,eAAe,CAAC,UAA2B,EAAE,QAAgB,EAAE,OAAe,EAAE,UAAqB;;IAC5G,IAAI,WAAW,GAAgB,UAAU,CAAC,QAAQ,CAAC,CAAA;IAEnD,IACE,WAAW;QACX,OAAO,KAAK,WAAW,CAAC,aAAa,EACrC;QACA,oBACK,UAAU,eACZ,QAAQ,iBACJ,WAAW,IACd,UAAU,EAAE,KAAK,EACjB,UAAU,YAAA,UAEb;KACF;IAED,OAAO,UAAU,CAAA;CAClB;AAGD,SAAS,oBAAoB,CAAC,YAA6B,EAAE,QAAkB;IAC7E,OAAO,UAAU,CAAC,YAAY,EAAE,UAAS,WAAW;QAClD,OAAO,mBAAmB,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAA;KAClD,CAAC,CAAA;CACH;;AC3LD;IASE,8BAAY,QAAkB,EAAE,QAAkB;QAChD,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;QACxB,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAA;QAC/B,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAA;QAC/B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;QAExB,IAAI,CAAC,cAAc,EAAE,CAAA;KACtB;IAQD,wCAAS,GAAT,UAAU,kBAA+B,EAAE,WAAuB;QAC1D,IAAA,sBAAO,CAAS;QAEtB,IAAI,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAC7B,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,kBAAkB,CAAC,gBAAgB,CAAC;QACjE,kBAAkB,CAAC,aAAa,CACjC,CAAA;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAA;KAChC;IAID,wCAAS,GAAT,UAAU,kBAA+B,EAAE,WAAuB;QAC1D,IAAA,sBAAO,CAAS;QAEtB,IAAI,QAAQ,GAAG,OAAO,CAAC,GAAG,CACxB,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,kBAAkB,CAAC,gBAAgB,CAAC;QACjE,kBAAkB,CAAC,aAAa,CACjC,CAAA;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAA;KAC/B;IAMD,oCAAK,GAAL,UAAM,WAAuB,EAAE,SAAU,EAAE,YAAoB;QAApB,6BAAA,EAAA,oBAAoB;QAC7D,IAAI,UAAqB,CAAA;QACzB,IAAI,OAAO,GAAG,IAAI,CAAA;QAClB,IAAI,OAAO,GAAG,IAAI,CAAA;QAClB,IAAI,WAAW,CAAA;QACf,IAAI,aAAa,CAAA;QACjB,IAAI,WAAsB,CAAA;QAC1B,IAAI,WAAsB,CAAA;QAC1B,IAAI,OAAO,CAAA;QAEX,UAAU,GAAG,IAAI,CAAC,eAAe,EAAE,CAAA;QACnC,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAA;QAE5C,IAAI,YAAY,EAAE;YAChB,WAAW,GAAG,sBAAsB,CAAC,WAAW,EAAE,UAAU,CAAC,CAAA;SAC9D;QAED,WAAW,GAAG,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,SAAS,CAAC,CAAA;QAChE,aAAa,GAAG,yBAAyB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAA;QAChE,WAAW,GAAG,IAAI,CAAC,gBAAgB,CACjC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,CAAC,EACtC,WAAW,CAAC,IAAI,EAChB,aAAa,CACd,CAAA;QACD,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAA;QAC9C,WAAW,GAAG,WAAW,CAAA;QAEzB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,mBAAmB,EAAE;YACrC,WAAW,GAAG,eAAe,CAAC,WAAW,EAAE,WAAW,CAAC,KAAK,CAAC,CAAA;SAC9D;QAED,OAAO,GAAG,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;QAC9C,OAAO,GAAG,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;QAC9C,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,OAAO,EAAE,OAAO,CAAC,CAAA;QACnE,WAAW,GAAG,eAAe,CAAC,WAAW,EAAE,UAAU,CAAC,CAAA;QAItD,OAAO,GAAG,eAAe,CAAC,WAAW,CAAC,KAAK,EAAE,UAAU,CAAC,CAAA;QAExD,OAAO;YAGL,UAAU,EAAE,UAAU;YAItB,YAAY,EAAE,WAAW,CAAC,KAAK;YAG/B,gBAAgB,EAAE,WAAW,CAAC,IAAI;YAElC,aAAa,eAAA;YAIb,WAAW,aAAA;YAIX,WAAW,aAAA;YAGX,OAAO,SAAA;YAGP,OAAO,SAAA;YAEP,OAAO,SAAA;YAGP,aAAa,EAAE,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,QAAQ,CAAC;SAE7D,CAAA;KACF;IAMD,8CAAe,GAAf;QACE,OAAO,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;YAC9D,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,CAAA;KAC7B;IAOD,oDAAqB,GAArB,UAAsB,IAAgB,EAAE,SAAS;QAC3C,IAAA,SAA4B,EAA1B,sBAAQ,EAAE,oBAAgB,CAAA;QAChC,IAAI,QAAQ,GAAG,IAAI,CAAA;QACnB,IAAI,IAAI,GAAG,IAAI,CAAA;QACf,IAAI,KAAK,GAAG,IAAI,CAAA;QAChB,IAAI,QAAQ,CAAA;QAEZ,IAAI,QAAQ,CAAC,QAAQ,EAAE;YACrB,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAA;YAC5B,IAAI,GAAG,QAAQ,CAAC,YAAY,CAAA;YAC5B,KAAK,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAA;SACrE;aAAM,KAAK,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG;YAC7C,IAAI,GAAG,KAAK,CAAA;YACZ,KAAK,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAA;SAC/D;aAAM,KAAK,KAAK,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,GAAG;YACvD,IAAI,GAAG,OAAO,CAAC,iBAAiB,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAA;SAC9D;aAAM;YACL,QAAQ,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAA;YACrC,IAAI,GAAG,2BAA2B,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAA;YACjD,KAAK,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAA;SACrE;QAED,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,OAAA,EAAE,CAAA;KACjD;IAGD,kDAAmB,GAAnB;QACE,OAAO,cAAc,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,CAAA;KAClC;IAKD,gDAAiB,GAAjB,UAAkB,KAAgB,EAAE,OAAiB,EAAE,OAAiB;QAChE,IAAA,sBAAO,CAAS;QACtB,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,CAAA;QACvB,IAAI,GAAG,GAAG,KAAK,CAAC,GAAG,CAAA;QAEnB,IAAK,IAAI,CAAC,QAAQ,CAAC,KAAa,CAAC,SAAS,CAAC,cAAc,EAAE;YAGzD,IAAI,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBAC5B,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAA;gBACzB,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,CAAA;aACpC;YAGD,IAAI,WAAW,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBAC5B,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC,CAAA;gBACrB,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAA;gBACtB,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;aAChC;SACF;QAED,OAAO,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,CAAA;KACtB;IAKD,qDAAsB,GAAtB,UAAuB,IAAgB,EAAE,SAAS,EAAE,QAAkB,EAAE,IAAI;QACpE,IAAA,sBAAO,CAAS;QACtB,IAAI,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAA;QAC1C,IAAI,kBAAkB,CAAA;QACtB,IAAI,qBAAqB,CAAA;QACzB,IAAI,KAAiB,CAAA;QACrB,IAAI,GAAe,CAAA;QACnB,IAAI,GAAG,CAAA;QAGP,IAAI,CAAC,SAAS,EAAE;YACd,kBAAkB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAA;YAE/C,IAAI,kBAAkB,EAAE;gBACtB,qBAAqB,GAAG,cAAc,CAAC,kBAAkB,CAAC,CAAA;gBAG1D,IAAI,SAAS,CAAC,qBAAqB,CAAC,GAAG,SAAS,CAAC,QAAQ,CAAC,EAAE;oBAC1D,SAAS,GAAG,2BAA2B,CACrC,qBAAqB,EACrB,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,CACvC,CAAC,IAAI,CAAA;iBACP;qBAAM;oBACL,SAAS,GAAG,IAAI,CAAA;iBACjB;aACF;iBAAM;gBACL,SAAS,GAAG,IAAI,CAAA;aACjB;SACF;QAGD,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YAC9B,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;gBAC3B,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,SAAS,CAAC,CAAA;gBAC7C,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAA;aAC1B;SACF;QAED,SAAS,UAAU;YACjB,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;YACxC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAA;YAClC,GAAG,GAAG,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,CAAA;SACrB;QAED,UAAU,EAAE,CAAA;QAGZ,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;YAC7B,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;YAC3C,UAAU,EAAE,CAAA;SACb;QAED,OAAO,GAAG,CAAA;KACX;IAID,qDAAsB,GAAtB,UAAuB,IAAgB,EAAE,SAAS,EAAE,QAAQ;QACpD,IAAA,sBAAO,CAAS;QACtB,IAAI,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAA;QAChD,IAAI,YAAY,GAAG,CAAC,CAAA;QACpB,IAAI,KAAK,GAAe,IAAI,CAAA;QAC5B,IAAI,GAAe,CAAA;QAEnB,IAAI,eAAe,EAAE;YACnB,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,EAAE,eAAe,CAAC,CAAA;SAChD;QAED,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAA;QACzB,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,SAAS,CAAC,CAAA;QAE7C,GAAG,GAAG,KAAK,CAAA;QACX,GAAG;YACD,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAA;YACrB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE;gBAC1B,YAAY,EAAE,CAAA;aACf;SACF,QAAQ,YAAY,GAAG,QAAQ,EAAC;QAEjC,OAAO,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,CAAA;KACtB;IAKD,sDAAuB,GAAvB,UAAwB,IAAgB;QAChC,IAAA,sBAAO,CAAS;QACtB,IAAI,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAA;QAE5E,IAAI,YAAY,KAAK,YAAY,CAAC,KAAK,IAAI,IAAI,IAAI,YAAY,CAAC,GAAG,IAAI,IAAI,CAAC,EAAE;YAC5E,OAAO,IAAI,CAAA;SACZ;QAED,OAAO,YAAY,CAAA;KACpB;IAMD,+CAAgB,GAAhB,UAAiB,YAAuB,EAAE,gBAAgB,EAAE,aAAa;QACvE,OAAO,YAAY,CAAA;KACpB;IAKD,iDAAkB,GAAlB,UAAmB,QAAQ;QACzB,IAAI,kBAAkB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAA;QACnD,IAAI,eAAe,CAAA;QAEnB,IAAI,kBAAkB,EAAE;YACtB,OAAO,cAAc,CAAC,kBAAkB,CAAC,CAAA;SAC1C;aAAM,KAAK,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,GAAG;YACzD,OAAO,cAAc,CAAC,CAAC,EAAE,eAAe,CAAC,CAAA;SAC1C;aAAM,IAAI,QAAQ,EAAE;YACnB,OAAO,QAAQ,CAAA;SAChB;aAAM;YACL,OAAO,cAAc,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAA;SACnC;KACF;IAMD,6CAAc,GAAd,UAAe,IAAI;QAAE,mBAAY;aAAZ,UAAY,EAAZ,qBAAY,EAAZ,IAAY;YAAZ,kCAAY;;QAC/B,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;QAE5B,IAAI,OAAO,GAAG,KAAK,UAAU,EAAE;YAC7B,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;SACjC;QAED,IAAI,GAAG,EAAE;YACP,GAAG,GAAG,UAAU,CAAC,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;SACpC;QAED,IAAI,GAAG,EAAE;YACP,GAAG,GAAG,sBAAsB,CAAC,GAAG,CAAC,CAAA;SAClC;QAED,OAAO,GAAG,CAAA;KACX;IAQD,6CAAc,GAAd;QACE,IAAI,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAA;QAC9C,IAAI,eAAe,GAAG,EAAE,CAAA;QACxB,IAAI,MAAM,GAAG,CAAC,CAAA;QACd,IAAI,CAAC,CAAA;QAEL,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,KAAK,EAAE;YACnC,UAAU,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;SACtB;QAED,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YACtB,IACE,EAAE,eAAe,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EACpD;gBACA,MAAM,EAAE,CAAA;aACT;SACF;QAED,IAAI,CAAC,MAAM,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAA;SACtC;QAED,IAAI,CAAC,eAAe,GAAG,eAAe,CAAA;KACvC;IAKD,6CAAc,GAAd,UAAe,KAAgB;QAC7B,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,CAAA;QACvB,IAAI,GAAG,GAAG,KAAK,CAAC,GAAG,CAAA;QAEnB,IAAI,KAAK,EAAE;YACT,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAA;SACnC;QAED,IAAI,GAAG,EAAE;YACP,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAA;SACzC;QAED,IAAI,KAAK,IAAI,IAAI,IAAI,GAAG,IAAI,IAAI,IAAI,KAAK,GAAG,GAAG,EAAE;YAC/C,OAAO,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,CAAA;SACtB;QAED,OAAO,IAAI,CAAA;KACZ;IAKD,0CAAW,GAAX,UAAY,GAAG;QACb,IAAI,GAAG,YAAY,IAAI,EAAE;YACvB,GAAG,GAAG,GAAG,CAAC,SAAS,EAAE,CAAA;SACtB;QACD,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAA;KACjC;IAQD,6CAAc,GAAd,UAAe,IAAgB,EAAE,GAAO,EAAE,WAAmB;QAA5B,oBAAA,EAAA,OAAO;QAAE,4BAAA,EAAA,mBAAmB;QAC3D,OACE,IAAI,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,WAAW,GAAG,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAC1E;YACA,IAAI,GAAG,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;SAC1B;QACD,OAAO,IAAI,CAAA;KACZ;IAEH,2BAAC;CAAA,IAAA;SAIe,mBAAmB,CAAC,EAAe,EAAE,EAAe;IAClE,OAAO,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC;QAC9C,WAAW,CAAC,EAAE,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,CAAC;QAC3C,WAAW,CAAC,EAAE,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,CAAC;QAC3C,cAAc,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC;QACtC,cAAc,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,CAAA;CASzC;;iBCtcuB,KAAoB,EAAE,MAAc,EAAE,QAAkB;IAE9E,IAAI,QAAQ,GAAG,cAAc,CAAC,KAAK,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAA;IACrD,IAAI,WAAW,GAAG,iBAAiB,CAAC,KAAK,CAAC,WAAW,EAAE,MAAM,EAAE,KAAK,CAAC,WAAW,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAA;IACrG,IAAI,YAAY,GAAG,kBAAkB,CAAC,KAAK,CAAC,YAAY,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAA;IAExF,IAAI,SAAS,gBACR,KAAK,IACR,QAAQ,UAAA;QACR,WAAW,aAAA,EACX,WAAW,EAAE,iBAAiB,CAAC,KAAK,CAAC,WAAW,EAAE,MAAM,EAAE,WAAW,CAAC,EACtE,YAAY,cAAA,EACZ,UAAU,EAAE,gBAAgB,CAAC,KAAK,CAAC,UAAU,EAAE,MAAM,EAAE,YAAY,EAAE,WAAW,EAAE,QAAQ,CAAC,EAC3F,aAAa,EAAE,mBAAmB,CAAC,KAAK,CAAC,aAAa,EAAE,MAAM,EAAE,QAAQ,CAAC,EACzE,cAAc,EAAE,mBAAmB,CAAC,KAAK,CAAC,cAAc,EAAE,MAAM,CAAC,EACjE,SAAS,EAAE,eAAe,CAAC,KAAK,CAAC,SAAS,EAAE,MAAM,EAAE,YAAY,EAAE,QAAQ,CAAC,EAC3E,WAAW,EAAE,iBAAiB,CAAC,KAAK,CAAC,WAAW,EAAE,MAAM,EAAE,YAAY,EAAE,QAAQ,CAAC,EACjF,uBAAuB,EAAE,mBAAmB,CAAC,YAAY,CAAC,EAC1D,YAAY,EAAE,mBAAmB,CAAC,YAAY,CAAC,GAChD,CAAA;IAED,KAAwB,UAAoC,EAApC,KAAA,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,EAApC,cAAoC,EAApC,IAAoC,EAAE;QAAzD,IAAI,WAAW,SAAA;QAClB,SAAS,GAAG,WAAW,CAAC,SAAS,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAA;KACrD;IAID,OAAO,SAAS,CAAA;CACjB;AAED,SAAS,cAAc,CAAC,eAAuB,EAAE,MAAc;IAC7D,QAAQ,MAAM,CAAC,IAAI;QACjB,KAAK,eAAe;YAClB,OAAO,MAAM,CAAC,QAAQ,CAAA;QACxB;YACE,OAAO,eAAe,CAAA;KACzB;CACF;AAED,SAAS,iBAAiB,CAAC,kBAAsC,EAAE,MAAc,EAAE,WAAuB,EAAE,QAAgB,EAAE,QAAkB;IAC9I,IAAI,cAA2B,CAAA;IAE/B,QAAQ,MAAM,CAAC,IAAI;QAEjB,KAAK,MAAM;YACT,cAAc,GAAG,QAAQ,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAA;YACpG,MAAK;QAEP,KAAK,MAAM;YACT,cAAc,GAAG,QAAQ,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAA;YACpG,MAAK;QAEP,KAAK,UAAU;YACb,IACE,CAAC,kBAAkB,CAAC,WAAW;gBAC/B,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,YAAY,EAAE,MAAM,CAAC,UAAU,CAAC,EACxE;gBACA,cAAc,GAAG,QAAQ,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC,KAAK,CAC7D,MAAM,CAAC,UAAU,EACjB,SAAS,EACT,IAAI;iBACL,CAAA;aACF;YACD,MAAK;QAEP,KAAK,eAAe;YAClB,IAAI,SAAS,GAAG,QAAQ,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAA;YAExD,IAAI,CAAC,SAAS,EAAE;gBACd,MAAM,IAAI,KAAK,CACb,QAAQ;oBACN,yBAAyB,GAAG,QAAQ,GAAG,gEAAgE;oBACvG,yCAAyC,CAC5C,CAAA;aACF;YAED,cAAc,GAAG,SAAS,CAAC,KAAK,CAC9B,MAAM,CAAC,UAAU,IAAI,WAAW,EAChC,SAAS,EACT,IAAI;aACL,CAAA;YACD,MAAK;KACR;IAED,IACE,cAAc;QACd,cAAc,CAAC,OAAO;QACtB,EAAE,kBAAkB,IAAI,mBAAmB,CAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC,EAChF;QACA,OAAO,cAAc,CAAA;KACtB;SAAM;QACL,OAAO,kBAAkB,CAAA;KAC1B;CACF;AAED,SAAS,iBAAiB,CAAC,WAAuB,EAAE,MAAc,EAAE,WAAwB;IAC1F,QAAQ,MAAM,CAAC,IAAI;QAEjB,KAAK,MAAM,CAAC;QACZ,KAAK,MAAM;YACT,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,YAAY,EAAE,WAAW,CAAC,EAAE;gBAC/D,OAAO,WAAW,CAAC,YAAY,CAAC,KAAK,CAAA;aACtC;iBAAM;gBACL,OAAO,WAAW,CAAA;aACnB;QAEH,KAAK,UAAU,CAAC;QAChB,KAAK,eAAe;YAClB,IAAI,OAAO,GAAG,MAAM,CAAC,UAAU,IAAI,WAAW,CAAA;YAC9C,IAAI,WAAW,CAAC,WAAW,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,WAAW,EAAE,OAAO,CAAC,EAAE;gBACrF,OAAO,WAAW,CAAC,YAAY,CAAC,KAAK,CAAA;aACtC;iBAAM;gBACL,OAAO,OAAO,CAAA;aACf;QAEH;YACE,OAAO,WAAW,CAAA;KACrB;CACF;AAED,SAAS,mBAAmB,CAAC,gBAAiC,EAAE,MAAc,EAAE,QAAkB;IAChG,QAAQ,MAAM,CAAC,IAAI;QACjB,KAAK,cAAc;YACjB,OAAO,MAAM,CAAC,SAAS,CAAA;QACzB,KAAK,gBAAgB;YACnB,OAAO,IAAI,CAAA;QACb;YACE,OAAO,gBAAgB,CAAA;KAC1B;CACF;AAED,SAAS,mBAAmB,CAAC,iBAAyB,EAAE,MAAc;IACpE,QAAQ,MAAM,CAAC,IAAI;QACjB,KAAK,cAAc;YACjB,OAAO,MAAM,CAAC,eAAe,CAAA;QAC/B,KAAK,gBAAgB;YACnB,OAAO,EAAE,CAAA;QACX;YACE,OAAO,iBAAiB,CAAA;KAC3B;CACF;AAED,SAAS,eAAe,CAAC,WAAyC,EAAE,MAAc,EAAE,OAAwB,EAAE,QAAkB;IAC9H,QAAQ,MAAM,CAAC,IAAI;QAEjB,KAAK,gBAAgB;YACnB,IAAI,OAAO,GAAG,MAAM,CAAC,KAAK,CAAA;YAE1B,OAAO;gBACL,cAAc,EAAE,OAAO,CAAC,cAAc;gBACtC,aAAa,EAAE,OAAO,CAAC,aAAa;gBACpC,OAAO,EAAE,OAAO,CAAC,OAAO;gBACxB,OAAO,EAAE,OAAO,CAAC,OAAO;aACzB,CAAA;QAEH,KAAK,kBAAkB;YACrB,OAAO,IAAI,CAAA;QAEb;YACE,OAAO,WAAW,CAAA;KACrB;CACF;AAED,SAAS,iBAAiB,CAAC,aAA2C,EAAE,MAAc,EAAE,OAAwB,EAAE,QAAkB;IAClI,QAAQ,MAAM,CAAC,IAAI;QAEjB,KAAK,kBAAkB;YACrB,IAAI,SAAS,GAAG,MAAM,CAAC,KAAK,CAAA;YAE5B,OAAO;gBACL,cAAc,EAAE,SAAS,CAAC,cAAc;gBACxC,aAAa,EAAE,SAAS,CAAC,aAAa;gBACtC,OAAO,EAAE,SAAS,CAAC,OAAO;gBAC1B,OAAO,EAAE,SAAS,CAAC,OAAO;aAC3B,CAAA;QAEH,KAAK,oBAAoB;YACvB,OAAO,IAAI,CAAA;QAEb;YACE,OAAO,aAAa,CAAA;KACvB;CACF;AAED,SAAS,mBAAmB,CAAC,YAA6B;IACxD,IAAI,GAAG,GAAG,CAAC,CAAA;IAEX,KAAK,IAAI,QAAQ,IAAI,YAAY,EAAE;QACjC,IAAI,YAAY,CAAC,QAAQ,CAAC,CAAC,UAAU,EAAE;YACrC,GAAG,EAAE,CAAA;SACN;KACF;IAED,OAAO,GAAG,CAAA;CACX;;ACzJD,IAAM,cAAc,GAAG;IACrB,KAAK,EAAE,IAAI;IACX,GAAG,EAAE,IAAI;IACT,MAAM,EAAE,OAAO;CAChB,CAAA;AAED,SAAgB,aAAa,CAAC,GAAkB,EAAE,OAAgB,EAAE,eAA0B;IAC5F,IAAI,IAAI,GAAG,iBAAiB,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;IACpC,IAAA,kBAAK,CAAS;IAEpB,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;QAChB,OAAO,IAAI,CAAA;KACZ;IAED,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE;QACd,IAAI,eAAe,IAAI,IAAI,EAAE;YAC3B,OAAO,IAAI,CAAA;SACZ;aAAM;YACL,KAAK,CAAC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,EAAE,eAAe,CAAC,CAAA;SACtD;KACF;IAED,OAAO,IAAgB,CAAA;CACxB;AAMD,SAAgB,iBAAiB,CAAC,GAAsB,EAAE,OAAgB;IACxE,IAAI,SAAS,GAAG,EAAc,CAAA;IAC9B,IAAI,aAAa,GAAG,WAAW,CAAC,GAAG,EAAE,cAAc,EAAE,EAAE,EAAE,SAAS,CAAC,CAAA;IACnE,IAAI,SAAS,GAAG,aAAa,CAAC,KAAK,GAAG,OAAO,CAAC,gBAAgB,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,IAAI,CAAA;IAC1F,IAAI,OAAO,GAAG,aAAa,CAAC,GAAG,GAAG,OAAO,CAAC,gBAAgB,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,IAAI,CAAA;IACpF,IAAI,MAAM,GAAG,aAAa,CAAC,MAAM,CAAA;IAEjC,IAAI,MAAM,IAAI,IAAI,EAAE;QAClB,MAAM,GAAG,CAAC,SAAS,IAAI,SAAS,CAAC,iBAAiB;aAC/C,CAAC,OAAO,IAAI,OAAO,CAAC,iBAAiB,CAAC,CAAA;KAC1C;IAGD,SAAS,CAAC,KAAK,GAAG;QAChB,KAAK,EAAE,SAAS,GAAG,SAAS,CAAC,MAAM,GAAG,IAAI;QAC1C,GAAG,EAAE,OAAO,GAAG,OAAO,CAAC,MAAM,GAAG,IAAI;KACrC,CAAA;IACD,SAAS,CAAC,MAAM,GAAG,MAAM,CAAA;IAEzB,OAAO,SAAS,CAAA;CACjB;AAED,SAAgB,gBAAgB,CAAC,KAAe,EAAE,KAAe;IAC/D,OAAO,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC;QAC1C,KAAK,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM;QAC7B,gBAAgB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;CACjC;AAGD,SAAS,gBAAgB,CAAC,KAAe,EAAE,KAAe;IAExD,KAAK,IAAI,QAAQ,IAAI,KAAK,EAAE;QAC1B,IAAI,QAAQ,KAAK,OAAO,IAAI,QAAQ,KAAK,QAAQ,EAAE;YACjD,IAAI,KAAK,CAAC,QAAQ,CAAC,KAAK,KAAK,CAAC,QAAQ,CAAC,EAAE;gBACvC,OAAO,KAAK,CAAA;aACb;SACF;KACF;IAID,KAAK,IAAI,QAAQ,IAAI,KAAK,EAAE;QAC1B,IAAI,EAAE,QAAQ,IAAI,KAAK,CAAC,EAAE;YACxB,OAAO,KAAK,CAAA;SACb;KACF;IAED,OAAO,IAAI,CAAA;CACZ;AAED,SAAgB,gBAAgB,CAAC,IAAc,EAAE,OAAgB;IAC/D,OAAO;QACL,KAAK,EAAE,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;QACvC,GAAG,EAAE,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC;QACnC,QAAQ,EAAE,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC;QACxE,MAAM,EAAE,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC;QACpE,MAAM,EAAE,IAAI,CAAC,MAAM;KACpB,CAAA;CACF;AAED,SAAgB,iBAAiB,CAAC,IAAc,EAAE,OAAgB;IAChE,OAAO;QACL,IAAI,EAAE,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;QACtC,OAAO,EAAE,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC;QACvE,MAAM,EAAE,IAAI,CAAC,MAAM;KACpB,CAAA;CACF;AAED,SAAgB,mBAAmB,CAAC,QAAkB,EAAE,YAAyB,EAAE,QAAkB;IACnG,IAAI,GAAG,GAAG,aAAa,CACrB,EAAE,QAAQ,EAAE,KAAK,EAAE,EACnB,EAAE;IACF,QAAQ,CAAC,MAAM,EACf,IAAI;IACJ,QAAQ,CACT,CAAA;IAED,OAAO;QACL,GAAG,KAAA;QACH,EAAE,EAAE,cAAc,CAAC,GAAG,EAAE,YAAY,CAAC;QACrC,QAAQ,EAAE,mBAAmB,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,KAAK,CAAC;QACxD,KAAK,EAAE,QAAQ,CAAC,KAAK;QACrB,OAAO,EAAE,IAAI;QACb,KAAK,EAAE,IAAI;KACZ,CAAA;CACF;;SCvJe,eAAe,CAAC,cAA8B,EAAE,eAA+B;IAC7F,IAAI,IAAI,GAAgB,EAAE,CAAA;IAC1B,IAAI,QAAgB,CAAA;IAEpB,KAAK,QAAQ,IAAI,cAAc,EAAE;QAC/B,aAAa,CAAC,QAAQ,EAAE,IAAI,EAAE,cAAc,EAAE,eAAe,CAAC,CAAA;KAC/D;IAED,KAAK,QAAQ,IAAI,eAAe,EAAE;QAChC,aAAa,CAAC,QAAQ,EAAE,IAAI,EAAE,cAAc,EAAE,eAAe,CAAC,CAAA;KAC/D;IAED,OAAO,IAAI,CAAA;CACZ;AAED,SAAS,aAAa,CAAC,QAAgB,EAAE,IAAiB,EAAE,cAA8B,EAAE,eAA+B;IACzH,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE;QAClB,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAA;KACtB;IAED,IAAI,OAAO,GAAG,YAAY,CAAC,QAAQ,EAAE,IAAI,EAAE,cAAc,EAAE,eAAe,CAAC,CAAA;IAE3E,IAAI,OAAO,EAAE;QACX,IAAI,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAA;KACzB;IAED,OAAO,OAAO,CAAA;CACf;AAED,SAAS,YAAY,CAAC,QAAgB,EAAE,IAAiB,EAAE,cAA8B,EAAE,eAA+B;IACxH,IAAI,aAAa,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAA;IAC5C,IAAI,cAAc,GAAG,eAAe,CAAC,QAAQ,CAAC,CAAA;IAE9C,IAAI,SAAS,GAAG,UAAS,IAAI;QAC3B,OAAO,CAAC,aAAa,IAAI,aAAa,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,aAAa,CAAC,IAAI,CAAC;aACzE,CAAC,cAAc,IAAI,cAAc,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,cAAc,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAA;KACpF,CAAA;IAED,IAAI,QAAQ,GAAG,SAAS,CAAC,OAAO,CAAc,CAAA;IAC9C,IAAI,SAAS,GAAG,SAAS,CAAC,WAAW,CAAW,CAAA;IAEhD,IAAI,CAAC,SAAS,IAAI,QAAQ,EAAE;QAC1B,SAAS;YACP,sBAAsB,CAAC,QAAQ,EAAE,eAAe,CAAC;gBACjD,sBAAsB,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAA;KACnD;IAED,IAAI,QAAQ,GAAmB,IAAI,CAAA;IAEnC,IAAI,SAAS,EAAE;QAEb,IAAI,SAAS,KAAK,QAAQ,EAAE;YAC1B,MAAM,IAAI,KAAK,CAAC,uDAAuD,CAAC,CAAA;SACzE;QAED,QAAQ,GAAG,aAAa,CAAC,SAAS,EAAE,IAAI,EAAE,cAAc,EAAE,eAAe,CAAC,CAAA;KAC3E;IAED,IAAI,CAAC,QAAQ,IAAI,QAAQ,EAAE;QACzB,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAA;KAC1B;IAED,IAAI,CAAC,QAAQ,EAAE;QACb,OAAO,IAAI,CAAA;KACZ;IAED,OAAO;QACL,IAAI,EAAE,QAAQ;QACd,KAAK,EAAE,QAAQ;QACf,QAAQ,gBACF,QAAQ,GAAG,QAAQ,CAAC,QAAQ,GAAG,EAAE,IACjC,aAAa,GAAG,aAAa,CAAC,OAAO,GAAG,EAAE,EAC/C;QACD,SAAS,gBACH,QAAQ,GAAG,QAAQ,CAAC,SAAS,GAAG,EAAE,IAClC,cAAc,GAAG,cAAc,CAAC,OAAO,GAAG,EAAE,EACjD;KACF,CAAA;CACF;AAED,SAAS,sBAAsB,CAAC,YAAuB,EAAE,OAAuB;IAC9E,IAAI,UAAU,GAAG,MAAM,CAAC,cAAc,CAAC,YAAY,CAAC,SAAS,CAAC,CAAA;IAE9D,KAAK,IAAI,QAAQ,IAAI,OAAO,EAAE;QAC5B,IAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAA;QAG9B,IAAI,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,SAAS,KAAK,UAAU,EAAE;YACzD,OAAO,QAAQ,CAAA;SAChB;KACF;IAED,OAAO,EAAE,CAAA;CACV;;SCtEe,gBAAgB,CAAC,MAA2B;IAC1D,OAAO,OAAO,CAAC,MAAM,EAAE,eAAe,CAAC,CAAA;CACxC;AAED,IAAM,cAAc,GAAG;IACrB,IAAI,EAAE,MAAM;IACZ,KAAK,EAAE,IAAI;CACZ,CAAA;AAED,SAAS,eAAe,CAAC,KAAsB;IAC7C,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;QAC/B,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAA;KACzB;IAED,IAAI,OAAO,GAAG,EAAE,CAAA;IAChB,IAAI,KAAK,GAAG,WAAW,CAAC,KAAK,EAAE,cAAc,EAAE,EAAE,EAAE,OAAO,CAAC,CAAA;IAE3D,OAAO;QACL,SAAS,EAAE,KAAK,CAAC,IAAI;QACrB,KAAK,EAAE,KAAK,CAAC,KAAK;QAClB,OAAO,SAAA;KACR,CAAA;CACF;;SChCe,cAAc,CAAC,aAAkC,EAAE,cAA8B;IAC/F,IAAI,cAAc,GAAG,gBAAgB,CAAC,aAAa,CAAC,CAAA;IACpD,IAAI,eAAe,GAAG,gBAAgB,CAAC,cAAc,CAAC,SAAS,CAAC,KAAK,CAAC,CAAA;IACtE,IAAI,QAAQ,GAAG,eAAe,CAAC,cAAc,EAAE,eAAe,CAAC,CAAA;IAE/D,OAAO,OAAO,CAAC,QAAQ,EAAE,UAAS,OAAO;QACvC,OAAO,aAAa,CAAC,OAAO,EAAE,eAAe,EAAE,cAAc,CAAC,CAAA;KAC/D,CAAC,CAAA;CACH;AAED,SAAS,aAAa,CAAC,OAAgB,EAAE,eAA+B,EAAE,cAA8B;IACtG,IAAI,aAAa,GACf,OAAO,CAAC,SAAS,CAAC,QAAQ;QAC1B,OAAO,CAAC,QAAQ,CAAC,QAAQ;QACzB,cAAc,CAAC,gBAAgB,CAAC,QAAQ;QACxC,cAAc,CAAC,SAAS,CAAC,QAAQ,CAAA;IAEnC,IAAI,QAAQ,GAAG,IAAI,CAAA;IACnB,IAAI,YAAY,GAAG,EAAE,CAAA;IACrB,IAAI,UAAU,GAAG,EAAE,CAAA;IACnB,IAAI,mBAAmB,GAAG,EAAE,CAAA;IAE5B,IAAI,aAAa,EAAE;QACjB,QAAQ,GAAG,cAAc,CAAC,aAAa,CAAC,CAAA;QAExC,IAAI,QAAQ,EAAE;YACZ,IAAI,KAAK,GAAG,2BAA2B,CACrC,QAAQ,EACR,CAAC,iBAAiB,CAAC,aAAa,CAAC,CAClC,CAAA;YAED,YAAY,GAAG,KAAK,CAAC,IAAI,CAAA;YAEzB,IAAI,KAAK,CAAC,KAAK,KAAK,CAAC,EAAE;gBACrB,UAAU,GAAG,YAAY,CAAA;gBACzB,mBAAmB,GAAG,eAAe,CAAC,YAAY,CAAC,GAAG,eAAe,CAAC,YAAY,CAAC,CAAC,OAAO,GAAG,EAAE,CAAA;aACjG;SACF;KACF;IAED,IAAI,eAAe,GAAG,UAAS,OAAO;QACpC,IAAI,aAAa,GAAG,OAAO,CAAC,UAAU,IAAI,EAAE,CAAA;QAC5C,IAAI,aAAa,GAAG,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAA;QAElD,IAAI,aAAa,IAAI,IAAI,IAAI,aAAa,CAAC,aAAa,CAAC,IAAI,IAAI,EAAE;YACjE,OAAO,aAAa,CAAC,aAAa,CAAC,CAAA;SACpC;QAED,IAAI,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE;YACvC,OAAO,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;SACnC;QAED,IAAI,aAAa,CAAC,UAAU,CAAC,IAAI,IAAI,EAAE;YACrC,OAAO,aAAa,CAAC,UAAU,CAAC,CAAA;SACjC;KACF,CAAA;IAED,OAAO;QACL,IAAI,EAAE,OAAO,CAAC,IAAI;QAClB,KAAK,EAAE,OAAO,CAAC,KAAK;QACpB,QAAQ,UAAA;QACR,YAAY,cAAA;QACZ,UAAU,YAAA;QAEV,OAAO,eACF,cAAc,EACd,OAAO,CAAC,QAAQ,EAChB,cAAc,CAAC,WAAW,EAC1B,cAAc,CAAC,cAAc,EAC7B,cAAc,CAAC,SAAS,EACxB,mBAAmB,EACnB,OAAO,CAAC,SAAS,EACjB,cAAc,CAAC,gBAAgB,CACnC;QAED,kBAAkB,EAChB,eAAe,CAAC,cAAc,CAAC,gBAAgB,CAAC;YAChD,eAAe,CAAC,cAAc,CAAC,SAAS,CAAC;YACzC,OAAO,CAAC,SAAS,CAAC,UAAU;QAE9B,iBAAiB,EACf,eAAe,CAAC,cAAc,CAAC,cAAc,CAAC;YAC9C,eAAe,CAAC,cAAc,CAAC,WAAW,CAAC;YAC3C,OAAO,CAAC,QAAQ,CAAC,UAAU;YAC3B,eAAe,CAAC,cAAc,CAAC;YAC/B,OAAO,CAAC,IAAI;KACf,CAAA;CACF;;ACjGD;IAAqCD,2BAA6B;IAahE,iBAAY,OAAyB,EAAE,cAAc;QAArD,YACE,kBAAM,OAAO,CAAC,SAGf;QAZO,mBAAa,GAAG,gBAAgB,CAAC,KAAI,CAAC,YAAY,EAAE,KAAI,CAAC,cAAc,CAAC,CAAA;QACxE,kBAAY,GAAG,gBAAgB,CAAC,KAAI,CAAC,WAAW,EAAE,IAAI,EAAE,CAAE,KAAI,CAAC,aAAa,CAAE,CAAC,CAAA;QAC/E,yBAAmB,GAAG,gBAAgB,CAAC,KAAI,CAAC,kBAAkB,EAAE,IAAI,EAAE,CAAE,KAAI,CAAC,aAAa,CAAE,CAAC,CAAA;QAC7F,kBAAY,GAAG,gBAAgB,CAAC,KAAI,CAAC,WAAW,EAAE,IAAI,EAAE,CAAE,KAAI,CAAC,aAAa,CAAE,CAAC,CAAA;QAC/E,iBAAW,GAAG,gBAAgB,CAAC,KAAI,CAAC,UAAU,EAAE,IAAI,EAAE,CAAE,KAAI,CAAC,aAAa,CAAE,CAAC,CAAA;QAC7E,iBAAW,GAAG,gBAAgB,CAAC,KAAI,CAAC,UAAU,EAAE,IAAI,EAAE,CAAE,KAAI,CAAC,aAAa,CAAE,CAAC,CAAA;QAMnF,KAAI,CAAC,EAAE,GAAG,aAAa,CAAC,KAAK,EAAE,EAAE,SAAS,EAAE,aAAa,GAAG,cAAc,EAAE,CAAC,CAAA;;KAC9E;IAGD,yBAAO,GAAP;QACE,iBAAM,OAAO,WAAE,CAAA;QAEf,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAA;QAC7B,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;KACvB;IAGD,wBAAM,GAAN,UAAO,KAAyB;QAC9B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;QAChC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;QAC9B,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,YAAY,CAAC,CAAA;QAC5C,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,cAAc,CAAC,CAAA;QACvC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;QACrC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;KACtC;IAGD,8BAAY,GAAZ,UAAa,MAAM;QACX,IAAA,YAAE,CAAS;QAEjB,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAA;QAE1B,eAAe,CAAC,EAAE,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,CAAA;QAC5D,eAAe,CAAC,EAAE,EAAE,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,CAAA;QAChE,eAAe,CAAC,EAAE,EAAE,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAA;KAC/D;IAGD,gCAAc,GAAd;QACE,IAAI,CAAC,EAAE,CAAC,SAAS,GAAG,EAAE,CAAA;KACvB;IAGD,+BAAa,GAAb,UAAc,QAAQ,EAAE,SAAS;QAAjC,iBAuGC;QAtGK,IAAA,SAA0B,EAAxB,gBAAK,EAAE,sBAAiB,CAAA;QAC9B,IAAI,cAAc,GAAG,QAAQ,CAAC,cAAc,CAAA;QAC5C,IAAI,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAA;QAClC,IAAI,SAAS,GAAG,aAAa,CAAC,KAAK,EAAE,EAAE,SAAS,EAAE,KAAK,GAAG,QAAQ,EAAE,CAAC,CAAA;QACrE,IAAI,qBAAqB,GAAG,cAAc,CAAC,QAAQ,CAAC,aAAa,IAAI,EAAE,CAAA;QACvE,IAAI,2BAA2B,GAAG,cAAc,CAAC,SAAS,CAAC,UAAU,IAAI,EAAE,CAAA;QAC3E,IAAI,kBAAkB,GAAG,cAAc,CAAC,QAAQ,CAAC,UAAU,IAAI,EAAE,CAAA;QAEjE,IAAI,SAAS,EAAE;YACb,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAC,cAAc,EAAE,CAAC;gBAC7C,IAAI,aAAa,GAAG,EAAE,CAAA;gBACtB,IAAI,aAAa,GAAG,IAAI,CAAA;gBACxB,IAAI,OAAO,CAAA;gBAEX,cAAc,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAC,UAAU,EAAE,CAAC;oBAC9C,IAAI,iBAAiB,CAAA;oBACrB,IAAI,QAAkB,CAAA;oBACtB,IAAI,WAAW,CAAA;oBACf,IAAI,UAAU,CAAA;oBACd,IAAI,UAAU,CAAA;oBACd,IAAI,eAAe,CAAA;oBACnB,IAAI,aAAa,CAAA;oBACjB,IAAI,QAAqB,CAAA;oBACzB,IAAI,cAAc,CAAA;oBAElB,IAAI,UAAU,KAAK,OAAO,EAAE;wBAC1B,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAA;wBACpD,aAAa,GAAG,KAAK,CAAA;qBACtB;yBAAM;wBAEL,KAAK,iBAAiB,GAAG,qBAAqB,CAAC,UAAU,CAAC,GAAG;4BAC3D,WAAW,GAAG,UAAS,EAAE;gCACvB,IAAI,iBAAiB,CAAC,KAAK,EAAE;oCAC3B,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAA;iCAC3C;6BACF,CAAC;4BACF,CAAC,UAAU,GAAG,KAAK,CAAC,wBAAwB,CAAC,iBAAiB,CAAC;iCAC9D,UAAU,GAAG,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;iCAC5C,UAAU,GAAG,iBAAiB,CAAC,IAAI,CAAC,CAAA;yBACtC;6BAAM,KAAK,QAAQ,GAAG,SAAS,CAAC,UAAU,CAAC,GAAG;4BAC7C,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;4BACtC,WAAW,GAAG;gCACZ,QAAQ,CAAC,UAAU,CAAC,UAAU,CAAC,CAAA;6BAChC,CAAC;4BACF,CAAC,UAAU,GAAG,QAAQ,CAAC,kBAAkB;iCACxC,UAAU,GAAG,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;iCAC5C,UAAU,GAAG,QAAQ,CAAC,iBAAiB,CAAC,CAAA;yBAC1C;6BAAM,IAAI,QAAQ,CAAC,UAAU,CAAC,EAAE;4BAC/B,WAAW,GAAG;gCACZ,QAAQ,CAAC,UAAU,CAAC,EAAE,CAAA;6BACvB,CAAC;4BACF,CAAC,UAAU,GAAG,2BAA2B,CAAC,UAAU,CAAC;iCACpD,UAAU,GAAG,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;iCAC5C,UAAU,GAAG,kBAAkB,CAAC,UAAU,CAAC,CAAC,CAAA;yBAE9C;wBAED,IAAI,WAAW,EAAE;4BAEf,aAAa,GAAG;gCACd,KAAK,GAAG,UAAU,GAAG,SAAS;gCAC9B,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC;6BACzB,CAAA;4BAED,IAAI,UAAU,EAAE;gCACd,eAAe,GAAG,UAAU,CAAC,UAAU,CAAC,CAAA;gCACxC,cAAc,GAAG,EAAE,CAAA;6BACpB;iCAAM,IAAI,UAAU,EAAE;gCACrB,eAAe,GAAG,eAAe,GAAG,UAAU,GAAG,WAAW,CAAA;gCAC5D,cAAc,GAAG,eAAe,GAAG,UAAU,GAAG,GAAG,CAAA;6BACpD;4BAED,QAAQ,GAAG,aAAa;4BACtB,+BAA+B,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG;gCAC7D,cAAc;gCAChB,GAAG,GAAG,eAAe,GAAG,WAAW,CACpC,CAAA;4BAED,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,WAAW,CAAC,CAAA;4BAE/C,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;yBAC7B;qBACF;iBACF,CAAC,CAAA;gBAEF,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC5B,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;oBAEvC,IAAI,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAA;oBACxD,IAAI,aAAa,IAAI,oBAAoB,EAAE;wBACzC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAA;qBAC5C;oBAED,eAAe,CAAC,OAAO,EAAE,aAAa,CAAC,CAAA;oBACvC,SAAS,CAAC,WAAW,CAAC,OAAO,CAAC,CAAA;iBAC/B;qBAAM;oBACL,eAAe,CAAC,SAAS,EAAE,aAAa,CAAC,CAAA;iBAC1C;aACF,CAAC,CAAA;SACH;QAED,OAAO,SAAS,CAAA;KACjB;IAGD,6BAAW,GAAX,UAAY,cAAc;QACxB,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,cAAc,CAAC,CAAA;KAClD;IAGD,4BAAU,GAAV,UAAW,aAAa;QACtB,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,aAAa,CAAC,CAAA;KAChD;IAGD,4BAAU,GAAV,UAAW,aAAa;QACtB,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,aAAa,CAAC,CAAA;KAChD;IAGD,6BAAW,GAAX,UAAY,IAAI;QACd,YAAY,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,UAAS,OAAO;YAClD,OAAO,CAAC,SAAS,GAAG,IAAI,CAAA;SACzB,CAAC,CAAA;KACH;IAGD,oCAAkB,GAAlB,UAAmB,UAAW;QAC5B,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAA;QAEnD,YAAY,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAC,QAAQ;YAC/C,IAAI,UAAU,IAAI,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,GAAG,UAAU,GAAG,SAAS,CAAC,EAAE;gBAC7E,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAA;aAClC;iBAAM;gBACL,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAA;aACrC;SACF,CAAC,CAAA;KACH;IAGD,qCAAmB,GAAnB,UAAoB,UAAU,EAAE,IAAI;QAClC,YAAY,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,GAAG,UAAU,GAAG,SAAS,CAAC,CAAC,OAAO,CAAC,UAAC,QAA2B;YACzF,QAAQ,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAA;SAC1B,CAAC,CAAA;KACH;IAEH,cAAC;CAzMD,CAAqC,SAAS,GAyM7C;;AClMD;IAA+CA,qCAAiC;IAmB9E,2BAAY,OAAyB,EAAE,EAAe;QAAtD,YACE,kBAAM,OAAO,CAAC,SAqBf;QA1BO,qBAAe,GAAG,gBAAgB,CAAC,KAAI,CAAC,cAAc,CAAC,CAAA;QACvD,+BAAyB,GAAG,OAAO,CAAC,yBAAyB,CAAC,CAAA;QAMpE,KAAI,CAAC,EAAE,GAAG,EAAE,CAAA;QAEZ,gBAAgB,CACd,EAAE,EACF,KAAI,CAAC,SAAS,GAAG,aAAa,CAAC,KAAK,EAAE,EAAE,SAAS,EAAE,mBAAmB,EAAE,CAAC,CAC1E,CAAA;QAEK,IAAA,yBAAQ,CAAS;QACvB,KAAgC,UAAkD,EAAlD,KAAA,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,sBAAsB,EAAlD,cAAkD,EAAlD,IAAkD,EAAE;YAA/E,IAAI,mBAAmB,SAAA;YAC1B,mBAAmB,CAAC,KAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAA;SAC9C;QAED,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAA;QAE7B,KAAI,CAAC,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC,CAAA;QAEzC,KAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC,UAAC,KAAK;YACtC,OAAO,kBAAkB,CAAC,KAAK,EAAE,KAAI,CAAC,QAAQ,CAAC,CAAA;SAChD,CAAC,CAAA;;KACH;IAED,mCAAO,GAAP;QACE,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAA;SACtB;QAED,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAA;SACtB;QAED,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAA;SACpB;QAED,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;QAC7B,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAA;QAE9B,iBAAM,OAAO,WAAE,CAAA;KAChB;IAED,8CAAkB,GAAlB,UAAmB,IAAa;QAC9B,IAAI,SAAS,GAAG,IAAI,CAAC,EAAE,CAAC,SAAS,CAAA;QACjC,IAAI,YAAY,GAAG,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;QAC1C,IAAI,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;QAElD,IAAI,IAAI,EAAE;YACR,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;YACnB,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;YAC3B,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;SAC9B;aAAM;YACL,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;YACtB,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAA;YAC9B,SAAS,CAAC,MAAM,CAAC,cAAc,CAAC,CAAA;SACjC;KACF;IAED,kCAAM,GAAN,UAAO,KAA6B;QAClC,IAAI,CAAC,YAAY,EAAE,CAAA;QAEnB,IAAI,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAA;QACxE,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC,oBAAoB,EAAE,KAAK,CAAC,CAAA;QAC7G,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,CAAA;QAE7B,IAAI,CAAC,UAAU,EAAE,CAAA;QACjB,IAAI,CAAC,UAAU,EAAE,CAAA;KAClB;IAED,0CAAc,GAAd,UAAe,QAAkB,EAAE,WAAwB,EAAE,WAAuB,EAAE,oBAA0C,EAAE,KAAa;QAC7I,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;QACrC,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;QAErC,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAA;QAChC,IAAI,SAAS,GAAG,oBAAoB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;QAC/C,IAAI,QAAQ,GAAG,oBAAoB,CAAC,SAAS,CAAC,WAAW,EAAE,WAAW,CAAC,CAAA;QACvE,IAAI,QAAQ,GAAG,oBAAoB,CAAC,SAAS,CAAC,WAAW,EAAE,WAAW,CAAC,CAAA;QAEvE,IAAI,YAAY,GAAG;YACjB,KAAK,OAAA;YACL,YAAY,EAAE,QAAQ,CAAC,IAAI;YAC3B,cAAc,EAAE,SAAS,CAAC,OAAO,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,YAAY,EAAE,GAAG,CAAC;YACxF,aAAa,EAAE,QAAQ,CAAC,OAAO;YAC/B,aAAa,EAAE,QAAQ,CAAC,OAAO;SAChC,CAAA;QAED,IAAI,YAAY,EAAE;YAChB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAChB,IAAI,CAAC,MAAM,GAAG,IAAI,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,mBAAmB,CAAC,CAAA;gBAC5D,gBAAgB,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAA;aAC1C;YACD,IAAI,CAAC,MAAM,CAAC,YAAY,YACtB,MAAM,EAAE,YAAY,IACjB,YAAY,EACf,CAAA;SACH;aAAM,IAAI,IAAI,CAAC,MAAM,EAAE;YACtB,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAA;YACrB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;SACnB;QAED,IAAI,YAAY,EAAE;YAChB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAChB,IAAI,CAAC,MAAM,GAAG,IAAI,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,mBAAmB,CAAC,CAAA;gBAC5D,eAAe,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAA;aACzC;YACD,IAAI,CAAC,MAAM,CAAC,YAAY,YACtB,MAAM,EAAE,YAAY,IACjB,YAAY,EACf,CAAA;SACH;aAAM,IAAI,IAAI,CAAC,MAAM,EAAE;YACtB,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAA;YACrB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;SACnB;KACF;IAED,sCAAU,GAAV,UAAW,KAA6B,EAAE,KAAa;QAC/C,IAAA,gBAAI,CAAS;QACb,IAAA,yBAAQ,EAAE,iDAAoB,CAAU;QAE9C,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ,KAAK,QAAQ,EAAE;YAEvC,IAAI,IAAI,EAAE;gBACR,IAAI,CAAC,OAAO,EAAE,CAAA;aACf;YAED,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,QAAQ,CAAC,OAAO,CAAC,CACtC;gBACE,QAAQ,EAAE,IAAI,CAAC,QAAQ;gBACvB,IAAI,EAAE,IAAI;gBACV,OAAO,EAAE,IAAI,CAAC,OAAO;gBACrB,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,OAAO,EAAE,QAAQ,CAAC,OAAO;aAC1B,EACD,QAAQ,EACR,oBAAoB,EACpB,IAAI,CAAC,SAAS,CACf,CAAA;SACF;aAAM;YACL,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAA;SACnC;QAED,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAElB,IAAI,SAAS,GAAG;YACd,WAAW,EAAE,KAAK,CAAC,WAAW;YAC9B,aAAa,EAAE,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,OAAO,CAAC,aAAa,CAAC;YACtE,UAAU,EAAE,KAAK,CAAC,UAAU;YAC5B,YAAY,EAAE,KAAK,CAAC,YAAY;YAChC,aAAa,EAAE,KAAK,CAAC,aAAa;YAClC,cAAc,EAAE,KAAK,CAAC,cAAc;YACpC,SAAS,EAAE,KAAK,CAAC,SAAS;YAC1B,WAAW,EAAE,KAAK,CAAC,WAAW;SAC/B,CAAA;QAED,IAAI,YAAY,GAAG,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAA;QAEzG,KAAwB,UAAY,EAAZ,6BAAY,EAAZ,0BAAY,EAAZ,IAAY,EAAE;YAAjC,IAAI,WAAW,qBAAA;YAClB,QAAQ,CACN,SAAS,EACT,WAAW,CAAC,SAAS,CAAC,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,IAAI,CAAC,CACxD,CAAA;SACF;QAED,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,CAAA;KAC7B;IAMD,sCAAU,GAAV,UAAW,QAAgB;QAAhB,yBAAA,EAAA,gBAAgB;QACnB,IAAA,gBAAI,CAAS;QAEnB,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAA;SACnC;QAED,IAAI,QAAQ,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,EAAE;YACzC,IAAI,CAAC,iBAAiB,EAAE,CAAA;SACzB;QAED,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,YAAY,CAAC,CAAA;QAC7D,IAAI,CAAC,kBAAkB,EAAE,CAAA;QACzB,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAA;KACzB;IAED,6CAAiB,GAAjB;QACQ,IAAA,wBAAQ,CAAS;QACvB,IAAI,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;QACxC,IAAI,kBAAkB,GAAG,QAAQ,CAAC,GAAG,CAAC,eAAe,CAAC,CAAA;QAEtD,IAAI,CAAC,YAAY,GAAG,WAAW,KAAK,MAAM,IAAI,kBAAkB,KAAK,MAAM,CAAA;QAE3E,IAAI,OAAO,kBAAkB,KAAK,QAAQ,EAAE;YAC1C,IAAI,CAAC,UAAU,GAAG,kBAAkB,CAAA;SACrC;aAAM,IAAI,OAAO,kBAAkB,KAAK,UAAU,EAAE;YACnD,IAAI,CAAC,UAAU,GAAG,kBAAkB,EAAE,CAAA;SACvC;aAAM,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;YAC1C,IAAI,CAAC,UAAU,GAAG,WAAW,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAA;SAC3D;aAAM,IAAI,OAAO,WAAW,KAAK,UAAU,EAAE;YAC5C,IAAI,CAAC,UAAU,GAAG,WAAW,EAAE,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAA;SAC7D;aAAM,IAAI,WAAW,KAAK,QAAQ,EAAE;YACnC,IAAI,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,UAAyB,CAAA;YAChD,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,qBAAqB,EAAE,CAAC,MAAM,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAA;SACvF;aAAM;YACL,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAC1B,IAAI,CAAC,SAAS,CAAC,qBAAqB,EAAE,CAAC,KAAK;gBAC5C,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE,EAAE,CAAC,CAC1C,CAAA;SACF;KACF;IAED,+CAAmB,GAAnB;QACE,IAAI,MAAM,GAAG,CAAC,CAAA;QAEd,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,MAAM,IAAI,uBAAuB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAA;SAClD;QAED,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,MAAM,IAAI,uBAAuB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAA;SAClD;QAED,OAAO,MAAM,CAAA;KACd;IAMD,wCAAY,GAAZ;QACE,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE;YAClB,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,qBAAqB,EAAE,CAAC,MAAM;YAC9C,QAAQ,EAAE,QAAQ;SACnB,CAAC,CAAA;KACH;IAED,sCAAU,GAAV;QACE,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE;YAClB,MAAM,EAAE,EAAE;YACV,QAAQ,EAAE,EAAE;SACb,CAAC,CAAA;KACH;IAEH,wBAAC;CAxQD,CAA+C,SAAS,GAwQvD;AAOD,SAAS,YAAY,CAAC,WAAW,EAAE,WAAW;IAC5C,IAAI,KAAgB,CAAA;IAGpB,IAAI,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,gBAAgB,CAAC,EAAE;QACvD,KAAK,GAAG,WAAW,CAAC,YAAY,CAAA;KACjC;SAAM;QACL,KAAK,GAAG,WAAW,CAAC,WAAW,CAAA;KAChC;IAED,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAC7B,KAAK,CAAC,KAAK,EACX,KAAK,CAAC,GAAG,EACT,eAAe,CACb,WAAW,CAAC,WAAW,IAAI,kBAAkB,CAAC,WAAW,CAAC,EAC1D,WAAW,CAAC,mBAAmB,CAChC,EACD,EAAE,cAAc,EAAE,WAAW,CAAC,aAAa,EAAE,CAC9C,CAAA;CACF;AAKD,SAAS,kBAAkB,CAAC,WAAW;IACrC,IAAI,gBAAgB,GAAG,WAAW,CAAC,gBAAgB,CAAA;IAEnD,IAAI,gBAAgB,KAAK,MAAM,EAAE;QAC/B,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,CAAA;KAC3B;SAAM,IAAI,gBAAgB,KAAK,OAAO,EAAE;QACvC,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE,CAAA;KAC1C;SAAM;QACL,IAAI,IAAI,GAAG,aAAa,CACtB,WAAW,CAAC,YAAY,CAAC,KAAK,EAC9B,WAAW,CAAC,YAAY,CAAC,GAAG,CAC7B,CAAA;QACD,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,GAAG,CAAC,EAAE;YAE7B,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,EAAE,SAAS,EAAE,CAAA;SAC3D;aAAM;YAEL,OAAO,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,SAAS,EAAE,CAAA;SAC1D;KACF;CACF;AAMD,SAAS,yBAAyB,CAAC,UAAuC;IACxE,OAAO,UAAU,CAAC,GAAG,CAAC,UAAS,QAAQ;QACrC,OAAO,IAAI,QAAQ,EAAE,CAAA;KACtB,CAAC,CAAA;CACH;;;ICvVC,qBAAY,QAA6B;QACvC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAA;KACpC;IAED,6BAAO,GAAP;KACC;IAEH,kBAAC;CAAA,IAAA;SAmBe,wBAAwB,CAAC,SAA6B,EAAE,KAA+B;IACrG,OAAO;QACL,SAAS,EAAE,SAAS;QACpB,EAAE,EAAE,KAAK,CAAC,EAAE;QACZ,cAAc,EAAE,KAAK,CAAC,cAAc,IAAI,IAAI,GAAG,KAAK,CAAC,cAAc,GAAG,IAAI;KAC3E,CAAA;CACF;AAED,SAAgB,0BAA0B,CAAC,QAA6B;;IACtE;QACE,GAAC,QAAQ,CAAC,SAAS,CAAC,GAAG,IAAG,QAAQ;WACnC;CACF;AAKD,IAAW,wBAAwB,GAA6B,EAAE;;ACzClE;IAA2CA,iCAAW;IAEpD,uBAAY,QAA6B;QAAzC,YACE,kBAAM,QAAQ,CAAC,SAShB;QAED,oBAAc,GAAG,UAAC,EAAS,EAAE,KAAkB;YACvC,IAAA,2BAAS,CAAS;YACxB,IAAI,GAAG,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAA;YAEzB,IACE,GAAG;gBACH,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,MAAqB,CAAC,EACpD;gBAIA,IAAI,eAAe,GAAG,cAAc,CAAC,EAAE,CAAC,MAAqB,EAAE,aAAa,CAAC,CAAA;gBAC7E,IAAI,GAAG,GAAG,eAAe,GAAI,eAAe,CAAC,aAAa,CAAC,SAAS,CAAS,CAAC,IAAI,GAAG,EAAE,CAAA;gBAEvF,SAAS,CAAC,eAAe,CAAC,YAAY,EAAE;oBACtC;wBACE,EAAE,EAAE,KAAK;wBACT,KAAK,EAAE,IAAI,QAAQ,CACjB,SAAS,CAAC,QAAQ,EAClB,GAAG,CAAC,UAAU,CAAC,GAAG,EAClB,GAAG,CAAC,UAAU,CAAC,QAAQ,CACxB;wBACD,OAAO,EAAE,EAAgB;wBACzB,IAAI,EAAE,SAAS,CAAC,IAAI;qBACrB;iBACF,CAAC,CAAA;gBAEF,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE;oBAC/B,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,CAAA;iBAC3B;aACF;SACF,CAAA;QAzCO,IAAA,8BAAS,CAAa;QAE5B,KAAI,CAAC,OAAO,GAAG,gBAAgB,CAC7B,SAAS,CAAC,EAAE,EACZ,OAAO,EACP,SAAS,CAAC,aAAa,GAAG,GAAG,GAAG,SAAS,CAAC,aAAa,EACvD,KAAI,CAAC,cAAc,CACpB,CAAA;;KACF;IAmCH,oBAAC;CA/CD,CAA2C,WAAW,GA+CrD;;AC/CD;IAA2CA,iCAAW;IAKpD,uBAAY,QAA6B;QAAzC,YACE,kBAAM,QAAQ,CAAC,SAWhB;QAQD,yBAAmB,GAAG,UAAC,EAAe;YACpC,IAAI,EAAE,KAAK,KAAI,CAAC,YAAY,EAAE;gBAC5B,KAAI,CAAC,cAAc,CAAC,IAAI,EAAE,KAAI,CAAC,YAAY,CAAC,CAAA;aAC7C;SACF,CAAA;QAED,oBAAc,GAAG,UAAC,EAAS,EAAE,KAAkB;YAC7C,IAAI,QAAQ,CAAC,KAAK,CAAC,EAAE;gBACnB,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAA;gBAC5C,KAAI,CAAC,YAAY,GAAG,KAAK,CAAA;gBACzB,KAAI,CAAC,YAAY,CAAC,iBAAiB,EAAE,EAAE,EAAE,KAAK,CAAC,CAAA;aAChD;SACF,CAAA;QAED,oBAAc,GAAG,UAAC,EAAgB,EAAE,KAAkB;YACpD,IAAI,KAAI,CAAC,YAAY,EAAE;gBACrB,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAA;gBAC/C,KAAI,CAAC,YAAY,GAAG,IAAI,CAAA;gBACxB,KAAI,CAAC,YAAY,CAAC,iBAAiB,EAAE,EAAE,EAAE,KAAK,CAAC,CAAA;aAChD;SACF,CAAA;QAtCO,IAAA,8BAAS,CAAa;QAE5B,KAAI,CAAC,oBAAoB,GAAG,uBAAuB,CACjD,SAAS,CAAC,EAAE,EACZ,SAAS,CAAC,aAAa,GAAG,GAAG,GAAG,SAAS,CAAC,aAAa,EACvD,KAAI,CAAC,cAAc,EACnB,KAAI,CAAC,cAAc,CACpB,CAAA;QAED,SAAS,CAAC,QAAQ,CAAC,EAAE,CAAC,eAAe,EAAE,KAAI,CAAC,mBAAmB,CAAC,CAAA;;KACjE;IAED,+BAAO,GAAP;QACE,IAAI,CAAC,oBAAoB,EAAE,CAAA;QAC3B,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,eAAe,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAA;KACvE;IAyBD,oCAAY,GAAZ,UAAa,YAAmD,EAAE,EAAgB,EAAE,KAAkB;QAC9F,IAAA,0BAAS,CAAS;QACxB,IAAI,GAAG,GAAG,QAAQ,CAAC,KAAK,CAAE,CAAA;QAE1B,IAAI,CAAC,EAAE,IAAI,SAAS,CAAC,gBAAgB,CAAC,EAAE,CAAC,MAAqB,CAAC,EAAE;YAC/D,SAAS,CAAC,eAAe,CAAC,YAAY,EAAE;gBACtC;oBACE,EAAE,EAAE,KAAK;oBACT,KAAK,EAAE,IAAI,QAAQ,CACjB,IAAI,CAAC,SAAS,CAAC,QAAQ,EACvB,GAAG,CAAC,UAAU,CAAC,GAAG,EAClB,GAAG,CAAC,UAAU,CAAC,QAAQ,CACxB;oBACD,OAAO,EAAE,EAAgB;oBACzB,IAAI,EAAE,SAAS,CAAC,IAAI;iBACrB;aACF,CAAC,CAAA;SACH;KACF;IAEH,oBAAC;CAnED,CAA2C,WAAW,GAmErD;;AC1ED;IAA2CA,iCAAK;IAAhD;;KACC;IAAD,oBAAC;CADD,CAA2C,KAAK,GAC/C;AAED,aAAa,CAAC,SAAS,CAAC,OAAO,GAAG;IAChC,MAAM,EAAE,aAAa;IACrB,YAAY,EAAE,kBAAkB;IAChC,aAAa,EAAE,mBAAmB;IAElC,WAAW,EAAE,iBAAiB;IAC9B,MAAM,EAAE,6BAA6B;IACrC,YAAY,EAAE,kBAAkB;IAEhC,aAAa,EAAE,kBAAkB;IACjC,cAAc,EAAE,mBAAmB;IAGnC,SAAS,EAAE,kBAAkB;IAC7B,MAAM,EAAE,mBAAmB;IAG3B,QAAQ,EAAE,mBAAmB;CAC9B,CAAA;AAED,aAAa,CAAC,SAAS,CAAC,aAAa,GAAG,SAAS,CAAA;AACjD,aAAa,CAAC,SAAS,CAAC,WAAW,GAAG;IACpC,KAAK,EAAE,WAAW;IAClB,IAAI,EAAE,sBAAsB;IAC5B,IAAI,EAAE,uBAAuB;IAC7B,QAAQ,EAAE,uBAAuB;IACjC,QAAQ,EAAE,wBAAwB;CACnC,CAAA;AAED,aAAa,CAAC,SAAS,CAAC,kBAAkB,GAAG,aAAa,CAAA;AAC1D,aAAa,CAAC,SAAS,CAAC,8BAA8B,GAAG,MAAM,CAAA;AAC/D,aAAa,CAAC,SAAS,CAAC,kBAAkB,GAAG,UAAU,CAAA;;ACuBvD;IAgEE,kBAAY,EAAe,EAAE,SAAwB;QAArD,iBAiBC;QAnEO,oBAAe,GAAG,OAAO,CAAC,eAAe,CAAC,CAAA;QAC1C,gBAAW,GAAG,OAAO,CAAC,WAAW,CAAC,CAAA;QAClC,iBAAY,GAAG,OAAO,CAAC,YAAY,CAAC,CAAA;QACpC,eAAU,GAAG,OAAO,CAAC,UAAU,CAAC,CAAA;QAChC,2BAAsB,GAAG,OAAO,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAA;QAC9D,yBAAoB,GAAG,OAAO,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAA;QAC1D,yBAAoB,GAAG,aAAa,CAAC,oBAAoB,EAAE,YAAY,CAAC,CAAA;QACxE,sBAAiB,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAA;QAgBtD,sBAAiB,GAA8C,EAAE,CAAA;QAOjE,gBAAW,GAAG,EAAE,CAAA;QAChB,eAAU,GAAY,KAAK,CAAA;QAG3B,kBAAa,GAAY,KAAK,CAAA;QAC9B,sBAAiB,GAAY,KAAK,CAAA;QAClC,gBAAW,GAAY,KAAK,CAAA;QAC5B,wBAAmB,GAAW,CAAC,CAAA;QAE/B,yBAAoB,GAAG,OAAO,CAAC,oBAAoB,CAAC,CAAA;QAEpD,wBAAmB,GAAQ,EAAE,CAAA;QAC7B,kBAAa,GAAY,KAAK,CAAA;QAC9B,mBAAc,GAAY,KAAK,CAAA;QAC/B,oBAAe,GAAY,KAAK,CAAA;QAO9B,IAAI,CAAC,EAAE,GAAG,EAAE,CAAA;QAEZ,IAAI,CAAC,cAAc,GAAG,IAAI,cAAc,CAAC,SAAS,IAAI,EAAE,CAAC,CAAA;QACzD,IAAI,CAAC,YAAY,GAAG,IAAI,YAAY,EAAE,CAAA;QAGtC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,OAAO,IAAI,EAAE,CAAC,CAAA;QAEhE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAA;QAChD,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAA;QAC7B,IAAI,CAAC,OAAO,EAAE,CAAA;QAEd,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,oBAAoB;aACrE,GAAG,CAAC,UAAC,wBAAwB;YAC5B,OAAO,IAAI,wBAAwB,CAAC,KAAI,CAAC,CAAA;SAC1C,CAAC,CAAA;KACL;IAGD,kCAAe,GAAf,UAAgB,YAAY;QAC1B,IAAI,UAAU,GAAG,gBAAgB,CAAC,YAAY,CAAC,CAAA;QAE/C,KAAsB,UAAU,EAAV,yBAAU,EAAV,wBAAU,EAAV,IAAU,EAAE;YAA7B,IAAI,SAAS,mBAAA;YAChB,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,CAAC,CAAA;SACjC;KACF;IAID,sBAAI,0BAAI;aAAR;YACE,OAAO,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,IAAI,CAAA;SACnD;;;OAAA;IAOD,yBAAM,GAAN;QACE,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACnB,IAAI,CAAC,oBAAoB,GAAG,qBAAqB,EAAE,CAAA;YACnD,IAAI,CAAC,YAAY,EAAE,CAAA;YACnB,IAAI,CAAC,aAAa,EAAE,CAAA;SACrB;aAAM;YACL,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAA;SAC3B;KACF;IAGD,0BAAO,GAAP;QACE,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,cAAc,EAAE,CAAA;YACrB,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAA;YACxB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;YAErB,KAAwB,UAAyB,EAAzB,KAAA,IAAI,CAAC,oBAAoB,EAAzB,cAAyB,EAAzB,IAAyB,EAAE;gBAA9C,IAAI,WAAW,SAAA;gBAClB,WAAW,CAAC,OAAO,EAAE,CAAA;aACtB;YAED,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,CAAA;SACnC;KACF;IAOD,+BAAY,GAAZ;QAAA,iBAgCC;QA7BC,IAAI,CAAC,qBAAqB,GAAG,gBAAgB,CAAC,IAAI,CAAC,EAAE,EAAE,OAAO,EAAE,cAAc,EAAE,UAAC,EAAE,EAAE,QAAQ;YAC3F,IAAI,WAAW,GAAQ,QAAQ,CAAC,YAAY,CAAC,WAAW,CAAC,CAAA;YACzD,WAAW,GAAG,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,EAAE,CAAA;YAElD,IAAA,uBAAO,CAAS;YACtB,IAAI,UAAU,GAAG,OAAO,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,CAAA;YACvD,IAAI,QAAQ,GAAG,WAAW,CAAC,IAAI,CAAA;YAG/B,IAAI,YAAY,GAAG,KAAI,CAAC,OAAO,CAAC,SAAS,GAAG,qBAAqB,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,CAAA;YAEtF,IAAI,OAAO,YAAY,KAAK,UAAU,EAAE;gBACtC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,CAAC,CAAA;aAC7C;iBAAM;gBACL,IAAI,OAAO,YAAY,KAAK,QAAQ,EAAE;oBACpC,QAAQ,GAAG,YAAY,CAAA;iBACxB;gBACD,KAAI,CAAC,MAAM,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAA;aAClC;SACF,CAAC,CAAA;QAEF,IAAI,IAAI,CAAC,GAAG,CAAC,oBAAoB,CAAC,EAAE;YAClC,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAC9B,IAAI,CAAC,iBAAiB,GAAG,QAAQ;YAC/B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAC5B,IAAI,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAC9B,CACF,CAAA;SACF;KACF;IAED,iCAAc,GAAd;QACE,IAAI,CAAC,qBAAqB,EAAE,CAAA;QAE5B,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAA;YAC5D,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAA;SAC9B;KACF;IAOD,0BAAO,GAAP;QAAA,iBA0BC;QAzBC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAA;QAErC,IAAI,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,IAAI,EAAE,CAAA;QAC/C,IAAI,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;QACxC,IAAI,OAAO,GAAG,EAAE,CAAA;QAEhB,IAAI,eAAe,EAAE;YACnB,UAAU,CAAC,OAAO,CAAC,eAAe,CAAC,CAAA;SACpC;QAED,KAAsB,UAAU,EAAV,yBAAU,EAAV,wBAAU,EAAV,IAAU,EAAE;YAA7B,IAAI,SAAS,mBAAA;YAChB,IAAI,MAAM,GAAG,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,CAAA;YAC9C,IAAI,MAAM,EAAE;gBACV,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;aACrB;SACF;QAED,IAAI,CAAC,cAAc,CAAC;YAClB,KAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAA;YAC/B,KAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,mBAAmB,EAAE,OAAO,SAAA,EAAE,CAAC,CAAA;YACrD,KAAI,CAAC,QAAQ,CAAC;gBACZ,IAAI,EAAE,eAAe;gBACrB,QAAQ,EAAE,KAAI,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,WAAW;aACzE,CAAC,CAAA;SACH,CAAC,CAAA;KACH;IAGD,oCAAiB,GAAjB;QACE,OAAO;YACL,QAAQ,EAAE,IAAI;YACd,YAAY,EAAE,CAAC;YACf,uBAAuB,EAAE,CAAC;YAC1B,WAAW,EAAE,IAAI,CAAC,cAAc,EAAE;YAClC,WAAW,EAAE,IAAI;YACjB,YAAY,EAAE,EAAE;YAChB,UAAU,EAAE,qBAAqB,EAAE;YACnC,aAAa,EAAE,IAAI;YACnB,cAAc,EAAE,EAAE;YAClB,SAAS,EAAE,IAAI;YACf,WAAW,EAAE,IAAI;SAClB,CAAA;KACF;IAGD,2BAAQ,GAAR,UAAS,MAAc;QACrB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;QAE7B,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAA;YACtB,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAA;YAEzB,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE;gBAC9B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CACtB,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,EACxB,IAAI,CACL,CAAA;aACF;YAED,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAA;YACzB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAA;YAEvB,IAAI,CAAC,QAAQ,CAAC,YAAY,IAAI,QAAQ,CAAC,YAAY,EAAE;gBACnD,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,CAAE,IAAI,CAAE,CAAC,CAAA;aAC1C;iBAAM,IAAI,QAAQ,CAAC,YAAY,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE;gBAC1D,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,CAAE,KAAK,CAAE,CAAC,CAAA;aAC3C;YAED,IAAI,IAAI,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAA;YAEhD,IAAI,QAAQ,CAAC,UAAU,KAAK,QAAQ,CAAC,UAAU,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBACzE,IAAI,QAAQ,CAAC,UAAU,EAAE;oBACvB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAA;iBAC5B;aACF;YAED,IAAI,QAAQ,CAAC,WAAW,KAAK,QAAQ,CAAC,WAAW,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC3E,IAAI,QAAQ,CAAC,WAAW,IAAI,IAAI,EAAE;oBAChC,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE;wBACnC;4BACE,IAAI,MAAA;4BACJ,EAAE,EAAE,IAAI,CAAC,EAAE;yBACZ;qBACF,CAAC,CAAA;iBACH;gBACD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAA;aAC3B;YAED,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAC,QAAQ,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBACrE,IAAI,QAAQ,CAAC,QAAQ,IAAI,IAAI,EAAE;oBAC7B,IAAI,CAAC,eAAe,CAAC,qBAAqB,EAAE;wBAC1C;4BACE,IAAI,MAAA;4BACJ,EAAE,EAAE,IAAI,CAAC,EAAE;yBACZ;qBACF,CAAC,CAAA;iBACH;gBACD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;aAC1B;YAED,IAAI,CAAC,eAAe,EAAE,CAAA;SACvB;KACF;IAGD,yBAAM,GAAN,UAAO,KAAoB,EAAE,MAAc,EAAE,QAAkB;QAC7D,OAAO,MAAM,CAAC,KAAK,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAA;KACvC;IAOD,kCAAe,GAAf,UAAgB,SAAiB;QAAjB,0BAAA,EAAA,iBAAiB;QAC/B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;QACzB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,IAAI,SAAS,CAAA;QAC5D,IAAI,CAAC,eAAe,EAAE,CAAA;KACvB;IAGD,8BAAW,GAAX;QACE,IACE,IAAI,CAAC,SAAS;YACd,IAAI,CAAC,aAAa;YAClB,CAAC,IAAI,CAAC,mBAAmB;YACzB,CAAC,IAAI,CAAC,WAAW;UACjB;YACA,IAAI,CAAC,aAAa,EAAE,CAAA;SACrB;KACF;IAGD,iCAAc,GAAd,UAAe,IAAI;QACjB,IAAI,CAAC,mBAAmB,EAAE,CAAA;QAC1B,IAAI,EAAE,CAAA;QACN,IAAI,CAAC,mBAAmB,EAAE,CAAA;QAE1B,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,eAAe,EAAE,CAAA;SACvB;KACF;IAMD,gCAAa,GAAb;QACQ,IAAA,0CAAiB,CAAS;QAGhC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAA;QAC1B,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAA;QAE9B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAA;QACvB,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAA;QACvC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAA;QAGxB,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,eAAe,EAAE,CAAA;SACvB;KACF;IAKD,kCAAe,GAAf,UAAgB,SAAS;QACnB,IAAA,SAA2B,EAAzB,gBAAK,EAAE,wBAAkB,CAAA;QACzB,IAAA,yBAAQ,CAAU;QACxB,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAA;QACvC,IAAI,WAAW,GAAG,CAAC,SAAS,IAAI,SAAS,IAAI,SAAS,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,CAAA;QAEhF,IAAI,CAAC,QAAQ,EAAE;YACb,MAAM,IAAI,KAAK,CAAC,iBAAc,QAAQ,oBAAgB,CAAC,CAAA;SACxD;QAID,IAAI,oBAAoB,GAAG,IAAI,CAAC,oBAAoB;YAClD,CAAC,KAAK,CAAC,uBAAuB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,2BAA2B,CAAC;gBACtE,IAAI,CAAC,oBAAoB;gBACzB,KAAK,CAAC,UAAU,CAAA;QAEpB,IAAI,iBAAiB,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAA;QACrE,IAAI,eAAe,GAAG,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,YAAY,CAAC,CAAA;QACnE,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,oBAAoB,CAAC,IAAI,EAAE,iBAAiB,EAAE,eAAe,CAAC,CAAA;QAE5H,IAAI,SAAS,IAAI,CAAC,SAAS,EAAE;YAE3B,IAAI,SAAS,EAAE;gBACb,SAAS,CAAC,YAAY,EAAE,CAAA;gBACxB,SAAS,CAAC,OAAO,EAAE,CAAA;aACpB;YAED,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,iBAAiB,CAAC;gBACjD,QAAQ,EAAE,IAAI;gBACd,IAAI,EAAE,IAAI;gBACV,OAAO,EAAE,IAAI,CAAC,OAAO;gBACrB,KAAK,EAAE,IAAI,CAAC,KAAK;gBACjB,OAAO,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ;aACtC,EAAE,IAAI,CAAC,EAAE,CAAC,CAAA;YAEX,IAAI,CAAC,aAAa,GAAG,IAAI,CAAA;YACzB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAA;YAC1B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAA;SAC5B;QAED,SAAS,CAAC,YAAY,cACjB,KAAK,IACR,QAAQ,UAAA,EACR,WAAW,EAAE,KAAK,CAAC,WAAW,EAC9B,oBAAoB,EAAE,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,EAC1D,UAAU,EAAE,oBAAoB,EAChC,YAAY,cAAA,EACZ,aAAa,EAAE,KAAK,CAAC,aAAa,EAClC,cAAc,EAAE,KAAK,CAAC,cAAc,EACpC,SAAS,EAAE,KAAK,CAAC,SAAS,EAC1B,WAAW,EAAE,KAAK,CAAC,WAAW,IAC9B,CAAA;QAEF,IAAI,WAAW,EAAE;YACf,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,KAAK,CAAC,CAAA;SAC/C;QAED,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,aAAa,GAAG,KAAK,CAAA;YAC1B,IAAI,CAAC,eAAe,CAAC,oBAAoB,EAAE;gBACzC;oBACE,IAAI,EAAE,SAAS,CAAC,IAAI;oBACpB,EAAE,EAAE,SAAS,CAAC,IAAI,CAAC,EAAE;iBACtB;aACF,CAAC,CAAA;SACH;QAED,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,cAAc,GAAG,KAAK,CAAA;YAC3B,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE;gBAClC;oBACE,IAAI,EAAE,SAAS,CAAC,IAAI;oBACpB,EAAE,EAAE,SAAS,CAAC,IAAI,CAAC,EAAE;iBACtB;aACF,CAAC,CAAA;SACH;QAED,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,eAAe,GAAG,KAAK,CAAA;SAC7B;QAED,IAAI,CAAC,0BAA0B,EAAE,CAAA;KAClC;IAOD,4BAAS,GAAT,UAAU,IAAY,EAAE,GAAG;;QACzB,IAAI,CAAC,aAAa,WAAG,GAAC,IAAI,IAAG,GAAG,OAAI,EAAE,EAAE,IAAI,CAAC,CAAA;KAC9C;IAGD,4BAAS,GAAT,UAAU,IAAY;QACpB,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;KAC1C;IAGD,sBAAG,GAAH,UAAI,IAAY;QACd,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;KAC1C;IAGD,0BAAO,GAAP,UAAQ,IAAY;QAClB,OAAO,IAAI,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,CAAA;KAC7B;IAGD,2BAAQ,GAAR;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAA;KACnD;IAKD,gCAAa,GAAb,UAAc,OAAO,EAAE,QAAkB,EAAE,SAAmB,EAAE,SAAU;QAA1E,iBAsEC;QArEC,IAAI,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,oBAAoB,CAAA;QACjE,IAAI,aAAa,GAAG,EAAE,CAAA;QACtB,IAAI,cAAc,GAAG,EAAE,CAAA;QACvB,IAAI,UAAU,GAAG,IAAI,CAAC,OAAO,CAAA;QAC7B,IAAI,eAAe,GAAG,KAAK,CAAA;QAC3B,IAAI,WAAW,GAAG,KAAK,CAAA;QACvB,IAAI,mBAAmB,GAAG,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAA;QAElD,KAAK,IAAI,MAAI,IAAI,OAAO,EAAE;YACxB,IAAI,cAAc,CAAC,MAAI,CAAC,EAAE;gBACxB,cAAc,CAAC,MAAI,CAAC,GAAG,OAAO,CAAC,MAAI,CAAC,CAAA;aACrC;iBAAM;gBACL,aAAa,CAAC,MAAI,CAAC,GAAG,OAAO,CAAC,MAAI,CAAC,CAAA;aACpC;SACF;QAED,KAAK,IAAI,MAAI,IAAI,aAAa,EAAE;YAC9B,IAAI,sCAAsC,CAAC,IAAI,CAAC,MAAI,CAAC,EAAE;gBACrD,WAAW,GAAG,IAAI,CAAA;aACnB;iBAAM,IAAI,6BAA6B,CAAC,IAAI,CAAC,MAAI,CAAC,EAAE,CAEpD;iBAAM;gBACL,mBAAmB,GAAG,IAAI,CAAA;gBAE1B,IAAI,MAAI,KAAK,UAAU,EAAE;oBACvB,eAAe,GAAG,IAAI,CAAA;iBACvB;aACF;SACF;QAED,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAA;QAE9D,IAAI,mBAAmB,EAAE;YACvB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAA;YAChD,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAA;SAC9B;QAED,IAAI,CAAC,cAAc,CAAC;YAElB,IAAI,mBAAmB,EAAE;gBAEvB,IAAI,eAAe,EAAE;oBACnB,KAAI,CAAC,QAAQ,CAAC;wBACZ,IAAI,EAAE,iBAAiB;wBACvB,UAAU,YAAA;qBACX,CAAC,CAAA;iBACH;gBAMD,KAAI,CAAC,QAAQ,CAAC;oBACZ,IAAI,EAAE,eAAe;oBACrB,QAAQ,EAAE,KAAI,CAAC,KAAK,CAAC,QAAQ;iBAC9B,CAAC,CAAA;aAEH;iBAAM,IAAI,WAAW,EAAE;gBACtB,KAAI,CAAC,UAAU,EAAE,CAAA;aAClB;YAGD,IAAI,SAAS,EAAE;gBACb,KAAK,IAAI,MAAI,IAAI,cAAc,EAAE;oBAC/B,cAAc,CAAC,MAAI,CAAC,CAAC,cAAc,CAAC,MAAI,CAAC,EAAE,KAAI,EAAE,SAAS,CAAC,CAAA;iBAC5D;aACF;SAEF,CAAC,CAAA;KACH;IAKD,gCAAa,GAAb,UAAc,OAAO;QAArB,iBAkCC;QAjCC,IAAI,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAA;QAEzC,IAAI,CAAC,0BAA0B,GAAG,cAAc,CAAC,OAAO,CAAC,0BAA0B,CAAC,CAAA;QACpF,IAAI,CAAC,yBAAyB,GAAG,cAAc,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAA;QAClF,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,aAAa,CAAC,CAAA;QACvE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAA;QAErC,IAAI,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;QACrD,IAAI,CAAC,mBAAmB,GAAG,SAAS,CAAC,GAAG,CAAA;QACxC,IAAI,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,IAAI,SAAS,CAAC,WAAW,EAAE,SAAS,CAAC,GAAG,CAAC,CAAA;QAErF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,YAAY,CAC9B,MAAM,EACN,OAAO,CAAC,QAAQ,EAChB,WAAW,CAAC,kBAAkB,EAC9B,OAAO,CAAC,QAAQ,EAChB,OAAO,CAAC,qBAAqB,EAC7B,OAAO,CAAC,SAAS,EACjB,WAAW,CAAC,YAAY,CACzB,CAAA;QAED,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAA;QAGzD,IAAI,CAAC,SAAS,GAAG,cAAc,CAC7B,WAAW,CAAC,KAAK,EACjB,IAAI,CAAC,cAAc,CACpB,CAAA;QAGD,IAAI,CAAC,qBAAqB,GAAG,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,UAAC,QAAQ;YAC5D,OAAO,IAAI,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,yBAAyB,CAAC,QAAQ,EAAE,KAAI,CAAC,CAAA;SAC9E,CAAC,CAAA;KACH;IAGD,0CAAuB,GAAvB;QACE,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA;KAC7C;IAGD,wCAAqB,GAArB,UAAsB,OAAO;QAC3B,OAAO,oBAAoB,CAAC,QAAQ,EAAE,OAAO,EAAE,IAAI,CAAC,CAAA;KACrD;IAGD,0CAAuB,GAAvB,UAAwB,OAAO;QAC7B,IAAI,OAAO,CAAC,QAAQ,EAAE;YACpB,OAAO,gBAAQ,OAAO,IAAE,aAAa,EAAE,IAAI,GAAE,CAAA;SAC9C;QACD,OAAO,oBAAoB,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,CAAA;KACpD;IAOD,oCAAiB,GAAjB,UAA8C,IAAO;QACnD,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;YAC3B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;KACjB;IAGD,kCAAe,GAAf,UAA4C,IAAO,EAAE,IAA0B;QAC7E,IAAI,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;QAE/B,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAA;QAElC,IAAI,UAAU,EAAE;YACd,OAAO,UAAU,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;SACpC;KACF;IAGD,6CAA0B,GAA1B,UAAuD,IAAO,EAAE,IAAyB;QACjF,IAAA,8CAAmB,CAAU;QAEnC,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,mBAAmB,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;KAC3E;IAGD,6CAA0B,GAA1B;QACQ,IAAA,8CAAmB,CAAS;QAElC,KAAK,IAAI,MAAI,IAAI,mBAAmB,EAAE;YACpC,KAAiB,UAAyB,EAAzB,KAAA,mBAAmB,CAAC,MAAI,CAAC,EAAzB,cAAyB,EAAzB,IAAyB,EAAE;gBAAvC,IAAI,IAAI,SAAA;gBACX,IAAI,CAAC,eAAe,CAAC,MAAwB,EAAE,IAAI,CAAC,CAAA;aACrD;SACF;QAED,IAAI,CAAC,mBAAmB,GAAG,EAAE,CAAA;KAC9B;IAQD,kCAAe,GAAf,UAAgB,QAAgB;QAC9B,OAAO,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAA;KACzC;IAGD,6BAAU,GAAV,UAAW,QAAgB,EAAE,WAAwC;QACnE,IAAI,UAAU,GAAG,IAAI,CAAA;QAErB,IAAI,WAAW,EAAE;YACf,IAAK,WAA8B,CAAC,KAAK,IAAK,WAA8B,CAAC,GAAG,EAAE;gBAChF,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,YAAY,EAAE,WAAW,EAAE,EAAE,EAAE,CAAC,CAAA;gBAC7D,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAA;aACjD;iBAAM;gBACL,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,WAAwB,CAAC,CAAA;aACjE;SACF;QAED,IAAI,CAAC,QAAQ,EAAE,CAAA;QACf,IAAI,CAAC,QAAQ,CAAC;YACZ,IAAI,EAAE,eAAe;YACrB,QAAQ,UAAA;YACR,UAAU,YAAA;SACX,CAAC,CAAA;KACH;IAMD,yBAAM,GAAN,UAAO,UAAsB,EAAE,QAAiB;QAC9C,IAAI,IAAI,CAAA;QAER,QAAQ,GAAG,QAAQ,IAAI,KAAK,CAAA;QAC5B,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;YAC7B,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAA;QAEhC,IAAI,CAAC,QAAQ,EAAE,CAAA;QAEf,IAAI,IAAI,EAAE;YACR,IAAI,CAAC,QAAQ,CAAC;gBACZ,IAAI,EAAE,eAAe;gBACrB,QAAQ,EAAE,IAAI,CAAC,IAAI;gBACnB,UAAU,YAAA;aACX,CAAC,CAAA;SACH;aAAM;YACL,IAAI,CAAC,QAAQ,CAAC;gBACZ,IAAI,EAAE,UAAU;gBAChB,UAAU,YAAA;aACX,CAAC,CAAA;SACH;KACF;IAKD,kCAAe,GAAf,UAAgB,IAAY;QACpB,IAAA,0BAAS,CAAS;QACxB,IAAI,SAAS,GAAG,EAAE,CAAA;QAClB,IAAI,CAAC,CAAA;QACL,IAAI,IAAI,CAAA;QAGR,IAAI,SAAS,CAAC,MAAM,EAAE;YACpB,SAAS,CAAC,IAAI,OAAd,SAAS,EAAS,SAAS,CAAC,MAAM,CAAC,gBAAgB,EAAC;SACrD;QACD,IAAI,SAAS,CAAC,MAAM,EAAE;YACpB,SAAS,CAAC,IAAI,OAAd,SAAS,EAAS,SAAS,CAAC,MAAM,CAAC,gBAAgB,EAAC;SACrD;QAED,KAAK,IAAI,QAAQ,IAAI,IAAI,CAAC,SAAS,EAAE;YACnC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;SACzB;QAED,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACrC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAA;YACnC,IAAI,IAAI,EAAE;gBACR,IAAI,IAAI,CAAC,UAAU,KAAK,IAAI,EAAE;oBAC5B,OAAO,IAAI,CAAA;iBACZ;aACF;SACF;KACF;IAOD,iCAAc,GAAd;QACE,IAAI,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,CAAA;QAG9C,IAAI,gBAAgB,IAAI,IAAI,EAAE;YAC5B,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,gBAAgB,CAAC,CAAA;SACnD;aAAM;YACL,OAAO,IAAI,CAAC,MAAM,EAAE,CAAA;SACrB;KACF;IAGD,uBAAI,GAAJ;QACE,IAAI,CAAC,QAAQ,EAAE,CAAA;QACf,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAA;KAChC;IAGD,uBAAI,GAAJ;QACE,IAAI,CAAC,QAAQ,EAAE,CAAA;QACf,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAA;KAChC;IAGD,2BAAQ,GAAR;QACE,IAAI,CAAC,QAAQ,EAAE,CAAA;QACf,IAAI,CAAC,QAAQ,CAAC;YACZ,IAAI,EAAE,UAAU;YAChB,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;SAC9D,CAAC,CAAA;KACH;IAGD,2BAAQ,GAAR;QACE,IAAI,CAAC,QAAQ,EAAE,CAAA;QACf,IAAI,CAAC,QAAQ,CAAC;YACZ,IAAI,EAAE,UAAU;YAChB,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;SAC7D,CAAC,CAAA;KACH;IAGD,wBAAK,GAAL;QACE,IAAI,CAAC,QAAQ,EAAE,CAAA;QACf,IAAI,CAAC,QAAQ,CAAC;YACZ,IAAI,EAAE,UAAU;YAChB,UAAU,EAAE,IAAI,CAAC,MAAM,EAAE;SAC1B,CAAC,CAAA;KACH;IAGD,2BAAQ,GAAR,UAAS,cAAc;QACrB,IAAI,CAAC,QAAQ,EAAE,CAAA;QACf,IAAI,CAAC,QAAQ,CAAC;YACZ,IAAI,EAAE,UAAU;YAChB,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,cAAc,CAAC;SACtD,CAAC,CAAA;KACH;IAGD,gCAAa,GAAb,UAAc,UAAU;QACtB,IAAI,KAAK,GAAG,cAAc,CAAC,UAAU,CAAC,CAAA;QAEtC,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,QAAQ,EAAE,CAAA;YACf,IAAI,CAAC,QAAQ,CAAC;gBACZ,IAAI,EAAE,UAAU;gBAChB,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC;aAC5D,CAAC,CAAA;SACH;KACF;IAID,0BAAO,GAAP;QACE,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;KACnD;IAOD,6BAAU,GAAV,UAAW,CAAY,EAAE,SAAS;QACxB,IAAA,sBAAO,CAAS;QACxB,OAAO,OAAO,CAAC,MAAM,CACnB,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,EACvB,eAAe,CAAC,SAAS,CAAC,CAC3B,CAAA;KACF;IAID,8BAAW,GAAX,UAAY,EAAa,EAAE,EAAa,EAAE,QAAQ;QACxC,IAAA,sBAAO,CAAS;QACxB,OAAO,OAAO,CAAC,WAAW,CACxB,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,EACxB,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,EACxB,eAAe,CAAC,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC,EAC5D,QAAQ,CACT,CAAA;KACF;IAGD,4BAAS,GAAT,UAAU,CAAY,EAAE,QAAkB;QAChC,IAAA,sBAAO,CAAS;QACxB,OAAO,OAAO,CAAC,SAAS,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,EAAE,QAAQ,UAAA,EAAE,CAAC,CAAA;KAChE;IAOD,+BAAY,GAAZ,UAAa,EAAS;QACpB,IACE,CAAC,IAAI,CAAC,sBAAsB;YAC5B,IAAI,CAAC,SAAS;YACb,EAAU,CAAC,MAAM,KAAK,MAAM;UAC7B;YACA,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAA;YAClC,IAAI,CAAC,UAAU,EAAE,CAAA;YACjB,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,CAAE,IAAI,CAAC,IAAI,CAAE,CAAC,CAAA;YACnD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAA;SACpC;KACF;IAGD,6BAAU,GAAV;QACE,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,CAAA;SAChC;KACF;IAOD,+CAA4B,GAA5B,UAA6B,SAA6B,EAAE,aAAuC;QACjG,IAAI,QAAQ,GAAG,wBAAwB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAA;QACjE,IAAI,oBAAoB,GAAuB;YAC7C,aAAa;YACb,aAAa;SACd,CAAA;QACD,IAAI,kBAAkB,GAAuB,oBAAoB,CAAC,MAAM,CACtE,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,qBAAqB,CAC9C,CAAA;QACD,IAAI,YAAY,GAAG,kBAAkB,CAAC,GAAG,CAAC,UAAC,gBAAgB;YACzD,OAAO,IAAI,gBAAgB,CAAC,QAAQ,CAAC,CAAA;SACtC,CAAC,CAAA;QAEF,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,YAAY,CAAA;QACpD,wBAAwB,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAA;KACnD;IAGD,iDAA8B,GAA9B,UAA+B,SAA6B;QAE1D,KAAqB,UAAqC,EAArC,KAAA,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,EAArC,cAAqC,EAArC,IAAqC,EAAE;YAAvD,IAAI,QAAQ,SAAA;YACf,QAAQ,CAAC,OAAO,EAAE,CAAA;SACnB;QAED,OAAO,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA;QAC5C,OAAO,wBAAwB,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA;KAC/C;IASD,yBAAM,GAAN,UAAO,SAA0B,EAAE,OAAmB;QACpD,IAAI,cAA6B,CAAA;QAEjC,IAAI,OAAO,IAAI,IAAI,EAAE;YACnB,IAAI,SAAS,CAAC,KAAK,IAAI,IAAI,EAAE;gBAC3B,cAAc,GAAG,SAA0B,CAAA;aAC5C;iBAAM;gBACL,cAAc,GAAG;oBACf,KAAK,EAAE,SAAS;oBAChB,GAAG,EAAE,IAAI;iBACV,CAAA;aACF;SACF;aAAM;YACL,cAAc,GAAG;gBACf,KAAK,EAAE,SAAS;gBAChB,GAAG,EAAE,OAAO;aACI,CAAA;SACnB;QAED,IAAI,SAAS,GAAG,aAAa,CAC3B,cAAc,EACd,IAAI,CAAC,OAAO,EACZ,cAAc,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC;SAC5B,CAAA;QAED,IAAI,SAAS,EAAE;YACb,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,cAAc,EAAE,SAAS,WAAA,EAAE,CAAC,CAAA;YAClD,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAA;SAClC;KACF;IAID,2BAAQ,GAAR,UAAS,GAAsB;QAC7B,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE;YAC5B,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,gBAAgB,EAAE,CAAC,CAAA;YACzC,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAA;SAC9B;KACF;IAGD,oCAAiB,GAAjB,UAAkB,SAAmB,EAAE,GAAsB;QAC3D,IAAM,GAAG,gBACJ,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,IACnC,OAAO,EAAE,GAAG,GAAG,GAAG,CAAC,SAAuB,GAAG,IAAI,EACjD,IAAI,EAAE,IAAI,CAAC,IAAI,GAChB,CAAA;QACD,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAE,GAAG,CAAE,CAAC,CAAA;KACxC;IAGD,sCAAmB,GAAnB,UAAoB,GAAsB;QACxC,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE;YAC/B;gBACE,OAAO,EAAE,GAAG,GAAG,GAAG,CAAC,SAAS,GAAG,IAAI;gBACnC,IAAI,EAAE,IAAI,CAAC,IAAI;aAChB;SACF,CAAC,CAAA;KACH;IAID,mCAAgB,GAAhB,UAAiB,QAAkB,EAAE,KAAkB,EAAE,IAAU,EAAE,EAAW;QAC9E,IAAM,GAAG,gBACJ,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,IACnC,KAAK,OAAA,EACL,OAAO,EAAE,EAAgB;YACzB,IAAI,MAAA,GACL,CAAA;QAED,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,CAAE,GAAG,CAAE,CAAC,CAAA;KAC3C;IAGD,oCAAiB,GAAjB,UAAkB,QAAkB;QAClC,IAAI,KAAK,GAAG,EAAkB,CAAA;QAE9B,KAAsB,UAA2C,EAA3C,KAAA,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,mBAAmB,EAA3C,cAA2C,EAA3C,IAA2C,EAAE;YAA9D,IAAI,SAAS,SAAA;YAChB,QAAQ,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAA;SAC3C;QAED,QAAQ,CAAC,KAAK,EAAE,iBAAiB,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAA;QAE1D,OAAO,KAAK,CAAA;KACb;IAGD,mCAAgB,GAAhB,UAAiB,QAAkB;QACjC,IAAI,KAAK,GAAG,EAAiB,CAAA;QAE7B,KAAsB,UAA0C,EAA1C,KAAA,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,kBAAkB,EAA1C,cAA0C,EAA1C,IAA0C,EAAE;YAA7D,IAAI,SAAS,SAAA;YAChB,QAAQ,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAA;SAC3C;QAED,QAAQ,CAAC,KAAK,EAAE,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAA;QAEzD,OAAO,KAAK,CAAA;KACb;IAQD,yBAAM,GAAN;QACE,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;QAEzB,IAAI,OAAO,GAAG,KAAK,UAAU,EAAE;YAC7B,GAAG,GAAG,GAAG,EAAE,CAAA;SACZ;QAED,IAAI,GAAG,IAAI,IAAI,EAAE;YACf,OAAO,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAA;SACtC;QAED,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,CAAA;KACtC;IASD,qCAAkB,GAAlB,UAAmB,MAAe,EAAE,MAAkB;QACpD,IAAI,GAAG,GAAG,MAAM,CAAA;QAEhB,IAAI,MAAM,EAAE;YACV,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC,CAAA;YACrB,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,0BAA0B,CAAC,CAAA;SAC7D;aAAM;YACL,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,yBAAyB,CAAC,CAAA;SAC5D;QAED,OAAO,GAAG,CAAA;KACX;IAOD,2BAAQ,GAAR,UAAS,UAAsB,EAAE,WAA8C;QAE7E,IAAI,UAAU,YAAY,QAAQ,EAAE;YAClC,IAAI,GAAG,GAAG,UAAU,CAAC,IAAI,CAAA;YACzB,IAAI,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAA;YAGnC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBAC1C,IAAI,CAAC,QAAQ,CAAC;oBACZ,IAAI,EAAE,YAAY;oBAClB,UAAU,EAAE,iBAAiB,CAAC,EAAE,GAAG,KAAA,EAAE,QAAQ,UAAA,EAAE,CAAC;iBACjD,CAAC,CAAA;aACH;YAED,OAAO,UAAU,CAAA;SAClB;QAED,IAAI,QAAQ,CAAA;QACZ,IAAI,WAAW,YAAY,cAAc,EAAE;YACzC,QAAQ,GAAG,WAAW,CAAC,mBAAmB,CAAC,QAAQ,CAAA;SACpD;aAAM,IAAI,WAAW,IAAI,IAAI,EAAE;YAC9B,IAAI,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAA;YAEpD,IAAI,CAAC,SAAS,EAAE;gBACd,OAAO,CAAC,IAAI,CAAC,0CAA0C,GAAG,WAAW,GAAG,GAAG,CAAC,CAAA;gBAC5E,OAAO,IAAI,CAAA;aACZ;iBAAM;gBACL,QAAQ,GAAG,SAAS,CAAC,mBAAmB,CAAC,QAAQ,CAAA;aAClD;SACF;QAED,IAAI,KAAK,GAAG,UAAU,CAAC,UAAU,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAA;QAElD,IAAI,KAAK,EAAE;YAET,IAAI,CAAC,QAAQ,CAAC;gBACZ,IAAI,EAAE,YAAY;gBAClB,UAAU,EAAE,iBAAiB,CAAC,KAAK,CAAC;aACrC,CAAC,CAAA;YAEF,OAAO,IAAI,QAAQ,CACjB,IAAI,EACJ,KAAK,CAAC,GAAG,EACT,KAAK,CAAC,GAAG,CAAC,YAAY,GAAG,IAAI,GAAG,KAAK,CAAC,QAAQ,CAC/C,CAAA;SACF;QAED,OAAO,IAAI,CAAA;KACZ;IAID,+BAAY,GAAZ,UAAa,EAAU;QACjB,IAAA,0BAA2C,EAAzC,cAAI,EAAE,wBAAmC,CAAA;QAE/C,EAAE,GAAG,MAAM,CAAC,EAAE,CAAC,CAAA;QAEf,KAAK,IAAI,KAAK,IAAI,IAAI,EAAE;YACtB,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAA;YAErB,IAAI,GAAG,CAAC,QAAQ,KAAK,EAAE,EAAE;gBAEvB,IAAI,GAAG,CAAC,YAAY,EAAE;oBACpB,OAAO,IAAI,QAAQ,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,CAAA;iBACrC;qBAAM;oBAEL,KAAK,IAAI,UAAU,IAAI,SAAS,EAAE;wBAChC,IAAI,QAAQ,GAAG,SAAS,CAAC,UAAU,CAAC,CAAA;wBAEpC,IAAI,QAAQ,CAAC,KAAK,KAAK,GAAG,CAAC,KAAK,EAAE;4BAChC,OAAO,IAAI,QAAQ,CAAC,IAAI,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAA;yBACzC;qBACF;iBACF;aACF;SACF;QAED,OAAO,IAAI,CAAA;KACZ;IAGD,4BAAS,GAAT;QACM,IAAA,0BAA2C,EAAzC,cAAI,EAAE,wBAAmC,CAAA;QAC/C,IAAI,SAAS,GAAe,EAAE,CAAA;QAE9B,KAAK,IAAI,EAAE,IAAI,SAAS,EAAE;YACxB,IAAI,QAAQ,GAAG,SAAS,CAAC,EAAE,CAAC,CAAA;YAC5B,IAAI,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;YAE9B,SAAS,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,IAAI,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAA;SAClD;QAED,OAAO,SAAS,CAAA;KACjB;IAGD,kCAAe,GAAf;QACE,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,mBAAmB,EAAE,CAAC,CAAA;KAC7C;IAGD,iCAAc,GAAd;QACE,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAA;KACxC;IAOD,kCAAe,GAAf;QACE,IAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAA;QACxC,IAAI,UAAU,GAAqB,EAAE,CAAA;QAErC,KAAK,IAAI,UAAU,IAAI,UAAU,EAAE;YACjC,UAAU,CAAC,IAAI,CAAC,IAAI,cAAc,CAAC,IAAI,EAAE,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC,CAAA;SAClE;QAED,OAAO,UAAU,CAAA;KAClB;IAGD,qCAAkB,GAAlB,UAAmB,EAAmB;QACpC,IAAI,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAA;QAExC,EAAE,GAAG,MAAM,CAAC,EAAE,CAAC,CAAA;QAEf,KAAK,IAAI,QAAQ,IAAI,UAAU,EAAE;YAC/B,IAAI,UAAU,CAAC,QAAQ,CAAC,CAAC,QAAQ,KAAK,EAAE,EAAE;gBACxC,OAAO,IAAI,cAAc,CAAC,IAAI,EAAE,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAA;aACtD;SACF;QAED,OAAO,IAAI,CAAA;KACZ;IAGD,iCAAc,GAAd,UAAe,WAA6B;QAE1C,IAAI,WAAW,YAAY,cAAc,EAAE;YAGzC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,WAAW,CAAC,mBAAmB,CAAC,QAAQ,CAAC,EAAE;gBACtE,IAAI,CAAC,QAAQ,CAAC;oBACZ,IAAI,EAAE,mBAAmB;oBACzB,OAAO,EAAE,CAAE,WAAW,CAAC,mBAAmB,CAAE;iBAC7C,CAAC,CAAA;aACH;YAED,OAAO,WAAW,CAAA;SACnB;QAED,IAAI,WAAW,GAAG,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,CAAA;QAErD,IAAI,WAAW,EAAE;YACf,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,mBAAmB,EAAE,OAAO,EAAE,CAAE,WAAW,CAAE,EAAE,CAAC,CAAA;YAEtE,OAAO,IAAI,cAAc,CAAC,IAAI,EAAE,WAAW,CAAC,CAAA;SAC7C;QAED,OAAO,IAAI,CAAA;KACZ;IAGD,wCAAqB,GAArB;QACE,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,0BAA0B,EAAE,CAAC,CAAA;KACpD;IAGD,gCAAa,GAAb;QACE,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,qBAAqB,EAAE,CAAC,CAAA;KAC/C;IAMD,+BAAY,GAAZ,UAAa,SAAwB;QACnC,IAAI,QAAQ,GAAG,cAAc,CAAC,SAAS,CAAC,CAAA;QAExC,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAA;SAC/C;KACF;IAEH,eAAC;CAAA,IAAA;AAED,YAAY,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAA;AAO9B,SAAS,YAAY,CAAC,MAAc,EAAE,QAAQ,EAAE,iBAAyC,EAAE,QAAQ,EAAE,qBAAqB,EAAE,SAAS,EAAE,YAA8B;IACnK,OAAO,IAAI,OAAO,CAAC;QACjB,cAAc,EAAE,SAAS;QACzB,QAAQ,UAAA;QACR,iBAAiB,mBAAA;QACjB,MAAM,QAAA;QACN,qBAAqB,uBAAA;QACrB,QAAQ,UAAA;QACR,SAAS,WAAA;QACT,YAAY,cAAA;KACb,CAAC,CAAA;CACH;AAGD,SAAS,UAAU,CAAiB,eAAe;IACjD,IAAI,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,YAAY,CAAC,eAAe,CAAC,WAAW,CAAC,IAAI,aAAa,CAAA;IACnG,OAAO,IAAI,UAAU,CAAC,eAAe,CAAC,CAAA;CACvC;AAGD,SAAS,oBAAoB,CAAiB,IAAI;IAChD,IAAI,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;IAEtC,IAAI,IAAI,IAAI,IAAI,EAAE;QAChB,IAAI,GAAG,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;KAC5B;IAED,OAAO,IAAI,CAAA;CACZ;AAGD,SAAS,oBAAoB,CAAC,YAA6B;IACzD,OAAO,OAAO,CAAC,YAAY,EAAE,UAAS,WAAW;QAC/C,OAAO,WAAW,CAAC,EAAE,CAAA;KACtB,CAAC,CAAA;CACH;AAGD,SAAS,iBAAiB,CAAC,SAAuB,EAAE,iBAA0B,EAAE,eAA4B;IAC1G,IAAI,YAAY,GAAgB,EAAE,EAAE,EAAE,iBAAiB,EAAE,CAAA;IAEzD,KAAK,IAAI,KAAK,IAAI,SAAS,EAAE;QAC3B,IAAI,GAAG,GAAG,SAAS,CAAC,KAAK,CAAC,CAAA;QAE1B,IAAI,GAAG,CAAC,QAAQ,IAAI,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YACjD,YAAY,CAAC,KAAK,CAAC,GAAG,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;SACpD;KACF;IAED,OAAO,YAAY,CAAA;CACpB;;AC3yCD;IAA2CA,wBAAwB;IAuCjE,cAAY,OAAyB,EAAE,QAAkB,EAAE,oBAA0C,EAAE,QAAqB;QAA5H,YACE,kBACE,OAAO,EACP,aAAa,CAAC,KAAK,EAAE,EAAE,SAAS,EAAE,aAAa,GAAG,QAAQ,CAAC,IAAI,GAAG,OAAO,EAAE,CAAC,EAC5E,IAAI;SACL,SAUF;QAxBO,oBAAc,GAAG,gBAAgB,CAAC,KAAI,CAAC,eAAe,EAAE,KAAI,CAAC,iBAAiB,CAAC,CAAA;QAC/E,4BAAsB,GAAG,gBAAgB,CAAC,KAAI,CAAC,mBAAmB,EAAE,KAAI,CAAC,qBAAqB,EAAE,CAAE,KAAI,CAAC,cAAc,CAAE,CAAC,CAAA;QACxH,4BAAsB,GAAG,gBAAgB,CAAC,KAAI,CAAC,uBAAuB,EAAE,KAAI,CAAC,yBAAyB,EAAE,CAAE,KAAI,CAAC,cAAc,CAAE,CAAC,CAAA;QAChI,qBAAe,GAAG,gBAAgB,CAAC,KAAI,CAAC,YAAY,EAAE,KAAI,CAAC,cAAc,EAAE,CAAE,KAAI,CAAC,cAAc,CAAE,CAAC,CAAA;QACnG,6BAAuB,GAAG,gBAAgB,CAAC,KAAI,CAAC,wBAAwB,EAAE,KAAI,CAAC,0BAA0B,EAAE,CAAE,KAAI,CAAC,eAAe,CAAE,CAAC,CAAA;QACpI,wBAAkB,GAAG,gBAAgB,CAAC,KAAI,CAAC,mBAAmB,EAAE,KAAI,CAAC,qBAAqB,EAAE,CAAE,KAAI,CAAC,cAAc,CAAE,CAAC,CAAA;QACpH,0BAAoB,GAAG,gBAAgB,CAAC,KAAI,CAAC,qBAAqB,EAAE,KAAI,CAAC,uBAAuB,EAAE,CAAE,KAAI,CAAC,cAAc,CAAE,CAAC,CAAA;QAUhI,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;QACxB,KAAI,CAAC,oBAAoB,GAAG,oBAAoB,CAAA;QAChD,KAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAA;QACzB,KAAI,CAAC,eAAe,GAAG,eAAe,CAAC,KAAI,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAA;QAC9D,KAAI,CAAC,gBAAgB,GAAG,cAAc,CAAC,KAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,CAAA;QAEpE,QAAQ,CAAC,WAAW,CAAC,KAAI,CAAC,EAAE,CAAC,CAAA;QAC7B,KAAI,CAAC,UAAU,EAAE,CAAA;;KAClB;IAGD,yBAAU,GAAV;KACC;IAOD,sBAAI,6BAAW;aAAf;YACE,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,CAAA;SACrE;;;OAAA;IAED,sBAAI,2BAAS;aAAb;YACE,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,WAAW,CAAC,GAAG,CAAC,CAAA;SACnE;;;OAAA;IAED,sBAAI,8BAAY;aAAhB;YACE,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,YAAY,CAAC,KAAK,CAAC,CAAA;SACtE;;;OAAA;IAED,sBAAI,4BAAU;aAAd;YACE,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,YAAY,CAAC,GAAG,CAAC,CAAA;SACpE;;;OAAA;IAOD,qBAAM,GAAN,UAAO,KAAgB;QACrB,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;QACtC,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;QAChD,IAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;QAChD,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,UAAU,CAAC,CAAA;QACtC,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,cAAc,CAAC,CAAA;QAClD,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;QACxC,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,WAAW,CAAC,CAAA;KAC7C;IAGD,sBAAO,GAAP;QACE,iBAAM,OAAO,WAAE,CAAA;QAEf,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAA;KAC/B;IAOD,yBAAU,GAAV,UAAW,QAAiB,EAAE,UAAkB,EAAE,MAAe;QACzD,IAAA,wBAAQ,CAAS;QAEvB,IACE,QAAQ;YACR,QAAQ,CAAC,aAAa;YACtB,QAAQ,CAAC,cAAc;YACvB,QAAQ,CAAC,eAAe,EACxB;YAGA,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,UAAU,EAAE,MAAM,CAAC,CAAA;SAClD;KACF;IAGD,6BAAc,GAAd,UAAe,QAAiB,EAAE,UAAkB,EAAE,MAAe;KACpE;IAMD,8BAAe,GAAf,UAAgB,WAAwB;QACtC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,CAAA;QAC7B,IAAI,CAAC,SAAS,CAAC;YACb,QAAQ,EAAE,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;SACjD,CAAC,CAAA;QACF,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAA;KACpC;IAED,gCAAiB,GAAjB;QACE,IAAI,CAAC,gBAAgB,EAAE,CAAA;QACvB,IAAI,CAAC,aAAa,EAAE,CAAA;KACrB;IAED,0BAAW,GAAX,UAAY,WAAwB,KAAI;IACxC,4BAAa,GAAb,eAAkB;IAMlB,kCAAmB,GAAnB,UAAoB,aAAyB,KAAI;IACjD,oCAAqB,GAArB,eAA0B;IAM1B,sCAAuB,GAAvB,UAAwB,SAAmB;QACzC,IAAI,SAAS,EAAE;YACb,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAA;SACpC;KACF;IAED,wCAAyB,GAAzB,UAA0B,SAAmB;QAC3C,IAAI,SAAS,EAAE;YACb,IAAI,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAA;SACtC;KACF;IAED,kCAAmB,GAAnB,UAAoB,SAAmB,KAAI;IAC3C,oCAAqB,GAArB,UAAsB,SAAmB,KAAI;IAM7C,2BAAY,GAAZ,UAAa,UAAsB,KAAI;IACvC,6BAAc,GAAd,eAAmB;IAGnB,0BAAW,GAAX,UAAY,UAAsB,EAAE,MAAe;QAC3C,IAAA,kBAAK,CAAS;QAEpB,OAAO,eAAe,CACpB,UAAU,EACV,KAAK,CAAC,YAAY,EAClB,KAAK,CAAC,WAAW,CAAC,WAAW,EAC7B,MAAM,GAAG,IAAI,CAAC,gBAAgB,GAAG,IAAI,CACtC,CAAC,EAAE,CAAA;KACL;IAED,oCAAqB,GAArB,UAAsB,QAAkB,EAAE,OAAgB;QACxD,IAAI,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,KAAK,CAAC,uBAAuB,CAAA;QAC3E,IAAI,GAAG,GAAG,OAAO,CAAC,aAAa,CAAA;QAE/B,KAAwB,UAAY,EAAZ,6BAAY,EAAZ,0BAAY,EAAZ,IAAY,EAAE;YAAjC,IAAI,WAAW,qBAAA;YAClB,GAAG,GAAG,WAAW,CAAC,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,IAAI,CAAC,CAAA;SAChD;QAED,OAAO,GAAG,CAAA;KACX;IAED,yCAA0B,GAA1B,UAA2B,QAAkB,EAAE,OAAgB;QAC7D,OAAO,OAAO,CAAC,gBAAgB,IAAI,IAAI,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAA;KACvE;IAED,uCAAwB,GAAxB,UAAyB,QAAkB,EAAE,OAAgB;QAC3D,OAAO,OAAO,CAAC,gBAAgB,CAAA;KAChC;IAMD,uCAAwB,GAAxB,UAAyB,UAAkB;QACzC,IAAI,UAAU,EAAE;YACd,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,CAAA;SACtC;KACF;IAED,yCAA0B,GAA1B,UAA2B,UAAkB;QAC3C,IAAI,UAAU,EAAE;YACd,IAAI,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAA;SACxC;KACF;IAED,mCAAoB,GAApB,UAAqB,UAAkB,KAAI;IAC3C,qCAAsB,GAAtB,UAAuB,UAAkB,KAAI;IAM7C,kCAAmB,GAAnB,UAAoB,KAA4B;QAC9C,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAA;SAC5B;KACF;IAED,oCAAqB,GAArB,UAAsB,KAA4B;QAChD,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAA;SAC9B;KACF;IAED,8BAAe,GAAf,UAAgB,KAA4B,KAAI;IAChD,gCAAiB,GAAjB,UAAkB,KAA4B,KAAI;IAMlD,oCAAqB,GAArB,UAAsB,KAA4B;QAChD,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAA;SAC9B;KACF;IAED,sCAAuB,GAAvB,UAAwB,KAA4B;QAClD,IAAI,KAAK,EAAE;YACT,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAA;SAChC;KACF;IAED,gCAAiB,GAAjB,UAAkB,KAA4B,KAAI;IAClD,kCAAmB,GAAnB,UAAoB,KAA4B,KAAI;IAUpD,gCAAiB,GAAjB,UAAkB,WAAwB;QAA1C,iBAqCC;QApCO,IAAA,sBAAO,CAAS;QACtB,IAAI,IAAI,CAAA;QACR,IAAI,MAAM,CAAA;QACV,IAAI,KAAK,CAAA;QAET,IAAI,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,EAAE;YAC5B,IAAI,GAAG,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,CAAA;YAC5C,IAAI,IAAI,EAAE;gBACR,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;gBAE3C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAA;gBAC5C,IAAI,CAAC,mBAAmB,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAA;gBAG/C,KAAK,GAAG,OAAO,CAAC,GAAG,CACjB,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,EAC1C,cAAc,CAAC,CAAC,EAAE,IAAI,CAAC,CACxB,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAA;gBAG3C,IAAI,CAAC,qBAAqB,GAAG,UAAU,CAAC;oBACtC,KAAI,CAAC,qBAAqB,GAAG,IAAI,CAAA;oBACjC,MAAM,EAAE,CAAA;oBAER,IAAI,IAAI,KAAK,QAAQ,EAAE;wBACrB,KAAK,GAAG,IAAI,CAAA;qBACb;yBAAM;wBACL,KAAK,GAAG,IAAI,GAAG,EAAE,CAAA;qBAClB;oBAED,KAAI,CAAC,sBAAsB,GAAG,WAAW,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA;iBACzD,EAAE,KAAK,CAAC,CAAA;aACV;SAGF;KACF;IAKD,iCAAkB,GAAlB;QACE,IACE,IAAI,CAAC,KAAK,CAAC,WAAW;YACtB,IAAI,CAAC,cAAc;UACnB;YACA,IAAI,CAAC,oBAAoB,EAAE,CAAA;YAC3B,IAAI,CAAC,kBAAkB,CACrB,KAAK,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,mBAAmB,CAAC,CAC5E,CAAA;YACD,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAA;SACnC;KACF;IAKD,+BAAgB,GAAhB;QACE,IAAI,IAAI,CAAC,sBAAsB,EAAE;YAE/B,IAAI,IAAI,CAAC,qBAAqB,EAAE;gBAC9B,YAAY,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAA;gBACxC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAA;aAClC;YACD,IAAI,IAAI,CAAC,sBAAsB,EAAE;gBAC/B,aAAa,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAA;gBAC1C,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAA;aACnC;YAED,IAAI,CAAC,oBAAoB,EAAE,CAAA;YAC3B,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAA;SACpC;KACF;IAGD,kCAAmB,GAAnB,UAAoB,WAAwB;KAE3C;IAID,iCAAkB,GAAlB,UAAmB,IAAI;KAEtB;IAID,mCAAoB,GAApB;KAEC;IAOD,wBAAS,GAAT,UAAU,MAAM;QACd,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,KAAK,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,CAAA;QAEhE,QAAQ,CAAC,YAAY,EAAE,MAAM,CAAC,CAAA;KAC/B;IAGD,wBAAS,GAAT,UAAU,QAAiB;QACzB,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAA;QAChC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAA;KACzB;IAGD,gCAAiB,GAAjB,UAAkB,QAAiB;QACjC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,IAAI,EAAE,EAAE,QAAQ,CAAC,CAAA;KACpD;IAGD,0BAAW,GAAX;QACE,IAAI,MAAM,GAAG,EAAS,CAAA;QAEtB,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE;YAC1B,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,eAAe,EAAE,CAAC,CAAA;SACzC;QAED,OAAO,MAAM,CAAA;KACd;IAGD,0BAAW,GAAX,UAAY,MAAM,EAAE,QAAiB;QAC7B,IAAA,0BAAQ,CAAW;QAEzB,IAAI,QAAQ,IAAI,IAAI,EAAE;YACpB,OAAO,MAAM,CAAC,QAAQ,CAAA;YAEtB,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE;gBAC1B,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,CAAA;aACnD;SACF;QAED,IAAI,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE;YAC1B,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAA;SAC7B;KACF;IAGD,gCAAiB,GAAjB,UAAkB,QAAkB;QAClC,OAAO,EAAE,CAAA;KACV;IAGD,8BAAe,GAAf;QACE,OAAO,EAAE,CAAA;KACV;IAGD,8BAAe,GAAf,UAAgB,MAAM;KAErB;IAID,+BAAgB,GAAhB,UAAiB,QAAkB;QACjC,IAAI,CAAC,WAAW,CAAC,EAAE,QAAQ,UAAA,EAAE,EAAE,KAAK,CAAC,CAAA;KACtC;IAEH,WAAC;CAvbD,CAA2C,aAAa,GAubvD;AAED,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;AAE1B,IAAI,CAAC,SAAS,CAAC,cAAc,GAAG,KAAK,CAAA;AACrC,IAAI,CAAC,SAAS,CAAC,yBAAyB,GAAG,oBAAoB,CAAA;;AC/c/D;IAaE,yBAAY,OAAyB;QAJrC,SAAI,GAAU,EAAE,CAAA;QAChB,gBAAW,GAAY,KAAK,CAAA;QAI1B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;KACvB;IAGD,oCAAU,GAAV,UAAW,IAAW,EAAE,UAAW;QACjC,IAAI,CAAC,YAAY,EAAE,CAAA;QAInB,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,UAAU,CAAC,CAAA;QAE1C,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;QAChB,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,UAAU,CAAC,CAAA;QAEjC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAA;QACvB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAA;KACtE;IAGD,kCAAQ,GAAR,UAAS,KAAY,EAAE,UAAW;QAChC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAA;QACvE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;QAC1B,IAAI,CAAC,IAAI,GAAG,EAAE,CAAA;KACf;IASD,sCAAY,GAAZ;QACQ,IAAA,8BAAO,CAAiB;QAC9B,IAAI,gBAAgB,CAAA;QACpB,IAAI,eAAe,CAAA;QAEnB,IAAI,CAAC,eAAe,GAAG,eAAe,CACpC,OAAO,CAAC,eAAe,IAAI,IAAI,CAAC,sBAAsB,EAAE,EACxD,OAAO,CAAC,qBAAqB,CAC9B,CAAA;QAED,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,CAAA;QAC3C,IAAI,gBAAgB,IAAI,IAAI,EAAE;YAC5B,gBAAgB,GAAG,IAAI,CAAC,uBAAuB,EAAE,CAAA;SAClD;QAED,eAAe,GAAG,OAAO,CAAC,eAAe,CAAA;QACzC,IAAI,eAAe,IAAI,IAAI,EAAE;YAC3B,eAAe,GAAG,IAAI,CAAC,sBAAsB,EAAE,CAAA;SAChD;QAED,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAA;QACxC,IAAI,CAAC,eAAe,GAAG,eAAe,CAAA;KACvC;IAKD,sCAAY,GAAZ,UAAa,IAAW,EAAE,UAAU;QAClC,IAAI,IAAI,GAAG,EAAE,CAAA;QACb,IAAI,CAAC,CAAA;QAEL,IAAI,IAAI,CAAC,MAAM,EAAE;YAGf,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAChC,IAAI,IAAI,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAA;aAChD;YAID,cAAc,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAC,EAAE,EAAE,CAAC;gBACjC,IAAI,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;gBAEjB,IAAI,EAAE,EAAE;oBACN,GAAG,CAAC,EAAE,GAAG,EAAE,CAAA;iBACZ;aACF,CAAC,CAAA;YAEF,IAAI,GAAG,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC,CAAA;SACtE;QAED,OAAO,IAAI,CAAA;KACZ;IAID,uCAAa,GAAb,UAAc,GAAQ,EAAE,WAAW,EAAE,WAAW,EAAE,UAAU;QAC1D,IAAI,OAAO,GAAG;YACZ,UAAU;YACV,GAAG,CAAC,OAAO,GAAG,UAAU,GAAG,cAAc;YACzC,GAAG,CAAC,KAAK,GAAG,QAAQ,GAAG,YAAY;SACpC,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,CAAA;QAEtC,IAAI,WAAW,EAAE;YACf,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;SAC7B;QAED,IAAI,WAAW,EAAE;YACf,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;SAC7B;QAED,IAAI,UAAU,EAAE;YACd,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;YAEzB,IAAI,UAAU,CAAC,UAAU,EAAE;gBACzB,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;aAC5B;YAED,IAAI,UAAU,CAAC,UAAU,EAAE;gBACzB,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAA;aAC5B;SACF;QAED,OAAO,OAAO,CAAA;KACf;IAQD,qCAAW,GAAX,UAAY,UAA4B,EAAE,SAAU,EAAE,UAAW;QACzD,IAAA,oBAAG,EAAE,8BAAQ,CAAe;QAElC,OAAO,IAAI,CAAC,YAAY,CACtB,QAAQ,CAAC,KAAK,CAAC,KAAK,EACpB,GAAG,CAAC,MAAM,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,EACtC,GAAG,CAAC,MAAM,EACV,SAAS,EACT,UAAU,EACV,QAAQ,CAAC,cAAc,EACvB,QAAQ,CAAC,YAAY,CACtB,CAAA;KACF;IAGD,sCAAY,GAAZ,UACE,KAAiB,EACjB,GAAe,EACf,MAAM,EACN,SAAU,EACV,UAAW,EACX,cAAuB,EACvB,YAAqB;QAEf,IAAA,8BAAO,CAAiB;QAE9B,IAAI,SAAS,IAAI,IAAI,EAAE;YACrB,SAAS,GAAG,IAAI,CAAC,eAAe,CAAA;SACjC;QAED,IAAI,UAAU,IAAI,IAAI,EAAE;YACtB,UAAU,GAAG,IAAI,CAAC,eAAe,CAAA;SAClC;QAED,IAAI,IAAI,CAAC,gBAAgB,IAAI,CAAC,MAAM,EAAE;YACpC,IAAI,UAAU,IAAI,GAAG,EAAE;gBACrB,OAAO,OAAO,CAAC,WAAW,CAAC,KAAK,EAAE,GAAG,EAAE,SAAS,EAAE;oBAChD,cAAc,gBAAA;oBACd,YAAY,cAAA;iBACb,CAAC,CAAA;aACH;iBAAM;gBACL,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,EAAE;oBACtC,SAAS,EAAE,cAAc;iBAC1B,CAAC,CAAA;aACH;SACF;QAED,OAAO,EAAE,CAAA;KACV;IAGD,gDAAsB,GAAtB;QACE,OAAO;YACL,IAAI,EAAE,SAAS;YACf,MAAM,EAAE,SAAS;YACjB,cAAc,EAAE,IAAI;SACrB,CAAA;KACF;IAGD,iDAAuB,GAAvB;QACE,OAAO,IAAI,CAAA;KACZ;IAGD,gDAAsB,GAAtB;QACE,OAAO,IAAI,CAAA;KACZ;IAID,oCAAU,GAAV,UAAW,EAAW;QACpB,OAAO;YACL,kBAAkB,EAAE,EAAE,CAAC,eAAe;YACtC,cAAc,EAAE,EAAE,CAAC,WAAW;YAC9B,KAAK,EAAE,EAAE,CAAC,SAAS;SACpB,CAAA;KACF;IAGD,uCAAa,GAAb,UAAc,IAAI;QAChB,IAAI,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAA;QAC7C,IAAI,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAA;QAEvC,IAAI,CAAC,IAAI,CAAC,UAAS,IAAI,EAAE,IAAI;YAC3B,OAAO,mBAAmB,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,CAAA;SAC9C,CAAC,CAAA;QAEF,OAAO,IAAI,CAAC,GAAG,CAAC,UAAS,CAAC;YACxB,OAAO,CAAC,CAAC,IAAI,CAAA;SACd,CAAC,CAAA;KACH;IAGD,sCAAY,GAAZ,UAAa,KAAc;QACzB,IAAI,KAAK,IAAI,IAAI,CAAC,WAAW,EAAE;YAC7B,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;SAChC;KACF;IAGD,qCAAW,GAAX,UAAY,KAAc;QACxB,IAAI,KAAK,IAAI,IAAI,CAAC,WAAW,EAAE;YAC7B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;YAC9B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAA;SACzB;KACF;IAGD,yCAAe,GAAf,UAAgB,IAAW;KAC1B;IAGD,wCAAc,GAAd,UAAe,IAAW;KACzB;IAMD,oCAAU,GAAV,UAAW,IAAI;QACb,IAAI,IAAI,EAAE;YACR,KAAgB,UAAS,EAAT,KAAA,IAAI,CAAC,IAAI,EAAT,cAAS,EAAT,IAAS,EAAE;gBAAtB,IAAI,GAAG,SAAA;gBACV,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;oBAC5C,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAA;iBACnC;aACF;SACF;KACF;IAGD,oCAAU,GAAV,UAAW,IAAI;QACb,IAAI,IAAI,EAAE;YACR,KAAgB,UAAS,EAAT,KAAA,IAAI,CAAC,IAAI,EAAT,cAAS,EAAT,IAAS,EAAE;gBAAtB,IAAI,GAAG,SAAA;gBACV,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;oBAC5C,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,CAAA;iBAC7B;aACF;SACF;KACF;IAGD,4CAAkB,GAAlB,UAAmB,UAAkB;QACnC,IAAI,UAAU,EAAE;YACd,KAAgB,UAAS,EAAT,KAAA,IAAI,CAAC,IAAI,EAAT,cAAS,EAAT,IAAS,EAAE;gBAAtB,IAAI,GAAG,SAAA;gBACV,IAAI,aAAa,GAAG,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAA;gBAC3C,IACE,aAAa,IAAI,aAAa,CAAC,UAAU,KAAK,UAAU;oBACxD,GAAG,CAAC,EAAE;kBACN;oBACA,GAAG,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAA;iBACpC;aACF;SACF;KACF;IAGD,8CAAoB,GAApB,UAAqB,UAAkB;QACrC,IAAI,UAAU,EAAE;YACd,KAAgB,UAAS,EAAT,KAAA,IAAI,CAAC,IAAI,EAAT,cAAS,EAAT,IAAS,EAAE;gBAAtB,IAAI,GAAG,SAAA;gBACV,IAAI,GAAG,CAAC,EAAE,EAAE;oBACV,GAAG,CAAC,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,aAAa,CAAC,CAAA;iBACvC;aACF;SACF;KACF;IAEH,sBAAC;CAAA,IAAA;SAIe,kBAAkB,CAAC,GAAQ;IACzC,IAAI,QAAQ,GAAG,GAAG,CAAC,UAAU,CAAC,GAAG,CAAA;IACjC,IAAI,KAAK,GAAG,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAK,CAAA;IACzC,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,CAAC,CAAA;IACnD,IAAI,GAAG,GAAG,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,CAAA;IAE7C,oBACK,QAAQ,CAAC,aAAa,EACtB,QAAQ,IACX,EAAE,EAAE,QAAQ,CAAC,QAAQ,EACrB,KAAK,OAAA;QACL,GAAG,KAAA,EACH,QAAQ,EAAE,GAAG,GAAG,KAAK,EACrB,MAAM,EAAE,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAC/B,IAAI,EAAE,GAAG;QACV;CACF;;ACxUD;IASE,sBAAY,OAAyB;QANrC,eAAU,GAAW,KAAK,CAAA;QAG1B,mBAAc,GAAQ,EAAE,CAAA;QAItB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;QACtB,IAAI,CAAC,kBAAkB,GAAG,EAAE,CAAA;QAC5B,IAAI,CAAC,UAAU,GAAG,EAAE,CAAA;KACrB;IAGD,oCAAa,GAAb,UAAc,IAAY;QACxB,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,CAAA;KACnC;IAGD,iCAAU,GAAV,UAAW,IAAI,EAAE,IAAW;;QAC1B,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;QAChD,IAAI,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,YAAY,CAAC,CAAA;QAEtD,IAAI,YAAY,EAAE;YAChB,CAAA,MAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,EACpE,IAAI,WAAI,YAAY,EAAC;SACzB;QAED,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,YAAY,CAAA;QAEpC,IAAI,IAAI,KAAK,SAAS,EAAE;YACtB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC,YAAY,EAAE,KAAK,CAAC,CAAA;SAC3D;QAED,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,IAAI,CAAA;KACjC;IAID,+BAAQ,GAAR,UAAS,IAAI;QACX,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAA;QAEhC,IAAI,IAAI,EAAE;YAER,IAAI,IAAI,KAAK,SAAS,EAAE;gBACtB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;aACrD;YAED,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;SAC5B;KACF;IAKD,mCAAY,GAAZ,UAAa,IAAI,EAAE,IAAW;QAA9B,iBAoCC;QAnCC,IAAI,IAAI,GAAG,EAAE,CAAA;QACb,IAAI,CAAC,CAAA;QAEL,IAAI,IAAI,CAAC,MAAM,EAAE;YAGf,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAChC,IAAI,IAAI,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAA;aAC1C;YAID,cAAc,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAC,EAAE,EAAE,CAAC;gBACjC,IAAI,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAA;gBAEjB,IAAI,EAAE,EAAE;oBACN,GAAG,CAAC,EAAE,GAAG,EAAE,CAAA;iBACZ;aACF,CAAC,CAAA;YAEF,IAAI,IAAI,KAAK,SAAS,EAAE;gBACtB,IAAI,GAAG,gBAAgB,CACrB,IAAI,CAAC,OAAO,CAAC,IAAI,EACjB,IAAI,EACJ,KAAK;iBACN,CAAA;aACF;YAGD,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,UAAC,GAAG;gBACrB,OAAO,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,KAAI,CAAC,UAAU,CAAC,CAAA;aAC/C,CAAC,CAAA;SACH;QAED,OAAO,IAAI,CAAA;KACZ;IAID,oCAAa,GAAb,UAAc,IAAI,EAAE,GAAQ;QAC1B,IAAI,GAAG,GAAG,IAAI,CAAA;QACd,IAAI,UAAU,GAAG,EAAE,CAAA;QAEnB,IAAI,IAAI,KAAK,WAAW,IAAI,IAAI,KAAK,eAAe,EAAE;YACpD,GAAG,GAAG;gBACJ,kBAAkB,EAAE,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,eAAe;aACtD,CAAA;SACF;QAED,IAAI,IAAI,KAAK,WAAW,EAAE;YACxB,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,CAAA;SAC7D;QAED,IAAI,IAAI,KAAK,eAAe,EAAE;YAC5B,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;SAC9B;aAAM;YACL,UAAU,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,CAAA;SAC5C;QAED,OAAO,GAAG,GAAG,IAAI,CAAC,UAAU;aACzB,UAAU,CAAC,MAAM,GAAG,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;aACjE,GAAG,GAAG,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;YAC7C,KAAK,GAAG,IAAI,CAAC,UAAU,GAAG,GAAG,CAAA;KAChC;IAMD,iCAAU,GAAV,UAAW,IAAI,EAAE,IAAW;QAC1B,IAAI,YAAY,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAA;QAEhD,IAAI,YAAY,EAAE;YAChB,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,CAAA;YACnC,OAAO,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAA;SACrC;KACF;IAGD,mCAAY,GAAZ,UAAa,KAAc;QACzB,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;YAChC,IAAI,KAAK,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;gBACtC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAA;aAC5C;SACF;KACF;IAGD,kCAAW,GAAX,UAAY,KAAc;QACxB,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;YAChC,IAAI,KAAK,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;gBACtC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAA;aAC3C;SACF;QAED,IAAI,CAAC,cAAc,GAAG,EAAE,CAAA;KACzB;IAGD,sCAAe,GAAf,UAAgB,IAAW;KAC1B;IAGD,qCAAc,GAAd,UAAe,IAAW;KACzB;IAEH,mBAAC;CAAA,IAAA;;;ICtKC,2BAAY,YAAoB;QAC9B,IAAI,CAAC,YAAY,GAAG,YAAY,CAAA;KACjC;IAIH,wBAAC;CAAA;;ACID;IAIE,yBAAY,EAAe;QACzB,IAAI,CAAC,OAAO,GAAG,IAAI,YAAY,EAAE,CAAA;KAClC;IAED,iCAAO,GAAP;KACC;IAKD,4CAAkB,GAAlB,UAAmB,IAAa;KAE/B;IAED,8CAAoB,GAApB,UAAqB,IAAa;KAEjC;IAED,8CAAoB,GAApB,UAAqB,IAAa;KAEjC;IAEH,sBAAC;CAAA,IAAA;;SCpCe,UAAU,CAAC,SAAoB,EAAE,QAAa;IAAb,yBAAA,EAAA,aAAa;IAC5D,IAAI,OAAO,GAAGG,cAAY,CAAC,QAAQ,CAAC,CAAA;IACpC,IAAI,SAAS,GAAG,eAAe,CAAC,QAAQ,CAAC,CAAA;IACzC,IAAI,QAAQ,GAAG,OAAO,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAA;IAElD,IAAI,CAAC,QAAQ,EAAE;QACb,OAAO,EAAE,CAAA;KACV;IAED,OAAO,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,SAAS,EAAE;QAChD,SAAS,EAAE,QAAQ,CAAC,SAAS;KAC9B,CAAC,CAAA;CACH;AAED,SAAgB,WAAW,CACzB,UAAqB,EACrB,QAAmB,EACnB,QAAQ;;IAER,IAAI,OAAO,GAAGA,cAAY,CAAC,OAAO,QAAQ,KAAK,QAAQ,IAAI,QAAQ,GAAG,QAAQ,GAAG,EAAE,CAAC,CAAA;IACpF,IAAI,SAAS,GAAG,eAAe,CAAC,QAAQ,EAAE,cAAc,CAAC,qBAAqB,CAAC,CAAA;IAC/E,IAAI,SAAS,GAAG,OAAO,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAA;IACpD,IAAI,OAAO,GAAG,OAAO,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAA;IAEhD,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,EAAE;QAC1B,OAAO,EAAE,CAAA;KACV;IAED,OAAO,OAAO,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,EAAE,OAAO,CAAC,MAAM,EAAE,SAAS,EAAE;QACtE,cAAc,EAAE,SAAS,CAAC,SAAS;QACnC,YAAY,EAAE,OAAO,CAAC,SAAS;QAC/B,cAAc,EAAE,QAAQ,CAAC,cAAc;KACxC,CAAC,CAAA;CACH;AAGD,SAASA,cAAY,CAAC,QAAQ;IAC5B,IAAI,MAAM,GAAG,WAAW,CAAC,QAAQ,CAAC,MAAM,IAAI,IAAI,EAAE,eAAe,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAA;IAG1E,QAAQ,cACN,QAAQ,EAAE,cAAc,CAAC,QAAQ,EACjC,cAAc,EAAE,SAAS,IACtB,QAAQ,IACX,MAAM,QAAA,GACP,CAAA;IAED,OAAO,IAAI,OAAO,CAAC,QAAQ,CAAC,CAAA;CAC7B;;AC7BD,IAAM,eAAe,GAAG;IACtB,SAAS,EAAE,cAAc;IACzB,QAAQ,EAAE,cAAc;IACxB,MAAM,EAAE,OAAO;IACf,QAAQ,EAAE,MAAM;CACjB,CAAA;AAED,IAAM,kBAAkB,GAAG;IACzB,MAAM,EAAE,IAAI;CACb,CAAA;AAED,SAAgB,aAAa,CAAC,GAAkB;IAC9C,IAAI,aAAa,GAAG,EAAE,CAAA;IACtB,IAAI,OAAO,GAAG,WAAW,CAAC,GAAG,EAAE,eAAe,EAAE,kBAAkB,EAAE,aAAa,CAAa,CAAA;IAE9F,OAAO,CAAC,aAAa,GAAG,aAAa,CAAA;IAErC,OAAO,OAAO,CAAA;CACf;;SClCe,2BAA2B,CAAC,oBAA6B,EAAE,MAAc;IAGvF,IAAI,CAAC,oBAAoB,IAAI,MAAM,GAAG,EAAE,EAAE;QACxC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,CAAA;KAC5B;SAAM,IAAI,MAAM,GAAG,CAAC,EAAE;QACrB,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,SAAS,EAAE,UAAU,EAAE,IAAI,EAAE,CAAA;KAChF;SAAM;QACL,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,CAAA;KAC3B;CACF;AAED,SAAgB,cAAc,CAC5B,UAAsB,EACtB,WAAwB,EACxB,oBAAoB,EACpB,MAAM,EACN,aAAa,EACb,OAAyB,EACzB,OAAQ,EACR,UAAW;IAEL,IAAA,mBAAI,EAAE,yBAAO,EAAE,qBAAK,EAAE,yBAAO,CAAY;IAC/C,IAAI,WAAW,GAAG,mBAAmB,CAAC,WAAW,CAAC,WAAW,EAAE,UAAU,CAAC,CAAA;IAC1E,IAAI,UAAU,GAAG;QACf,eAAe;QACf,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC;KAC/B,CAAA;IACD,IAAI,SAAS,CAAA;IAEb,IAAI,OAAO,OAAO,CAAC,gBAAgB,KAAK,UAAU,EAAE;QAClD,SAAS,GAAG,OAAO,CAAC,gBAAgB,CAClC,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAC3B,CAAA;KACF;SAAM,IAAI,OAAO,OAAO,CAAC,gBAAgB,KAAK,UAAU,EAAE;QACzD,SAAS,GAAG,UAAU,CACpB,OAAO,CAAC,gBAAgB,CACtB,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAC3B,CACF,CAAA;KACF;SAAM;QACL,SAAS,GAAG,UAAU,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,CAAC,CAAA;KAClE;IAGD,IAAI,oBAAoB,EAAE;QACxB,UAAU,GAAG,UAAU,CAAC,MAAM;QAG5B,aAAa,CAAC,UAAU,EAAE,WAAW,EAAE,OAAO,EAAE,IAAI,CAAC,CACtD,CAAA;KACF;SAAM;QACL,UAAU,CAAC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC,CAAC,CAAA;KACzD;IAED,OAAO,EAAE;QACP,aAAa,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG;SACvC,CAAC,WAAW,IAAI,oBAAoB;YACnC,cAAc,GAAG,OAAO,CAAC,SAAS,CAAC,UAAU,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,GAAG,GAAG;YACxE,EAAE,CAAC;SACF,OAAO,GAAG,CAAC;YACV,YAAY,GAAG,OAAO,GAAG,GAAG;YAC5B,EAAE,CAAC;SACJ,UAAU;YACT,GAAG,GAAG,UAAU;YAChB,EAAE,CAAC;QACP,GAAG;SACF,WAAW;YAEV,mBAAmB,CACjB,IAAI,EACJ,EAAE,IAAI,EAAE,UAAU,EAAE,QAAQ,EAAE,CAAC,oBAAoB,IAAI,MAAM,KAAK,CAAC,EAAE,EACrE,SAAS,CACV;YAED,SAAS,CACV;QACH,OAAO,CAAA;CACV;;ACxED;IAAuCH,6BAA8B;IAKnE,mBAAY,OAAyB,EAAE,QAAqB;QAA5D,YACE,kBAAM,OAAO,CAAC,SAcf;QAZC,QAAQ,CAAC,SAAS,GAAG,EAAE,CAAA;QACvB,QAAQ,CAAC,WAAW,CAClB,KAAI,CAAC,EAAE,GAAG,aAAa,CACrB,qBAAqB,GAAG,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,IAAI;YAC7D,gBAAgB,GAAG,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,IAAI;YACxD,iBAAiB;YACnB,UAAU;YACZ,QAAQ,CACT,CACF,CAAA;QAED,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,EAAE,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;;KAC5C;IAED,2BAAO,GAAP;QACE,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;KACvB;IAED,0BAAM,GAAN,UAAO,KAA0B;QACzB,IAAA,mBAAK,EAAE,iDAAoB,CAAU;QAC3C,IAAI,KAAK,GAAG,EAAE,CAAA;QAEd,IAAI,KAAK,CAAC,eAAe,EAAE;YACzB,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,CAAA;SACpC;QAED,IAAI,aAAa,GAAG,eAAe,CACjC,IAAI,CAAC,GAAG,CAAC,oBAAoB,CAAC;YAC9B,2BAA2B,CAAC,oBAAoB,EAAE,KAAK,CAAC,MAAM,CAAC,CAChE,CAAA;QAED,KAAiB,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAK,EAAE;YAAnB,IAAI,IAAI,cAAA;YACX,KAAK,CAAC,IAAI,CACR,cAAc,CACZ,IAAI,EACJ,KAAK,CAAC,WAAW,EACjB,oBAAoB,EACpB,KAAK,CAAC,MAAM,EACZ,aAAa,EACb,IAAI,CAAC,OAAO,CACb,CACF,CAAA;SACF;QAED,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,KAAK,CAAC,OAAO,EAAE,CAAA;SAChB;QAED,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,OAAO,CAAA;KACzD;IAEH,gBAAC;CA3DD,CAAuC,SAAS,GA2D/C;;AC9DD;IAME,mBAAY,KAAgB,EAAE,oBAA0C;QACtE,IAAI,IAAI,GAAe,KAAK,CAAC,KAAK,CAAA;QAClC,IAAI,GAAG,GAAe,KAAK,CAAC,GAAG,CAAA;QAC/B,IAAI,OAAO,GAAa,EAAE,CAAA;QAC1B,IAAI,KAAK,GAAiB,EAAE,CAAA;QAC5B,IAAI,QAAQ,GAAG,CAAC,CAAC,CAAA;QAEjB,OAAO,IAAI,GAAG,GAAG,EAAE;YACjB,IAAI,oBAAoB,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE;gBAC1C,OAAO,CAAC,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC,CAAA;aAC7B;iBAAM;gBACL,QAAQ,EAAE,CAAA;gBACV,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;gBACtB,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;aACjB;YACD,IAAI,GAAG,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC,CAAA;SACxB;QAED,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAClB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;QACtB,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,MAAM,CAAA;KACxB;IAED,8BAAU,GAAV,UAAW,KAAgB;QACzB,IAAI,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;QAClD,IAAI,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAA;QAE5D,IAAI,iBAAiB,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,UAAU,CAAC,CAAA;QAC/C,IAAI,gBAAgB,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,EAAE,SAAS,CAAC,CAAA;QAGxD,iBAAiB,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;QAChD,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAA;QAE/C,IAAI,iBAAiB,IAAI,gBAAgB,EAAE;YACzC,OAAO;gBACL,UAAU,EAAE,iBAAiB;gBAC7B,SAAS,EAAE,gBAAgB;gBAC3B,OAAO,EAAE,UAAU,KAAK,iBAAiB;gBACzC,KAAK,EAAE,SAAS,KAAK,gBAAgB;aACtC,CAAA;SACF;aAAM;YACL,OAAO,IAAI,CAAA;SACZ;KACF;IAOO,mCAAe,GAAvB,UAAwB,IAAgB;QACtC,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAA;QAC1B,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAA;QAEzD,IAAI,SAAS,GAAG,CAAC,EAAE;YACjB,OAAO,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;SACtB;aAAM,IAAI,SAAS,IAAI,OAAO,CAAC,MAAM,EAAE;YACtC,OAAO,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,CAAA;SACvC;aAAM;YACL,OAAO,OAAO,CAAC,SAAS,CAAC,CAAA;SAC1B;KACF;IAEH,gBAAC;CAAA,IAAA;;ACjED;IASE,kBAAY,SAAoB,EAAE,YAAqB;QAC/C,IAAA,uBAAK,CAAc;QACzB,IAAI,UAAU,CAAA;QACd,IAAI,QAAQ,CAAA;QACZ,IAAI,MAAM,CAAA;QAEV,IAAI,YAAY,EAAE;YAEhB,QAAQ,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAA;YAC/B,KAAK,UAAU,GAAG,CAAC,EAAE,UAAU,GAAG,KAAK,CAAC,MAAM,EAAE,UAAU,EAAE,EAAE;gBAC5D,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC,SAAS,EAAE,KAAK,QAAQ,EAAE;oBAC9C,MAAK;iBACN;aACF;YACD,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,CAAC,CAAA;SAC9C;aAAM;YACL,MAAM,GAAG,CAAC,CAAA;YACV,UAAU,GAAG,KAAK,CAAC,MAAM,CAAA;SAC1B;QAED,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;QACpB,IAAI,CAAC,MAAM,GAAG,UAAU,CAAA;QACxB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;QAC1B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,UAAU,EAAE,CAAA;QAC9B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAA;KAC3C;IAEO,6BAAU,GAAlB;QACE,IAAI,IAAI,GAAG,EAAE,CAAA;QAEb,KAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;YAC1C,IAAI,KAAK,GAAG,EAAE,CAAA;YAEd,KAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;gBAC1C,KAAK,CAAC,IAAI,CACR,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,GAAG,CAAC,CACzB,CAAA;aACF;YAED,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;SACjB;QAED,OAAO,IAAI,CAAA;KACZ;IAEO,4BAAS,GAAjB,UAAkB,GAAG,EAAE,GAAG;QACxB,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC;SACpD,CAAA;KACF;IAEO,mCAAgB,GAAxB;QACE,IAAI,KAAK,GAAG,EAAE,CAAA;QAEd,KAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;YAC1C,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAA;SACpC;QAED,OAAO,KAAK,CAAA;KACb;IAED,6BAAU,GAAV,UAAW,KAAgB;QACnB,IAAA,oBAAM,CAAS;QACrB,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;QAChD,IAAI,IAAI,GAAkB,EAAE,CAAA;QAE5B,IAAI,SAAS,EAAE;YACP,IAAA,iCAAU,EAAE,+BAAS,CAAc;YACzC,IAAI,KAAK,GAAG,UAAU,CAAA;YAEtB,OAAO,KAAK,IAAI,SAAS,EAAE;gBACzB,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC,CAAA;gBACpC,IAAI,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,IAAI,MAAM,EAAE,SAAS,GAAG,CAAC,CAAC,CAAA;gBAE3D,IAAI,CAAC,IAAI,CAAC;oBACR,GAAG,KAAA;oBACH,QAAQ,EAAE,KAAK,GAAG,MAAM;oBACxB,OAAO,EAAE,CAAC,SAAS,GAAG,CAAC,IAAI,MAAM;oBACjC,OAAO,EAAE,SAAS,CAAC,OAAO,IAAI,KAAK,KAAK,UAAU;oBAClD,KAAK,EAAE,SAAS,CAAC,KAAK,IAAI,CAAC,SAAS,GAAG,CAAC,MAAM,SAAS;iBACxD,CAAC,CAAA;gBAEF,KAAK,GAAG,SAAS,CAAA;aAClB;SACF;QAED,OAAO,IAAI,CAAA;KACZ;IAEH,eAAC;CAAA,IAAA;;AClFD;IAAA;QAEU,uBAAkB,GAAG,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAA;QACtD,uBAAkB,GAAG,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;QACjD,oBAAe,GAAG,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;QAChD,mBAAc,GAAG,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;QAChD,qBAAgB,GAAG,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;KA8K3D;IA1KC,2BAAU,GAAV,UACE,KAAqB,EACrB,WAAwB,EACxB,gBAAiC,EACjC,SAA6B;QAC7B,mBAAuB;aAAvB,UAAuB,EAAvB,qBAAuB,EAAvB,IAAuB;YAAvB,kCAAuB;;QAEjB,IAAA,iCAAY,CAAU;QAC5B,IAAI,SAAS,GAAG,IAAI,CAAC,eAAe,OAApB,IAAI,GAAiB,KAAK,CAAC,UAAU,EAAE,YAAY,EAAE,WAAW,EAAE,gBAAgB,EAAE,SAAS,SAAK,SAAS,EAAC,CAAA;QAE5H,OAAO;YACL,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,OAAvB,IAAI,GAAoB,KAAK,CAAC,aAAa,EAAE,YAAY,EAAE,SAAS,SAAK,SAAS,EAAC;YACtG,gBAAgB,EAAE,IAAI,CAAC,kBAAkB,OAAvB,IAAI,GAAoB,KAAK,CAAC,aAAa,EAAE,WAAW,EAAE,gBAAgB,EAAE,SAAS,SAAK,SAAS,EAAC;YACtH,WAAW,EAAE,SAAS,CAAC,EAAE;YACzB,WAAW,EAAE,SAAS,CAAC,EAAE;YACzB,SAAS,EAAE,IAAI,CAAC,cAAc,OAAnB,IAAI,GAAgB,KAAK,CAAC,SAAS,EAAE,YAAY,EAAE,WAAW,EAAE,gBAAgB,EAAE,SAAS,SAAK,SAAS,EAAC;YACrH,WAAW,EAAE,IAAI,CAAC,gBAAgB,OAArB,IAAI,GAAkB,KAAK,CAAC,WAAW,EAAE,YAAY,EAAE,WAAW,EAAE,gBAAgB,EAAE,SAAS,SAAK,SAAS,EAAC;YAC3H,cAAc,EAAE,KAAK,CAAC,cAAc;SACrC,CAAA;KACF;IAED,6BAAY,GAAZ;IACE,IAAgB,EAChB,SAA6B;QAC7B,mBAAuB;aAAvB,UAAuB,EAAvB,qBAAuB,EAAvB,IAAuB;YAAvB,kCAAuB;;QAEvB,OAAO,IAAI,CAAC,cAAc,OAAnB,IAAI,GACT,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE;YAC9D,EAAE;YACF,SAAS,SACN,SAAS,GACb;KACF;IAEO,oCAAmB,GAA3B,UACE,aAAyB,EACzB,WAAwB,EACxB,gBAAiC,EACjC,SAA6B;QAC7B,mBAAuB;aAAvB,UAAuB,EAAvB,qBAAuB,EAAvB,IAAuB;YAAvB,kCAAuB;;QAEvB,IAAI,CAAC,aAAa,EAAE;YAClB,OAAO,EAAE,CAAA;SACV;QAED,OAAO,IAAI,CAAC,gBAAgB,OAArB,IAAI,GACT,eAAe,CACb,aAAa,EACb,kBAAkB,CAAC,WAAW,EAAE,OAAO,CAAC,gBAAgB,CAAC,CAAC,EAC1D,SAAS,CAAC,QAAQ,CACnB;YACD,EAAE;YACF,WAAW;YACX,gBAAgB;YAChB,SAAS,SACN,SAAS,GACZ,EAAE,CAAA;KACL;IAEO,iCAAgB,GAAxB,UACE,UAAsB,EACtB,YAAyB,EACzB,WAAwB,EACxB,gBAAiC,EACjC,SAA6B;QAC7B,mBAAuB;aAAvB,UAAuB,EAAvB,qBAAuB,EAAvB,IAAuB;YAAvB,kCAAuB;;QAEvB,IAAI,UAAU,EAAE;YACd,IAAI,QAAQ,GAAG,eAAe,CAC5B,UAAU,EACV,YAAY,EACZ,kBAAkB,CAAC,WAAW,EAAE,OAAO,CAAC,gBAAgB,CAAC,CAAC,EAC1D,gBAAgB,CACjB,CAAA;YAED,OAAO;gBACL,EAAE,EAAE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,EAAE,EAAE,SAAS,EAAE,SAAS,CAAC;gBAC5D,EAAE,EAAE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,EAAE,EAAE,SAAS,EAAE,SAAS,CAAC;aAC7D,CAAA;SAEF;aAAM;YACL,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAA;SAC1B;KACF;IAEO,kCAAiB,GAAzB,UACE,WAAkC,EAClC,YAAyB,EACzB,WAAwB,EACxB,gBAAiC,EACjC,SAA6B;QAC7B,mBAAuB;aAAvB,UAAuB,EAAvB,qBAAuB,EAAvB,IAAuB;YAAvB,kCAAuB;;QAEvB,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,IAAI,CAAA;SACZ;QAED,IAAI,QAAQ,GAAG,eAAe,CAC5B,WAAW,CAAC,aAAa,EACzB,YAAY,EACZ,kBAAkB,CAAC,WAAW,EAAE,OAAO,CAAC,gBAAgB,CAAC,CAAC,EAC1D,gBAAgB,CACjB,CAAA;QAED,OAAO;YACL,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,EAAE,EAAE,SAAS,EAAE,SAAS,CAAC;YAC9D,iBAAiB,EAAE,WAAW,CAAC,cAAc,CAAC,SAAS;YACvD,OAAO,EAAE,WAAW,CAAC,OAAO;YAC5B,SAAS,EAAE,WAAW,CAAC,OAAO;SAC/B,CAAA;KACF;IAEO,+BAAc,GAAtB,UACE,QAAkB,EAClB,YAAyB,EACzB,SAA6B;QAC7B,mBAAuB;aAAvB,UAAuB,EAAvB,qBAAuB,EAAvB,IAAuB;YAAvB,kCAAuB;;QAEvB,IAAI,CAAC,QAAQ,EAAE;YACb,OAAO,EAAE,CAAA;SACV;QAED,IAAI,UAAU,GAAG,mBAAmB,CAAC,QAAQ,EAAE,YAAY,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAA;QAChF,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,OAAf,IAAI,GAAY,QAAQ,CAAC,KAAK,SAAK,SAAS,EAAC,CAAA;QAExD,KAAgB,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,EAAE;YAAjB,IAAI,GAAG,aAAA;YACV,GAAG,CAAC,SAAS,GAAG,SAAS,CAAA;YACzB,GAAG,CAAC,UAAU,GAAG,UAAU,CAAA;SAC5B;QAED,OAAO,IAAI,CAAA;KACZ;IAKO,iCAAgB,GAAxB,UACE,WAA+B,EAC/B,SAA6B;IAC7B,SAAoB;QAEpB,IAAI,IAAI,GAAc,EAAE,CAAA;QAExB,KAAuB,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAW,EAAE;YAA/B,IAAI,UAAU,oBAAA;YACjB,IAAI,CAAC,IAAI,OAAT,IAAI,EAAS,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,SAAS,EAAE,SAAS,CAAC,EAAC;SACrE;QAED,OAAO,IAAI,CAAA;KACZ;IAKO,gCAAe,GAAvB,UACE,UAA4B,EAC5B,SAA6B;IAC7B,SAAoB;QAEpB,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,OAAf,IAAI,GAAY,UAAU,CAAC,KAAK,SAAK,SAAS,EAAC,CAAA;QAE1D,KAAgB,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,EAAE;YAAjB,IAAI,GAAG,aAAA;YACV,GAAG,CAAC,SAAS,GAAG,SAAS,CAAA;YACzB,GAAG,CAAC,UAAU,GAAG,UAAU,CAAA;YAC3B,GAAG,CAAC,OAAO,GAAG,UAAU,CAAC,OAAO,IAAI,GAAG,CAAC,OAAO,CAAA;YAC/C,GAAG,CAAC,KAAK,GAAG,UAAU,CAAC,KAAK,IAAI,GAAG,CAAC,KAAK,CAAA;SAC1C;QAED,OAAO,IAAI,CAAA;KACZ;IAEH,aAAC;CAAA,IAAA;AAOD,SAAS,kBAAkB,CAAC,WAAwB,EAAE,iBAA0B;IAC9E,IAAI,KAAK,GAAG,WAAW,CAAC,WAAW,CAAA;IAEnC,IAAI,iBAAiB,EAAE;QACrB,OAAO,KAAK,CAAA;KACb;IAED,OAAO;QACL,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE,WAAW,CAAC,OAAO,CAAC,YAAY,CAAC;QAC3D,GAAG,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE,WAAW,CAAC,OAAO,CAAC,YAAY,GAAG,KAAK,CAAC;KAChE,CAAA;CACF;;IClOY,OAAO,GAAG,OAAgB;;;;"}